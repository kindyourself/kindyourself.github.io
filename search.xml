<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Base64-ä¸é‡è¦æ•°æ®çš„ç®€å•åŠ å¯†</title>
    <url>/2016/07/09/Base64-%E4%B8%8D%E9%87%8D%E8%A6%81%E6%95%B0%E6%8D%AE%E7%9A%84%E7%AE%80%E5%8D%95%E5%8A%A0%E5%AF%86/</url>
    <content><![CDATA[<h2 id="å¯¼è¯­"><a href="#å¯¼è¯­" class="headerlink" title="å¯¼è¯­"></a>å¯¼è¯­</h2><blockquote>
<p> æœ€è¿‘å…¬å¸è¦æ±‚å¯¹æœåŠ¡å™¨çš„tokenç­‰å‚æ•°è¿›è¡Œä¸€ä¸ªç®€å•çš„åŠ å¯†ï¼Œé˜²æ­¢æ¶æ„è¯·æ±‚ã€‚è¦æ±‚åŠ å¯†è¿‡ç¨‹è‡ªå®šä¹‰ï¼Œäºæ˜¯å°±æƒ³åˆ°äº†ç”¨base64ï¼Œå…¶å®è¿™ä¸æ˜¯ä¸€ä¸ªåŠ å¯†è§£å¯†çš„ç®—æ³•ï¼Œå…¶å®å®ƒå°±æ˜¯ä½¿ç”¨64ä¸ªå­—ç¬¦æ¥å¯¹ä»»æ„æ•°æ®è¿›è¡Œç¼–ç è§£ç çš„ï¼Œå…·ä½“åº•å±‚å®ç°åŸç†å°±ä¸è®¨è®ºäº†ï¼Œå®ƒæ˜¯éšç€iOS7æ¨å‡ºçš„ã€‚</p>
</blockquote>
<p>##æˆ‘çš„å®ç°è¿‡ç¨‹ï¼ˆå¯ä»¥æ ¹æ®å…¬å¸éœ€æ±‚è‡ªå®šä¹‰ï¼‰ï¼š</p>
<ol>
<li>å…ˆç¼–ç ä¸€æ¬¡</li>
<li>å¯¹ç¼–ç ç»“æœçš„æ•°æ®äº¤æ¢é¦–ä½å­—ç¬¦åœ¨ç¼–ç ä¸€æ¬¡</li>
<li>å¯¹ç¼–ç ç»“æœé€†åºåœ¨ç¼–ç ä¸€æ¬¡</li>
</ol>
<p>##ç¤ºä¾‹ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+(NSString *)base64EncodedString:(NSString *)string &#123;</span><br><span class="line">Base64Encoding *base64 = [[Base64Encoding alloc] init];</span><br><span class="line">   </span><br><span class="line">    // 1æ¬¡</span><br><span class="line">    NSString *encrypt1 = [base64 base64EncodedString:string];</span><br><span class="line">    // äº¤æ¢å­—ç¬¦ä¸²é¦–ä½æ¬¡åº</span><br><span class="line">    NSString *string1 = [base64 changeStringFirsrAndLast:encrypt1];</span><br><span class="line">    </span><br><span class="line">    // 2æ¬¡</span><br><span class="line">    NSString *encrypt2 = [base64 base64EncodedString:string1];</span><br><span class="line">    // äº¤æ¢å­—ç¬¦ä¸²é¦–ä½æ¬¡åº</span><br><span class="line">    NSString *string2 = [base64 changeStringOrder:encrypt2];</span><br><span class="line">    </span><br><span class="line">    // 3æ¬¡</span><br><span class="line">    NSString *encrypt3 = [base64 base64EncodedString:string2];</span><br><span class="line">    </span><br><span class="line">    return encrypt3;</span><br><span class="line">&#125;</span><br><span class="line">// æ·»åŠ é€—å·</span><br><span class="line">- (NSString *)addSeparaedSingle:(NSString *)string &#123;</span><br><span class="line">    NSMutableString *mutableString = [string mutableCopy];</span><br><span class="line">    NSInteger cont = mutableString.length;</span><br><span class="line">    for (int i = 0; i &lt; cont - 1; i ++) &#123;</span><br><span class="line">        [mutableString insertString:@&quot;,&quot; atIndex:2 * i + 1];</span><br><span class="line">    &#125;</span><br><span class="line">    return mutableString;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å»æ‰é€—å·</span><br><span class="line">- (NSString *)removeSeparaedSingle:(NSString *)string &#123;</span><br><span class="line">   return [string stringByReplacingOccurrencesOfString:@&quot;,&quot; withString:@&quot;&quot;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å­—ç¬¦ä¸²è½¬æ•°ç»„</span><br><span class="line">- (NSMutableArray *)stringChangeArray:(NSString *)string &#123;</span><br><span class="line">    NSMutableArray *mutableArray = [NSMutableArray arrayWithArray:[string componentsSeparatedByString:@&quot;,&quot;]];</span><br><span class="line">    return mutableArray;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// æ•°ç»„è½¬å­—ç¬¦ä¸²</span><br><span class="line">- (NSString *)arrayChangeString:(NSArray *)array &#123;</span><br><span class="line">    return [array componentsJoinedByString:@&quot;,&quot;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å­—ç¬¦ä¸²äº¤æ¢é¦–å°¾</span><br><span class="line">- (NSString *)changeStringFirsrAndLast:(NSString *)string &#123;</span><br><span class="line">    NSString *str = [self addSeparaedSingle:string];</span><br><span class="line">    NSMutableArray *mutableArray = [self stringChangeArray:str];</span><br><span class="line">    NSString *temp = mutableArray[0];</span><br><span class="line">    mutableArray[0] = mutableArray[mutableArray.count - 1];</span><br><span class="line">    mutableArray[mutableArray.count - 1] = temp;</span><br><span class="line">    NSString *arrayString = [self arrayChangeString:mutableArray];</span><br><span class="line">    return [self removeSeparaedSingle:arrayString];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å­—ç¬¦ä¸²é€†åº</span><br><span class="line">- (NSString *)changeStringOrder:(NSString *)string &#123;</span><br><span class="line">    NSString *str = [self addSeparaedSingle:string];</span><br><span class="line">    NSMutableArray *mutableArray = [self stringChangeArray:str];</span><br><span class="line">    NSArray *reversedArray = [[mutableArray reverseObjectEnumerator] allObjects];</span><br><span class="line">    NSString *arrayString = [self arrayChangeString:reversedArray];</span><br><span class="line">    return [self removeSeparaedSingle:arrayString];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ç¼–ç </span><br><span class="line">- (NSString *)base64EncodedString:(NSString *)string &#123;</span><br><span class="line">    NSData *data = [string dataUsingEncoding:NSUTF8StringEncoding];</span><br><span class="line">    return [data base64EncodedStringWithOptions:0];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>###ç»“æŸè¯­ï¼š</p>
<blockquote>
<p>  è¿™ä¸ªå¯ä»¥æ ¹æ®å…¬å¸çš„è¦æ±‚è·Ÿåå°å†™çš„å¥½åŠ å¯†çš„è§„åˆ™ï¼Œè§£å¯†å°±äº¤ç»™åå°äº†ï¼Œ<code>æ–¹æ³•ï¼šinitWithBase64EncodedData</code> é‡‡ç”¨é€†å‘è§„åˆ™è§£å¯†å³å¯ï¼Œå½“ç„¶è¿™ä¸ªæ˜¯æå…¶å®¹æ˜“è¢«ç ´è§£çš„ï¼Œæ¶‰åŠæ•æ„Ÿæ•°æ®æ˜¯ä¸å¯ä½¿ç”¨è¿™ä¸ªæ–¹æ³•çš„ã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>â€œBase64â€</tag>
        <tag>â€œåŠ å¯†â€</tag>
      </tags>
  </entry>
  <entry>
    <title>UISearchBarè¯¦è§£</title>
    <url>/2017/03/11/UISearchBar%E8%AF%A6%E8%A7%A3/</url>
    <content><![CDATA[<blockquote>
<p>ä»Šå¤©å…¬å¸çš„é¡¹ç›®æµ‹è¯•çš„å·®ä¸å¤šäº†ï¼ŒåŸºæœ¬å¯ä»¥ä¸Šæ¶äº†ï¼Œåˆæœ‰æ—¶é—´æ¥åˆ†äº«ä¸€ä¸‹æœ€è¿‘é‡åˆ°çš„ä¸€äº›é—®é¢˜äº†ï¼Œå…¬å¸çš„é¡¹ç›®è¿›è¡Œäº†å¤§æ”¹ç‰ˆï¼ˆåº”è¯¥æ˜¯å…¨æ”¹äº†ï¼ŒåŸºæœ¬æ˜¯ä¸€ä¸ªæ–°çš„é¡¹ç›®äº†ï¼‰ï¼Œè€å¤§å†³å®šç”¨swifté‡å†™ã€‚ä¹‹å‰ä¸€ç›´åœ¨è‡ªå­¦swiftï¼Œç»ˆäºè¿™ä¸€æ¬¡å¯ä»¥å®æˆ˜äº†ã€‚é¡¹ç›®ä¸­æœç´¢ç”¨çš„æ¯”è¾ƒå¤šï¼Œä½†æ˜¯æœç´¢æ¡†çš„æ ·å¼ä¸é»˜è®¤çš„å·®åˆ«å¤ªå¤§äº†ï¼Œæ‰€ä»¥åªèƒ½è‡ªå®šä¹‰äº†ã€‚</p>
</blockquote>
<p>The UISearchBar class implements a text field control for text-based searches. The control provides a text field for entering text, a search button, a bookmark button, and a cancel button. The UISearchBar object does not actually perform any searches. You use a delegate, an object conforming to the UISearchBarDelegate protocol, to implement the actions when text is entered and buttons are clicked.</p><p>

<blockquote>
<p>ä»¥ä¸Šæ˜¯è‹¹æœå¯¹UISearchBarçš„è§£é‡Šï¼Œå¯ä»¥çœ‹è§UISearchBaræä¾›äº†ç±»ä¼¼UITextFieldçš„è¾“å…¥ï¼ˆå…¶å®å®ƒçš„ç»„æˆä¸­å°±æœ‰UITextFieldï¼Œä¸‹é¢ä¼šè®²åˆ°ï¼‰ï¼Œå³è¾¹æœ‰æœç´¢æŒ‰é’®ã€æ ‡ç­¾æŒ‰é’®ã€å…³é—­æŒ‰é’®å¯ä¾›é€‰æ‹©ï¼Œæœç´¢éƒ½æ˜¯åœ¨åè®®UISearchBarDelegateä¸­è¿›è¡Œã€‚</p>
</blockquote>
</p><p><strong>è‡ªå®šä¹‰å¤–è§‚</strong></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/7efbcef7e9cb93c4383fe6794bdbefdf.webp?x-image-process=image/format,png" alt="é»˜è®¤æœç´¢å¤–è§‚"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/226c294545fe64cc3f3f91cd71df0146.webp?x-image-process=image/format,png" alt="é¡¹ç›®æœç´¢å¤–è§‚"></p>
<blockquote>
<p>UISearchBarçš„å±‚çº§å¾ˆæ˜¯å¤æ‚ä¸»è¦ç”±UISearchBarBackgroudã€UISearchBarTextFieldã€<br>UINavigationButtonç»„æˆï¼Œå…¶ä¸­UISearchBarTextFieldå°±æ˜¯è¾“å…¥æ¡†ï¼Œä¸»è¦æ˜¯ç”±â€”â€”UISearchBarSearchFieldBackgroundViewã€UIButtonï¼ˆâŒï¼‰ã€UIImageViewï¼ˆ?ï¼‰ç­‰ç»„æˆï¼Œ</p>
</blockquote>
<p><strong>è·å–TextFieldæ–¹æ³•ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">let searchFiled:UITextField = self.searchBar.value(forKey: &quot;_searchField&quot;) as! UITextField</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>è¿™æ ·å°±å¯ä»¥é€šè¿‡ä¿®æ”¹	searchFiledæ¥ä¿®æ”¹è¾“å…¥æ ·å¼ï¼ˆåœ†è§’ã€å­—ä½“ç­‰ï¼‰ã€‚</strong></p>
<blockquote>
<p>UISearchBarçš„ç›´æ¥å­æ§ä»¶æ˜¯UIVIewï¼Œå…¶ä¸Šçš„å­æ§ä»¶UISearchBarBackgroudçš„frameä¸UISearchBarçš„boundsç›¸ç­‰ï¼ŒUISearchBarTextFieldçš„é«˜åº¦é»˜è®¤ä¸º28ä¸UISearchBarå·¦å³æœ‰8åƒç´ çš„å›ºå®šé—´è·ï¼Œä¸Šä¸‹é—´è·ä¸ºç›´æ¥å­æ§ä»¶UIViewçš„é«˜åº¦ - UISearchBarTextFieldçš„é»˜è®¤é«˜åº¦28 å†é™¤ä»¥2ã€‚å› æ­¤UISearchBarçš„è¾“å…¥æ¡†å§‹ç»ˆä¸è®¾ç½®çš„frameä¸ä¸€æ ·ï¼Œä¸ä¾¿äºå¸ƒå±€ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªå­ç±»ç»§æ‰¿UISearchBarï¼Œå¯ä»¥æ›´æ”¹å…¶å†…è¾¹è·ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class MySearchBar: UISearchBar &#123;</span><br><span class="line">    </span><br><span class="line">    // ç›‘å¬æ˜¯å¦æ·»åŠ äº†è¯¥å±æ€§</span><br><span class="line">    var contentInset: UIEdgeInsets? &#123;</span><br><span class="line">        didSet &#123;</span><br><span class="line">            self.layoutSubviews()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    override func layoutSubviews() &#123;</span><br><span class="line">        super.layoutSubviews()</span><br><span class="line">        // ä¾¿åˆ©å¯»æ‰¾</span><br><span class="line">        for view in self.subviews &#123;</span><br><span class="line">            for subview in view.subviews &#123;</span><br><span class="line">                // åˆ¤å®šæ˜¯å¦æ˜¯UISearchBarTextField</span><br><span class="line">                if subview.isKind(of: UITextField.classForCoder()) &#123;</span><br><span class="line">                    if let textFieldContentInset = contentInset &#123;</span><br><span class="line">                        // ä¿®æ”¹UISearchBarTextFieldçš„å¸ƒå±€</span><br><span class="line">                        subview.frame = CGRect(x: textFieldContentInset.left, y: textFieldContentInset.top, width: self.bounds.width - textFieldContentInset.left - textFieldContentInset.right, height: self.bounds.height - textFieldContentInset.top - textFieldContentInset.bottom)</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        // è®¾ç½®UISearchBarä¸­UISearchBarTextFieldçš„é»˜è®¤è¾¹è·</span><br><span class="line">                        let top: CGFloat = (self.bounds.height - 28.0) / 2.0</span><br><span class="line">                        let bottom: CGFloat = top</span><br><span class="line">                        let left: CGFloat = 8.0</span><br><span class="line">                        let right: CGFloat = left</span><br><span class="line">                        contentInset = UIEdgeInsets(top: top, left: left, bottom: bottom, right: right)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è®©å®ä¾‹åŒ–çš„UISearchBarç»§æ‰¿MySearchBarï¼Œç„¶åå°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç›´æ¥æ§åˆ¶å†…è¾¹è·äº†</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">self.searchBar.contentInset = UIEdgeInsets(top: 0, left: 0, bottom: 0, right: 0)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ¥ä¸‹æ¥å°±æ˜¯å¤„ç†placeholderé å·¦ï¼Œè¿™ä¸ªå°±æ¯”è¾ƒéº»çƒ¦äº†ï¼ŒæŸ¥è¯¢äº†ä¸€å¤§å †åŠæ³•éƒ½æŒºéº»çƒ¦çš„ï¼Œæœ€åæ‰¾åˆ°äº†ä¸€ä¸ªå¾ˆæŠ•æœºçš„åŠæ³•ï¼šå…ˆåˆ¤å®šæ‰‹æœºå®½åº¦ï¼Œç„¶ååœ¨placeholderå³è¾¹åŠ ä¸Šç©ºæ ¼åšæˆé å·¦çš„å‡è±¡ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if SCREEN.WIDTH == 320 &#123;</span><br><span class="line">           self.searchBar.placeholder = &quot;æœç´¢ä½ç½®       &quot;</span><br><span class="line">       &#125;else if SCREEN.WIDTH == 373\5 &#123;</span><br><span class="line">           self.searchBar.placeholder = &quot;æœç´¢ä½ç½®                  &quot;</span><br><span class="line">       &#125;else if SCREEN.WIDTH == 414 &#123;</span><br><span class="line">           self.searchBar.placeholder = &quot;æœç´¢ä½ç½®                                 &quot;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç„¶ååœ¨storyboardä¸­è®¾ç½®searchBarçš„BarStyleä¸ºMinimalå°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ§åˆ¶UISearchBarçš„å¤–è§‚äº†ã€‚<br>åˆ°è¿™é‡Œå°±å‰©ä¸€ä¸ªé—®é¢˜äº†ï¼šUISearchBarä¸Šä¸‹çš„ä¸¤æ ¹é»‘çº¿äº†ï¼Œ</p>
</blockquote>
<p><strong>å»é™¤æ–¹æ³•ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">self.searchBar.setBackgroundImage(UIImage.init(), for: .any, barMetrics: .default)</span><br></pre></td></tr></table></figure>

<p><strong>æœç´¢çš„ä½¿ç”¨</strong></p>
<blockquote>
<p>å¦‚è‹¹æœå®˜æ–¹æ–‡æ¡£æ‰€è¯´ï¼Œä¸æœç´¢ç›¸å…³çš„éƒ½æ˜¯åœ¨å…¶ä»£ç†æ–¹æ³•ä¸­å®Œæˆã€‚UISearchBaræœ‰å¾ˆå¤šçš„ä»£ç†æ–¹æ³•ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥ç‚¹å‡»è¿›å…¥æŸ¥çœ‹</p>
</blockquote>
<p><a href="https://developer.apple.com/reference/uikit/uisearchbardelegate">UISearchBarDelegate</a>æˆ‘å°±ä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„ï¼š</p>
<blockquote>
<p>å½“æœç´¢å†…å®¹å˜åŒ–æ—¶ï¼Œæ‰§è¡Œè¯¥æ–¹æ³•,å¯ä»¥å®æ—¶ç›‘å¬è¾“å…¥æ¡†çš„å˜åŒ–,å¯ä»¥å®ç°æ—¶å®æœç´¢ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- (BOOL)searchBar:(UISearchBar *)searchBar shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)textNS_AVAILABLE_IOS(3_0);                 // called before text changes</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¹Ÿè¡Œä½ æƒ³æŠŠæœç´¢äº‹ä»¶æ”¾åœ¨ç‚¹å‡»æœç´¢ä»¥åå†è§¦å‘ï¼Œé‚£å°±é€‰ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå®ƒå°±æ˜¯ç‚¹å‡»æœç´¢åçš„ä»£ç†æ–¹æ³•</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- (void)searchBarSearchButtonClicked:(UISearchBar *)searchBar;</span><br></pre></td></tr></table></figure>

<h3 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h3><blockquote>
<p>å½“ç„¶å¦‚æœä½ è§‰å¾—è¿™æ ·å¤ªéº»çƒ¦äº†ï¼Œä½ è¿˜å¯ä»¥é€‰æ‹©ç”¨UITextFieldæ¥å®ç°UISearchBarçš„åŠŸèƒ½ï¼Œä½†æ˜¯æœ€ç»ˆå“ªä¸€ä¸ªæ›´åŠ çš„éº»çƒ¦è¿˜éœ€è¦è¯•ä¸€è¯•æ‰çŸ¥é“ã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>swift</category>
      </categories>
      <tags>
        <tag>â€œiOSâ€</tag>
        <tag>â€œswiftâ€</tag>
        <tag>â€œUISearchBarâ€</tag>
      </tags>
  </entry>
  <entry>
    <title>Flutteré‡åˆ°çš„é—®é¢˜</title>
    <url>/2025/05/23/flutter-error/</url>
    <content><![CDATA[<blockquote>
<p><strong>1.Flutter In ios 14+,debug mode Flutter apps can only be launched from Flutter toolingã€‚<br>åŸå› ï¼šDebugæ¨¡å¼ä¸‹ï¼ŒFlutterä¹Ÿå®ç°äº†çƒ­é‡è½½ï¼Œé»˜è®¤ç¼–è¯‘æ–¹å¼ä¸ºJITè€ŒiOS 14+ç³»ç»Ÿå¯¹è¿™ç§ç¼–è¯‘æ¨¡å¼åšäº†é™åˆ¶ï¼Œå¯¼è‡´æ— æ³•å¯åŠ¨ã€‚</strong></p>
</blockquote>
<p>è§£å†³åŠæ³•å¦‚ä¸‹ï¼šç”¨ [Xcode] æ‰“å¼€Flutteré‡Œé¢Runnerå·¥ç¨‹é¡¹ç›®ï¼Œåœ¨ Build Settings çš„æœ€ä¸‹æ–¹æ‰¾åˆ° User-Definedï¼Œç‚¹å‡» + æŒ‰é’®ï¼Œæ·»åŠ ä¸€ä¸ªé”®ä¸º FLUTTER_BUILD_MODE ï¼Œdebugè®¾ç½®profileæ¨¡å¼ï¼Œreleaseè®¾ç½®release æ¨¡å¼ï¼š<img src="https://i-blog.csdnimg.cn/img_convert/7f789a7b66202aa3d5d577d4ff7a4b51.webp?x-oss-process=image/format,png" alt="æˆªå±2024-03-14 11.27.00.png">{target&#x3D;â€_blankâ€}</p>
<blockquote>
<p><strong>2.å°† flutter æ¨¡å— åµŒå…¥iOSå·¥ç¨‹ä¸­ï¼Œç¼–è¯‘æ—¶æŠ¥é”™ï¼šFailed to package ã€‚ã€‚ã€‚ã€‚flutterä»£ç è·¯å¾„ã€‚ã€‚ã€‚ã€‚ã€‚Command PhaseScriptExecution failed with a nonzero exit code</strong><br><img src="https://i-blog.csdnimg.cn/img_convert/ad21f4b3e2a82eb701e1e9363f00d885.webp?x-oss-process=image/format,png" alt="æˆªå±2024-03-14 11.28.18.png">{target&#x3D;â€_blankâ€}</p>
</blockquote>
<p>è§£å†³åŠæ³•å¦‚ä¸‹ï¼š<br><strong>1.ç¡®ä¿flutteré¡¹ç›®ä»£ç ä¸­æ²¡æœ‰é”™è¯¯</strong><br><strong>2.é‡æ–°æ„å»ºé¡¹ç›®ï¼š</strong><br><strong>flutter clean</strong><br><strong>2.flutter pub getï¼ˆè·å–è¿œç¨‹åº“,ç¡®å®šå½“å‰åº”ç”¨æ‰€ä¾èµ–çš„åŒ…ï¼Œå¹¶å°†å®ƒä»¬ä¿å­˜åˆ°ä¸­å¤®ç³»ç»Ÿç¼“å­˜ï¼ˆcentral system cacheï¼‰ä¸­ï¼‰</strong><br><strong>3.flutter run</strong></p>
<blockquote>
<p><strong>3.å‡çº§flutterï¼šflutter upgrade â€“force æŠ¥é”™</strong><br><img src="https://i-blog.csdnimg.cn/img_convert/ed59f544c4becaac4c167e3128af66ca.webp?x-oss-process=image/format,png" alt="æˆªå±2024-09-12 15.23.05.png">{target&#x3D;â€_blankâ€}</p>
</blockquote>
<p>Flutter Channelç‰ˆæœ¬é€‰æ‹©<br>Flutteræä¾›äº†Stableã€Betaã€Devå’ŒMasterå››ç§ç‰ˆæœ¬ï¼Œæ¯ç§ç‰ˆæœ¬éƒ½æœ‰å…¶ç‰¹å®šçš„ç”¨é€”å’Œç¨³å®šæ€§ï¼š<br>Stableï¼šæœ€ç¨³å®šçš„ç‰ˆæœ¬ï¼Œæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒã€‚<br>Betaï¼šç›¸å¯¹è¾ƒç¨³å®šï¼Œä½†ä»å¯èƒ½å­˜åœ¨ä¸€äº›å·²çŸ¥é—®é¢˜ã€‚<br>Devï¼šç»è¿‡Googleæµ‹è¯•åçš„æœ€æ–°ç‰ˆæœ¬ï¼ŒåŒ…å«æ–°åŠŸèƒ½å’Œæ”¹è¿›ã€‚<br>Masterï¼šæœ€æ–°çš„ä»£ç ä¸»åˆ†æ”¯ï¼Œæ›´æ–°é€Ÿåº¦éå¸¸å¿«ï¼Œå‡ ä¹æ¯å¤©éƒ½æœ‰æäº¤ï¼Œæ–°åŠŸèƒ½å¤šä½†å¯èƒ½ä¸ç¨³å®šã€‚<br>å¼€å‘Flutteré¡¹ç›®æ—¶ï¼Œä¸€èˆ¬æ¨èä½¿ç”¨Stableç‰ˆæœ¬ï¼Œä»¥ç¡®ä¿é¡¹ç›®çš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚å¦‚éœ€ä½¿ç”¨æŸäº›å°šæœªåœ¨Stableç‰ˆæœ¬ä¸­æ”¯æŒçš„åŠŸèƒ½ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨Betaæˆ–Devç‰ˆæœ¬ã€‚Masterç‰ˆæœ¬åˆ™æ›´é€‚åˆäºé‚£äº›å¸Œæœ›å°è¯•æœ€æ–°åŠŸèƒ½å¹¶æ„¿æ„æ‰¿å—æ½œåœ¨ä¸ç¨³å®šæ€§çš„å¼€å‘è€…ã€‚</p>
]]></content>
      <categories>
        <category>Flutter</category>
      </categories>
      <tags>
        <tag>â€œFlutterâ€</tag>
        <tag>â€œErrorâ€</tag>
      </tags>
  </entry>
  <entry>
    <title>gitHub hexo ä¸ªäººåšå®¢å‡çº§ç‰ˆ</title>
    <url>/2025/06/11/gitHub-hexo-%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E5%8D%87%E7%BA%A7%E7%89%88/</url>
    <content><![CDATA[<blockquote>
<p>9å¹´å‰è‡ªå·±å¼€å§‹å­¦ä¹ gitHub hexoæ­å»ºä¸ªäººåšå®¢ï¼ŒæŸ¥äº†å¾ˆå¤šèµ„æ–™ï¼Œæœ€åç”¨hexo æ­å»ºä¸€ä¸ªä¸ªäººåšå®¢ï¼Œæ‰˜ç®¡åœ¨gitHubä¸Šï¼Œå‰æ®µæ—¶é—´æ¢äº†ä¸€ä¸ªç”µè„‘ï¼Œæˆ‘åœ¨æ–°çš„ç”µè„‘ä¸Šæƒ³å†å‘å¸ƒä¸€ç¯‡æ–‡ç« ï¼Œæ‰å‘ç°ä¸è¡Œäº†ã€‚å› ä¸ºä¹‹å‰åªåœ¨GitHubæ‰˜ç®¡äº†hexoç”Ÿæˆçš„é™æ€æ–‡ä»¶(public)ï¼Œå¿˜è®°å¤‡ä»½Hexoçš„æºæ–‡ä»¶ã€‚<br>source&#x2F;_posts&#x2F;ï¼ˆæ‰€æœ‰æ–‡ç« ï¼‰<br>_config.ymlï¼ˆHexo ä¸»é…ç½®ï¼‰<br>themes&#x2F;ï¼ˆä¸»é¢˜æ–‡ä»¶ï¼‰<br>package.jsonï¼ˆä¾èµ–åˆ—è¡¨ï¼‰<br>å¦‚æœä½ é‡åˆ°è¿™ç§æƒ…å†µï¼Œè·Ÿç€æˆ‘è¿›å…¥æ¥ä¸‹æ¥çš„é‡æ–°éƒ¨ç½²è¿‡ç¨‹ã€‚</p>
</blockquote>
<p><a href="https://www.jianshu.com/p/e0619df8f245">gitHub hexo ä¸ªäººåšå®¢åŸºç¡€ç‰ˆ</a>ã€‚</p>
<h3 id="é¦–å…ˆç¡®è®¤ä½ æœ¬åœ°å·²ç»ä¸å­˜åœ¨source-x2F-postsæ–‡ä»¶å¤¹ï¼Œå†æŸ¥ä¸€æŸ¥githubæ˜¯å¦æœ‰å¤‡ä»½ï¼Œå¦‚ä½•è¿œç¨‹å’Œæœ¬åœ°éƒ½æ²¡æœ‰ï¼Œé‚£å°±åªèƒ½é‡æ–°éƒ¨ç½²äº†ã€‚"><a href="#é¦–å…ˆç¡®è®¤ä½ æœ¬åœ°å·²ç»ä¸å­˜åœ¨source-x2F-postsæ–‡ä»¶å¤¹ï¼Œå†æŸ¥ä¸€æŸ¥githubæ˜¯å¦æœ‰å¤‡ä»½ï¼Œå¦‚ä½•è¿œç¨‹å’Œæœ¬åœ°éƒ½æ²¡æœ‰ï¼Œé‚£å°±åªèƒ½é‡æ–°éƒ¨ç½²äº†ã€‚" class="headerlink" title="é¦–å…ˆç¡®è®¤ä½ æœ¬åœ°å·²ç»ä¸å­˜åœ¨source&#x2F;_postsæ–‡ä»¶å¤¹ï¼Œå†æŸ¥ä¸€æŸ¥githubæ˜¯å¦æœ‰å¤‡ä»½ï¼Œå¦‚ä½•è¿œç¨‹å’Œæœ¬åœ°éƒ½æ²¡æœ‰ï¼Œé‚£å°±åªèƒ½é‡æ–°éƒ¨ç½²äº†ã€‚"></a>é¦–å…ˆç¡®è®¤ä½ æœ¬åœ°å·²ç»ä¸å­˜åœ¨source&#x2F;_postsæ–‡ä»¶å¤¹ï¼Œå†æŸ¥ä¸€æŸ¥githubæ˜¯å¦æœ‰å¤‡ä»½ï¼Œå¦‚ä½•è¿œç¨‹å’Œæœ¬åœ°éƒ½æ²¡æœ‰ï¼Œé‚£å°±åªèƒ½é‡æ–°éƒ¨ç½²äº†ã€‚</h3><blockquote>
<p>1.é™æ€æ–‡ä»¶ï¼ˆå¦‚ public&#x2F; ä¸‹çš„ HTMLï¼‰å¯é€šè¿‡æµè§ˆå™¨å³é”®ã€ŒæŸ¥çœ‹é¡µé¢æºä»£ç ã€å¤åˆ¶æ­£æ–‡ï¼Œæˆ–ä½¿ç”¨å·¥å…·è§£æ HTML ç»“æ„ã€‚</p>
</blockquote>
<blockquote>
<p>2.ä½¿ç”¨ Markdown æ¸²æŸ“ï¼ŒHTML ä¸­çš„ â€œarticle â€æ ‡ç­¾å†…é€šå¸¸åŒ…å«åŸå§‹æ–‡æœ¬çš„è½¬æ¢ç»“æœã€‚</p>
</blockquote>
<blockquote>
<p>3.ç”Ÿæˆ.mdæ–‡ä»¶æ”¾åœ¨_postsæ–‡ä»¶å¤¹é‡Œé¢ã€‚</p>
</blockquote>
<h1 id="1-å¤‡ä»½Hexoçš„æºæ–‡ä»¶"><a href="#1-å¤‡ä»½Hexoçš„æºæ–‡ä»¶" class="headerlink" title="1.å¤‡ä»½Hexoçš„æºæ–‡ä»¶"></a>1.å¤‡ä»½Hexoçš„æºæ–‡ä»¶</h1><p><strong>åˆ°è¿™é‡Œå°±å¯ä»¥é‡æ–°å‘å¸ƒæ–‡ç« äº†ï¼Œä½†æ˜¯ä¸ºäº†ä¸‹ä¸€æ¬¡ä¸è¦å†å‡ºç°è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦å¯¹Hexoçš„æºæ–‡ä»¶è¿›è¡Œå¤‡ä»½ã€‚</strong></p>
<p><strong>å¤‡ä»½æ–¹å¼å…±æœ‰ä¸¤ç§ï¼š</strong></p>
<blockquote>
<p>1.åœ¨å½“å‰gitHubç®¡ç†çš„hexoç”Ÿæˆçš„é™æ€æ–‡ä»¶ä»“åº“ä¸­å†å¼€ä¸€ä¸ªåˆ†æ”¯ï¼Œç”¨äºå¤‡ä»½Hexoçš„æºæ–‡ä»¶ã€‚</p>
</blockquote>
<blockquote>
<p>2.å•ç‹¬åˆ›å»ºä¸€ä¸ªç§æœ‰ä»“åº“ç”¨äºå¤‡ä»½Hexoçš„æºæ–‡ä»¶ã€‚</p>
</blockquote>
<p><em>å› ä¸ºåšå®¢éœ€è¦å¯¹å¤–å±•ç¤ºï¼Œæ‰€ä»¥å½“å‰gitHubç®¡ç†çš„hexoç”Ÿæˆçš„é™æ€æ–‡ä»¶ä»“åº“å¿…é¡»æ˜¯å…¬å¼€çš„ï¼Œæ‰€ä»¥å¦‚æœä½ é€‰æ‹©ç¬¬ä¸€ç§æ–¹å¼ä½ çš„åŸæ–‡ä»¶ä¹Ÿåªèƒ½æ”¾åœ¨å…¬å¼€çš„ä»“åº“åˆ†æ”¯ã€‚å¦‚æœä¸æƒ³å°†è‡ªå·±çš„Hexoçš„æºæ–‡ä»¶å…¬å¼€å°±å¯ä»¥é€‰æ‹©ç¬¬äºŒç§æ–¹å¼ï¼šå•ç‹¬åˆ›å»ºä¸€ä¸ªç§æœ‰çš„ä»“åº“ç”¨æ¥å¤‡ä»½Hexoçš„æºæ–‡ä»¶ã€‚</em></p>
<h1 id="2-è‡ªåŠ¨åŒ–"><a href="#2-è‡ªåŠ¨åŒ–" class="headerlink" title="2.è‡ªåŠ¨åŒ–"></a>2.è‡ªåŠ¨åŒ–</h1><blockquote>
<p>ä¸Šæ–‡åˆ›å»ºå®Œæˆåæ¯æ¬¡å‘å¸ƒåšå®¢ï¼Œéƒ½éœ€è¦å»gitæäº¤å¤‡ä»½æ–‡ä»¶ï¼Œè¿™æ ·å¤ªéº»çƒ¦äº†ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬ï¼Œå°†è¿™äº›é‡å¤æ­¥éª¤è‡ªåŠ¨åŒ–ã€‚</p>
</blockquote>
<p><strong>åˆ›å»ºä¸€ä¸ªdeploy.shæ”¾åœ¨åšå®¢æ ¹ç›®å½•ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># è®¾ç½®ç»å¯¹è·¯å¾„</span><br><span class="line">BLOG_DIR=&quot;å®é™…è·¯å¾„/blog&quot;</span><br><span class="line"></span><br><span class="line"># è¿›å…¥åšå®¢ç›®å½•</span><br><span class="line">cd &quot;$BLOG_DIR&quot; || exit 1</span><br><span class="line"></span><br><span class="line"># Hexoæ“ä½œ</span><br><span class="line">hexo clean</span><br><span class="line">hexo generate</span><br><span class="line">hexo deploy</span><br><span class="line"></span><br><span class="line"># æºæ–‡ä»¶å¤‡ä»½</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;è‡ªåŠ¨å¤‡ä»½: $(date +&quot;%Y-%m-%d %H:%M&quot;)&quot;</span><br><span class="line">git push origin main</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¿™æ ·ä¸€ä¸ªç®€å•çš„å‘å¸ƒåšå®¢å¹¶ä¸”æºæ–‡ä»¶å¤‡ä»½çš„è‡ªåŠ¨åŒ–è„šæœ¬å°±å¥½äº†ã€‚<br>ä»¥åæ¯ä¸€æ¬¡å†™å®Œæ–‡ç« åå†åœ¨ç»ˆç«¯è¿›å…¥â€å®é™…è·¯å¾„&#x2F;blogâ€ æ‰§è¡Œ.&#x2F;deploy.sh å°±è¡Œäº†</p>
</blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-be565414c227becd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ‰§è¡Œ./deploy.sh"></p>
<p><strong>é¦–æ¬¡æ‰§è¡Œéœ€è¦å…ˆè®¾ç½®æ‰§è¡Œæƒé™ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod +x deploy.sh</span><br></pre></td></tr></table></figure>

<h1 id="3-å¤šåšå®¢è‡ªåŠ¨åŒ–"><a href="#3-å¤šåšå®¢è‡ªåŠ¨åŒ–" class="headerlink" title="3.å¤šåšå®¢è‡ªåŠ¨åŒ–"></a>3.å¤šåšå®¢è‡ªåŠ¨åŒ–</h1><blockquote>
<p>å½“æˆ‘ä»¬æœ‰å¤šä¸ªåšå®¢éœ€è¦åŒæ­¥æ˜¯å°±éœ€è¦å¯¹Hexoçš„æºæ–‡ä»¶è¿›è¡Œå†æ¬¡ä¿®æ”¹ã€‚</p>
</blockquote>
<p>æˆ‘ä»¥githubä¸ºä¾‹ï¼š</p>
<p><strong>1.é¦–å…ˆæˆ‘ä»¬çš„æœ‰ä¸¤ä¸ªGitHubè´¦å·å¹¶ä¸”æœ¬åœ°é…ç½®å¥½SSH</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-4b672d531de2e4be.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æœ¬åœ°SSHé…ç½®"></p>
<p><strong>2.æ·»åŠ é…ç½®æ–‡ä»¶</strong></p>
<h3 id="config-ymlï¼šä¸ºå…¶ä¸­ä¸€ä¸ªGitHubè´¦å·çš„é…ç½®"><a href="#config-ymlï¼šä¸ºå…¶ä¸­ä¸€ä¸ªGitHubè´¦å·çš„é…ç½®" class="headerlink" title="_config.ymlï¼šä¸ºå…¶ä¸­ä¸€ä¸ªGitHubè´¦å·çš„é…ç½®"></a>_config.ymlï¼šä¸ºå…¶ä¸­ä¸€ä¸ªGitHubè´¦å·çš„é…ç½®</h3><blockquote>
<p>url: <a href="https://gavincarter1991.github.io/#">https://gavincarter1991.github.io#</a> åšå®¢å®Œæ•´URL</p>
<p>source_dir: source  # è¿™ä¸ªå€¼ä¼šè¢«è„šæœ¬è¦†ç›–ï¼Œä½†éœ€è¦å­˜åœ¨</p>
<p>public_dir: public_kind</p>
<p> <img src="https://upload-images.jianshu.io/upload_images/1976231-d4cc0887e0a1f1c7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="deploy"></p>
</blockquote>
<h3 id="config-other-ymlï¼šä¸ºå¦å¤–ä¸€ä¸ªGitHubè´¦å·çš„é…ç½®"><a href="#config-other-ymlï¼šä¸ºå¦å¤–ä¸€ä¸ªGitHubè´¦å·çš„é…ç½®" class="headerlink" title="_config_other.ymlï¼šä¸ºå¦å¤–ä¸€ä¸ªGitHubè´¦å·çš„é…ç½®"></a>_config_other.ymlï¼šä¸ºå¦å¤–ä¸€ä¸ªGitHubè´¦å·çš„é…ç½®</h3><blockquote>
<p>url: <a href="https://kindyourself.github.io/">https://kindyourself.github.io</a> # åšå®¢å®Œæ•´URL</p>
<p>source_dir:  &#x2F;Users&#x2F;dianyin&#x2F;Desktop&#x2F;blog&#x2F;temp_source_gavin</p>
<p>public_dir: public_gavin</p>
<p> <img src="https://upload-images.jianshu.io/upload_images/1976231-e88ac014d9ccf8ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="deploy"></p>
</blockquote>
<p>è€ƒè™‘åˆ°å¤šä¸ªåšå®¢å†…å®¹å¯èƒ½ä¸ä¸€æ ·ï¼šåœ¨æ ¹ç›®å½•æ–°å»ºä¸€ä¸ªscriptsæ–‡ä»¶å¤¹åˆ›å»ºä¸€ä¸ªJSè„šæœ¬multi-site.jsè¿›è¡Œå†…å®¹é…ç½®ï¼Œå…¬å…±æ–‡ç« æ”¾åœ¨source&#x2F;_postsï¼Œä¸åŒçš„æ–‡ç« å„è‡ªæ”¾åœ¨è‡ªå·±çš„ç›®å½•é‡Œé¢ï¼ˆsource&#x2F;_posts_gavin  source&#x2F;_posts_gavin _posts_kindï¼‰è„šæœ¬ä¼šåˆ†å¼€å‘å¸ƒã€‚</p>
<p><strong>multi-site.js å†…å®¹ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const fs = require(&#x27;fs-extra&#x27;);</span><br><span class="line">const path = require(&#x27;path&#x27;);</span><br><span class="line">const &#123; promisify &#125; = require(&#x27;util&#x27;);</span><br><span class="line">const exec = promisify(require(&#x27;child_process&#x27;).exec);</span><br><span class="line"></span><br><span class="line">hexo.extend.filter.register(&#x27;before_generate&#x27;, async function() &#123;</span><br><span class="line">  const baseDir = hexo.base_dir;</span><br><span class="line">  const currentSite = process.env.HEXO_SITE || &#x27;kind&#x27;;</span><br><span class="line">  </span><br><span class="line">  const sites = &#123;</span><br><span class="line">    kind: &#123;</span><br><span class="line">      exclusiveDir: &#x27;source/_posts_kind&#x27;,</span><br><span class="line">      commonDir: &#x27;source/_posts&#x27;,</span><br><span class="line">      output: &#x27;public_kind&#x27;,</span><br><span class="line">      config: &#x27;_config.yml&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    gavin: &#123;</span><br><span class="line">      exclusiveDir: &#x27;source/_posts_gavin&#x27;,</span><br><span class="line">      commonDir: &#x27;source/_posts&#x27;,</span><br><span class="line">      output: &#x27;public_gavin&#x27;,</span><br><span class="line">      config: &#x27;_config_gavin.yml&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">  const site = sites[currentSite];</span><br><span class="line">  if (!site) return;</span><br><span class="line">  </span><br><span class="line">  // åˆ›å»ºä¸´æ—¶æºç›®å½•</span><br><span class="line">  const tempSourceDir = path.join(baseDir, `temp_source_$&#123;currentSite&#125;`);</span><br><span class="line">  fs.ensureDirSync(tempSourceDir);</span><br><span class="line">  fs.emptyDirSync(tempSourceDir);</span><br><span class="line">  </span><br><span class="line">  // 1. å¤åˆ¶æ•´ä¸ªsourceç›®å½•ï¼ˆåŒ…æ‹¬æ‰€æœ‰å…±äº«æ–‡ä»¶ï¼‰</span><br><span class="line">  fs.copySync(path.join(baseDir, &#x27;source&#x27;), tempSourceDir);</span><br><span class="line">  </span><br><span class="line">  // 2. æ¸…ç©ºä¸´æ—¶æºç›®å½•çš„_postsæ–‡ä»¶å¤¹</span><br><span class="line">  const tempPostsDir = path.join(tempSourceDir, &#x27;_posts&#x27;);</span><br><span class="line">  fs.ensureDirSync(tempPostsDir);</span><br><span class="line">  fs.emptyDirSync(tempPostsDir);</span><br><span class="line">  </span><br><span class="line">  // 3. å¤åˆ¶å…±åŒæ–‡ç« </span><br><span class="line">  const commonPosts = path.join(baseDir, site.commonDir);</span><br><span class="line">  if (fs.existsSync(commonPosts)) &#123;</span><br><span class="line">    fs.readdirSync(commonPosts).forEach(file =&gt; &#123;</span><br><span class="line">      if (file.endsWith(&#x27;.md&#x27;)) &#123;</span><br><span class="line">        fs.copySync(</span><br><span class="line">          path.join(commonPosts, file),</span><br><span class="line">          path.join(tempPostsDir, file)</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  // 4. å¤åˆ¶ä¸“å±æ–‡ç« </span><br><span class="line">  const exclusivePosts = path.join(baseDir, site.exclusiveDir);</span><br><span class="line">  if (fs.existsSync(exclusivePosts)) &#123;</span><br><span class="line">    fs.readdirSync(exclusivePosts).forEach(file =&gt; &#123;</span><br><span class="line">      if (file.endsWith(&#x27;.md&#x27;)) &#123;</span><br><span class="line">        fs.copySync(</span><br><span class="line">          path.join(exclusivePosts, file),</span><br><span class="line">          path.join(tempPostsDir, file)</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  // 5. åŠ¨æ€åº”ç”¨é…ç½®</span><br><span class="line">  hexo.config.source_dir = tempSourceDir;</span><br><span class="line">  hexo.config.public_dir = site.output;</span><br><span class="line">  </span><br><span class="line">  // 6. éªŒè¯å¤åˆ¶ç»“æœ</span><br><span class="line">  const postCount = fs.readdirSync(tempPostsDir).length;</span><br><span class="line">  hexo.log.info(`âœ… $&#123;currentSite&#125; ç«™ç‚¹å‡†å¤‡å®Œæˆ: $&#123;postCount&#125; ç¯‡æ–‡ç« `);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// æ·»åŠ éƒ¨ç½²åæ¸…ç†é’©å­</span><br><span class="line">hexo.extend.filter.register(&#x27;after_deploy&#x27;, function() &#123;</span><br><span class="line">  const baseDir = hexo.base_dir;</span><br><span class="line">  const currentSite = process.env.HEXO_SITE;</span><br><span class="line">  </span><br><span class="line">  if (currentSite) &#123;</span><br><span class="line">    const tempSourceDir = path.join(baseDir, `temp_source_$&#123;currentSite&#125;`);</span><br><span class="line">    if (fs.existsSync(tempSourceDir)) &#123;</span><br><span class="line">      fs.removeSync(tempSourceDir);</span><br><span class="line">      hexo.log.info(`ğŸ§¹ æ¸…ç†ä¸´æ—¶ç›®å½•: $&#123;tempSourceDir&#125;`);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>å½“ç„¶deploy.shä¹Ÿéœ€è¦æ›´æ”¹ä¸ºï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/usr/bin/env bash</span><br><span class="line"></span><br><span class="line"># é…ç½®åŒº</span><br><span class="line">BLOG_DIR=&quot;/Users/dianyin/Desktop/blog&quot;</span><br><span class="line">SOURCE_BRANCH=&quot;master&quot;</span><br><span class="line">PRIVATE_REPO_KIND=&quot;git@github.com-kind:kindyourself/blog-source.git&quot;</span><br><span class="line">PRIVATE_REPO_GAVIN=&quot;git@github.com-gavin:gavincarter1991/blog-source.git&quot;</span><br><span class="line"></span><br><span class="line">cd &quot;$BLOG_DIR&quot; || &#123; echo &quot;âŒ æ— æ³•è¿›å…¥åšå®¢ç›®å½•&quot;; exit 1; &#125;</span><br><span class="line"></span><br><span class="line"># æ¸…ç†ä¸Šæ¬¡ç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶</span><br><span class="line">rm -rf temp_source_* public*</span><br><span class="line">hexo clean</span><br><span class="line"></span><br><span class="line"># ç”Ÿæˆ Kind ç«™ç‚¹</span><br><span class="line">echo &quot;===== ğŸš€ ç”Ÿæˆ Kind ç«™ç‚¹ =====&quot;</span><br><span class="line">export HEXO_SITE=&quot;kind&quot;</span><br><span class="line">hexo generate --config _config.yml</span><br><span class="line"></span><br><span class="line"># éªŒè¯ç”Ÿæˆç»“æœ</span><br><span class="line">echo &quot;Kind ç«™ç‚¹å†…å®¹:&quot;</span><br><span class="line">ls -lh public_kind</span><br><span class="line">tree -L 2 public_kind | head -20</span><br><span class="line"></span><br><span class="line"># ç”Ÿæˆ Gavin ç«™ç‚¹</span><br><span class="line">echo &quot;===== ğŸš€ ç”Ÿæˆ Gavin ç«™ç‚¹ =====&quot;</span><br><span class="line">export HEXO_SITE=&quot;gavin&quot;</span><br><span class="line">hexo generate --config _config_gavin.yml</span><br><span class="line"></span><br><span class="line"># éªŒè¯ç”Ÿæˆç»“æœ</span><br><span class="line">echo &quot;Gavin ç«™ç‚¹å†…å®¹:&quot;</span><br><span class="line">ls -lh public_gavin</span><br><span class="line">tree -L 2 public_gavin | head -20</span><br><span class="line"></span><br><span class="line"># éƒ¨ç½²åˆ°GitHub Pages</span><br><span class="line">echo &quot;===== ğŸš€ éƒ¨ç½²åˆ° GitHub Pages =====&quot;</span><br><span class="line">echo &quot;éƒ¨ç½² Kind ç«™ç‚¹...&quot;</span><br><span class="line">export HEXO_SITE=&quot;kind&quot;</span><br><span class="line">hexo deploy --config _config.yml</span><br><span class="line"></span><br><span class="line">echo &quot;éƒ¨ç½² Gavin ç«™ç‚¹...&quot;</span><br><span class="line">export HEXO_SITE=&quot;gavin&quot;</span><br><span class="line">hexo deploy --config _config_gavin.yml</span><br><span class="line"></span><br><span class="line"># å¤‡ä»½åˆ°ç§æœ‰ä»“åº“</span><br><span class="line">echo &quot;===== ğŸ“¦ å¤‡ä»½æºæ–‡ä»¶åˆ°ç§æœ‰ä»“åº“ =====&quot;</span><br><span class="line">git add .</span><br><span class="line">if git diff-index --quiet HEAD --; then</span><br><span class="line">    echo &quot;ğŸ”„ æ— æ–‡ä»¶å˜æ›´&quot;</span><br><span class="line">else</span><br><span class="line">    git commit -m &quot;è‡ªåŠ¨å¤‡ä»½: $(date +&quot;%Y-%m-%d %H:%M:%S&quot;)&quot;</span><br><span class="line">    </span><br><span class="line">    # æ¨é€åˆ°ä¸¤ä¸ªç§æœ‰ä»“åº“</span><br><span class="line">    git push &quot;$PRIVATE_REPO_KIND&quot; &quot;$SOURCE_BRANCH&quot; &amp;&amp; \</span><br><span class="line">        echo &quot;âœ… kindyourself/blog-source å¤‡ä»½æˆåŠŸ&quot; || \</span><br><span class="line">        echo &quot;âŒ kindyourself/blog-source å¤‡ä»½å¤±è´¥&quot;</span><br><span class="line">    </span><br><span class="line">    git push &quot;$PRIVATE_REPO_GAVIN&quot; &quot;$SOURCE_BRANCH&quot; &amp;&amp; \</span><br><span class="line">        echo &quot;âœ… gavincarter1991/blog-source å¤‡ä»½æˆåŠŸ&quot; || \</span><br><span class="line">        echo &quot;âŒ gavincarter1991/blog-source å¤‡ä»½å¤±è´¥&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">echo &quot;===== âœ… éƒ¨ç½²å®Œæˆ =====&quot;</span><br><span class="line">echo &quot;åšå®¢åœ°å€1: https://kindyourself.github.io&quot;</span><br><span class="line">echo &quot;åšå®¢åœ°å€2: https://gavincarter1991.github.io&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>ä»¥ä¸Šå°±æ˜¯gitHub hexo ä¸ªäººåšå®¢å‡çº§ç‰ˆ</strong></p>
]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>â€œHexoâ€</tag>
        <tag>â€œgithub&quot;</tag>
        <tag>â€œåšå®¢&quot;</tag>
      </tags>
  </entry>
  <entry>
    <title>iOS-SM3åŠ å¯†ç®—æ³•Nç§é›†æˆ</title>
    <url>/2025/06/13/iOS-SM3%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95N%E7%A7%8D%E9%9B%86%E6%88%90/</url>
    <content><![CDATA[<p>è¿‘æœŸçš„ä¸€ä¸ªé¡¹ç›®éœ€è¦ç”¨åˆ°SM3åŠ å¯†ç®—æ³•ï¼Œéœ€è¦åœ¨iOSä¸­ä½¿ç”¨Objective-Cå®ç°SM3å›½å¯†åŠ å¯†ç®—æ³•ã€‚</p>
<blockquote>
<p>SM3ï¼šæ˜¯ä¸­å›½å›½å®¶å¯†ç ç®¡ç†å±€å‘å¸ƒçš„å¯†ç æ‚å‡‘ç®—æ³•æ ‡å‡†ï¼Œé€‚ç”¨äºå•†ç”¨å¯†ç åº”ç”¨ä¸­çš„æ•°å­—ç­¾åå’ŒéªŒè¯ã€æ¶ˆæ¯è®¤è¯ç çš„ç”Ÿæˆä¸éªŒè¯ä»¥åŠéšæœºæ•°çš„ç”Ÿæˆç­‰</p>
<p>ç”±äºiOSç³»ç»Ÿå¹¶æœªå†…ç½®SM3ç®—æ³•ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ç¬¬ä¸‰æ–¹å¼€æºåº“æˆ–è‡ªå·±å®ç°</p>
<p><strong><a href="https://github.com/muzipiao/GMObjC">GMObjC</a>åº“ï¼š</strong> æ˜¯ä¸€ä¸ªåŸºäº OpenSSL çš„å›½å¯†ï¼ˆSM2ã€SM3ã€SM4ï¼‰ç®—æ³•çš„ Objective-C å¼€æºåº“ï¼Œé€‚ç”¨äº iOS å’Œ macOS å¼€å‘ã€‚å®ƒå°è£…äº†ä¸­å›½å›½å®¶å¯†ç ç®¡ç†å±€å‘å¸ƒçš„å¤šç§åŠ å¯†ç®—æ³•ï¼ŒåŒ…æ‹¬ï¼š</p>
</blockquote>
<blockquote>
<p><strong>1. SM2ï¼š</strong> æ”¯æŒåŸºäºæ¤­åœ†æ›²çº¿ï¼ˆECCï¼‰çš„åŠ è§£å¯†ï¼Œå¯†é’¥åå•†ï¼ˆECDHï¼‰å’Œç­¾åç®—æ³•</p>
<p><strong>2. SM3ï¼š</strong> ç±»ä¼¼ SHA ç³»åˆ—çš„å›½å¯†å“ˆå¸Œç®—æ³•ï¼ŒåŒ…å« SM3 å’Œ HMAC ç­‰</p>
<p><strong>3. SM4ï¼š</strong> å®ç°å¯¹ç§°åˆ†ç»„åŠ å¯†ç®—æ³•</p>
<p><strong><a href="https://github.com/guanzhi/GmSSL#">GmSSL</a>åº“ï¼š</strong>GmSSLæ˜¯ç”±åŒ—äº¬å¤§å­¦è‡ªä¸»å¼€å‘çš„å›½äº§å•†ç”¨å¯†ç å¼€æºåº“ï¼Œå®ç°äº†å¯¹å›½å¯†ç®—æ³•ã€æ ‡å‡†å’Œå®‰å…¨é€šä¿¡åè®®çš„å…¨é¢åŠŸèƒ½è¦†ç›–ï¼Œæ”¯æŒåŒ…æ‹¬ç§»åŠ¨ç«¯åœ¨å†…çš„ä¸»æµæ“ä½œç³»ç»Ÿå’Œå¤„ç†å™¨ï¼Œæ”¯æŒå¯†ç é’¥åŒ™ã€å¯†ç å¡ç­‰å…¸å‹å›½äº§å¯†ç ç¡¬ä»¶ï¼Œæä¾›åŠŸèƒ½ä¸°å¯Œçš„å‘½ä»¤è¡Œå·¥å…·åŠå¤šç§ç¼–è¯‘è¯­è¨€ç¼–ç¨‹æ¥å£</p>
</blockquote>
<h2 id="æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼ˆGMObjCï¼‰"><a href="#æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼ˆGMObjCï¼‰" class="headerlink" title="æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼ˆGMObjCï¼‰"></a>æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼ˆGMObjCï¼‰</h2><p>é›†æˆGMObjCï¼š<a href="https://muzipiao.github.io/gmdocs/zh/guide/getting-started">é›†æˆGMObjCæ–¹æ³•</a></p>
<p>å› ä¸ºæˆ‘ä»¬çš„é¡¹ç›®æ˜¯SDKä¸ä¾¿ç”¨CocoaPodsæ–¹æ³•ï¼Œå› æ­¤æˆ‘åªèƒ½é€‰æ‹©ç›´æ¥é›†æˆå’Œæ‰‹åŠ¨ç¼–è¯‘ä¸º Frameworkã€‚</p>
<h3 id="1-ç›´æ¥é›†æˆ-demo"><a href="#1-ç›´æ¥é›†æˆ-demo" class="headerlink" title="1.ç›´æ¥é›†æˆ (demo)"></a>1.ç›´æ¥é›†æˆ (<a href="https://github.com/GavinCarter1991/sm3-demo/tree/GMObjC%EF%BC%88%E7%9B%B4%E6%8E%A5%E9%9B%86%E6%88%90%EF%BC%89">demo</a>)</h3><blockquote>
<p>1.ä» Git ä¸‹è½½æœ€æ–°ä»£ç ï¼Œæ‰¾åˆ°å’Œ README åŒçº§çš„ GMObjC æ–‡ä»¶å¤¹ï¼Œå°† GMObjC æ–‡ä»¶å¤¹æ‹–å…¥é¡¹ç›®</p>
<p>2.æ‰¾åˆ°å’Œ README åŒçº§çš„ Frameworks æ–‡ä»¶å¤¹ï¼Œå°†é¡¹ç›® Frameworks&#x2F;OpenSSL.xcframework æ‹–å…¥é¡¹ç›®</p>
<p>3.åœ¨éœ€è¦ä½¿ç”¨çš„åœ°æ–¹å¯¼å…¥å¤´æ–‡ä»¶ GMObjC.h å³å¯ä½¿ç”¨ SM2ã€SM4 åŠ è§£å¯†ï¼Œç­¾åéªŒç­¾ï¼Œè®¡ç®— SM3 æ‘˜è¦ç­‰</p>
</blockquote>
<p><strong>æ³¨æ„äº‹é¡¹</strong></p>
<p><code> GMObjC ä¾èµ– OpenSSLï¼Œå¯ç›´æ¥æ‹–å…¥ Frameworks/OpenSSL.xcframework æˆ–é€šè¿‡pod GMOpenSSLå®‰è£… OpenSSLã€‚</code></p>
<p><code> å¦‚æœé¡¹ç›®ä¸­å·²é›†æˆ OpenSSL 1.1.1l ä»¥ä¸Šç‰ˆæœ¬ï¼Œå¯å…±ç”¨åŒä¸€ä¸ª OpenSSLï¼›å¦åˆ™éœ€è¦ä½¿ç”¨ Carthage å°† GMObjC ç¼–è¯‘ä¸ºåŠ¨æ€åº“ã€‚</code></p>
<p><strong>æˆ‘æŒ‰ç…§ä»¥ä¸Šæ­¥éª¤å°†æ–‡ä»¶å¯¼å…¥åæŠ¥é”™ï¼š</strong><br>OpenSSL.xcframework ç­¾åéªŒè¯å¤±è´¥</p>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-53feb7bc56f237bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="OpenSSL.xcframeworkæŠ¥é”™"></p>
<p><strong>ç»ˆç«¯æ‰§è¡Œå¼ºåˆ¶é‡ç­¾åå‘½ä»¤</strong></p>
<p>codesign â€“force â€“deep â€“sign - ä½ çš„è·¯å¾„&#x2F;OpenSSL.xcframework</p>
<p>è¿”å›ï¼šä½ çš„è·¯å¾„&#x2F;OpenSSL.xcframework: replacing existing signature</p>
<p>ç°åœ¨å°±å¯ä»¥è¿è¡Œæµ‹è¯•äº†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#import &quot;GMObjC.h&quot;</span><br><span class="line"></span><br><span class="line">NSString *str = @&quot;123@1234&quot;;</span><br><span class="line">NSString *digest = [GMSm3Utils hashWithText:str];</span><br><span class="line">NSLog(@&quot;%@&quot;, digest);</span><br></pre></td></tr></table></figure>

<h3 id="2-æ‰‹åŠ¨ç¼–è¯‘ä¸º-Framework-demo"><a href="#2-æ‰‹åŠ¨ç¼–è¯‘ä¸º-Framework-demo" class="headerlink" title="2.æ‰‹åŠ¨ç¼–è¯‘ä¸º Framework (demo)"></a>2.æ‰‹åŠ¨ç¼–è¯‘ä¸º Framework (<a href="https://github.com/GavinCarter1991/sm3-demo/tree/GMObjC-Framework%EF%BC%88%E6%89%8B%E5%8A%A8%E7%BC%96%E8%AF%91%EF%BC%89">demo</a>)</h3><p>1.<strong>åŠ¨æ€åº“â€Œï¼š</strong></p>
<blockquote>
<p>ä» GitHub ä¸‹è½½æºç ï¼Œæ‰“å¼€é¡¹ç›®GMObjC-master&#x2F;Frameworks&#x2F;GMObjC.xcframeworkæŠŠè¿™ä¸ªæ‹–å…¥é¡¹ç›®</p>
<p>åœ¨ Xcode çš„ General â†’ Frameworks, Libraries, and Embedded Content ä¸­éœ€æ ‡è®°ä¸º Embed &amp; Sign</p>
</blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-30c18fc5528e087b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Embed &amp; Sign"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#import &quot;GMObjC/GMObjC.h&quot;</span><br><span class="line"></span><br><span class="line">NSString *digest1 = [GMSm3Utils hashWithText:str];</span><br><span class="line">NSLog(@&quot;%@&quot;, digest1);</span><br></pre></td></tr></table></figure>

<p>2.<strong>é™æ€åº“ï¼š</strong></p>
<blockquote>
<p>ä» GitHub ä¸‹è½½æºç ï¼Œæ‰“å¼€é¡¹ç›® GMObjC.xcodeprojï¼Œè®¾ç½® Build Settings - Linking-General - Mach-O Type ä¸º Static Library</p>
<p>æ‰‹åŠ¨ç¼–è¯‘ä¸ºé™æ€åº“ GMObjC.framework</p>
<p><strong>åˆå¹¶ä¸º XCFrameworkï¼š</strong>é€šè¿‡xcodebuild -create-xcframeworkå‘½ä»¤æ¥åˆå¹¶ä¸º XCFrameworkï¼Œé€šè¿‡åˆå¹¶ GMObjC åº“çš„æ¨¡æ‹Ÿå™¨å’ŒçœŸæœºç‰ˆæœ¬æ¥æ¼”ç¤º</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># åˆ›å»ºåˆå¹¶åŒ… GMObjC.xcframework</span><br><span class="line"></span><br><span class="line">xcodebuild -create-xcframework \</span><br><span class="line">           -framework Release-iphoneos/GMObjC.framework \</span><br><span class="line">           -framework Release-iphonesimulator/GMObjC.framework \</span><br><span class="line">           -output GMObjC.xcframework</span><br></pre></td></tr></table></figure>
<p><strong>æŠŠç”Ÿæˆçš„GMObjC.xcframeworkæ‹–å…¥é¡¹ç›®å³å¯</strong></p>
<h3 id="3-CocoaPodså®‰è£…GMObjC-GMObjC-demo-GMDynamic-demo"><a href="#3-CocoaPodså®‰è£…GMObjC-GMObjC-demo-GMDynamic-demo" class="headerlink" title="3.CocoaPodså®‰è£…GMObjC  (GMObjC-demo) (GMDynamic-demo)"></a>3.CocoaPodså®‰è£…GMObjC  (<a href="https://github.com/GavinCarter1991/sm3-demo/tree/GMObjC-CocoaPods">GMObjC-demo</a>) (<a href="https://github.com/GavinCarter1991/sm3-demo/tree/GMDynamic-CocoaPods">GMDynamic-demo</a>)</h3><blockquote>
<p>GMObjC å’Œ GMDynamic åªèƒ½å®‰è£…å…¶ä¸­ä¸€ä¸ªï¼ŒäºŒè€…ä¸èƒ½åŒæ—¶å®‰è£…ã€‚</p>
<p>GMObjC ä¸ºé™æ€åº“ï¼ŒGMDynamic ä¸ºç¼–è¯‘å¥½çš„ GMObjC åŠ¨æ€åº“ç‰ˆæœ¬ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å®‰è£… GMObjC çš„æºç å’Œ GMOpenSSL.xcframework (é™æ€åº“)</span><br><span class="line">pod &#x27;GMObjC&#x27;, &#x27;~&gt; 4.0.3&#x27;</span><br><span class="line"></span><br><span class="line"># å½“ Podfile ä¸­ä½¿ç”¨ use_frameworks! æ—¶ï¼Œå®‰è£… GMObjC.xcframework (åŠ¨æ€åº“)</span><br><span class="line">pod &#x27;GMDynamic&#x27;, &#x27;~&gt; 4.0.3&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼ˆGmSSLï¼‰-demo"><a href="#æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼ˆGmSSLï¼‰-demo" class="headerlink" title="æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼ˆGmSSLï¼‰(demo)"></a>æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼ˆGmSSLï¼‰(<a href="https://github.com/GavinCarter1991/sm3-demo/tree/GmSSL%EF%BC%88libgmssl.a%EF%BC%89">demo</a>)</h2><p><strong>é›†æˆGmSSLï¼š</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-4e921d7eba588139.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="é›†æˆGmSSLæ–¹æ³•"></p>
<p>ä½†æ˜¯æˆ‘ç”¨è¿™ç§æ–¹æ³•ä¸è¡Œï¼Œæˆ‘ç”¨äº†å…¶ä»–çš„æ–¹æ³•ã€‚</p>
<blockquote>
<p>æˆ‘ä»¬ä½¿ç”¨GmSSL 3.xï¼ˆmasteråˆ†æ”¯ï¼‰æ¥ç¼–è¯‘iOSçš„é™æ€åº“ï¼ˆlibcrypto.aå’Œlibssl.aï¼‰ã€‚ç”±äº3.xç‰ˆæœ¬é‡‡ç”¨äº†CMakeæ„å»ºç³»ç»Ÿï¼Œå› æ­¤æµç¨‹ä¸2.xä¸åŒã€‚</p>
<p>GmSSL 3.x çš„æ„å»ºç³»ç»Ÿå·²ç»å‘ç”Ÿäº†å˜åŒ–ï¼Œç”Ÿæˆçš„åº“æ–‡ä»¶åä¸º libgmssl.a è€Œä¸æ˜¯ä¼ ç»Ÿçš„ libcrypto.a å’Œ libssl.aã€‚</p>
<p> å¦‚æœé¡¹ç›®å¿…é¡»ä½¿ç”¨ <code>libcrypto.a</code> å’Œ <code>libssl.a</code>ï¼Œè¯·å›é€€åˆ° GmSSL 2.x</p>
</blockquote>
<ol>
<li><p>å…‹éš†ä»£ç å¹¶åˆ‡æ¢åˆ°masteråˆ†æ”¯ï¼ˆæˆ–æœ€æ–°çš„ç¨³å®šæ ‡ç­¾ï¼‰</p>
</li>
<li><p>é…ç½®CMakeå·¥å…·é“¾æ–‡ä»¶ï¼ˆä¸ºiOSäº¤å‰ç¼–è¯‘ï¼‰</p>
</li>
<li><p>åˆ†åˆ«ç¼–è¯‘arm64ï¼ˆçœŸæœºï¼‰å’Œx86_64ï¼ˆæ¨¡æ‹Ÿå™¨ï¼‰æ¶æ„</p>
</li>
<li><p>ä½¿ç”¨lipoåˆå¹¶æˆé€šç”¨é™æ€åº“</p>
</li>
<li><p>å°†ç”Ÿæˆçš„é™æ€åº“å’Œå¤´æ–‡ä»¶é›†æˆåˆ°iOSé¡¹ç›®ä¸­ã€‚</p>
</li>
</ol>
<p><strong>åˆ›å»ºç¼–è¯‘è„šæœ¬ï¼š</strong> build_ios.shï¼ˆæ”¾åœ¨GmSSLæ ¹ç›®å½•ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">set -e</span><br><span class="line"></span><br><span class="line"># ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„è·¯å¾„</span><br><span class="line">export PATH=&quot;/usr/local/bin:$PATH&quot;</span><br><span class="line"></span><br><span class="line"># è®¾ç½®ç¯å¢ƒå˜é‡</span><br><span class="line">export XCODE_PATH=$(xcode-select -p)</span><br><span class="line">export IOS_SDK=$XCODE_PATH/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk</span><br><span class="line">export SIM_SDK=$XCODE_PATH/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator.sdk</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºè¾“å‡ºç›®å½•</span><br><span class="line">OUTPUT_DIR=&quot;build-ios&quot;</span><br><span class="line">rm -rf $OUTPUT_DIR</span><br><span class="line">mkdir -p $OUTPUT_DIR</span><br><span class="line"></span><br><span class="line"># ç¼–è¯‘å‡½æ•°</span><br><span class="line">compile_arch() &#123;</span><br><span class="line">    ARCH=$1</span><br><span class="line">    SDK=$2</span><br><span class="line">    </span><br><span class="line">    BUILD_DIR=&quot;$&#123;OUTPUT_DIR&#125;/$&#123;ARCH&#125;&quot;</span><br><span class="line">    mkdir -p $BUILD_DIR</span><br><span class="line">    pushd $BUILD_DIR &gt; /dev/null</span><br><span class="line">    </span><br><span class="line">    echo &quot;â–¸ é…ç½® $ARCH...&quot;</span><br><span class="line">    cmake ../.. \</span><br><span class="line">        -DCMAKE_SYSTEM_NAME=iOS \</span><br><span class="line">        -DCMAKE_OSX_ARCHITECTURES=$ARCH \</span><br><span class="line">        -DCMAKE_OSX_SYSROOT=$SDK \</span><br><span class="line">        -DCMAKE_OSX_DEPLOYMENT_TARGET=13.0 \</span><br><span class="line">        -DCMAKE_BUILD_TYPE=Release \</span><br><span class="line">        -DBUILD_SHARED_LIBS=OFF \</span><br><span class="line">        -DENABLE_SM2=ON \</span><br><span class="line">        -DENABLE_SM3=ON \</span><br><span class="line">        -DENABLE_SM4=ON \</span><br><span class="line">        -DENABLE_SM9=ON \</span><br><span class="line">        -G Ninja</span><br><span class="line">        </span><br><span class="line">    echo &quot;â–¸ ç¼–è¯‘ $ARCH...&quot;</span><br><span class="line">    ninja</span><br><span class="line">    </span><br><span class="line">    # å…³é”®ä¿®æ”¹ï¼šGmSSL 3.x ç”Ÿæˆçš„åº“æ˜¯ libgmssl.a</span><br><span class="line">    mkdir -p lib</span><br><span class="line">    cp bin/libgmssl.a lib/</span><br><span class="line">    </span><br><span class="line">    popd &gt; /dev/null</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># ç¼–è¯‘å„æ¶æ„</span><br><span class="line">compile_arch &quot;arm64&quot; &quot;$IOS_SDK&quot;</span><br><span class="line">compile_arch &quot;x86_64&quot; &quot;$SIM_SDK&quot;</span><br><span class="line"></span><br><span class="line"># åˆå¹¶é€šç”¨åº“</span><br><span class="line">UNIVERSAL_DIR=&quot;$&#123;OUTPUT_DIR&#125;/universal&quot;</span><br><span class="line">mkdir -p $UNIVERSAL_DIR/lib</span><br><span class="line"></span><br><span class="line"># åˆå¹¶ä¸ºå•ä¸ªåº“ (GmSSL 3.x åªç”Ÿæˆä¸€ä¸ªåº“)</span><br><span class="line">lipo -create \</span><br><span class="line">    &quot;$&#123;OUTPUT_DIR&#125;/arm64/lib/libgmssl.a&quot; \</span><br><span class="line">    &quot;$&#123;OUTPUT_DIR&#125;/x86_64/lib/libgmssl.a&quot; \</span><br><span class="line">    -output &quot;$UNIVERSAL_DIR/lib/libgmssl.a&quot;</span><br><span class="line"></span><br><span class="line"># å¤åˆ¶å¤´æ–‡ä»¶</span><br><span class="line">if [ -d &quot;$&#123;OUTPUT_DIR&#125;/arm64/include&quot; ]; then</span><br><span class="line">    cp -R &quot;$&#123;OUTPUT_DIR&#125;/arm64/include&quot; &quot;$UNIVERSAL_DIR/&quot;</span><br><span class="line">elif [ -d &quot;../../include&quot; ]; then</span><br><span class="line">    cp -R &quot;../../include&quot; &quot;$UNIVERSAL_DIR/&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;âš ï¸ è­¦å‘Š: æ‰¾ä¸åˆ°å¤´æ–‡ä»¶ç›®å½•&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">echo &quot;âœ… ç¼–è¯‘æˆåŠŸï¼&quot;</span><br><span class="line">echo &quot;åº“æ–‡ä»¶ä½ç½®: $UNIVERSAL_DIR/lib/libgmssl.a&quot;</span><br><span class="line">echo &quot;å¤´æ–‡ä»¶ä½ç½®: $UNIVERSAL_DIR/include&quot;</span><br><span class="line"></span><br><span class="line"># éªŒè¯æ–‡ä»¶</span><br><span class="line">file &quot;$UNIVERSAL_DIR/lib&quot;/*.a</span><br><span class="line">lipo -info &quot;$UNIVERSAL_DIR/lib/libgmssl.a&quot;</span><br></pre></td></tr></table></figure>

<p><strong>ç„¶åæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ‰§è¡Œï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å®‰è£…æ„å»ºå·¥å…·</span><br><span class="line">brew install cmake ninja pkg-config</span><br><span class="line"></span><br><span class="line"># è·å–æœ€æ–°ä»£ç </span><br><span class="line">git clone https://github.com/guanzhi/GmSSL.git</span><br><span class="line">cd GmSSL</span><br><span class="line">git checkout master  # ç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬</span><br><span class="line">git pull</span><br><span class="line"></span><br><span class="line"># 2. æ‰§è¡Œç¼–è¯‘</span><br><span class="line">chmod +x build_ios.sh</span><br><span class="line">./build_ios.sh</span><br></pre></td></tr></table></figure>

<ol>
<li><p>å°†GmSSL&#x2F;build-ios&#x2F;universal&#x2F;lib&#x2F;libgmssl.a æ‹–å…¥é¡¹ç›®</p>
</li>
<li><p>å°†GmSSL&#x2F;include&#x2F;gmssl æ‹–å…¥é¡¹ç›®</p>
</li>
<li><p>import â€œsm3.hâ€</p>
</li>
</ol>
<p><strong>å°è£…æ–¹æ³•ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@interface GmSSLEncryptorSM3 : NSObject</span><br><span class="line"></span><br><span class="line">+ (NSString *)sm3HashWithString:(NSString *)input;</span><br><span class="line">+ (NSData *)sm3HashWithData:(NSData *)data;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation GmSSLEncryptorSM3</span><br><span class="line"></span><br><span class="line">+ (instancetype)encryptor &#123;</span><br><span class="line">    return [[GmSSLEncryptorSM3 alloc] init];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (NSData *)sm3HashWithData:(NSData *)data &#123;</span><br><span class="line">    // åˆå§‹åŒ– SM3 ä¸Šä¸‹æ–‡</span><br><span class="line">    SM3_CTX ctx;</span><br><span class="line">    sm3_init(&amp;ctx);</span><br><span class="line">    // æ·»åŠ æ•°æ®åˆ°å“ˆå¸Œè®¡ç®—</span><br><span class="line">    sm3_update(&amp;ctx, data.bytes, data.length);</span><br><span class="line">    // å‡†å¤‡å­˜å‚¨ç»“æœçš„ç¼“å†²åŒº (SM3 è¾“å‡ºä¸º 32 å­—èŠ‚)</span><br><span class="line">    uint8_t dgst[SM3_DIGEST_SIZE];</span><br><span class="line">    // å®Œæˆå“ˆå¸Œè®¡ç®—</span><br><span class="line">    sm3_finish(&amp;ctx, dgst);</span><br><span class="line">    // è½¬æ¢ä¸º NSData</span><br><span class="line">    return [NSData dataWithBytes:dgst length:SM3_DIGEST_SIZE];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (NSString *)sm3HashWithString:(NSString *)input &#123;</span><br><span class="line">    NSData *inputData = [input dataUsingEncoding:NSUTF8StringEncoding];</span><br><span class="line">    // è®¡ç®— SM3 å“ˆå¸Œ</span><br><span class="line">    NSData *hashData = [GmSSLEncryptorSM3 sm3HashWithData:inputData];</span><br><span class="line">    // è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²æ˜¾ç¤º</span><br><span class="line">    NSMutableString *hexString = [NSMutableString string];</span><br><span class="line">    const uint8_t *bytes = (const uint8_t *)hashData.bytes;</span><br><span class="line">    for (NSUInteger i = 0; i &lt; hashData.length; i++) &#123;</span><br><span class="line">        [hexString appendFormat:@&quot;%02x&quot;, bytes[i]];</span><br><span class="line">    &#125;</span><br><span class="line">    return hexString;</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p><strong>å°±å¯ä»¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨äº†ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">NSString *encryptor = [GmSSLEncryptorSM3 sm3HashWithString:str];</span><br><span class="line">NSLog(@&quot;%@&quot;, encryptor);</span><br></pre></td></tr></table></figure>

<h2 id="æ–¹æ¡ˆä¸‰ï¼šçº¯-Objective-C-å®ç°ï¼ˆæ— ä¾èµ–ï¼‰-demo"><a href="#æ–¹æ¡ˆä¸‰ï¼šçº¯-Objective-C-å®ç°ï¼ˆæ— ä¾èµ–ï¼‰-demo" class="headerlink" title="æ–¹æ¡ˆä¸‰ï¼šçº¯ Objective-C å®ç°ï¼ˆæ— ä¾èµ–ï¼‰(demo)"></a>æ–¹æ¡ˆä¸‰ï¼šçº¯ Objective-C å®ç°ï¼ˆæ— ä¾èµ–ï¼‰(<a href="https://github.com/GavinCarter1991/sm3-demo/tree/SM3-%E7%BA%AFOC%E4%BB%A3%E7%A0%81">demo</a>)</h2><blockquote>
<p>SM3æœ¬è´¨ä¸Šä¸æ˜¯åŠ å¯†ç®—æ³•ï¼Œå®ƒæ˜¯æ˜¯ä¸€ç§æ‚å‡‘å‡½æ•°ï¼Œæ˜¯åœ¨[SHA-256]åŸºç¡€ä¸Šæ”¹è¿›å®ç°çš„ä¸€ç§ç®—æ³•ï¼Œå®ƒä¸æ˜¯å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ç„¶åå†è§£å¯†ï¼Œè€Œæ˜¯ç”Ÿæˆä¸€ä¸ª256ä½çš„æ•£åˆ—å€¼ï¼Œå› æ­¤SM3é€‚ç”¨äºå†…å®¹æ‘˜è¦ï¼Œæ•°å­—ç­¾åéªŒè¯æˆ–å¯†ç éªŒè¯ç­‰ã€‚</p>
</blockquote>
<p><strong>SM3ç®—æ³•çš„æ‰§è¡Œè¿‡ç¨‹ï¼š</strong></p>
<p>æ ¹æ®SM3æ ‡å‡†æ–‡æ¡£ï¼ˆGM&#x2F;T 0004-2012ï¼‰</p>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-b73f718c48617fcb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="sm3æµç¨‹.png"></p>
<p><strong>æ¶ˆæ¯æ‰©å±•ï¼š</strong>å°†16ä¸ª32ä½å­—æ‰©å±•ä¸º68ä¸ªå­—ï¼ˆWï¼‰å’Œ64ä¸ªå­—ï¼ˆW1ï¼‰ï¼Œä½¿ç”¨P1å®ã€‚<br><strong>å‹ç¼©å‡½æ•°ï¼š</strong>64è½®è¿­ä»£æ›´æ–°å¯„å­˜å™¨ï¼ˆA-Hï¼‰ï¼Œæ¯è½®ä½¿ç”¨FF1&#x2F;GG1ç­‰å®ã€‚<br><strong>å¸¸é‡ï¼š</strong>å‹ç¼©å‡½æ•°ä¸­çš„å¸¸é‡0x7A879D8Aï¼ˆTJçš„å›ºå®šå€¼ï¼‰ã€‚<br><strong>ç»“æœè¾“å‡ºï¼š</strong>å°†æœ€ç»ˆçŠ¶æ€å¯„å­˜å™¨è½¬æ¢ä¸ºå¤§ç«¯åºå­—èŠ‚æµï¼ˆ256ä½ï¼‰ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//</span><br><span class="line">//  SM3Encryptor.m</span><br><span class="line">//  testDemo</span><br><span class="line">//</span><br><span class="line">//  Created by wt on 2025/6/12.</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">#import &quot;SM3Encryptor.h&quot;</span><br><span class="line">#include &lt;stdint.h&gt;</span><br><span class="line"></span><br><span class="line">// SM3 ä¸Šä¸‹æ–‡ç»“æ„</span><br><span class="line">typedef struct &#123;</span><br><span class="line">    uint32_t state[8];   // 8ä¸ª32ä½å¯„å­˜å™¨ï¼ˆA-Hï¼‰</span><br><span class="line">    uint64_t totalLength; // æ€»æ¶ˆæ¯é•¿åº¦ï¼ˆä½ï¼‰</span><br><span class="line">    uint8_t buffer[64];  // å½“å‰æ•°æ®å—ç¼“å­˜</span><br><span class="line">    uint32_t bufferLength; // å½“å‰ç¼“å†²åŒºé•¿åº¦</span><br><span class="line">&#125; SM3Context;</span><br><span class="line"></span><br><span class="line">// å¾ªç¯å·¦ç§»</span><br><span class="line">static inline uint32_t ROTL(uint32_t x, uint8_t n) &#123;</span><br><span class="line">    return (x &lt;&lt; n) | (x &gt;&gt; (32 - n));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å¸ƒå°”å‡½æ•° FF0ï¼ˆ0â‰¤jâ‰¤15ï¼‰</span><br><span class="line">static inline uint32_t FF0(uint32_t x, uint32_t y, uint32_t z) &#123;</span><br><span class="line">    return x ^ y ^ z;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å¸ƒå°”å‡½æ•° FF1ï¼ˆ16â‰¤jâ‰¤63ï¼‰</span><br><span class="line">static inline uint32_t FF1(uint32_t x, uint32_t y, uint32_t z) &#123;</span><br><span class="line">    return (x &amp; y) | (x &amp; z) | (y &amp; z);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å¸ƒå°”å‡½æ•° GG0ï¼ˆ0â‰¤jâ‰¤15ï¼‰</span><br><span class="line">static inline uint32_t GG0(uint32_t x, uint32_t y, uint32_t z) &#123;</span><br><span class="line">    return x ^ y ^ z;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å¸ƒå°”å‡½æ•° GG1ï¼ˆ16â‰¤jâ‰¤63ï¼‰</span><br><span class="line">static inline uint32_t GG1(uint32_t x, uint32_t y, uint32_t z) &#123;</span><br><span class="line">    return (x &amp; y) | ((~x) &amp; z);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ç½®æ¢å‡½æ•° P0</span><br><span class="line">static inline uint32_t P0(uint32_t x) &#123;</span><br><span class="line">    return x ^ ROTL(x, 9) ^ ROTL(x, 17);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ç½®æ¢å‡½æ•° P1</span><br><span class="line">static inline uint32_t P1(uint32_t x) &#123;</span><br><span class="line">    return x ^ ROTL(x, 15) ^ ROTL(x, 23);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// åˆå§‹åŒ–SM3ä¸Šä¸‹æ–‡</span><br><span class="line">void SM3Init(SM3Context *context) &#123;</span><br><span class="line">    // SM3æ ‡å‡†åˆå§‹å€¼</span><br><span class="line">    context-&gt;state[0] = 0x7380166F;</span><br><span class="line">    context-&gt;state[1] = 0x4914B2B9;</span><br><span class="line">    context-&gt;state[2] = 0x172442D7;</span><br><span class="line">    context-&gt;state[3] = 0xDA8A0600;</span><br><span class="line">    context-&gt;state[4] = 0xA96F30BC;</span><br><span class="line">    context-&gt;state[5] = 0x163138AA;</span><br><span class="line">    context-&gt;state[6] = 0xE38DEE4D;</span><br><span class="line">    context-&gt;state[7] = 0xB0FB0E4E;</span><br><span class="line">    context-&gt;totalLength = 0;</span><br><span class="line">    context-&gt;bufferLength = 0;</span><br><span class="line">    memset(context-&gt;buffer, 0, 64);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å¤„ç†å•ä¸ª64å­—èŠ‚å—ï¼ˆå‹ç¼©å‡½æ•°æ ¸å¿ƒï¼‰</span><br><span class="line">void SM3Compress(SM3Context *context, const uint8_t block[64]) &#123;</span><br><span class="line">    // 1. æ¶ˆæ¯æ‰©å±•ï¼š16å­— â†’ 68å­—ï¼ˆWï¼‰ + 64å­—ï¼ˆW1ï¼‰</span><br><span class="line">    uint32_t W[68], W1[64];</span><br><span class="line">    </span><br><span class="line">    // åˆå§‹åŒ–å‰16å­—ï¼ˆå¤§ç«¯åºè½¬æ¢ï¼‰</span><br><span class="line">    for (int i = 0; i &lt; 16; i++) &#123;</span><br><span class="line">        W[i] = (uint32_t)block[i*4] &lt;&lt; 24 |</span><br><span class="line">               (uint32_t)block[i*4+1] &lt;&lt; 16 |</span><br><span class="line">               (uint32_t)block[i*4+2] &lt;&lt; 8 |</span><br><span class="line">               (uint32_t)block[i*4+3];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // è®¡ç®—W[16]-W[67]</span><br><span class="line">    for (int j = 16; j &lt; 68; j++) &#123;</span><br><span class="line">        uint32_t temp = W[j-16] ^ W[j-9] ^ ROTL(W[j-3], 15);</span><br><span class="line">        W[j] = P1(temp) ^ ROTL(W[j-13], 7) ^ W[j-6];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // è®¡ç®—W1[0]-W1[63]</span><br><span class="line">    for (int j = 0; j &lt; 64; j++) &#123;</span><br><span class="line">        W1[j] = W[j] ^ W[j+4];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 2. å¯„å­˜å™¨åˆå§‹åŒ–ï¼ˆA-Hï¼‰</span><br><span class="line">    uint32_t A = context-&gt;state[0];</span><br><span class="line">    uint32_t B = context-&gt;state[1];</span><br><span class="line">    uint32_t C = context-&gt;state[2];</span><br><span class="line">    uint32_t D = context-&gt;state[3];</span><br><span class="line">    uint32_t E = context-&gt;state[4];</span><br><span class="line">    uint32_t F = context-&gt;state[5];</span><br><span class="line">    uint32_t G = context-&gt;state[6];</span><br><span class="line">    uint32_t H = context-&gt;state[7];</span><br><span class="line">    </span><br><span class="line">    // 3. 64è½®è¿­ä»£ï¼ˆä¸¥æ ¼éµå¾ªæ ‡å‡†ï¼‰</span><br><span class="line">    for (int j = 0; j &lt; 64; j++) &#123;</span><br><span class="line">        uint32_t SS1, SS2, TT1, TT2;</span><br><span class="line">        </span><br><span class="line">        // å¸¸é‡é€‰æ‹©ï¼ˆå…³é”®ä¿®æ­£ï¼‰</span><br><span class="line">        uint32_t TJ = (j &lt; 16) ? 0x79CC4519 : 0x7A879D8A;</span><br><span class="line">        </span><br><span class="line">        // è®¡ç®—SS1/SS2ï¼ˆä¿®æ­£äº†TJå‚æ•°ï¼‰</span><br><span class="line">        SS1 = ROTL(ROTL(A, 12) + E + ROTL(TJ, j % 32), 7);</span><br><span class="line">        SS2 = SS1 ^ ROTL(A, 12);</span><br><span class="line">        </span><br><span class="line">        // è®¡ç®—TT1/TT2ï¼ˆä½¿ç”¨å†…è”å‡½æ•°ï¼‰</span><br><span class="line">        if (j &lt; 16) &#123;</span><br><span class="line">            TT1 = FF0(A, B, C) + D + SS2 + W1[j];</span><br><span class="line">            TT2 = GG0(E, F, G) + H + SS1 + W[j];</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            TT1 = FF1(A, B, C) + D + SS2 + W1[j];</span><br><span class="line">            TT2 = GG1(E, F, G) + H + SS1 + W[j];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        // æ›´æ–°å¯„å­˜å™¨ï¼ˆä¸¥æ ¼é¡ºåºï¼‰</span><br><span class="line">        D = C;</span><br><span class="line">        C = ROTL(B, 9);</span><br><span class="line">        B = A;</span><br><span class="line">        A = TT1;</span><br><span class="line">        H = G;</span><br><span class="line">        G = ROTL(F, 19);</span><br><span class="line">        F = E;</span><br><span class="line">        E = P0(TT2);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 4. æ›´æ–°æœ€ç»ˆçŠ¶æ€ï¼ˆä¸åˆå§‹IVå¼‚æˆ–ï¼‰</span><br><span class="line">    context-&gt;state[0] ^= A;</span><br><span class="line">    context-&gt;state[1] ^= B;</span><br><span class="line">    context-&gt;state[2] ^= C;</span><br><span class="line">    context-&gt;state[3] ^= D;</span><br><span class="line">    context-&gt;state[4] ^= E;</span><br><span class="line">    context-&gt;state[5] ^= F;</span><br><span class="line">    context-&gt;state[6] ^= G;</span><br><span class="line">    context-&gt;state[7] ^= H;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// æ›´æ–°æ•°æ®ï¼ˆå¯åˆ†å¤šæ¬¡è°ƒç”¨ï¼‰</span><br><span class="line">void SM3Update(SM3Context *context, const uint8_t *data, size_t length) &#123;</span><br><span class="line">    context-&gt;totalLength += length * 8; // æ›´æ–°æ€»ä½æ•°ï¼ˆå­—èŠ‚è½¬ä½ï¼‰</span><br><span class="line">    </span><br><span class="line">    // å¤„ç†ç¼“å†²åŒºä¸­çš„å‰©ä½™ç©ºé—´</span><br><span class="line">    if (context-&gt;bufferLength &gt; 0) &#123;</span><br><span class="line">        size_t copySize = MIN(64 - context-&gt;bufferLength, length);</span><br><span class="line">        memcpy(context-&gt;buffer + context-&gt;bufferLength, data, copySize);</span><br><span class="line">        context-&gt;bufferLength += copySize;</span><br><span class="line">        data += copySize;</span><br><span class="line">        length -= copySize;</span><br><span class="line">        </span><br><span class="line">        if (context-&gt;bufferLength == 64) &#123;</span><br><span class="line">            SM3Compress(context, context-&gt;buffer);</span><br><span class="line">            context-&gt;bufferLength = 0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // å¤„ç†å®Œæ•´å—</span><br><span class="line">    while (length &gt;= 64) &#123;</span><br><span class="line">        SM3Compress(context, data);</span><br><span class="line">        data += 64;</span><br><span class="line">        length -= 64;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // ç¼“å­˜å‰©ä½™æ•°æ®</span><br><span class="line">    if (length &gt; 0) &#123;</span><br><span class="line">        memcpy(context-&gt;buffer, data, length);</span><br><span class="line">        context-&gt;bufferLength = length;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å®Œæˆå“ˆå¸Œè®¡ç®—</span><br><span class="line">void SM3Final(SM3Context *context, uint8_t output[32]) &#123;</span><br><span class="line">    // è®¡ç®—å¡«å……é•¿åº¦ï¼ˆSM3æ ‡å‡†ï¼šè¡¥ä½1 + kä¸ª0 + 64ä½é•¿åº¦ï¼‰</span><br><span class="line">    size_t totalBits = context-&gt;totalLength;</span><br><span class="line">    size_t paddingBits = (context-&gt;bufferLength &lt; 56) ?</span><br><span class="line">                         (56 - context-&gt;bufferLength) :</span><br><span class="line">                         (120 - context-&gt;bufferLength);</span><br><span class="line">    </span><br><span class="line">    // æ„å»ºå¡«å……æ•°æ®</span><br><span class="line">    uint8_t padding[128] = &#123;0&#125;;</span><br><span class="line">    padding[0] = 0x80; // è¡¥ä½èµ·å§‹ä½ï¼ˆäºŒè¿›åˆ¶10000000ï¼‰</span><br><span class="line">    </span><br><span class="line">    // æ·»åŠ å¡«å……</span><br><span class="line">    SM3Update(context, padding, paddingBits);</span><br><span class="line">    </span><br><span class="line">    // æ·»åŠ æ¶ˆæ¯é•¿åº¦ï¼ˆå¤§ç«¯åº64ä½ï¼‰</span><br><span class="line">    uint64_t bitCount = CFSwapInt64HostToBig(totalBits);</span><br><span class="line">    SM3Update(context, (uint8_t *)&amp;bitCount, 8);</span><br><span class="line">    </span><br><span class="line">    // ç¡®ä¿æœ€åä¸€ä¸ªå—è¢«å¤„ç†</span><br><span class="line">    if (context-&gt;bufferLength &gt; 0) &#123;</span><br><span class="line">        memset(context-&gt;buffer + context-&gt;bufferLength, 0, 64 - context-&gt;bufferLength);</span><br><span class="line">        SM3Compress(context, context-&gt;buffer);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // è¾“å‡ºæœ€ç»ˆå“ˆå¸Œï¼ˆ256ä½ï¼Œå¤§ç«¯åºï¼‰</span><br><span class="line">    for (int i = 0; i &lt; 8; i++) &#123;</span><br><span class="line">        output[i*4]     = (uint8_t)(context-&gt;state[i] &gt;&gt; 24);</span><br><span class="line">        output[i*4 + 1] = (uint8_t)(context-&gt;state[i] &gt;&gt; 16);</span><br><span class="line">        output[i*4 + 2] = (uint8_t)(context-&gt;state[i] &gt;&gt; 8);</span><br><span class="line">        output[i*4 + 3] = (uint8_t)(context-&gt;state[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Objective-C å°è£…æ¥å£</span><br><span class="line">@implementation SM3Encryptor</span><br><span class="line"></span><br><span class="line">+ (NSData *)hashWithData:(NSData *)inputData &#123;</span><br><span class="line">    SM3Context context;</span><br><span class="line">    SM3Init(&amp;context);</span><br><span class="line">    </span><br><span class="line">    // å¤„ç†è¾“å…¥æ•°æ®</span><br><span class="line">    SM3Update(&amp;context, inputData.bytes, inputData.length);</span><br><span class="line">    </span><br><span class="line">    // è·å–ç»“æœ</span><br><span class="line">    uint8_t output[32];</span><br><span class="line">    SM3Final(&amp;context, output);</span><br><span class="line">    </span><br><span class="line">    return [NSData dataWithBytes:output length:32];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (NSString *)hexStringWithData:(NSData *)inputData &#123;</span><br><span class="line">    NSData *hashData = [self hashWithData:inputData];</span><br><span class="line">    const uint8_t *bytes = (const uint8_t *)hashData.bytes;</span><br><span class="line">    NSMutableString *hex = [NSMutableString string];</span><br><span class="line">    </span><br><span class="line">    for (NSUInteger i = 0; i &lt; hashData.length; i++) &#123;</span><br><span class="line">        [hex appendFormat:@&quot;%02X&quot;, bytes[i]];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return [hex copy];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (NSString *)hexStringWithInput:(NSString *)inputStr &#123;</span><br><span class="line">    NSData *inputData = [inputStr dataUsingEncoding:NSUTF8StringEncoding];</span><br><span class="line">    NSData *hashData = [self hashWithData:inputData];</span><br><span class="line">    const uint8_t *bytes = (const uint8_t *)hashData.bytes;</span><br><span class="line">    NSMutableString *hex = [NSMutableString string];</span><br><span class="line">    </span><br><span class="line">    for (NSUInteger i = 0; i &lt; hashData.length; i++) &#123;</span><br><span class="line">        [hex appendFormat:@&quot;%02X&quot;, bytes[i]];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return [hex copy];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>â€œiOSâ€</tag>
        <tag>â€œSM3â€</tag>
      </tags>
  </entry>
  <entry>
    <title>iOS-jsä¸iOSçš„äº¤äº’ï¼ˆåŸºäºWKWebViewJavascriptBridgeç¬¬ä¸‰æ–¹ï¼‰</title>
    <url>/2016/07/09/iOS-js%E4%B8%8EiOS%E7%9A%84%E4%BA%A4%E4%BA%92%EF%BC%88%E5%9F%BA%E4%BA%8EWKWebViewJavascriptBridge%E7%AC%AC%E4%B8%89%E6%96%B9%EF%BC%89/</url>
    <content><![CDATA[<blockquote>
<p>åå¤©å°±è¦å»åŒ—äº¬å‡ºå·®äº†ï¼Œæ®è¯´é‚£è¾¹çš„é¡¹ç›®ä¸»è¦æ˜¯ä¸ç½‘é¡µäº¤äº’ï¼Œæ‰€ä»¥å°±ç®€å•çš„ç ”ç©¶äº†ä¸€ä¸‹jsä¸iOSçš„äº¤äº’ã€‚<br>å…¶äº¤äº’æ–¹å¼æœ‰å¾ˆå¤šç§</p>
</blockquote>
<h3 id="ä¸€ã€nativeï¼ˆappï¼‰é€šè¿‡UIWebViewçš„ä»£ç†æ–¹æ³•æ‹¦æˆªurl-schemeåˆ¤æ–­æ˜¯å¦æ˜¯æˆ‘ä»¬éœ€è¦æ‹¦æˆªå¤„ç†çš„urlåŠå…¶æ‰€å¯¹åº”çš„è¦å¤„ç†çš„é€»è¾‘ï¼ˆå¯ä»¥å®ç°å¯¹ç½‘é¡µçš„è¿”å›ã€å‰æ™¯ã€åˆ·æ–°ï¼‰ï¼Œæ¯”è¾ƒé€šç”¨å’Œç®€å•ã€‚"><a href="#ä¸€ã€nativeï¼ˆappï¼‰é€šè¿‡UIWebViewçš„ä»£ç†æ–¹æ³•æ‹¦æˆªurl-schemeåˆ¤æ–­æ˜¯å¦æ˜¯æˆ‘ä»¬éœ€è¦æ‹¦æˆªå¤„ç†çš„urlåŠå…¶æ‰€å¯¹åº”çš„è¦å¤„ç†çš„é€»è¾‘ï¼ˆå¯ä»¥å®ç°å¯¹ç½‘é¡µçš„è¿”å›ã€å‰æ™¯ã€åˆ·æ–°ï¼‰ï¼Œæ¯”è¾ƒé€šç”¨å’Œç®€å•ã€‚" class="headerlink" title="ä¸€ã€nativeï¼ˆappï¼‰é€šè¿‡UIWebViewçš„ä»£ç†æ–¹æ³•æ‹¦æˆªurl schemeåˆ¤æ–­æ˜¯å¦æ˜¯æˆ‘ä»¬éœ€è¦æ‹¦æˆªå¤„ç†çš„urlåŠå…¶æ‰€å¯¹åº”çš„è¦å¤„ç†çš„é€»è¾‘ï¼ˆå¯ä»¥å®ç°å¯¹ç½‘é¡µçš„è¿”å›ã€å‰æ™¯ã€åˆ·æ–°ï¼‰ï¼Œæ¯”è¾ƒé€šç”¨å’Œç®€å•ã€‚"></a>ä¸€ã€nativeï¼ˆappï¼‰é€šè¿‡UIWebViewçš„ä»£ç†æ–¹æ³•æ‹¦æˆªurl schemeåˆ¤æ–­æ˜¯å¦æ˜¯æˆ‘ä»¬éœ€è¦æ‹¦æˆªå¤„ç†çš„urlåŠå…¶æ‰€å¯¹åº”çš„è¦å¤„ç†çš„é€»è¾‘ï¼ˆå¯ä»¥å®ç°å¯¹ç½‘é¡µçš„è¿”å›ã€å‰æ™¯ã€åˆ·æ–°ï¼‰ï¼Œæ¯”è¾ƒé€šç”¨å’Œç®€å•ã€‚</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">self.webView = [[UIWebView alloc]initWithFrame:CGRectMake(0, 0, self.view.bounds.size.width, self.view.bounds.size.height)];</span><br><span class="line"></span><br><span class="line">self.webView.delegate = self;</span><br><span class="line"></span><br><span class="line">[self.webView setUserInteractionEnabled:YES]; //æ˜¯å¦æ”¯æŒäº¤äº’</span><br><span class="line"></span><br><span class="line">[self.webView setOpaque:NO]; //opaqueæ˜¯ä¸é€æ˜çš„æ„æ€</span><br><span class="line"></span><br><span class="line">[self.webView setScalesPageToFit:YES]; //è‡ªåŠ¨ç¼©æ”¾ä»¥é€‚åº”å±å¹•</span><br><span class="line"></span><br><span class="line">[self.view addSubview:self.webView];</span><br><span class="line"></span><br><span class="line">if (sender.tag == 101) &#123;</span><br><span class="line"></span><br><span class="line">// è¿”å›ï¼ˆç‚¹å‡»é¡µé¢æ‰ä¼šæœ‰è¿”å›ï¼‰</span><br><span class="line">[self.mWebView goBack];</span><br><span class="line"></span><br><span class="line">&#125;else if (sender.tag == 102) &#123;</span><br><span class="line"></span><br><span class="line">// å‰è¿›ï¼ˆç‚¹å‡»è¿‡çš„é¡µé¢ï¼‰</span><br><span class="line">[self.mWebView goForward];</span><br><span class="line"></span><br><span class="line">&#125;else &#123;</span><br><span class="line"></span><br><span class="line">// åˆ·æ–°é¡µé¢</span><br><span class="line">[self.mWebView reload];</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="äºŒã€iOS7ä¹‹åå‡ºäº†JavaScriptCore-frameworkç”¨äºä¸JSäº¤äº’ï¼Œé€šè¿‡JSContextè°ƒç”¨JSä»£ç çš„æ–¹æ³•ï¼š"><a href="#äºŒã€iOS7ä¹‹åå‡ºäº†JavaScriptCore-frameworkç”¨äºä¸JSäº¤äº’ï¼Œé€šè¿‡JSContextè°ƒç”¨JSä»£ç çš„æ–¹æ³•ï¼š" class="headerlink" title="äºŒã€iOS7ä¹‹åå‡ºäº†JavaScriptCore.frameworkç”¨äºä¸JSäº¤äº’ï¼Œé€šè¿‡JSContextè°ƒç”¨JSä»£ç çš„æ–¹æ³•ï¼š"></a>äºŒã€iOS7ä¹‹åå‡ºäº†JavaScriptCore.frameworkç”¨äºä¸JSäº¤äº’ï¼Œé€šè¿‡JSContextè°ƒç”¨JSä»£ç çš„æ–¹æ³•ï¼š</h3><p><strong>1ã€ç›´æ¥è°ƒç”¨JSä»£ç </strong></p>
<p><strong>2ã€åœ¨ObjCä¸­é€šè¿‡JSContextæ³¨å…¥æ¨¡å‹ï¼Œç„¶åè°ƒç”¨æ¨¡å‹çš„æ–¹æ³•</strong></p>
<p><strong>é€šè¿‡evaluateScript:æ–¹æ³•å°±å¯ä»¥æ‰§è¡ŒJSä»£ç </strong></p>
<h3 id="ä¸‰ã€React-Native-ï¼ˆä¸æ˜¯å¾ˆäº†è§£ï¼ŒåªçŸ¥é“æ˜¯Facebookçš„ï¼Œèƒ½ç¼–è¯‘å¾ˆå¤šçš„è¯­éŸ³ï¼Œå…¼å®¹æ€§å¾ˆå¼ºï¼Œå¯ç§»æ¤ä¹Ÿå¾ˆå¼ºï¼Œæœ‰å¾ˆå¤šå¾ˆå¥½çš„åŸç”Ÿæ§ä»¶ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥äº†è§£ä¸€ä¸‹ï¼‰"><a href="#ä¸‰ã€React-Native-ï¼ˆä¸æ˜¯å¾ˆäº†è§£ï¼ŒåªçŸ¥é“æ˜¯Facebookçš„ï¼Œèƒ½ç¼–è¯‘å¾ˆå¤šçš„è¯­éŸ³ï¼Œå…¼å®¹æ€§å¾ˆå¼ºï¼Œå¯ç§»æ¤ä¹Ÿå¾ˆå¼ºï¼Œæœ‰å¾ˆå¤šå¾ˆå¥½çš„åŸç”Ÿæ§ä»¶ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥äº†è§£ä¸€ä¸‹ï¼‰" class="headerlink" title="ä¸‰ã€React Native ï¼ˆä¸æ˜¯å¾ˆäº†è§£ï¼ŒåªçŸ¥é“æ˜¯Facebookçš„ï¼Œèƒ½ç¼–è¯‘å¾ˆå¤šçš„è¯­éŸ³ï¼Œå…¼å®¹æ€§å¾ˆå¼ºï¼Œå¯ç§»æ¤ä¹Ÿå¾ˆå¼ºï¼Œæœ‰å¾ˆå¤šå¾ˆå¥½çš„åŸç”Ÿæ§ä»¶ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥äº†è§£ä¸€ä¸‹ï¼‰"></a>ä¸‰ã€React Native ï¼ˆä¸æ˜¯å¾ˆäº†è§£ï¼ŒåªçŸ¥é“æ˜¯Facebookçš„ï¼Œèƒ½ç¼–è¯‘å¾ˆå¤šçš„è¯­éŸ³ï¼Œå…¼å®¹æ€§å¾ˆå¼ºï¼Œå¯ç§»æ¤ä¹Ÿå¾ˆå¼ºï¼Œæœ‰å¾ˆå¤šå¾ˆå¥½çš„åŸç”Ÿæ§ä»¶ï¼Œæœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥äº†è§£ä¸€ä¸‹ï¼‰</h3><h3 id="å››ã€WebViewJavascriptBridgeï¼ˆç¬¬ä¸‰æ–¹ï¼‰æ˜¯åŸºäºæ–¹å¼ä¸€å°è£…çš„ï¼ˆä¸»è¦æ˜¯ä¸¤ä¸ªå›è°ƒå‡½æ•°ï¼‰ã€‚"><a href="#å››ã€WebViewJavascriptBridgeï¼ˆç¬¬ä¸‰æ–¹ï¼‰æ˜¯åŸºäºæ–¹å¼ä¸€å°è£…çš„ï¼ˆä¸»è¦æ˜¯ä¸¤ä¸ªå›è°ƒå‡½æ•°ï¼‰ã€‚" class="headerlink" title="å››ã€WebViewJavascriptBridgeï¼ˆç¬¬ä¸‰æ–¹ï¼‰æ˜¯åŸºäºæ–¹å¼ä¸€å°è£…çš„ï¼ˆä¸»è¦æ˜¯ä¸¤ä¸ªå›è°ƒå‡½æ•°ï¼‰ã€‚"></a>å››ã€WebViewJavascriptBridgeï¼ˆç¬¬ä¸‰æ–¹ï¼‰æ˜¯åŸºäºæ–¹å¼ä¸€å°è£…çš„ï¼ˆä¸»è¦æ˜¯ä¸¤ä¸ªå›è°ƒå‡½æ•°ï¼‰ã€‚</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">åœ¨iOSç«¯ï¼š1.self.bridge = [WebViewJavascriptBridge bridgeForWebView:self.webView];</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é“¾æ¥iOSä¸js,self.webViewå°±æ˜¯å±•ç¤ºä½ ç”¨æ¥æ˜¾ç¤ºéœ€è¦äº¤æ¢é¡µé¢çš„UIWebView</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2.[self.bridge registerHandler:@&quot;testJavascriptHandler&quot; handler:^(id data, WVJBResponseCallback responseCallback) &#123;</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;ObjC Echo called with: %@&quot;, data);</span><br><span class="line"></span><br><span class="line">// åé¦ˆç»™JS</span><br><span class="line">responseCallback(data);</span><br><span class="line"></span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">// åœ¨JSä¸­å¦‚æœè°ƒç”¨äº†bridge.send()ï¼Œé‚£ä¹ˆå°†è§¦å‘OCç«¯_bridgeåˆå§‹åŒ–æ–¹æ³•ä¸­çš„å›è°ƒã€‚</span><br><span class="line"></span><br><span class="line">// åœ¨JSä¸­è°ƒç”¨äº†bridge.callHandler(&#x27;testJavascriptHandler&#x27;)ï¼Œå®ƒå°†è§¦å‘OCç«¯æ³¨å†Œçš„åŒåæ–¹æ³•</span><br><span class="line"></span><br><span class="line">// oc åŒç†</span><br><span class="line"></span><br><span class="line">// JSä¸»åŠ¨è°ƒç”¨OjbCçš„æ–¹æ³•</span><br><span class="line"></span><br><span class="line">// è¿™æ˜¯JSä¼šè°ƒç”¨ObjC Echoæ–¹æ³•ï¼Œè¿™æ˜¯OCæ³¨å†Œç»™JSè°ƒç”¨çš„</span><br><span class="line"></span><br><span class="line">// JSéœ€è¦å›è°ƒï¼Œå½“ç„¶JSä¹Ÿå¯ä»¥ä¼ å‚æ•°è¿‡æ¥ã€‚dataå°±æ˜¯JSæ‰€ä¼ çš„å‚æ•°ï¼Œä¸ä¸€å®šéœ€è¦ä¼ </span><br><span class="line"></span><br><span class="line">// OCç«¯é€šè¿‡responseCallbackå›è°ƒJSç«¯ï¼ŒJSå°±å¯ä»¥å¾—åˆ°æ‰€éœ€è¦çš„æ•°æ®</span><br><span class="line"></span><br><span class="line">3.[self.bridge callHandler:@&quot;sayHello&quot; data:@&#123;@&quot;hello&quot;: @&quot;ä½ å¥½&quot;&#125; responseCallback:^(id responseData) &#123;</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;å›è°ƒç»“æœ: %@&quot;, responseData);</span><br><span class="line"></span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç›´æ¥è°ƒç”¨JSç«¯æ³¨å†Œçš„HandleNameï¼Œä¸€å®šæ³¨æ„æ­¤æ¬¡çš„åå­—ä¸€å®šè¦ä¸jsç«¯çš„ç›¸åŒã€‚<br>jsè°ƒç”¨æ—¶ä¹Ÿä¸€æ ·</p>
</blockquote>
<p>åœ¨JSç«¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.Copy and paste setupWebViewJavascriptBridge into your JS:</span><br><span class="line"></span><br><span class="line">ï¼ˆæ­¤æ®µä»£ç ä¸ºå›ºå®šæ ¼å¼ï¼Œç›´æ¥æ”¾åœ¨jsç«¯å°±è¡Œï¼‰</span><br><span class="line"></span><br><span class="line">function setupWebViewJavascriptBridge(callback) &#123;</span><br><span class="line"></span><br><span class="line">if (window.WebViewJavascriptBridge) &#123; return callback(WebViewJavascriptBridge); &#125;</span><br><span class="line"></span><br><span class="line">if (window.WVJBCallbacks) &#123; return window.WVJBCallbacks.push(callback); &#125;</span><br><span class="line"></span><br><span class="line">window.WVJBCallbacks = [callback];</span><br><span class="line"></span><br><span class="line">var WVJBIframe = document.createElement(&#x27;iframe&#x27;);</span><br><span class="line"></span><br><span class="line">WVJBIframe.style.display = &#x27;none&#x27;;</span><br><span class="line"></span><br><span class="line">WVJBIframe.src = &#x27;wvjbscheme://__BRIDGE_LOADED__&#x27;;</span><br><span class="line"></span><br><span class="line">document.documentElement.appendChild(WVJBIframe);</span><br><span class="line"></span><br><span class="line">setTimeout(function() &#123; document.documentElement.removeChild(WVJBIframe) &#125;, 0)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>åé¢å‡ æ­¥ä¸iOSç«¯ä¸€æ ·</p>
<p>å¦‚æœ‰é”™è¯¯ï¼Œæœ›è¯·æŒ‡å‡ºã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>â€œiOSâ€</tag>
        <tag>â€œjsâ€</tag>
        <tag>â€œWKWebViewJavascriptBridgeâ€</tag>
      </tags>
  </entry>
  <entry>
    <title>iOS-webViewä¸ŠåŠ è½½HTMLè§†é¢‘ä¸æ˜¾ç¤ºç¼©ç•¥å›¾</title>
    <url>/2016/08/08/iOS-webView%E4%B8%8A%E5%8A%A0%E8%BD%BDHTML%E8%A7%86%E9%A2%91%E4%B8%8D%E6%98%BE%E7%A4%BA%E7%BC%A9%E7%95%A5%E5%9B%BE/</url>
    <content><![CDATA[<blockquote>
<p>æœ€è¿‘åœ¨é¡¹ç›®ä¸­é‡åˆ°äº†ä¸€ä¸ªæ¯”è¾ƒæ£˜æ‰‹çš„é—®é¢˜ï¼šåœ¨åŸç”Ÿçš„iOSçš„webViewä¸Šé¢åŠ è½½HTMLè§†é¢‘å‘ç°æ²¡æœ‰ç¼©ç•¥å›¾ï¼Œåœ¨ç½‘ä¸ŠæŸ¥äº†èµ„æ–™å‘ç°åœ¨HTMLé‡Œé¢æœ‰ä¸ªposterå±æ€§ï¼ˆæ·»åŠ ä¸€ä¸ªå›¾ç‰‡ï¼‰å¯ä»¥è®¾ç½®ç¼©ç•¥å›¾ï¼Œä½†æ˜¯æˆ‘ä»¬çš„åå°å‘Šè¯‰æˆ‘è§†é¢‘èµ„æºæœ¬æ¥å°±æ˜¯æ¥è‡ªç½‘ç»œçš„ï¼Œæ²¡æœ‰ç¼©ç•¥å›¾åªèƒ½è‡ªå·±è§£å†³äº†ã€‚äºæ˜¯å¼€å§‹æ˜¯Googleæ¨¡å¼ã€‚ç»ˆäºåŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼Œåœ¨ä¸€ä¸ª<a href="https://www.sitepoint.com/html5-video-fragments-captions-dynamic-thumbnails/">å›½å¤–çš„ç½‘ç«™</a>ä¸Šé¢å‘ç°äº†ä¸€ä¸ªæŠ˜ä¸­çš„è§£å†³åŠæ³•ã€‚</p>
</blockquote>
<h3 id="åŠæ³•"><a href="#åŠæ³•" class="headerlink" title="åŠæ³•"></a>åŠæ³•</h3><blockquote>
<p>å…¶å®ç»“å±€çš„åŠæ³•å¾ˆç®€å•ï¼Œä½†æ˜¯å¯¹æˆ‘è¿™ä¸ªä¸æ˜¯å¤ªæ‡‚å‰ç«¯çš„äººæ¥è¯´è¿˜æ˜¯â€¦â€¦ã€‚</p>
</blockquote>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/4207318919c8a9ed74e9a03b62d18e6c.webp?x-image-process=image/format,png" alt="æ–¹æ³•2016-08-08 00.29.36.png"></p>
<blockquote>
<p>è¿™ä¸ªæ–¹æ³•å°±æ˜¯åœ¨èµ„æºURLçš„åé¢ï¼ˆè§†é¢‘æ ¼å¼åé¢ï¼Œæœ‰çš„æ—¶å€™è§†é¢‘æ ¼å¼åé¢è¿˜æœ‰å…¶ä»–çš„å­—ç¬¦ä¸²ï¼Œæˆ‘æ˜¯ç›´æ¥æŠŠ.mp4åé¢çš„ç›´æ¥åˆ é™¤äº†ï¼Œä½†æ˜¯è§†é¢‘è¿˜æ˜¯å¯ä»¥æ’­æ”¾ï¼‰åŠ ä¸Š#t&#x3D;xxx,å…¶ä¸­çš„xxxä»£è¡¨çš„æ˜¯æ—¶é—´ï¼ˆç§’ï¼‰ã€‚å¤§æ¦‚çš„æ€è·¯æ˜¯è¿™æ ·çš„ï¼šå°±æ˜¯åœ¨åŠ è½½è§†é¢‘çš„æ—¶å€™è®¾ç½®è§†é¢‘çš„èµ·å§‹æ—¶é—´è®©è§†é¢‘è·³è½¬åˆ°ä½ è®¾ç½®çš„æ—¶é—´ä¸Šï¼Œä½†æ˜¯æ—¶é—´ä¸€å®šè¦è¶³å¤Ÿçš„å°ï¼Œå› ä¸ºå¤§äº†å‰é¢çš„è§†é¢‘å°±çœ‹ä¸äº†äº†ã€‚</p>
</blockquote>
<p><strong>è¿™ä¸ªæ–¹æ³•å…¶å®è¿˜æœ‰ä¸€ä¸ªç”¨æ³•ï¼š</strong></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/406035d5b21ac7d6e4ba0edbf0414389.webp?x-image-process=image/format,png" alt="ç”¨æ³• 2016-08-08 00.50.52.png"></p>
<blockquote>
<p>è§†é¢‘ä¼šåœ¨0ï¼š06å¼€å§‹æ’­æ”¾ç›´åˆ°0ï¼š20åœæ­¢æ’­æ”¾ã€‚ä½†æ˜¯è¿™ä¸æ˜¯è‡ªåŠ¨æ’­æ”¾ï¼Œè‡ªåŠ¨æ’­æ”¾éœ€è¦è®¾ç½®ï¼šautoplay&#x3D;â€autoplayâ€ã€‚</p>
</blockquote>
<h3 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h3><blockquote>
<p>NOTEï¼šå¯¹äºwebç«¯æˆ‘æ˜¯ä¸€ä¸ªèœé¸Ÿï¼Œä¹Ÿä¸çŸ¥é“ç”¨è¿™ä¸ªæ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜æ˜¯ä¸æ˜¯å¤ªè ¢äº†ï¼Œå¸Œæœ›è°æœ‰å…¶ä»–æ›´å¥½çš„è§£å†³åŠæ³•å¯ä»¥ä¸åèµæ•™ï¼Œè°¢è°¢ã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>â€œiOSâ€</tag>
        <tag>â€œwebViewâ€</tag>
        <tag>â€œè§†é¢‘ä¸æ˜¾ç¤ºç¼©ç•¥å›¾â€</tag>
      </tags>
  </entry>
  <entry>
    <title>iOS-widget-Today æ‰©å±•</title>
    <url>/2016/07/25/iOS-widget-Today-%E6%89%A9%E5%B1%95/</url>
    <content><![CDATA[<blockquote>
<p>ä»Šå¤©è¦åˆ†äº«çš„æ˜¯é€šçŸ¥ä¸­å¿ƒæ‰©å±•ä¸­çš„-<a href="https://developer.apple.com/library/ios/documentation/General/Conceptual/ExtensibilityPG/">Today</a>æ‰©å±•ï¼ˆios8æ¨å‡ºï¼‰ï¼Œiosç›®å‰å¯ä»¥ä½¿ç”¨çš„æ‰©å±•æœ‰ï¼štodayæ‰©å±•ï¼ˆwidget-å³é€šçŸ¥æ çš„ä»Šå¤©ä¸€æ ï¼‰ã€é”®ç›˜è‡ªå®šä¹‰ã€æ–‡ä»¶ç®¡ç†ã€ç…§ç‰‡ç¼–è¾‘æ‰©å±•ã€é€šçŸ¥æ‰©å±•ï¼ˆæ¨é€ï¼‰ã€åˆ†äº«æ‰©å±•ç­‰ã€‚æ‰©å±•ä¸æ‹¥æœ‰è¿™ä¸ªæ‰©å±•ä¸»åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ç‹¬ç«‹çš„ã€‚ä»–ä»¬æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ã€‚</p>
</blockquote>
<h3 id="ä¸€ã€ç›®æ ‡ï¼š"><a href="#ä¸€ã€ç›®æ ‡ï¼š" class="headerlink" title="ä¸€ã€ç›®æ ‡ï¼š"></a>ä¸€ã€ç›®æ ‡ï¼š</h3><blockquote>
<p>æˆ‘é¡¹ç›®æ˜¯å¸Œæœ›åœ¨widgetä¸­æ·»åŠ ä¸€ä¸ªH5çš„é¡µé¢æ–¹ä¾¿ä»¥åçš„è‡ªå®šä¹‰ã€‚ç‚¹å‡»å¯¹åº”æŒ‰é’®å»åˆ°ç›¸åº”ç•Œé¢ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“è¿™æ ·ç®—ä¸ç®—æ»¥ç”¨widgetï¼Œå› ä¸ºä¹‹å‰çœ‹è§è¿‡æœ‰äººçš„åº”ç”¨è¢«è‹¹æœæ‹’ç»å°±æ˜¯å› ä¸ºæ»¥ç”¨widgetå¯¼è‡´çš„ã€‚</p>
</blockquote>
<h3 id="äºŒã€å®ç°ï¼š"><a href="#äºŒã€å®ç°ï¼š" class="headerlink" title="äºŒã€å®ç°ï¼š"></a>äºŒã€å®ç°ï¼š</h3><blockquote>
<p>1.å› ä¸ºwidgetæ˜¯ä¸€ä¸ªå•ç‹¬çš„è¿›ç¨‹æ‰€ä»¥éœ€è¦åˆ›å»ºä¸€ä¸ªtargetï¼š</p>
</blockquote>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/0b583421a35083363bf56d91148192dd.webp?x-image-process=image/format,png" alt="é¦–å…ˆ 2016-07-24 23.01.34.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/217a9594befa8d064b3f479abf1d92db.webp?x-image-process=image/format,png" alt="ç„¶å 2016-07-24 23.01.13.png"></p>
<blockquote>
<p>2.ä»£ç </p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    // è°ƒæ•´Widgetçš„é«˜åº¦</span><br><span class="line">    self.preferredContentSize = CGSizeMake(0, 200);</span><br><span class="line">    </span><br><span class="line">    // 1ã€åˆ›å»ºUIWebViewï¼š</span><br><span class="line">    UIWebView *mWebView = [[UIWebView alloc]initWithFrame:CGRectMake(0, 0, self.view.frame.size.width, 200)];</span><br><span class="line">    </span><br><span class="line">    // 2ã€è®¾ç½®å±æ€§ï¼š</span><br><span class="line">    mWebView.scalesPageToFit = YES;// è‡ªåŠ¨å¯¹é¡µé¢è¿›è¡Œç¼©æ”¾ä»¥é€‚åº”å±å¹•</span><br><span class="line">    // æ£€æµ‹æ‰€æœ‰æ•°æ®ç±»å‹  è®¾å®šç”µè¯å·ç ã€ç½‘å€ã€ç”µå­é‚®ä»¶å’Œæ—¥æœŸç­‰æ–‡å­—å˜ä¸ºé“¾æ¥æ–‡å­—</span><br><span class="line">    </span><br><span class="line">    [mWebView setDataDetectorTypes:UIDataDetectorTypeAll];</span><br><span class="line">    mWebView.delegate = self;</span><br><span class="line">    </span><br><span class="line">    // æ‰“å¼€URL</span><br><span class="line">    NSURLRequest *request =[NSURLRequest requestWithURL:[NSURL URLWithString:@&quot;http://www.baidu.com&quot;]];</span><br><span class="line">    [mWebView loadRequest:request];</span><br><span class="line">    [self.view addSubview:mWebView];</span><br><span class="line">    </span><br><span class="line">    [self makeButtonWithTitle:@&quot;è¿”å›&quot; frame:CGRectMake(0, 0, 80, 64) button:_backBtn];</span><br><span class="line">    [self makeButtonWithTitle:@&quot;å‰è¿›&quot; frame:CGRectMake(self.view.frame.size.width - 80, 0, 80, 64) button:_forWardBtn];</span><br><span class="line">    [self makeButtonWithTitle:@&quot;åˆ·æ–°&quot; frame:CGRectMake(100, 0, 80, 64) button:_refreshBtn];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å–æ¶ˆwidgeté»˜è®¤çš„insetï¼Œè®©åº”ç”¨é å·¦</span><br><span class="line">- (UIEdgeInsets)widgetMarginInsetsForProposedMarginInsets:(UIEdgeInsets)defaultMarginInsets &#123;</span><br><span class="line">    return UIEdgeInsetsZero;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)makeButtonWithTitle:(NSString *)title frame:(CGRect)frame button:(UIButton *)btn &#123;</span><br><span class="line">    btn = [UIButton buttonWithType:UIButtonTypeCustom];</span><br><span class="line">    [btn setTitle:title forState:UIControlStateNormal];</span><br><span class="line">    [btn setTitleColor:[UIColor redColor] forState:UIControlStateNormal];</span><br><span class="line">    [btn addTarget:self action:@selector(skip:) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">    [btn setFrame:frame];</span><br><span class="line">    </span><br><span class="line">    if ([title isEqualToString:@&quot;è¿”å›&quot;]) &#123;</span><br><span class="line">        btn.tag = 101;</span><br><span class="line">    &#125; else if([title isEqualToString:@&quot;å‰è¿›&quot;]) &#123;</span><br><span class="line">        btn.tag = 102;</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        btn.tag = 103;</span><br><span class="line">    &#125;</span><br><span class="line">    [self.view addSubview:btn];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)skip:(UIButton *)button</span><br><span class="line">&#123;</span><br><span class="line">    if (button.tag == 101) &#123;</span><br><span class="line">        [self.extensionContext openURL:[NSURL URLWithString:@&quot;iOSWidgetApp://action=GotoHomePage&quot;] completionHandler:^(BOOL success) &#123;</span><br><span class="line">            NSLog(@&quot;101   open url result:%d&quot;,success);</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">    else if(button.tag == 102) &#123;</span><br><span class="line">        [self.extensionContext openURL:[NSURL URLWithString:@&quot;iOSWidgetApp://action=GotoOtherPage&quot;] completionHandler:^(BOOL success) &#123;</span><br><span class="line">            NSLog(@&quot;102    open url result:%d&quot;,success);</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">        [self.extensionContext openURL:[NSURL URLWithString:@&quot;iOSWidgetApp://action=GotoOtherPages&quot;] completionHandler:^(BOOL success) &#123;</span><br><span class="line">            NSLog(@&quot;102    open url result:%d&quot;,success);</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¿è¡Œä¸ç»“æœå±•ç¤ºï¼š</p>
</blockquote>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d2078c3e20a8126af877649cb755bce1.webp?x-image-process=image/format,png" alt="è¿è¡Œ 2016-07-24 23.02.28.png"></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d8e9254bab90d77597bda99215fded4b.webp?x-image-process=image/format,png" alt="æ•ˆæœå›¾ 2016-07-25 09.55.44.png"></p>
<h3 id="æ‰©å±•ä¸ä¸»ç¨‹åºçš„äº¤äº’-æ•°æ®å…±äº«"><a href="#æ‰©å±•ä¸ä¸»ç¨‹åºçš„äº¤äº’-æ•°æ®å…±äº«" class="headerlink" title="æ‰©å±•ä¸ä¸»ç¨‹åºçš„äº¤äº’-æ•°æ®å…±äº«"></a>æ‰©å±•ä¸ä¸»ç¨‹åºçš„äº¤äº’-æ•°æ®å…±äº«</h3><p><strong>è¿™å°±è¦æ¶‰åŠæ‰©å±•ä¸åº”ç”¨ä¹‹é—´çš„æ•°æ®å…±äº«äº†-App Groups.</strong></p>
<blockquote>
<p>é¦–å…ˆåœ¨ä¸»åº”ç”¨çš„target &gt; Capabilitiesä¸‹ æ‰“å¼€App Groups ç‚¹å‡»+ åœ¨group.åé¢è¾“å…¥æ ‡è¯†ç¬¦ï¼Œ</p>
</blockquote>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/62f1aa6e7f4adbc919d563ca0a21bda6.webp?x-image-process=image/format,png" alt="Snip20160725_1.png"></p>
<p><strong>å†å»æ‰©å±•çš„targetä¸‹è¿›è¡Œç›¸åŒçš„æ“ä½œï¼Œè®°å¾—group.åçš„æ ‡è¯†ç¬¦è¦ä¸€è‡´ã€‚</strong></p>
<p>#####ä»£ç ï¼š</p>
<blockquote>
<p>åœ¨ä¸Šé¢çš„æ‰©å±•ä»£ç é‡Œé¢å·²ç»å®šä¹‰äº†ç‚¹å‡»äº‹ä»¶ï¼Œè¿™é‡Œä¸»è¦æ˜¯ä¸»åº”ç”¨æ¥æ”¶åˆ°ä¿¡æ¯åè¿›è¡Œåˆ¤æ–­å’Œå¤„ç†ã€‚</p>
<p>åœ¨è¿™ä¹‹å‰è¿˜éœ€è¦å…ˆé…ç½®URL schems,åœ¨ä¸»ç¨‹åºçš„plisté‡Œé¢ï¼š</p>
</blockquote>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/b36fb85f5f7ece4451b9e5c8b160d604.webp?x-image-process=image/format,png" alt="plist 2016-07-25 10.40.15.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation &#123;</span><br><span class="line">    </span><br><span class="line">    NSString* prefix = @&quot;iOSWidgetApp://action=&quot;;</span><br><span class="line">    </span><br><span class="line">    UIWebView *webView = [[UIWebView alloc]initWithFrame:[UIScreen mainScreen].bounds];</span><br><span class="line">    webView.backgroundColor = [UIColor clearColor];</span><br><span class="line">    webView.delegate = self;</span><br><span class="line">    [webView setUserInteractionEnabled:YES];//æ˜¯å¦æ”¯æŒäº¤äº’</span><br><span class="line">    [webView setOpaque:NO];//opaqueæ˜¯ä¸é€æ˜çš„æ„æ€</span><br><span class="line">    [webView setScalesPageToFit:YES];//è‡ªåŠ¨ç¼©æ”¾ä»¥é€‚åº”å±å¹•</span><br><span class="line">    webView .scrollView.bounces = NO;// ç¦æ­¢UIWebViewä¸‹æ‹‰æ‹–åŠ¨æ•ˆæœ</span><br><span class="line">    NSString *path;</span><br><span class="line">    if ([[url absoluteString] rangeOfString:prefix].location != NSNotFound) &#123;</span><br><span class="line">        NSString* action = [[url absoluteString] substringFromIndex:prefix.length];</span><br><span class="line">        if ([action isEqualToString:@&quot;GotoHomePage&quot;]) &#123;</span><br><span class="line">            path = [[NSBundle mainBundle] pathForResource:@&quot;help&quot; ofType:@&quot;html&quot;];</span><br><span class="line">        &#125;</span><br><span class="line">        else if([action isEqualToString:@&quot;GotoOtherPage&quot;]) &#123;</span><br><span class="line">            path = [[NSBundle mainBundle] pathForResource:@&quot;setting&quot; ofType:@&quot;html&quot;];</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            path = [[NSBundle mainBundle] pathForResource:@&quot;healthyArticle&quot; ofType:@&quot;html&quot;];</span><br><span class="line">        &#125;</span><br><span class="line">        NSURL *urll = [NSURL fileURLWithPath:path];</span><br><span class="line">        NSURLRequest* request = [NSURLRequest requestWithURL:urll] ;</span><br><span class="line">        [webView loadRequest:request];</span><br><span class="line">        [self.rootView.view addSubview:webView];</span><br><span class="line">        self.rootView.view.backgroundColor = [UIColor whiteColor];</span><br><span class="line">    &#125;</span><br><span class="line">    return  YES;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>å› ä¸ºæˆ‘æ˜¯éœ€è¦åˆ°å¯¹åº”çš„H5é¡µé¢æ‰€ä»¥æ˜¯æ·»åŠ çš„H5é¡µé¢ã€‚</strong></p>
<h3 id="æ³¨æ„ï¼š"><a href="#æ³¨æ„ï¼š" class="headerlink" title="æ³¨æ„ï¼š"></a>æ³¨æ„ï¼š</h3><blockquote>
<p>1.å½“ç¨‹åºå†…å­˜ä¸è¶³æ—¶ï¼Œè‹¹æœä¼˜å…ˆä¼šæ€æ­»æ‰©å±•ï¼Œå› æ­¤éœ€è¦æ³¨æ„å†…å­˜çš„ç®¡ç†ã€‚</p>
<p>2.åœ¨é…ç½®teamæ˜¯è´¦å·éœ€è¦ä¸€è‡´ï¼ˆæˆ‘æµ‹è¯•çš„æ—¶å€™å…è´¹è´¦å·å¥½åƒè¿˜ä¸è¡Œï¼Œéœ€è¦ä»˜è´¹çš„è´¦å·ï¼‰</p>
<p>3.åœ¨iOS10ä¸Šé¢è¿˜å¯ä»¥ä»å·¦æ»‘ä¸»é¡µé¢å’Œé”å±è¿›å…¥widgetã€‚</p>
<p>4.todayåªæœ‰åœ¨ä¸‹æ‹‰çš„æ—¶å€™æ‰ä¼šæ›´æ–°ï¼Œé€šçŸ¥æ ä¸¤è¾¹çš„æ›´æ–°æœºåˆ¶æ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
<p>5.ä¸€èˆ¬æ›´æ–°è·¯å¾„ï¼šviewDidLoad-&gt;viewWillAppearï¼Œä½†æ˜¯å¦‚æœä½ ä¸‹æ‹‰è¿‡äºé¢‘ç¹å°±åªä¼šæ‰§è¡ŒviewWillAppearé‡Œé¢çš„ï¼Œå› æ­¤æ›´æ–°ä»£ç æœ€å¥½æ”¾åœ¨viewWillAppearé‡Œé¢ã€‚</p>
</blockquote>
<h6 id="å¦‚æœ‰é”™è¯¯åœ°æ–¹ï¼Œä¸‡æœ›æŒ‡å‡ºï¼Œè°¢è°¢ï¼"><a href="#å¦‚æœ‰é”™è¯¯åœ°æ–¹ï¼Œä¸‡æœ›æŒ‡å‡ºï¼Œè°¢è°¢ï¼" class="headerlink" title="å¦‚æœ‰é”™è¯¯åœ°æ–¹ï¼Œä¸‡æœ›æŒ‡å‡ºï¼Œè°¢è°¢ï¼"></a>å¦‚æœ‰é”™è¯¯åœ°æ–¹ï¼Œä¸‡æœ›æŒ‡å‡ºï¼Œè°¢è°¢ï¼</h6>]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>â€œiOSâ€</tag>
        <tag>â€œwidgetâ€</tag>
        <tag>â€œæ‰©å±•â€</tag>
      </tags>
  </entry>
  <entry>
    <title>iOS ä¸‹åŠ è½½æœ¬åœ°HTML/js/css/image ç­‰è·¯å¾„é—®é¢˜</title>
    <url>/2016/07/25/iOS-%E4%B8%8B%E5%8A%A0%E8%BD%BD%E6%9C%AC%E5%9C%B0HTML-js-css-image-%E7%AD%89%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<blockquote>
<p>ä»Šå¤©åœ¨é¡¹ç›®ä¸­é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘å°†H5çš„æ–‡ä»¶æ‹–å…¥é¡¹ç›®ä¸­ï¼Œåœ¨webViewä¸Šæ·»åŠ H5,è¿è¡Œæ—¶å‘ç°H5çš„æ ·å¼ä¸å›¾ç‰‡ç­‰éƒ½æ²¡æœ‰äº†ã€‚ç»è¿‡å¤šç§æµ‹è¯•åå‘ç°ï¼šæ˜¯è·¯å¾„çš„é—®é¢˜ã€‚</p>
<p>åœ¨iosé¡¹ç›®ä¸‹æ·»åŠ æœ¬åœ°HTML&#x2F;js&#x2F;css&#x2F;image  å½“æ‹–å…¥é¡¹ç›®æ—¶æœ‰ä¸¤ç§é€‰æ‹©ï¼š</p>
<p>ä¸€ä¸ªæ˜¯  Create groups for any added foldersï¼ˆåˆ›å»ºè™šæ‹Ÿç»“æ„-åŒ…ç»“æ„ï¼‰</p>
<p>ä¸€ä¸ªæ˜¯ Create folder references for any added folders åˆ›å»ºå®ä½“ç»“æ„ï¼‰</p>
</blockquote>
<blockquote>
<p>å¦‚æœé€‰æ‹©å‰è€…ï¼Œå½“APPç¼–è¯‘è¿‡åå¼•å…¥çš„æ–‡ä»¶ä¼šè¢«æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹é¢ä¼šå¿½ç•¥ä½ åŸæœ¬çš„æ–‡ä»¶å¤¹ã€‚å› æ­¤åœ¨HTMLæ–‡ä»¶ä¸­çš„è·¯å¾„å°±ä¼šå‡ºç°é—®é¢˜ã€‚å¦‚æœä½ é€‰æ‹©äº†å‰è€…é‚£ä¹ˆHTMLæ–‡ä»¶ä¸­å¼•å…¥CSSï¼Œjsï¼Œå›¾ç‰‡ç­‰å°±ä¸éœ€è¦æ·»åŠ å‰ç¼€è·¯å¾„äº†ï¼Œç›´æ¥å†™æ–‡ä»¶åå°±è¡Œã€‚</p>
</blockquote>
<p><strong>å¼•å…¥æ–‡ä»¶æ–¹å¼ï¼š</strong></p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">NSString * htmlPath = [[NSBundle mainBundle] pathForResource:@&quot;index&quot; ofType:@&quot;html&quot;];</span><br><span class="line">NSString * htmlString = [NSString stringWithContentsOfFile:htmlPath encoding:NSUTF8StringEncoding error:nil];</span><br><span class="line"> NSURL *baseURL = [NSURL fileURLWithPath:[[NSBundle mainBundle] resourcePath]];</span><br><span class="line">[self.webView loadHTMLString:htmlString baseURL:baseURL];</span><br></pre></td></tr></table></figure>
<blockquote>
<p> å¦‚æœé€‰æ‹©åè€…ï¼Œå½“APPç¼–è¯‘è¿‡åå¼•å…¥çš„æ–‡ä»¶ä¼šæŒ‰ç…§åŸæœ¬çš„ç›®å½•ç»“æ„å­˜æ”¾ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æ·»åŠ ç›¸å¯¹è·¯å¾„ã€‚</p>
</blockquote>
<p> <strong>å¼•å…¥æ–‡ä»¶æ–¹å¼ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[self.webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@&quot;huaiha/index.html&quot; </span><br><span class="line"></span><br><span class="line">relativeToURL:[[NSBundle mainBundle] bundleURL]]]];</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>â€œiOSâ€</tag>
        <tag>â€œæœ¬åœ°â€</tag>
        <tag>â€œè·¯å¾„é—®é¢˜â€</tag>
      </tags>
  </entry>
  <entry>
    <title>iOS-å‘å¸ƒä»£ç åˆ°cocoapodsä¸Šè¯¦ç»†æ­¥éª¤</title>
    <url>/2025/06/18/iOS-%E5%8F%91%E5%B8%83%E4%BB%A3%E7%A0%81%E5%88%B0cocoapods%E4%B8%8A%E8%AF%A6%E7%BB%86%E6%AD%A5%E9%AA%A4/</url>
    <content><![CDATA[<h2 id="å®Œæ•´æ­¥éª¤ï¼š"><a href="#å®Œæ•´æ­¥éª¤ï¼š" class="headerlink" title="å®Œæ•´æ­¥éª¤ï¼š"></a>å®Œæ•´æ­¥éª¤ï¼š</h2><blockquote>
<ol>
<li><p>æŠŠä½ éœ€è¦å‘å¸ƒåˆ°CocoaPodsçš„ä»£ç å†™å¥½ã€‚</p>
</li>
<li><p>ç”¨Xcodeåˆ›å»ºä¸€ä¸ªFrameworké¡¹ç›®ï¼Œå°†ä½ å†™å¥½çš„ä»£ç æ‹–å…¥Frameworkï¼Œè¿›è¡Œç›¸å…³é…ç½®ï¼Œæ ¹æ®éœ€æ±‚æ‰“åŒ…Frameworkã€‚</p>
</li>
<li><p>æ³¨å†ŒCocoaPodsè´¦å·ï¼Œæ£€æŸ¥åº“åæ˜¯å¦å·²è¢«å ç”¨ï¼Œæ²¡æœ‰è¢«å ç”¨å°±åˆ›å»ºPodspecæ–‡ä»¶ï¼Œæ‹–å…¥é€šç”¨Frameworkã€‚</p>
</li>
<li><p>åˆ›å»ºgitä»“åº“ï¼Œä¿®æ”¹xxx.podspecé…ç½®ï¼Œå°†ä»£ç æ¨é€åˆ°è¿œç¨‹ä»“åº“å¹¶è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼ŒéªŒè¯Podspecæ–‡ä»¶ã€‚</p>
</li>
<li><p>éªŒè¯é€šè¿‡ï¼Œå‘å¸ƒåˆ° CocoaPodsã€‚</p>
</li>
</ol>
</blockquote>
<h2 id="1-åˆ›å»ºFrameworké¡¹ç›®"><a href="#1-åˆ›å»ºFrameworké¡¹ç›®" class="headerlink" title="1. åˆ›å»ºFrameworké¡¹ç›®"></a>1. åˆ›å»ºFrameworké¡¹ç›®</h2><p><strong>1. åœ¨Xcodeä¸­ï¼Œé€‰æ‹©File -&gt; New -&gt; Project</strong></p>
<p><strong>2. é€‰æ‹©iOS -&gt; Framework &amp; Library -&gt; Frameworkï¼Œç„¶åç‚¹å‡»Next</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-be0160ff8d3afd2a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åˆ›å»ºFramework"></p>
<p><strong>3. è¾“å…¥äº§å“åç§°ï¼ˆä¾‹å¦‚ï¼š<code>LanguageSet</code>ï¼‰ï¼Œé€‰æ‹©è¯­è¨€ï¼ˆObjective-Cæˆ–Swiftï¼‰ï¼Œç‚¹å‡»Nextå¹¶ä¿å­˜ã€‚</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-83b4887d1f953d7e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åˆ›å»ºcocoapodsDemo"></p>
<h2 id="2-é…ç½®Framework"><a href="#2-é…ç½®Framework" class="headerlink" title="2. é…ç½®Framework"></a>2. é…ç½®Framework</h2><ul>
<li><strong>æ·»åŠ ä»£ç æ–‡ä»¶</strong>ï¼šå°†ä½ çš„æºä»£ç æ–‡ä»¶æ‹–å…¥é¡¹ç›®ï¼Œç¡®ä¿åœ¨Build Phases -&gt; Headersä¸­è®¾ç½®å¥½å…¬å¼€å¤´æ–‡ä»¶ï¼ˆPublic Headersï¼‰ã€‚</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-ae2a853b2b80c1ef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ·»åŠ ä»£ç æ–‡ä»¶"></p>
<ul>
<li><strong>å°†éœ€è¦å…¬å¼€çš„å¤´æ–‡ä»¶æ‹–åˆ°publicï¼š</strong></li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-d9a8a7555487533e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è®¾ç½®å¥½å…¬å¼€å¤´æ–‡ä»¶"></p>
<p><strong>æ·»åŠ ç¬¬ä¸‰æ–¹åº“</strong></p>
<blockquote>
<p>1.ä½¿ç”¨cocoapodæ˜¯å¯ä»¥è‡ªåŠ¨ç®¡ç†ç¬¬ä¸‰æ–¹åº“ï¼Œåœ¨Link Binary With Libraries ä¸­æ‰¾åˆ°Pod_çš„framwork é€‰æ‹©Optional</p>
</blockquote>
<blockquote>
<p>2.æ‰‹åŠ¨æ·»åŠ ç¬¬ä¸‰æ–¹åº“å’Œæ–‡ä»¶æ—¶ï¼Œä¸è¦é€‰æ‹©target</p>
</blockquote>
<ul>
<li><p><strong>è®¾ç½®Build Settings</strong>:</p>
</li>
<li><p><strong>Mach-O Type</strong>: é»˜è®¤ä¸ºDynamic Libraryï¼Œä¹Ÿå¯ä»¥é€‰æ‹©Static Libraryï¼ˆä½†Frameworké€šå¸¸æŒ‡åŠ¨æ€åº“ï¼‰ã€‚<br><img src="https://upload-images.jianshu.io/upload_images/1976231-4ec8c2a6b6993b23.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Mach-O Type"></p>
</li>
<li><p><strong>Build Active Architecture Only</strong>: è®¾ç½®ä¸ºNOï¼Œä»¥æ”¯æŒæ‰€æœ‰æ¶æ„ã€‚<br><img src="https://upload-images.jianshu.io/upload_images/1976231-c68f41b1eae65414.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Build Active Architecture Only"></p>
</li>
<li><p><strong>iOS Deployment Target</strong>: é€‰æ‹©ä½ å¸Œæœ›æ”¯æŒçš„æœ€ä½iOSç‰ˆæœ¬ã€‚<br><img src="https://upload-images.jianshu.io/upload_images/1976231-7f6fb03188cbd741.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="iOS Deployment Target"></p>
</li>
<li><p><strong>Swiftç‰ˆæœ¬</strong>ï¼šå¦‚æœæ˜¯Swifté¡¹ç›®ï¼Œç¡®ä¿è®¾ç½®æ­£ç¡®çš„Swiftç‰ˆæœ¬ã€‚</p>
</li>
<li><p><strong>Enable Bitcode</strong>: å¦‚æœéœ€è¦ï¼Œè®¾ç½®ä¸ºYESã€‚</p>
</li>
</ul>
<h2 id="3-æ‰“åŒ…Frameworkï¼ˆæ”¯æŒçœŸæœºå’Œæ¨¡æ‹Ÿå™¨ï¼‰"><a href="#3-æ‰“åŒ…Frameworkï¼ˆæ”¯æŒçœŸæœºå’Œæ¨¡æ‹Ÿå™¨ï¼‰" class="headerlink" title="3. æ‰“åŒ…Frameworkï¼ˆæ”¯æŒçœŸæœºå’Œæ¨¡æ‹Ÿå™¨ï¼‰"></a>3. æ‰“åŒ…Frameworkï¼ˆæ”¯æŒçœŸæœºå’Œæ¨¡æ‹Ÿå™¨ï¼‰</h2><blockquote>
<p>æˆ‘ä»¬éœ€è¦åŒæ—¶æ”¯æŒçœŸæœºå’Œæ¨¡æ‹Ÿå™¨æ¶æ„ï¼ˆarm64, x86_64ï¼‰ï¼Œå¹¶æœ€ç»ˆåˆå¹¶ä¸ºä¸€ä¸ªé€šç”¨Frameworkã€‚</p>
</blockquote>
<p><strong>1. åˆ†åˆ«ç¼–è¯‘çœŸæœºå’Œæ¨¡æ‹Ÿå™¨ç‰ˆæœ¬</strong></p>
<p><strong>1. çœŸæœºRelease</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">xcodebuild archive </span><br><span class="line"></span><br><span class="line">-scheme LanguageSet </span><br><span class="line"></span><br><span class="line">-configuration Release </span><br><span class="line"></span><br><span class="line">-destination &quot;generic/platform=iOS&quot; </span><br><span class="line"></span><br><span class="line">-archivePath &quot;build/LanguageSet-iOS&quot; </span><br><span class="line"></span><br><span class="line">SKIP_INSTALL=NO </span><br><span class="line"></span><br><span class="line">BUILD_LIBRARY_FOR_DISTRIBUTION=YES</span><br></pre></td></tr></table></figure>

<p><strong>2. æ¨¡æ‹Ÿå™¨Release</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">xcodebuild archive </span><br><span class="line"></span><br><span class="line">-scheme LanguageSet </span><br><span class="line"></span><br><span class="line">-configuration Release </span><br><span class="line"></span><br><span class="line">-destination &quot;generic/platform=iOS Simulator&quot; </span><br><span class="line"></span><br><span class="line">-archivePath &quot;build/LanguageSet-Simulator&quot; </span><br><span class="line"></span><br><span class="line">SKIP_INSTALL=NO </span><br><span class="line"></span><br><span class="line">BUILD_LIBRARY_FOR_DISTRIBUTION=YES</span><br></pre></td></tr></table></figure>

<p><strong>2. åˆå¹¶ä¸¤ä¸ªFramework-æ‰“åŒ…é€šç”¨Frameworkï¼ˆæ”¯æŒçœŸæœº+æ¨¡æ‹Ÿå™¨ï¼‰</strong></p>
<blockquote>
<p>ä½¿ç”¨<code>lipo</code>å·¥å…·åˆå¹¶äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶å¤åˆ¶æ¨¡æ‹Ÿå™¨çš„swiftmoduleï¼ˆå¦‚æœæœ‰ï¼‰åˆ°çœŸæœºFrameworkä¸­ã€‚</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºé€šç”¨Frameworkç›®å½•</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">mkdir</span> -p build/LanguageSet-Universal</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤åˆ¶çœŸæœºFrameworkåˆ°é€šç”¨ç›®å½•</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cp</span> -R build/LanguageSet-iOS.xcarchive/Products/Library/Frameworks/LanguageSet build/LanguageSet-Universal/</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå¹¶äºŒè¿›åˆ¶æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">lipo -create </span><br><span class="line"></span><br><span class="line">build/LanguageSet-iOS.xcarchive/Products/Library/Frameworks/LanguageSet.framework/LanguageSet </span><br><span class="line"></span><br><span class="line">build/LanguageSet-Simulator.xcarchive/Products/Library/Frameworks/LanguageSetframework/LanguageSet </span><br><span class="line"></span><br><span class="line">-output build/LanguageSet-Universal/LanguageSet.framework/LanguageSet</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœä½¿ç”¨Swiftï¼Œéœ€è¦åˆå¹¶swiftmodule</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -d <span class="string">&quot;build/LanguageSet-Simulator.xcarchive/Products/Library/Frameworks/LanguageSet.framework/Modules/LanguageSet.swiftmodule&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cp</span> -R build/LanguageSet-Simulator.xcarchive/Products/Library/Frameworks/LanguageSet.framework/Modules/LanguageSet.swiftmodule/* \</span><br><span class="line"></span><br><span class="line">build/LanguageSet-Universal/LanguageSet.framework/Modules/LanguageSet.swiftmodule/</span><br><span class="line"></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>å°†ä¸Šé¢çš„åˆå¹¶èµ·æ¥ï¼š</strong></p>
<p><strong>åˆ›å»ºä¸€ä¸ªæ‰“åŒ…è„šæœ¬ build_framework.sh</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line"># 1. å®šä¹‰åŸºç¡€å˜é‡</span><br><span class="line">SCHEME_NAME=&quot;LanguageSet&quot;   # æ›¿æ¢ä¸ºå®é™…Schemeå</span><br><span class="line">PROJECT_NAME=&quot;LanguageSet&quot;    # æ›¿æ¢ä¸ºå®é™…å·¥ç¨‹å</span><br><span class="line">CONFIGURATION=&quot;Release&quot;           # å»ºè®®ä½¿ç”¨Releaseæ¨¡å¼</span><br><span class="line">OUTPUT_DIR=&quot;$&#123;PWD&#125;/Output&quot;        # è¾“å‡ºç›®å½•</span><br><span class="line"></span><br><span class="line"># 2. æ¸…ç†æ—§æ„å»º</span><br><span class="line">rm -rf &quot;$&#123;OUTPUT_DIR&#125;&quot;</span><br><span class="line">mkdir -p &quot;$&#123;OUTPUT_DIR&#125;&quot;</span><br><span class="line"></span><br><span class="line"># 3. ç¼–è¯‘çœŸæœºç‰ˆæœ¬ (arm64, armv7)</span><br><span class="line">xcodebuild archive \</span><br><span class="line">  -project &quot;$&#123;PROJECT_NAME&#125;.xcodeproj&quot; \</span><br><span class="line">  -scheme &quot;$&#123;SCHEME_NAME&#125;&quot; \</span><br><span class="line">  -configuration &quot;$&#123;CONFIGURATION&#125;&quot; \</span><br><span class="line">  -sdk iphoneos \</span><br><span class="line">  -archivePath &quot;$&#123;OUTPUT_DIR&#125;/iphoneos.xcarchive&quot; \</span><br><span class="line">  SKIP_INSTALL=NO \</span><br><span class="line">  BUILD_LIBRARIES_FOR_DISTRIBUTION=YES  # æ”¯æŒå¤šæ¶æ„ [[6]]</span><br><span class="line"></span><br><span class="line"># 4. ç¼–è¯‘æ¨¡æ‹Ÿå™¨ç‰ˆæœ¬ (x86_64, arm64)</span><br><span class="line">xcodebuild archive \</span><br><span class="line">  -project &quot;$&#123;PROJECT_NAME&#125;.xcodeproj&quot; \</span><br><span class="line">  -scheme &quot;$&#123;SCHEME_NAME&#125;&quot; \</span><br><span class="line">  -configuration &quot;$&#123;CONFIGURATION&#125;&quot; \</span><br><span class="line">  -sdk iphonesimulator \</span><br><span class="line">  -archivePath &quot;$&#123;OUTPUT_DIR&#125;/iphonesimulator.xcarchive&quot; \</span><br><span class="line">  SKIP_INSTALL=NO \</span><br><span class="line">  BUILD_LIBRARIES_FOR_DISTRIBUTION=YES  # M1èŠ¯ç‰‡éœ€åŒ…å«arm64 [[3, 6]]</span><br><span class="line"></span><br><span class="line"># 5. åˆå¹¶ä¸ºXCFramework (å®˜æ–¹æ¨èæ–¹å¼)</span><br><span class="line">xcodebuild -create-xcframework \</span><br><span class="line">  -framework &quot;$&#123;OUTPUT_DIR&#125;/iphoneos.xcarchive/Products/Library/Frameworks/$&#123;SCHEME_NAME&#125;.framework&quot; \</span><br><span class="line">  -framework &quot;$&#123;OUTPUT_DIR&#125;/iphonesimulator.xcarchive/Products/Library/Frameworks/$&#123;SCHEME_NAME&#125;.framework&quot; \</span><br><span class="line">  -output &quot;$&#123;OUTPUT_DIR&#125;/$&#123;SCHEME_NAME&#125;.xcframework&quot;  # ç”Ÿæˆå¤šå¹³å°å…¼å®¹åŒ… [[2, 6, 12, 16]]</span><br><span class="line"></span><br><span class="line"># 6. å¯é€‰ï¼šç”ŸæˆFat Framework (ä¼ ç»Ÿåˆå¹¶æ–¹å¼)</span><br><span class="line"># lipo -create \</span><br><span class="line">#   &quot;$&#123;OUTPUT_DIR&#125;/iphoneos.xcarchive/Products/Library/Frameworks/$&#123;SCHEME_NAME&#125;.framework/$&#123;SCHEME_NAME&#125;&quot; \</span><br><span class="line">#   &quot;$&#123;OUTPUT_DIR&#125;/iphonesimulator.xcarchive/Products/Library/Frameworks/$&#123;SCHEME_NAME&#125;.framework/$&#123;SCHEME_NAME&#125;&quot; \</span><br><span class="line">#   -output &quot;$&#123;OUTPUT_DIR&#125;/$&#123;SCHEME_NAME&#125;.framework/$&#123;SCHEME_NAME&#125;&quot;  # éœ€æ‰‹åŠ¨å¤„ç†å¤´æ–‡ä»¶ [[11, 15, 20]]</span><br><span class="line"></span><br><span class="line"># 7. æ‰“å¼€è¾“å‡ºç›®å½•</span><br><span class="line">open &quot;$&#123;OUTPUT_DIR&#125;&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-909a8b6bfe8a86bd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="build_framework.sh å­˜æ”¾"></p>
<p><strong>è¿è¡Œè„šæœ¬</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod +x build_framework.sh</span><br><span class="line">./build_framework.sh</span><br></pre></td></tr></table></figure>

<p><strong>ç”Ÿæˆæ–‡ä»¶å¤¹ï¼š</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-b9c853f304e38d24.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="XCFramework"></p>
<h2 id="æ³¨å†ŒCocoaPodsçš„Trunk"><a href="#æ³¨å†ŒCocoaPodsçš„Trunk" class="headerlink" title="æ³¨å†ŒCocoaPodsçš„Trunk"></a>æ³¨å†ŒCocoaPodsçš„Trunk</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ³¨å†ŒCocoaPodsè´¦å·ï¼ˆä»…é¦–æ¬¡ï¼‰</span><br><span class="line">pod trunk register your-email@example.com &quot;Your Name&quot; --description=&#x27;MacBook Pro&#x27;</span><br></pre></td></tr></table></figure>

<p><code>CocoaPodsä¼šå‘ä½ æä¾›çš„é‚®ç®±å‘é€ä¸€ä¸ªéªŒè¯é“¾æ¥ï¼Œç‚¹å‡»é“¾æ¥å®ŒæˆéªŒè¯ã€‚ </code></p>
<p><strong>éªŒè¯CocoaPodsçš„Trunkæ³¨å†Œç»“æœ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pod trunk me</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-5235e92f3f02d89f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Trunkåˆ›å»ºéªŒè¯"></p>
<h2 id="åˆ›å»ºPodspecæ–‡ä»¶"><a href="#åˆ›å»ºPodspecæ–‡ä»¶" class="headerlink" title="åˆ›å»ºPodspecæ–‡ä»¶"></a>åˆ›å»ºPodspecæ–‡ä»¶</h2><blockquote>
<p> <strong>pod lib create LanguageSet</strong></p>
</blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-e39b370605e72821.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åˆ›å»ºPodspecæ–‡ä»¶"></p>
<p><strong>ç”ŸæˆPodspecæ–‡ä»¶å¤¹</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-086200ce38c70fe4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ç”ŸæˆPodspecæ–‡ä»¶å¤¹"></p>
<blockquote>
<p> <strong>Example:</strong> æ”¾demoåº”ç”¨</p>
<p> <strong>LanguageSet:</strong> &#x2F;Classesä¸»ä»£ç  &#x2F;Assetså›¾ç‰‡èµ„æºæ–‡ä»¶</p>
</blockquote>
<p><strong>å°†ä¹‹å‰ç”Ÿæˆçš„XCFrameworkæ‹–å…¥æ–°å»ºPodspecæ–‡ä»¶å¤¹ä¸­çš„LanguageSetä¸­</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-60eec0705967d61c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="XCFrameworkæ‹–å…¥å"></p>
<h2 id="åˆ›å»ºGitä»“åº“"><a href="#åˆ›å»ºGitä»“åº“" class="headerlink" title="åˆ›å»ºGitä»“åº“"></a>åˆ›å»ºGitä»“åº“</h2><p><img src="https://upload-images.jianshu.io/upload_images/1976231-efca2c60c3794fd4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åˆ›å»ºGitä»“åº“"></p>
<p><strong>ä¿®æ”¹LanguageSet.podspecé…ç½®</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Pod::Spec.new do |s|</span><br><span class="line">  s.name             = &#x27;LanguageSet&#x27;</span><br><span class="line">  s.version          = &#x27;0.0.1&#x27;</span><br><span class="line">  s.summary          = &#x27;multilingual processing.&#x27;</span><br><span class="line"></span><br><span class="line">  s.description      = &lt;&lt;-DESC</span><br><span class="line">  A few simple lines of code can handle multiple languages</span><br><span class="line">  DESC</span><br><span class="line"></span><br><span class="line">  s.homepage         = &#x27;https://github.com/GavinCarter1991/LanguageSet&#x27;</span><br><span class="line">  s.license          = &#123; :type =&gt; &#x27;MIT&#x27;, :file =&gt; &#x27;LICENSE&#x27; &#125;</span><br><span class="line">  s.author           = &#123; &#x27;gavin&#x27; =&gt; &#x27;kindyourself@163.com&#x27; &#125;</span><br><span class="line">  s.source           = &#123; :git =&gt; &#x27;https://github.com/GavinCarter1991/LanguageSet.git&#x27;, :tag =&gt; s.version.to_s &#125;</span><br><span class="line"></span><br><span class="line">  s.ios.deployment_target = &#x27;12.0&#x27;</span><br><span class="line">  s.vendored_frameworks = &#x27;LanguageSet/Classes/LanguageSet.xcframework&#x27;</span><br><span class="line">  # æ·»åŠ æ¨¡å—æ˜ å°„</span><br><span class="line">  s.preserve_paths = &#x27;LanguageSet/Classes/LanguageSet.xcframework&#x27;</span><br><span class="line">  </span><br><span class="line">  # æ·»åŠ èµ„æºå¤„ç†æ’é™¤è§„åˆ™</span><br><span class="line">  s.pod_target_xcconfig = &#123;</span><br><span class="line">    &#x27;EXCLUDED_FILE_GROUP_PATTERNS&#x27; =&gt; [</span><br><span class="line">      &#x27;**/LanguageSet.xcframework/**/_CodeSignature/**&#x27;,</span><br><span class="line">      &#x27;**/LanguageSet.xcframework/**/Modules/**&#x27;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  # ç¦ç”¨æ¨¡å—éªŒè¯ï¼ˆé’ˆå¯¹ xcframeworkï¼‰</span><br><span class="line">  s.user_target_xcconfig = &#123; &#x27;VALIDATE_WORKSPACE&#x27; =&gt; &#x27;NO&#x27; &#125;</span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p><strong>è®¾ç½®Gitä»“åº“</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># åˆ›å»ºæœ¬åœ°ä»“åº“</span><br><span class="line">cd LanguageSet è¿›å…¥æ–‡ä»¶å¤¹</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;first commit&quot;</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºè¿œç¨‹ä»“åº“ï¼ˆåœ¨Gitee/GitHubä¸Šåˆ›å»ºï¼‰</span><br><span class="line">git remote add origin https://github.com/GavinCarter1991/LanguageSet.git // å…³è”ä»“åº“</span><br><span class="line">git push -u origin main</span><br><span class="line"></span><br><span class="line"># æ·»åŠ ç‰ˆæœ¬æ ‡ç­¾</span><br><span class="line">git tag 0.0.1</span><br><span class="line">git push --tags</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-abf0ebb55afd72eb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="tags"></p>
<h2 id="å‘å¸ƒåˆ°CocoaPods"><a href="#å‘å¸ƒåˆ°CocoaPods" class="headerlink" title="å‘å¸ƒåˆ°CocoaPods"></a>å‘å¸ƒåˆ°CocoaPods</h2><p><strong>1. é¦–æ¬¡å‘å¸ƒ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># éªŒè¯podspec</span><br><span class="line">pod lib lint --allow-warnings</span><br><span class="line"></span><br><span class="line"># å‘å¸ƒåˆ°CocoaPods</span><br><span class="line">pod trunk push CocoaPodsDemo.podspec --allow-warnings</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-6524cd38c321ead0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å‘å¸ƒåˆ°CocoaPods"></p>
<p><strong>2. æ›´æ–°ç‰ˆæœ¬</strong></p>
<blockquote>
<p>æ›´æ–°podspecä¸­çš„ç‰ˆæœ¬å·</p>
</blockquote>
<blockquote>
<p>æ¨é€æ–°ä»£ç åˆ°ä½ çš„åº“çš„ Git ä»“åº“ï¼Œåˆ›å»ºæ–°çš„Gitæ ‡ç­¾(tag)</p>
</blockquote>
<blockquote>
<p>é‡å¤æ¨é€å’Œå‘å¸ƒçš„æ­¥éª¤</p>
</blockquote>
<p><a href="https://github.com/GavinCarter1991/LanguageSet">Demo</a></p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>â€œiOSâ€</tag>
        <tag>â€œcocoapodsâ€</tag>
        <tag>Github</tag>
        <tag>å‘å¸ƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>iOS-è‡ªå®šä¹‰å¸¦æŠ½å±‰æ•ˆæœçš„tabBar</title>
    <url>/2016/07/15/iOS-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B8%A6%E6%8A%BD%E5%B1%89%E6%95%88%E6%9E%9C%E7%9A%84tabBar/</url>
    <content><![CDATA[<p>demoåœ°å€ï¼š<a href="https://github.com/GavinCarter1991/-tarBar">gitHub</a></p>
<h3 id="ä¸€ã€å…ˆæ¥ä¸ªæ•ˆæœ"><a href="#ä¸€ã€å…ˆæ¥ä¸ªæ•ˆæœ" class="headerlink" title="ä¸€ã€å…ˆæ¥ä¸ªæ•ˆæœ"></a>ä¸€ã€å…ˆæ¥ä¸ªæ•ˆæœ</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/05244727e176525fc66016280b6309d6.webp?x-image-process=image/format,png" alt="tabBar.gif"></p>
<h3 id="äºŒã€ä»£ç ç¤ºä¾‹"><a href="#äºŒã€ä»£ç ç¤ºä¾‹" class="headerlink" title="äºŒã€ä»£ç ç¤ºä¾‹"></a>äºŒã€ä»£ç ç¤ºä¾‹</h3><p><strong>1.æŠ½å±‰é¡µä½œä¸ºæ ¹è§†å›¾ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@interface DrawerViewController ()</span><br><span class="line">&#123;</span><br><span class="line">    UITapGestureRecognizer *tapGesture;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//åˆ›å»ºå·¦è¾¹çš„æŠ½å±‰</span><br><span class="line">@property (nonatomic, strong) LeftViewController *leftViewController;</span><br><span class="line"></span><br><span class="line">//åˆ›å»ºå³è¾¹çš„æ ‡ç­¾æ§åˆ¶å™¨</span><br><span class="line">@property (nonatomic, strong) MTabBarViewController *mainViewController;</span><br><span class="line">//æŠ½å±‰æ˜¯å¦æ˜¾ç¤ºçš„æ ‡ç¤º</span><br><span class="line"></span><br><span class="line">@property (nonatomic, assign) BOOL isOpen;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation DrawerViewController</span><br><span class="line"></span><br><span class="line">- (void)dealloc</span><br><span class="line">&#123;</span><br><span class="line">    //ç§»é™¤é€šçŸ¥</span><br><span class="line">    [[NSNotificationCenter defaultCenter]removeObserver:self name:@&quot;buttonTap&quot; object:nil];</span><br><span class="line">&#125;</span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    [self createTabBarController];</span><br><span class="line">    [self createLeftVc];</span><br><span class="line">    </span><br><span class="line">    self.view.backgroundColor = [UIColor grayColor];</span><br><span class="line">    </span><br><span class="line">    //æ·»åŠ é€šçŸ¥ï¼Œç›‘å¬TabBarçš„ç‚¹å‡»äº‹ä»¶ éšè—å·¦è¾¹æŠ½å±‰</span><br><span class="line">    [[NSNotificationCenter defaultCenter]addObserver:self selector:@selector(buttonTap) name:@&quot;buttonTap&quot; object:nil];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">- (void)buttonTap</span><br><span class="line">&#123;</span><br><span class="line">    //æŠ½å±‰å±•å¼€æ—¶åˆ™éšè—</span><br><span class="line">    if (self.isOpen == YES) &#123;</span><br><span class="line">        [self openOrHidden];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//åˆ›å»ºå·¦è¾¹æŠ½å±‰</span><br><span class="line">- (void)createLeftVc</span><br><span class="line">&#123;</span><br><span class="line">    self.leftViewController = [[LeftViewController alloc]init];</span><br><span class="line">    </span><br><span class="line">    //æŠ½å±‰æ§åˆ¶å™¨æ·»åŠ åˆ°çˆ¶æ§åˆ¶å™¨ä¸­</span><br><span class="line">    [self addChildViewController:self.leftViewController];</span><br><span class="line">    self.leftViewController.view.frame = LeftViewStartFrame();</span><br><span class="line">    [self.view addSubview:self.leftViewController.view];</span><br><span class="line">    [self.leftViewController didMoveToParentViewController:self];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//åˆ›å»ºå³è¾¹çš„æ ‡ç­¾æ§åˆ¶å™¨</span><br><span class="line">- (void)createTabBarController&#123;</span><br><span class="line">    //</span><br><span class="line">    NSArray *classNames = @[@&quot;ProductViewController&quot;,@&quot;MessageViewController&quot;,@&quot;OrderViewController&quot;];</span><br><span class="line">    </span><br><span class="line">    //ä¿å­˜viewControllers</span><br><span class="line">    NSMutableArray *viewControllers = [NSMutableArray array];</span><br><span class="line">    [classNames enumerateObjectsUsingBlock:^(NSString *  _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) &#123;</span><br><span class="line">        //å…ˆæŠŠå­—ç¬¦ä¸²è½¬åŒ–ä¸ºç±»å</span><br><span class="line">        Class class = NSClassFromString(obj);</span><br><span class="line">        </span><br><span class="line">        //åˆ›å»ºViewController</span><br><span class="line">        UIViewController *vc = [[class alloc]init];</span><br><span class="line">        UINavigationController *aNav = [[UINavigationController alloc]initWithRootViewController:vc];</span><br><span class="line">        </span><br><span class="line">        [viewControllers addObject:aNav];</span><br><span class="line">        </span><br><span class="line">    &#125;];</span><br><span class="line">    //TabBarController åˆ›å»º</span><br><span class="line">    _mainViewController = [[MTabBarViewController alloc]initWithViewControllers:viewControllers];</span><br><span class="line">    _mainViewController.view.backgroundColor = [UIColor brownColor];</span><br><span class="line">    </span><br><span class="line">    //æ·»åŠ æ ‡ç­¾æ§åˆ¶å™¨åˆ°çˆ¶æ§åˆ¶å™¨</span><br><span class="line">    [self addChildViewController:self.mainViewController];</span><br><span class="line">    self.mainViewController.view.frame = BOUNDS;</span><br><span class="line">    [self.view addSubview:self.mainViewController.view];</span><br><span class="line">    [self.mainViewController didMoveToParentViewController:self];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//æ ‡ç­¾æ§åˆ¶å™¨æ˜¾ç¤ºçš„vcçš„æ ¹æ§åˆ¶å™¨çš„viewå¾€å³è¾¹ç§»åŠ¨</span><br><span class="line">//tabBar -&gt; Nav (ViewControllers[selectedIndex]) -&gt; Nav.rootViewController.view</span><br><span class="line">- (void)tabBar_Nav_RootViewController_viewMoveRight</span><br><span class="line">&#123;</span><br><span class="line">    //æ ‡ç­¾æ§åˆ¶å™¨å½“ä¸­ å½“å‰æ˜¾ç¤ºçš„æ§åˆ¶å™¨</span><br><span class="line">    UINavigationController *nav = self.mainViewController.viewControllers[self.mainViewController.selectedIndex];</span><br><span class="line">    //å–å‡ºå¯¼èˆªæ§åˆ¶å™¨çš„æ ¹æ§åˆ¶å™¨</span><br><span class="line">    UIViewController *rootVc = nav.childViewControllers[0];</span><br><span class="line">    rootVc.view.frame = RightContentEndFrame();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)tabBar_Nav_RootViewController_viewMoveLeft</span><br><span class="line">&#123;</span><br><span class="line">    //æ ‡ç­¾æ§åˆ¶å™¨å½“ä¸­ å½“å‰æ˜¾ç¤ºçš„æ§åˆ¶å™¨</span><br><span class="line">    UINavigationController *nav = self.mainViewController.viewControllers[self.mainViewController.selectedIndex];</span><br><span class="line">    //å–å‡ºå¯¼èˆªæ§åˆ¶å™¨çš„æ ¹æ§åˆ¶å™¨</span><br><span class="line">    UIViewController *rootVc = nav.childViewControllers[0];</span><br><span class="line">    rootVc.view.frame = RigntContentStartFrame();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//æ˜¾ç¤ºå·¦è¾¹æŠ½å±‰</span><br><span class="line">- (void)open</span><br><span class="line">&#123;</span><br><span class="line">    [UIView animateWithDuration:0.48 animations:^&#123;</span><br><span class="line">        self.leftViewController.view.frame = LeftViewEndFrame();</span><br><span class="line">        [self tabBar_Nav_RootViewController_viewMoveRight];</span><br><span class="line">    &#125; completion:nil];</span><br><span class="line">    </span><br><span class="line">    //æ·»åŠ ç‚¹å‡»æ‰‹åŠ¿ï¼Œç‚¹å‡»æŸäº›åŒºåŸŸçš„éšè—æŠ½å±‰</span><br><span class="line">    tapGesture = [[UITapGestureRecognizer alloc]initWithTarget:self action:@selector(tap:)];</span><br><span class="line">    tapGesture.numberOfTapsRequired = 1;</span><br><span class="line">    tapGesture.numberOfTouchesRequired = 1;</span><br><span class="line">    [self.view addGestureRecognizer:tapGesture];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)tap:(UITapGestureRecognizer *)gesturer</span><br><span class="line">&#123;</span><br><span class="line">    //è·å–ç‚¹å‡»çš„ä½ç½®</span><br><span class="line">    CGPoint point = [gesturer locationInView:self.view];</span><br><span class="line">    if (CGRectContainsPoint(self.leftViewController.view.frame, point) == YES) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    [self hidden];</span><br><span class="line">    self.isOpen = NO;</span><br><span class="line">    //ç§»é™¤æ‰‹åŠ¿</span><br><span class="line">    [self.view removeGestureRecognizer:tapGesture];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//éšè—å·¦è¾¹æŠ½å±‰</span><br><span class="line">- (void)hidden</span><br><span class="line">&#123;</span><br><span class="line">    [UIView animateWithDuration:0.48 animations:^&#123;</span><br><span class="line">        self.leftViewController.view.frame = LeftViewStartFrame();</span><br><span class="line">        [self tabBar_Nav_RootViewController_viewMoveLeft];</span><br><span class="line">    &#125; completion:nil];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)openOrHidden</span><br><span class="line">&#123;</span><br><span class="line">    //å½“å‰å¦‚æœæ˜¯éšè—ï¼Œåˆ™æ˜¾ç¤º</span><br><span class="line">    if (self.isOpen == NO) &#123;</span><br><span class="line">        [self open];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //å½“å‰å¦‚æœæ˜¯æ˜¾ç¤ºçš„ï¼Œåˆ™éšè—</span><br><span class="line">    if (self.isOpen == YES) &#123;</span><br><span class="line">        [self hidden];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //æ”¹å˜éšè—æ ‡è®°</span><br><span class="line">    self.isOpen = !self.isOpen;</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>2.æ ‡ç­¾è§†å›¾ ä¿®æ”¹æ–¹æ³• <code>- (void)selectBtn:(UIButton *)sender</code>ä¸­çš„åˆ‡æ¢æ•ˆæœå¯ä»¥å®ç°ä¸åŒçš„åˆ‡æ¢åŠ¨ç”»ä¸æ•ˆæœã€‚</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@implementation MTabBar</span><br><span class="line">- (instancetype)initWithTitles:(NSArray *)titles imageNames:(NSArray *)imageNames</span><br><span class="line">&#123;</span><br><span class="line">    self = [super initWithFrame:TabBarFrame()];</span><br><span class="line">    if (self) &#123;</span><br><span class="line">        </span><br><span class="line">        //æ ‡é¢˜æ•°ç»„ä¸ä¸ºç©ºï¼Œå›¾ç‰‡åå­—ä¸ªæ•° ï¼ æ ‡é¢˜ä¸ªæ•°</span><br><span class="line">        self.buttonBack = [[UIView alloc]initWithFrame:CGRM(0, 0, BUTTON_W, 64)];</span><br><span class="line">        self.buttonBack.backgroundColor = BUTTON_BACK_COLOR;</span><br><span class="line">        [self addSubview:self.buttonBack];</span><br><span class="line">        </span><br><span class="line">        self.backgroundColor = TABBAR_BACK_COLOR;</span><br><span class="line">        </span><br><span class="line">        if ([titles count] &amp;&amp; [titles count] == [imageNames count]) &#123;</span><br><span class="line">            [titles enumerateObjectsUsingBlock:^(NSString *  _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) &#123;</span><br><span class="line">                UIButton *button = [[UIButton alloc]initWithFrame:CGRM(BUTTON_W*idx, 0, BUTTON_W, 64)];</span><br><span class="line">                button.tag = 1000 + idx;</span><br><span class="line">                [self addSubview:button];</span><br><span class="line">                //é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ª</span><br><span class="line">                if (idx == 0) &#123;</span><br><span class="line">                    button.selected = YES;</span><br><span class="line">                    self.selectedButton = button;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                [button addSubview:MakeLabel(CGRM(0, 30, BUTTON_W, 34), obj)];</span><br><span class="line">//                // å›¾ç‰‡å®½ é«˜åˆ†åˆ«ä¸º 44 24</span><br><span class="line">                CGFloat x = (BUTTON_W - 44)/2;</span><br><span class="line">                [button addSubview:MakeImageView(CGRM(x, 5, 44, 24),[imageNames objectAtIndex:idx])];</span><br><span class="line">                //æ·»åŠ ç‚¹å‡»æ–¹æ³•</span><br><span class="line">                [button addTarget:self action:@selector(selectBtn:) forControlEvents:UIControlEventTouchUpInside];</span><br><span class="line">            &#125;];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//button ç‚¹å‡»æ–¹æ³•</span><br><span class="line">- (void)selectBtn:(UIButton *)sender</span><br><span class="line">&#123;</span><br><span class="line">    //è®©æŠ½å±‰éšè—ï¼Œå‘å‡ºé€šçŸ¥</span><br><span class="line">    [[NSNotificationCenter defaultCenter]postNotificationName:@&quot;buttonTap&quot; object:nil];</span><br><span class="line">    </span><br><span class="line">    //é€‰ä¸­çš„button å·²ç»æ˜¯é€‰ä¸­çŠ¶æ€ ä¸ç”¨å¤„ç†</span><br><span class="line">    if (self.selectedButton == sender) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    //æ”¹å˜ä¹‹å‰é€‰ä¸­buttonçš„çŠ¶æ€  ä¸ºéé€‰ä¸­çŠ¶æ€</span><br><span class="line">    self.selectedButton.selected = NO;</span><br><span class="line">    </span><br><span class="line">    //æ”¹å˜å½“å‰é€‰ä¸­buttonçš„çŠ¶æ€</span><br><span class="line">    sender.selected = YES;</span><br><span class="line">    self.selectedButton = sender;</span><br><span class="line">    //é€šçŸ¥æ ‡ç­¾æ§åˆ¶å™¨æ˜¾ç¤ºå½“å‰buttonå¯¹åº”çš„viewController</span><br><span class="line">    if (self.callBack) &#123;</span><br><span class="line">        self.callBack(sender.tag - 1000);</span><br><span class="line">    &#125;</span><br><span class="line">    [UIView animateWithDuration:0.5 animations:^&#123;</span><br><span class="line">        self.buttonBack.center = CGPointMake(BUTTON_W/2+(sender.tag - 1000) * BUTTON_W, 32);</span><br><span class="line">    &#125; completion:nil];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">UILabel *MakeLabel(CGRect frame, NSString *title)</span><br><span class="line">&#123;</span><br><span class="line">    UILabel *label = [[UILabel alloc]initWithFrame:frame];</span><br><span class="line">//    label.userInteractionEnabled = YES;</span><br><span class="line">    label.backgroundColor = [UIColor clearColor];</span><br><span class="line">    label.textColor = [UIColor whiteColor];</span><br><span class="line">    label.textAlignment = NSTextAlignmentCenter;</span><br><span class="line">    label.text = title;</span><br><span class="line">    return label;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//æ ¹æ® frameå’Œ imageName åˆ›å»ºUIImageView</span><br><span class="line">UIImageView *MakeImageView(CGRect frame, NSString *imageName)</span><br><span class="line">&#123;</span><br><span class="line">    UIImageView *imageV = [[UIImageView alloc]initWithFrame:frame];</span><br><span class="line">//    imageV.userInteractionEnabled = YES;</span><br><span class="line">    imageV.backgroundColor = [UIColor clearColor];</span><br><span class="line">    imageV.image = [UIImage imageNamed:imageName];</span><br><span class="line">    return imageV;</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

<p><strong>3.æ ‡ç­¾æ§åˆ¶å™¨</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@interface MTabBarViewController ()</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation MTabBarViewController</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithViewControllers:(NSArray *)viewControllers</span><br><span class="line">&#123;</span><br><span class="line">    self = [super init];</span><br><span class="line">    if (self) &#123;</span><br><span class="line">        </span><br><span class="line">        _viewControllers = viewControllers;</span><br><span class="line">        //éå†æ•°ç»„ï¼Œæ·»åŠ å­æ§åˆ¶å™¨</span><br><span class="line">        [_viewControllers enumerateObjectsUsingBlock:^(UIViewController *  _Nonnull obj, NSUInteger idx, BOOL * _Nonnull stop) &#123;</span><br><span class="line">            [self addChild:obj];</span><br><span class="line">        &#125;];</span><br><span class="line">        /*</span><br><span class="line">         @[@&quot;å•†å“.png&quot;,@&quot;æ¶ˆæ¯.png&quot;,@&quot;è®¢å•.png&quot;]</span><br><span class="line">         @[@&quot;å•†å“æµè§ˆ&quot;,@&quot;æˆ‘çš„æ¶ˆæ¯&quot;,@&quot;æˆ‘çš„è®¢å•&quot;]</span><br><span class="line">         */</span><br><span class="line">        _tabBar = [[MTabBar alloc]initWithTitles:@[@&quot;å•†å“æµè§ˆ&quot;,@&quot;æˆ‘çš„æ¶ˆæ¯&quot;,@&quot;æˆ‘çš„è®¢å•&quot;] imageNames:@[@&quot;å•†å“.png&quot;,@&quot;æ¶ˆæ¯.png&quot;,@&quot;è®¢å•.png&quot;]];</span><br><span class="line">        [self.view addSubview:self.tabBar];</span><br><span class="line">        __weak typeof(self) weakSelf = self;</span><br><span class="line">        self.tabBar.callBack = ^(NSInteger index)&#123;</span><br><span class="line">            weakSelf.selectedIndex = index;</span><br><span class="line">        &#125;;</span><br><span class="line">        //é»˜è®¤é€‰ä¸­ç¬¬0ä¸ª</span><br><span class="line">        self.selectedIndex = 0;</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)setSelectedIndex:(NSInteger)selectedIndex</span><br><span class="line">&#123;</span><br><span class="line">    //å–å‡ºå½“å‰æ§åˆ¶å™¨ oldVc</span><br><span class="line">    UIViewController *oldVc = self.viewControllers[self.selectedIndex];</span><br><span class="line">    //å–å‡ºå°†è¦æ˜¾ç¤ºçš„ æ§åˆ¶å™¨ newVc</span><br><span class="line">    UIViewController *newVc = self.viewControllers[selectedIndex];</span><br><span class="line">    //åŠ¨ç”» å‘å·¦è¾¹ç§»åŠ¨</span><br><span class="line">    newVc.view.frame = CGRectMake(S_W, 0, S_W, S_H);</span><br><span class="line">    //æ”¹å˜ newVc çš„è§†å›¾å±‚æ¬¡</span><br><span class="line">    </span><br><span class="line">    //æŠŠnewVc.view çš„è§†å›¾æ”¾åœ¨ self.tabBar çš„ä¸‹é¢</span><br><span class="line">    [self.view insertSubview:newVc.view belowSubview:self.tabBar];</span><br><span class="line">    [UIView animateWithDuration:0.5 animations:^&#123;</span><br><span class="line">        oldVc.view.frame = CGRectMake(-S_W, 0, S_W, S_H);</span><br><span class="line">        newVc.view.frame = BOUNDS;</span><br><span class="line">    &#125;];</span><br><span class="line">    _selectedIndex = selectedIndex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//æ·»åŠ å­æ§åˆ¶å™¨å…·ä½“æ­¥éª¤</span><br><span class="line">- (void)addChild:(UIViewController *)viewController</span><br><span class="line">&#123;</span><br><span class="line">    [self addChildViewController:viewController];</span><br><span class="line">    viewController.view.frame = BOUNDS;</span><br><span class="line">    //å°†viewContoller.view æ”¾åœ¨æœ€åº•å±‚</span><br><span class="line">    [self.view insertSubview:viewController.view atIndex:0];</span><br><span class="line">    [viewController didMoveToParentViewController:self];</span><br><span class="line">    </span><br><span class="line">//    self.view.subviews æ•°ç»„ ä¸‹æ ‡è¶Šå°ï¼Œè§†å›¾å±‚æ¬¡è¶Šåœ¨ä¸‹é¢ï¼Œä¸‹æ ‡è¶Šå¤§ï¼Œè§†å›¾å±‚æ¬¡è¶Šåœ¨ä¸Šé¢</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>

<p><strong>4.è§†å›¾ä½ç½®æ§åˆ¶ ä¿®æ”¹å¯¹åº”çš„è§†å›¾çš„frameå¯ä»¥å®ç°ä¸åŒçš„è§†å›¾æ•ˆæœ</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CGRect TabBarFrame()</span><br><span class="line">&#123;</span><br><span class="line">    return CGRectMake(0, S_H-64, S_W, 64);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//å·¦è¾¹æŠ½å±‰éšè—ï¼ˆå¼€å§‹ï¼‰çš„ä½ç½®</span><br><span class="line">CGRect LeftViewStartFrame()</span><br><span class="line">&#123;</span><br><span class="line">    return CGRectMake(-S_W*0.75, 67,S_W*0.75 , S_H-64-64-6);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//å·¦è¾¹æŠ½å±‰æ˜¾ç¤ºï¼ˆç»“æŸï¼‰çš„ä½ç½®</span><br><span class="line">CGRect LeftViewEndFrame()</span><br><span class="line">&#123;</span><br><span class="line">    return CGRectMake(0, 67, S_W*0.75, S_H-64-64-6);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//å³è¾¹å†…å®¹å¼€å§‹ï¼ˆæŠ½å±‰éšè—æ—¶ï¼‰çš„ä½ç½®</span><br><span class="line">CGRect RigntContentStartFrame()</span><br><span class="line">&#123;</span><br><span class="line">    return CGRectMake(0, 0, S_W, S_H);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//å³è¾¹å†…å®¹ç»“æŸï¼ˆæŠ½å±‰æ˜¾ç¤ºæ—¶ï¼‰çš„ä½ç½®</span><br><span class="line">CGRect RightContentEndFrame()</span><br><span class="line">&#123;</span><br><span class="line">    return CGRectMake(S_W*0.75, 0, S_W, S_H);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CGRect CGRM(CGFloat x, CGFloat y,CGFloat w,CGFloat h)</span><br><span class="line">&#123;</span><br><span class="line">    return CGRectMake(x, y, w, h);</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<blockquote>
<p>æ¬¢è¿ä¸‹è½½</p>
</blockquote>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>â€œiOSâ€</tag>
        <tag>â€œæŠ½å±‰â€</tag>
        <tag>â€œtabBarâ€</tag>
      </tags>
  </entry>
  <entry>
    <title>iOS-è§£å‹zip</title>
    <url>/2016/07/09/iOS-%E8%A7%A3%E5%8E%8Bzip/</url>
    <content><![CDATA[<blockquote>
<p>æœ€è¿‘çš„é¡¹ç›®ä¸­æ¶‰åŠåˆ°äº†å°†zipæ–‡ä»¶ä»æœåŠ¡ä¸Šä¸‹è½½ä¸‹æ¥ï¼Œç„¶åè§£å‹ä½¿ç”¨ã€‚æœç´¢äº†ä¸€ä¸‹å‘ç°æœ‰ä¸€ä¸ªå‹ç¼©ä¸è§£å‹zipæ–‡ä»¶çš„ç¬¬ä¸‰æ–¹â€œSSZipArchiveâ€ï¼š<a href="https://github.com/ZipArchive/ZipArchive">https://github.com/ZipArchive/ZipArchive</a> æ˜¯ç”¨Cè¯­è¨€å®ç°çš„ï¼ŒåŒ…è£…ç”¨äºOCä¸swift.</p>
</blockquote>
<h5 id="ä¸€ã€åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°è¿‡å‡ ä¸ªå‘ï¼š"><a href="#ä¸€ã€åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°è¿‡å‡ ä¸ªå‘ï¼š" class="headerlink" title="ä¸€ã€åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°è¿‡å‡ ä¸ªå‘ï¼š"></a>ä¸€ã€åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°è¿‡å‡ ä¸ªå‘ï¼š</h5><ol>
<li><p>å¯¼å…¥å¤´æ–‡ä»¶å†²çªï¼Œæˆ‘åœ¨pchæ–‡ä»¶é‡Œé¢å¯¼å…¥äº†ä¸€äº›OCçš„å¤´æ–‡ä»¶ï¼Œè€ŒSSZipArchiveæ˜¯ç”±Cè¯­è¨€å®ç°çš„ï¼Œæ‰€ä»¥æŠ¥äº†å¾ˆå¤šçš„ç³»ç»Ÿé”™è¯¯ã€‚è§£å†³åŠæ³•ï¼šå°†pché‡Œé¢çš„å¯¼å…¥å¤´æ–‡ä»¶ä»£ç æ”¾åœ¨<br>â€œ#ifdef <strong>OBJC</strong><br>&#x2F;&#x2F;å¯¼å…¥å¤´æ–‡ä»¶<br>â€œ#endif é‡Œé¢â€<br>  æˆ–è€…åˆ é™¤é‡Œé¢å¯¼å…¥å¤´æ–‡ä»¶çš„ä»£ç ï¼Œå»å…·ä½“éœ€è¦çš„æ–‡ä»¶é‡Œé¢å¯¼å…¥ï¼Œæœ‰ä¸€ç‚¹æš´åŠ›å“ˆã€‚</p>
</li>
<li><p>æˆ‘æ¯ä¸€æ¬¡ä¸‹è½½çš„æ–‡ä»¶æ ·å¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å¸Œæœ›è¦†ç›–å¼çš„è§£å‹ï¼Œä¸€å¼€å§‹æ²¡æœ‰æ³¨æ„ä»¥ä¸ºå®ƒåªæœ‰è§£å‹æ–¹æ³•ï¼š+ (BOOL)unzipFileAtPath:(NSString *)path toDestination:(NSString *)destination;<br>å°±è‡ªå·±å»åˆ¤å®šæ˜¯å¦å­˜åœ¨ç„¶ååˆ é™¤ï¼Œåæ¥å»ä»”ç»†çš„çœ‹æºç æ‰å‘ç°å®ƒæ˜¯æœ‰å¸¦æ˜¯å¦è¦†ç›–å¼è§£å‹çš„æ–¹æ³•ï¼š+ (BOOL)unzipFileAtPath:(NSString *)path toDestination:(NSString *)destination overwrite:(BOOL)overwrite password:(NSString *)password error:(NSError * *)error;<br>å½“ç„¶å®ƒè¿˜æœ‰å¾ˆå¤šæ–¹æ³•ï¼ŒåŒ…æ‹¬å¸¦æœ‰ä»£ç†æ–¹æ³•ï¼Œå¸¦æœ‰å¯†ç ï¼Œå¸¦æœ‰å®Œæˆåçš„blockå›è°ƒæ–¹æ³•ï¼Œ<br><a href="http://blog.csdn.net/zhengang007/article/details/51019479">http://blog.csdn.net/zhengang007/article/details/51019479</a><br>è¿™é‡Œæœ‰æ¯ä¸€ä¸ªæ–¹æ³•çš„è¯¦ç»†è¯´æ˜ã€‚</p>
</li>
</ol>
<h5 id="äºŒã€æˆ‘çš„å®ç°ï¼š"><a href="#äºŒã€æˆ‘çš„å®ç°ï¼š" class="headerlink" title="äºŒã€æˆ‘çš„å®ç°ï¼š"></a>äºŒã€æˆ‘çš„å®ç°ï¼š</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- (void)downFileFromServer&#123;</span><br><span class="line">//è¿œç¨‹åœ°å€</span><br><span class="line">NSURL *URL = [NSURL URLWithString:DOWN_URL];</span><br><span class="line">//é»˜è®¤é…ç½®</span><br><span class="line">NSURLSessionConfiguration *configuration = [NSURLSessionConfiguration defaultSessionConfiguration];</span><br><span class="line">//AFN3.0+åŸºäºå°ä½URLSessionçš„å¥æŸ„</span><br><span class="line">AFURLSessionManager *manager = [[AFURLSessionManager alloc] initWithSessionConfiguration:configuration];</span><br><span class="line"></span><br><span class="line">//è¯·æ±‚</span><br><span class="line">NSURLRequest *request = [NSURLRequest requestWithURL:URL];</span><br><span class="line"></span><br><span class="line">//ä¸‹è½½Taskæ“ä½œ</span><br><span class="line">_downloadTask = [manager downloadTaskWithRequest:request progress:^(NSProgress * _Nonnull downloadProgress) &#123;</span><br><span class="line">// ä¸‹è½½è¿›åº¦</span><br><span class="line"></span><br><span class="line">&#125; destination:^NSURL * _Nonnull(NSURL * _Nonnull targetPath, NSURLResponse * _Nonnull response) &#123;</span><br><span class="line"></span><br><span class="line">//- blockçš„è¿”å›å€¼, è¦æ±‚è¿”å›ä¸€ä¸ªURL, è¿”å›çš„è¿™ä¸ªURLå°±æ˜¯æ–‡ä»¶çš„ä½ç½®çš„è·¯å¾„</span><br><span class="line">NSString *cachesPath = [NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES) lastObject];</span><br><span class="line"></span><br><span class="line">NSString *path = [cachesPath stringByAppendingPathComponent:response.suggestedFilename];</span><br><span class="line">return [NSURL fileURLWithPath:path];</span><br><span class="line">&#125; completionHandler:^(NSURLResponse * _Nonnull response, NSURL * _Nullable filePath, NSError * _Nullable error) &#123;</span><br><span class="line"></span><br><span class="line">//è®¾ç½®ä¸‹è½½å®Œæˆæ“ä½œ</span><br><span class="line">// filePathå°±æ˜¯ä½ ä¸‹è½½æ–‡ä»¶çš„ä½ç½®ï¼Œä½ å¯ä»¥è§£å‹ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ‹¿æ¥ä½¿ç”¨</span><br><span class="line">NSString *imgFilePath = [filePath path];// å°†NSURLè½¬æˆNSString</span><br><span class="line">MyLog(@&quot;imgFilePath = %@&quot;,imgFilePath);</span><br><span class="line">NSArray *documentArray =  NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES);</span><br><span class="line">NSString *path = [[documentArray lastObject] stringByAppendingPathComponent:@&quot;Preferences&quot;];</span><br><span class="line">[self releaseZipFilesWithUnzipFileAtPath:imgFilePath Destination:path];</span><br><span class="line">&#125;];</span><br><span class="line">[_downloadTask resume];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// è§£å‹</span><br><span class="line">- (void)releaseZipFilesWithUnzipFileAtPath:(NSString *)zipPath Destination:(NSString *)unzipPath&#123;</span><br><span class="line">NSError *error;</span><br><span class="line">if ([SSZipArchive unzipFileAtPath:zipPath toDestination:unzipPath overwrite:YES password:nil error:&amp;error delegate:self]) &#123;</span><br><span class="line">MyLog(@&quot;success&quot;);</span><br><span class="line">MyLog(@&quot;unzipPath = %@&quot;,unzipPath);</span><br><span class="line">&#125;else &#123;</span><br><span class="line">MyLog(@&quot;%@&quot;,error);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma mark - SSZipArchiveDelegate</span><br><span class="line">- (void)zipArchiveWillUnzipArchiveAtPath:(NSString *)path zipInfo:(unz_global_info)zipInfo &#123;</span><br><span class="line">MyLog(@&quot;å°†è¦è§£å‹ã€‚&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)zipArchiveDidUnzipArchiveAtPath:(NSString *)path zipInfo:(unz_global_info)zipInfo unzippedPath:(NSString *)unzippedPat uniqueId:(NSString *)uniqueId &#123;</span><br><span class="line">MyLog(@&quot;è§£å‹å®Œæˆï¼&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å½“ç„¶è¿˜å¾—éµå®ˆåè®®ï¼šSSZipArchiveDelegate<br>ä»¥ä¸Šå°±æ˜¯æˆ‘ä½¿ç”¨SSZipArchiveçš„ä½“ä¼šï¼Œæ¬¢è¿å„ä½æŒ‡æ­£ã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>â€œiOSâ€</tag>
        <tag>â€œè§£å‹zipâ€</tag>
      </tags>
  </entry>
  <entry>
    <title>iOS-é«˜å¾·åœ°å›¾</title>
    <url>/2016/07/09/iOS-%E9%AB%98%E5%BE%B7%E5%9C%B0%E5%9B%BE/</url>
    <content><![CDATA[<blockquote>
<p>ä¸€ç›´ä»¥æ¥åœ¨ç®€ä¹¦ä¸Šå­¦ä¹ äº†ä¸å°‘çš„çŸ¥è¯†ï¼Œè‡ªå·±ä¹Ÿæƒ³åˆ†äº«ä¸€äº›çŸ¥è¯†ä¾›å¤§å®¶æŒ‡ç‚¹ï¼Œæœ€è¿‘æ­£å¥½åœ¨ç ”ç©¶é«˜å¾·åœ°å›¾APIï¼Œæ‰€ä»¥åˆ†äº«ä¸€ä¸‹è‡ªå·±æœ€è¿‘æ£é¼“çš„ã€‚<br>è¦ä½¿ç”¨é«˜å¾·APIï¼Œé¦–å…ˆè¦å»é«˜å¾·APIå®˜ç½‘æ³¨å†Œå¼€å‘è€…è´¦å·ï¼Œåˆ›å»ºåº”ç”¨ï¼Œè·å¾—keyå€¼ã€‚ç„¶ååœ¨æœ¬åœ°åˆ›å»ºè‡ªå·±çš„é¡¹ç›®podé«˜å¾·SDKï¼Œåœ¨podæ—¶è¦æå‰æ€è€ƒæ¸…æ¥šæ˜¯å¦éœ€è¦å¯¼èˆªï¼Œæˆ‘åœ¨è¿™é‡Œå°±è¢«å‘è¿‡ï¼Œå› ä¸ºå¯¼èˆªçš„SDKåŒ…å«æœç´¢çš„SDKï¼Œå¦‚æœå°†æœç´¢SDKä¸å¯¼èˆªSDKéƒ½podäº†ä¼šæŠ¥é“¾æ¥é”™è¯¯ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦å¯¼èˆªå°±å¯ä»¥ä¸ç”¨podæœç´¢SDKäº†ã€‚æœ€åå°±æ˜¯æœ¬åœ°å¯¼å…¥ç›¸åº”å¤´æ–‡ä»¶ï¼Œç„¶åé…ç½®keyã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const static NSString *APIKey = @&quot;ä½ ç”³è¯·çš„key&quot;;</span><br><span class="line"></span><br><span class="line">// é…ç½®ç”¨æˆ·Key</span><br><span class="line"></span><br><span class="line">[MAMapServices sharedServices].apiKey = (NSString *)APIKey;</span><br><span class="line"></span><br><span class="line">// æœç´¢</span><br><span class="line"></span><br><span class="line">[AMapSearchServices sharedServices].apiKey = (NSString *)APIKey;</span><br><span class="line"></span><br><span class="line">// å¯¼èˆª</span><br><span class="line"></span><br><span class="line">[AMapNaviServices sharedServices].apiKey = (NSString *)APIKey;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>åé¢çš„å°±å¯ä»¥æŒ‰ç…§å®ƒçš„å¼€å‘æŒ‡å—å†™ï¼Œè¦æ³¨æ„çš„æ˜¯è·¯å¾„è§„åˆ’æ˜¯å»ºç«‹åœ¨è·¯å¾„æœç´¢ä¹‹ä¸Šçš„ï¼Œè¦è·¯å¾„è§„åˆ’å…ˆå¾—å®Œæˆè·¯å¾„æœç´¢ã€‚å¯¼èˆªçš„è¯­éŸ³åˆæˆï¼Œæˆ‘æ˜¯ç”¨çš„è®¯é£çš„åœ¨çº¿è¯­éŸ³åˆæˆï¼Œç¦»çº¿çš„å¥½åƒè¦æ”¶è´¹ï¼Œåœ¨ä¸‹ç©·çŒ¿ä¸€åã€‚é«˜å¾·å¯¼èˆªçš„demoå¥½åƒä¹Ÿæ˜¯ç”¨çš„è®¯é£çš„ã€‚å»è®¯é£APIå®˜ç½‘æ³¨å†Œè´¦å·ï¼Œåˆ›å»ºåº”ç”¨ï¼Œè·å–keyï¼Œç„¶åé…ç½®è¯­éŸ³ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//è®¾ç½®sdkçš„logç­‰çº§ï¼Œlogä¿å­˜åœ¨ä¸‹é¢è®¾ç½®çš„å·¥ä½œè·¯å¾„ä¸­</span><br><span class="line">[IFlySetting setLogFile:LVL_ALL];</span><br><span class="line"></span><br><span class="line">//æ‰“å¼€è¾“å‡ºåœ¨consoleçš„logå¼€å…³</span><br><span class="line">[IFlySetting showLogcat:YES];</span><br><span class="line"></span><br><span class="line">//è®¾ç½®sdkçš„å·¥ä½œè·¯å¾„</span><br><span class="line">NSArray *paths = NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES);</span><br><span class="line">NSString *cachePath = [paths objectAtIndex:0];</span><br><span class="line">[IFlySetting setLogFilePath:cachePath];</span><br><span class="line"></span><br><span class="line">// é…ç½®ç›¸å…³å‚æ•°</span><br><span class="line">- (void)configIFlySpeech</span><br><span class="line">&#123;</span><br><span class="line">[IFlySpeechUtility createUtility:[NSString stringWithFormat:@&quot;appid=%@,timeout=%@&quot;,@&quot;5733feca&quot;,@&quot;20000&quot;]];</span><br><span class="line"></span><br><span class="line">[IFlySetting setLogFile:LVL_NONE];</span><br><span class="line"></span><br><span class="line">[IFlySetting showLogcat:NO];</span><br><span class="line"></span><br><span class="line">// è®¾ç½®è¯­éŸ³åˆæˆçš„å‚æ•°</span><br><span class="line">[[IFlySpeechSynthesizer sharedInstance] setParameter:@&quot;50&quot; forKey:[IFlySpeechConstant SPEED]];//åˆæˆçš„è¯­é€Ÿ,å–å€¼èŒƒå›´ 0~100</span><br><span class="line"></span><br><span class="line">[[IFlySpeechSynthesizer sharedInstance] setParameter:@&quot;50&quot; forKey:[IFlySpeechConstant VOLUME]];//åˆæˆçš„éŸ³é‡;å–å€¼èŒƒå›´ 0~100</span><br><span class="line"></span><br><span class="line">// å‘éŸ³äºº,é»˜è®¤ä¸ºâ€xiaoyanâ€;å¯ä»¥è®¾ç½®çš„å‚æ•°åˆ—è¡¨å¯å‚è€ƒä¸ª æ€§åŒ–å‘éŸ³äººåˆ—è¡¨;</span><br><span class="line">[[IFlySpeechSynthesizer sharedInstance] setParameter:@&quot;xiaowang&quot; forKey:[IFlySpeechConstant VOICE_NAME]];</span><br><span class="line"></span><br><span class="line">// éŸ³é¢‘é‡‡æ ·ç‡,ç›®å‰æ”¯æŒçš„é‡‡æ ·ç‡æœ‰ 16000 å’Œ 8000;</span><br><span class="line">[[IFlySpeechSynthesizer sharedInstance] setParameter:@&quot;8000&quot; forKey:[IFlySpeechConstant SAMPLE_RATE]];</span><br><span class="line"></span><br><span class="line">// å½“ä½ å†ä¸éœ€è¦ä¿å­˜éŸ³é¢‘æ—¶ï¼Œè¯·åœ¨å¿…è¦çš„åœ°æ–¹åŠ ä¸Šè¿™è¡Œã€‚</span><br><span class="line">[[IFlySpeechSynthesizer sharedInstance] setParameter:nil forKey:[IFlySpeechConstant TTS_AUDIO_PATH]];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ç„¶ååˆå§‹åŒ–å’Œè®¾ç½®ä»£ç†ã€‚</span><br><span class="line">- (void)initIFlySpeech &#123;</span><br><span class="line"></span><br><span class="line">if (self.iFlySpeechSynthesizer == nil)</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">_iFlySpeechSynthesizer = [IFlySpeechSynthesizer sharedInstance];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">_iFlySpeechSynthesizer.delegate = self;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// è¯­éŸ³å¤±è´¥å›è°ƒä»£ç†å‡½æ•°</span><br><span class="line">- (void)onCompleted:(IFlySpeechError *)error &#123;</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;Speak Error:&#123;%d:%@&#125;&quot;, error.errorCode, error.errorDesc);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é«˜å¾·å¯¼èˆªæœ‰ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œä¼šä¼ å›å¯¼èˆªè¯­éŸ³çš„å­—ç¬¦ä¸²ï¼Œåœ¨å›è°ƒå‡½æ•°é‡Œé¢åˆ›å»ºå¼‚æ­¥çº¿ç¨‹ï¼Œå°†å­—ç¬¦ä¸²åˆæˆè¯­éŸ³ï¼Œå¹¶ä¸”æ’­æ”¾ï¼Œåœ¨é«˜å¾·å¯¼èˆªç‚¹å‡»å…³é—­æŒ‰é’®çš„å›è°ƒå‡½æ•°é‡Œé¢å…³é—­æ’­æ”¾å¹¶ä¸”å…³é—­å¯¼èˆªã€‚</p>
</blockquote>
<p>####pragma mark â€“ è¯­éŸ³è°ƒç”¨ï¼ˆå¯¼èˆªå›è°ƒï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">- (void)naviManager:(AMapNaviManager *)naviManager playNaviSoundString:(NSString *)soundString soundStringType:(AMapNaviSoundType)soundStringType &#123;</span><br><span class="line"></span><br><span class="line">if (soundStringType == AMapNaviSoundTypePassedReminder) &#123;</span><br><span class="line"></span><br><span class="line">// ç³»ç»Ÿè¯­éŸ³</span><br><span class="line">AudioServicesPlaySystemSound(1009);</span><br><span class="line">&#125;else &#123;</span><br><span class="line">// å¼€å¯å¼‚æ­¥çº¿ç¨‹ï¼ˆå…¨å±€ï¼‰</span><br><span class="line">dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0), ^&#123;</span><br><span class="line">[_iFlySpeechSynthesizer startSpeaking:soundString];</span><br><span class="line">&#125;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// è¿™æ˜¯ç‚¹å‡»å…³é—­æŒ‰é’®çš„å›è°ƒå‡½æ•°ï¼ˆå°±æ˜¯å¯¼èˆªç•Œé¢çš„å‰å‰ï¼‰</span><br><span class="line">- (void)naviViewControllerCloseButtonClicked:(AMapNaviViewController *)naviViewController &#123;</span><br><span class="line"></span><br><span class="line">dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0), ^&#123;</span><br><span class="line"></span><br><span class="line">[self.iFlySpeechSynthesizer stopSpeaking];</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">[self.naviManager stopNavi];</span><br><span class="line"></span><br><span class="line">[self.naviManager dismissNaviViewControllerAnimated:YES];</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä»¥ä¸Šå°±æ˜¯æˆ‘æœ€è¿‘ç ”ç©¶çš„é«˜å¾·APIï¼Œä¸€æ˜¯å¯¹æœ€è¿‘å­¦ä¹ çš„æ€»ç»“ï¼ŒäºŒæ˜¯å¸Œæœ›å¸®åŠ©åˆšåˆšæ¥è§¦é«˜å¾·çš„äººï¼Œå¸Œæœ›å¯¹ä½ ä»¬æœ‰å¸®åŠ©ï¼Œæ–‡ç« å†™å¾—æœ‰ç‚¹ä¹±ï¼Œç¬¬ä¸€æ¬¡å•Šï¼Œä»¥åè‚¯å®šä¼šè¶Šæ¥è¶Šå¥½ã€‚å¦‚æœ‰é”™è¯¯æ¬¢è¿å„ä½æŒ‡å‡ºã€‚è°¢è°¢ã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>â€œiOSâ€</tag>
        <tag>â€œé«˜å¾·åœ°å›¾â€</tag>
      </tags>
  </entry>
  <entry>
    <title>iOSé›†æˆèäº‘SDKå³æ—¶é€šè®¯æ•´ç†</title>
    <url>/2018/03/29/iOS%E9%9B%86%E6%88%90%E8%9E%8D%E4%BA%91SDK%E5%8D%B3%E6%97%B6%E9%80%9A%E8%AE%AF%E6%95%B4%E7%90%86/</url>
    <content><![CDATA[<h2 id="iOSé›†æˆèäº‘SDKå³æ—¶é€šè®¯æ•´ç†"><a href="#iOSé›†æˆèäº‘SDKå³æ—¶é€šè®¯æ•´ç†" class="headerlink" title="iOSé›†æˆèäº‘SDKå³æ—¶é€šè®¯æ•´ç†"></a>iOSé›†æˆèäº‘SDKå³æ—¶é€šè®¯æ•´ç†</h2><blockquote>
<p>æœ€è¿‘å¾ˆå°‘å†™ä¸€ä¸‹é¡¹ç›®æ€»ç»“äº†ï¼Œæœ€è¿‘é¡¹ç›®è™½ç„¶åšäº†å¾ˆå¤šï¼Œä½†æ˜¯éƒ½æ˜¯ä¸€äº›å¤–åŒ…é¡¹ç›®ï¼Œåšä¸‹æ¥ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå€¼å¾—æ€»ç»“çš„ã€‚æœ€è¿‘ä¸€ä¸ªé¡¹ç›®ç”¨åˆ°äº†èäº‘å³æ—¶é€šè®¯ï¼Œä»¥å‰åŸºæœ¬éƒ½æ˜¯ç”¨ç¯ä¿¡ï¼Œæ‰€ä»¥è¿˜é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œåœ¨æ­¤æ€»ç»“ä¸€ä¸‹è®°å½•ä¸€ä¸‹ã€‚</p>
</blockquote>
<h3 id="å¤´åƒã€æ˜µç§°ç­‰ç”¨æˆ·ä¿¡æ¯-èäº‘å¯¹è¿™ä¸ªé—®é¢˜æœ‰ä¸¤ç§å¤„ç†æ–¹å¼"><a href="#å¤´åƒã€æ˜µç§°ç­‰ç”¨æˆ·ä¿¡æ¯-èäº‘å¯¹è¿™ä¸ªé—®é¢˜æœ‰ä¸¤ç§å¤„ç†æ–¹å¼" class="headerlink" title="å¤´åƒã€æ˜µç§°ç­‰ç”¨æˆ·ä¿¡æ¯(èäº‘å¯¹è¿™ä¸ªé—®é¢˜æœ‰ä¸¤ç§å¤„ç†æ–¹å¼)"></a>å¤´åƒã€æ˜µç§°ç­‰ç”¨æˆ·ä¿¡æ¯(èäº‘å¯¹è¿™ä¸ªé—®é¢˜æœ‰ä¸¤ç§å¤„ç†æ–¹å¼)</h3><p><strong>ç”¨æˆ·ä¿¡æ¯æä¾›è€…</strong></p>
<blockquote>
<p>å®ç°æ­¥éª¤(ä»¥ä¸‹ä»£ç æ”¾åœ¨å•ä¾‹ä¸­ï¼Œå¯ä»¥æ˜¯AppDelegateï¼Œæœ€å¥½å•ç‹¬å†™ä¸€ä¸ªå•ä¾‹)  </p>
<p>é¦–å…ˆéµå®ˆRCIMUserInfoDataSourceè¿™ä¸ªåè®® </p>
</blockquote>
<p><strong>ç„¶åæ˜¯è¦è®¾ç½®ä»£ç†</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[[RCIM sharedRCIM] setUserInfoDataSource:self]; </span><br></pre></td></tr></table></figure>
<p><strong>æœ€åå®ç°ä»£ç†æ–¹æ³•ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- (void)getUserInfoWithUserId:(NSString *)userId completion:(void (^)(RCUserInfo *))completion &#123;</span><br><span class="line">    NSLog(@&quot;getUserInfoWithUserId ----- %@&quot;, userId);</span><br><span class="line">    RCUserInfo *user = [RCUserInfo new];</span><br><span class="line">    if (userId == nil || [userId length] == 0) &#123;</span><br><span class="line">        user.userId = userId;</span><br><span class="line">        user.portraitUri = @&quot;&quot;;</span><br><span class="line">        user.name = @&quot;&quot;;</span><br><span class="line">        completion(user);</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    if ([userId isEqualToString:[UserInfo shareInstance].uid]) &#123;</span><br><span class="line">        NSString *urlSelf = [BASIC_URL_image stringByAppendingString:[UserInfo shareInstance].photo];</span><br><span class="line">        return completion([[RCUserInfo alloc] initWithUserId:userId name:[UserInfo shareInstance].nickname portrait:urlSelf]);</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">    </span><br><span class="line">  //æ ¹æ®å­˜å‚¨è”ç³»äººä¿¡æ¯çš„æ¨¡å‹ï¼Œé€šè¿‡ userId æ¥å–å¾—å¯¹åº”çš„nameå’Œå¤´åƒurlï¼Œè¿›è¡Œä»¥ä¸‹è®¾ç½®</span><br><span class="line">    [WTBaseHttpRequst postRequstWithURL:getUserHttp params:@&#123;@&quot;uid&quot;:[UserInfo shareInstance].uid, @&quot;api_token&quot;:[UserInfo shareInstance].api_token, @&quot;k_uid&quot;:userId&#125; successBlock:^(NSDictionary *returnData) &#123;</span><br><span class="line">        if ([returnData[@&quot;status&quot;] integerValue] == 1) &#123;</span><br><span class="line">            NSString *urlStr = [BASIC_URL_image stringByAppendingString:returnData[@&quot;data&quot;][@&quot;user&quot;][@&quot;photo&quot;]];</span><br><span class="line">            return completion([[RCUserInfo alloc] initWithUserId:userId name:returnData[@&quot;data&quot;][@&quot;user&quot;][@&quot;nickname&quot;] portrait:urlStr]);</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            completion(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; failureBlock:^(NSString *error) &#123;</span><br><span class="line">        completion(user);</span><br><span class="line">    &#125; showHUD:NO];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>è¿™ä¸ªæ–¹æ³•ä¸éœ€è¦ä½ è‡ªå·±æ‰‹åŠ¨è°ƒç”¨ï¼Œåªæ˜¯å½“ä½ åœ¨ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯æ—¶è°ƒç”¨æ–¹æ³•å³å¯</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[[RCIM sharedRCIM] refreshUserInfoCache:user withUserId:[UserInfo shareInstance].uid]</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">WS(weakSelf);</span><br><span class="line">// ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯è°ƒç”¨</span><br><span class="line">[WTBaseHttpRequst postRequstWithURL:modifyInfoHttp params:dict successBlock:^(NSDictionary *returnData) &#123;</span><br><span class="line">    [weakSelf MBProgressHudShowWithTextOnlyWithText:returnData[@&quot;msg&quot;]];</span><br><span class="line">    if ([returnData[@&quot;status&quot;] integerValue] == 1) &#123;</span><br><span class="line">        RCUserInfo *user = [RCUserInfo new];</span><br><span class="line">        user.userId = [UserInfo shareInstance].uid;</span><br><span class="line">        user.portraitUri = [BASIC_URL_image stringByAppendingString:[UserInfo shareInstance].photo];</span><br><span class="line">        user.name = weakSelf.nickNameTextField.text;</span><br><span class="line">        [[RCIM sharedRCIM] refreshUserInfoCache:user withUserId:[UserInfo shareInstance].uid];</span><br><span class="line">        dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(1.5 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            [self.navigationController popViewControllerAnimated:YES];</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; failureBlock:^(NSString *error) &#123;</span><br><span class="line">    [weakSelf MBProgressHudShowWithTextOnlyWithText:error];</span><br><span class="line">&#125; showHUD:YES];</span><br></pre></td></tr></table></figure>

<p><strong>åœ¨æ‰©å±•æ¶ˆæ¯ä¸­æºå¸¦ç”¨æˆ·ä¿¡æ¯</strong></p>
<blockquote>
<p>è®¾ç½®å‘é€æ¶ˆæ¯æ—¶åœ¨æ¶ˆæ¯ä½“ä¸­æºå¸¦ç”¨æˆ·ä¿¡æ¯(ä»2.4.1 ä¹‹åé™„åŠ ç”¨æˆ·ä¿¡æ¯ä¹‹åcellé»˜è®¤ä¼šæ˜¾ç¤ºé™„åŠ çš„ç”¨æˆ·ä¿¡æ¯çš„å¤´åƒï¼Œå³ç”¨æˆ·ä¿¡æ¯ä¸ä¼šå–ç”¨æˆ·ä¿¡æ¯æä¾›è€…é‡Œæä¾›çš„ç”¨æˆ·ä¿¡æ¯)</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[RCIM sharedRCIM].enableMessageAttachUserInfo = YES; </span><br><span class="line">```  </span><br><span class="line">  </span><br><span class="line">**ä½ è®¾ç½®äº†enableMessageAttachUserInfoä¹‹åï¼Œå¯ä»¥å–åˆ°**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2F;**  </p>
<ul>
<li>å‘é€è€…ä¿¡æ¯</li>
<li>**&#x2F;<br>@property(nonatomic, strong) RCUserInfo *senderUserInfo; <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">   </span><br><span class="line">**å½“ç„¶æˆ‘è§‰å¾—è¿˜å¯ä»¥ä»åå°è·å–å¥½å‹å…³ç³»åï¼Œæˆ‘ä»¬åœ¨æ¯æ¬¡ç™»é™†åï¼Œå¼€ä¸€ä¸ªçº¿ç¨‹æŠŠå¥½å‹å…³ç³»è¯·æ±‚ä¸‹æ¥å­˜èµ·æ¥ç„¶åæ ¹æ®ç¯ä¿¡IDæŸ¥æ‰¾å¥½å‹çš„æ˜µç§°å’Œå¤´åƒ**</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### ç»™è¾“å…¥æ¡†æ·»åŠ æç¤ºè¯­(è¿™ä¸ªæˆ‘ä¸€ç›´è§‰å¾—ç¯ä¿¡åº”è¯¥ç»™äº†æ–¹æ³•ä¿®æ”¹ï¼Œåªæ˜¯æˆ‘ä¸€ç›´æ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥åªæœ‰è‡ªå·±å»å†™äº†)</span><br><span class="line">  </span><br><span class="line">**åˆ›å»ºæç¤ºçš„label**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
_lab &#x3D; [[UILabel alloc] initWithFrame:self.chatSessionInputBarControl.inputTextView.bounds];<br>_lab.text &#x3D; @â€è¯·è¾“å…¥æ–‡å­—ä¿¡æ¯â€¦â€;<br>_lab.textColor &#x3D; [UIColor colorWithHexColor:@â€ddddddâ€];<br>_lab.font &#x3D; [UIFont systemFontOfSize:15];<br>_lab.center &#x3D; CGPointMake(_lab.center.x + 15, _lab.center.y);<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">**åˆ¤å®šæ˜¯å¦æœ‰è‰ç¨¿æ¥æ˜¾ç¤ºå’Œéšè—æç¤ºçš„label**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
[self.chatSessionInputBarControl.inputTextView addSubview:_lab];<br>if (self.chatSessionInputBarControl.draft &#x3D;&#x3D; nil || self.chatSessionInputBarControl.draft.length &#x3D;&#x3D; 0) {<br> _lab.hidden &#x3D; NO;<br>}else {<br> _lab.hidden &#x3D; YES;<br>}<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">**æ ¹æ®è¾“å…¥æ•°æ®æ¥åˆ¤å®šæ˜¾ç¤ºéšè—æç¤ºlabel**</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<ul>
<li>(void)inputTextView:(UITextView *)inputTextView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text {<br>  if (((inputTextView.text.length &#x3D;&#x3D; 1 &amp;&amp; [text isEqualToString:@â€â€]) || (inputTextView.text.length &#x3D;&#x3D; 0 &amp;&amp; text.length &gt; 0))  &amp;&amp; range.length &#x3D;&#x3D; 1 &amp;&amp; range.location &#x3D;&#x3D; 0) {<br>  _lab.hidden &#x3D; NO;<br>  }else {<br>  _lab.hidden &#x3D; YES;<br>  }<br>}<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">### å–æ¶ˆè¾“å…¥@å¼¹å‡ºå¥½å‹åˆ—è¡¨ç•Œé¢ï¼Œä¿ç•™é•¿æŒ‰å¤´åƒ@æ–¹æ³•</span><br><span class="line"></span><br><span class="line">**é¦–å…ˆåœ¨AppDelegateä¸­å¼€å¯æ¶ˆæ¯@åŠŸèƒ½ï¼ˆåªæ”¯æŒç¾¤èŠå’Œè®¨è®ºç»„, Appéœ€è¦å®ç°ç¾¤æˆå‘˜æ•°æ®æºgroupMemberDataSourceï¼‰**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
[RCIM sharedRCIM].enableMessageMentioned &#x3D; YES;</li>
</ul>
<p>ç„¶ååœ¨ç»§æ‰¿RCConversationViewControllerçš„æ§åˆ¶å™¨ä¸­è°ƒç”¨<br>-(void)showChooseUserViewController:(void (^)(RCUserInfo *selectedUserInfo))selectedBlock<br>                         cancel:(void (^)())cancelBlock {<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">### åœ¨ä¼šè¯åˆ—è¡¨ä¸­æ·»åŠ ä¸€äº›å›ºå®šçš„cell(ç»§æ‰¿RCConversationListViewController)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F; å¯¹è‡ªå®šä¹‰cellèµ‹å€¼</p>
<ul>
<li>(RCConversationBaseCell *)rcConversationListTableView:(UITableView *)tableView<br>                            cellForRowAtIndexPath:(NSIndexPath *)indexPath {<br>  RCCustomCell *cell &#x3D; (RCCustomCell *)[[RCCustomCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@â€RCCustomCellâ€];<br>  RCConversationModel *model &#x3D; self.conversationListDataSource[indexPath.row];<br>  cell.nameLabel.text &#x3D; model.conversationTitle;<br>  return cell;<br>}</li>
</ul>
<p>&#x2F;&#x2F; æ·»åŠ è‡ªå®šä¹‰cellçš„æ•°æ®æº</p>
<ul>
<li>(NSMutableArray *)willReloadTableData:(NSMutableArray *)dataSource{<br>  NSArray *arr &#x3D; @[@â€è®ºå›å›å¤å’Œ@æˆ‘çš„â€, @â€é™Œç”Ÿäººç§ä¿¡â€, @â€å¹¸å­˜è€…éƒ¨è½@æˆ‘çš„â€, @â€é—®å·è°ƒæŸ¥â€];<br>  for (int i &#x3D; 0; i&lt;arr.count; i++) {<br>  RCConversationModel *model &#x3D; [[RCConversationModel alloc]init];<br>  model.conversationModelType &#x3D; RC_CONVERSATION_MODEL_TYPE_CUSTOMIZATION;<br>  model.conversationTitle &#x3D; arr[i];<br>  model.isTop &#x3D; YES;<br>  [dataSource insertObject:model atIndex:i];<br>  }<br>  return dataSource;<br>}</li>
</ul>
<p>&#x2F;&#x2F; ç‚¹å‡»cellè·³è½¬</p>
<ul>
<li>(void)onSelectedTableRow:(RCConversationModelType)conversationModelType<br>   conversationModel:(RCConversationModel *)model<br>     atIndexPath:(NSIndexPath *)indexPath{<br>  if (indexPath.row &#x3D;&#x3D; 0) {<br>  WTForumAndConnectListViewController *chatList &#x3D; (WTForumAndConnectListViewController *)[WTStoryBoardSegment instantiateViewControllerWithStoryBoardName:@â€Mainâ€ identifier:@â€WTForumAndConnectListViewControllerâ€];<br>  chatList.title &#x3D; @â€å›å¤å’Œ@æˆ‘çš„â€;<br>  [self.navigationController pushViewController:chatList animated:YES];<br>  }else if (indexPath.row &#x3D;&#x3D; 1) {<br>  WTChatListViewController *chatList &#x3D; [[WTChatListViewController alloc] init];<br>  chatList.title &#x3D; @â€é™Œç”Ÿäººç§ä¿¡â€;<br>  chatList.isEnteredToCollectionViewController &#x3D; YES;<br>  chatList.type &#x3D; 1;<br>  chatList.friendArray &#x3D; self.friendArray;<br>  [self.navigationController pushViewController:chatList animated:YES];<br>  }else if (indexPath.row &#x3D;&#x3D; 2) {<br>  WTChatListViewController *chatList &#x3D; [[WTChatListViewController alloc] init];<br>  chatList.title &#x3D; @â€å¹¸å­˜è€…éƒ¨è½@æˆ‘çš„â€;<br>  chatList.isEnteredToCollectionViewController &#x3D; YES;<br>  chatList.type &#x3D; 2;<br>  [self.navigationController pushViewController:chatList animated:YES];<br>  }else if (indexPath.row &#x3D;&#x3D; 3) {<br>  WTQuestionnaireViewController *questionnaire &#x3D; (WTQuestionnaireViewController *)[WTStoryBoardSegment instantiateViewControllerWithStoryBoardName:@â€Mainâ€ identifier:@â€WTQuestionnaireViewControllerâ€];<br>  [self.navigationController pushViewController:questionnaire animated:YES];<br>  }else {<br>  &#x2F;&#x2F;ç‚¹å‡»cellï¼Œæ‹¿åˆ°cellå¯¹åº”çš„modelï¼Œç„¶åä»modelä¸­æ‹¿åˆ°å¯¹åº”çš„RCUserInfoï¼Œç„¶åèµ‹å€¼ä¼šè¯å±æ€§ï¼Œè¿›å…¥ä¼šè¯<br>  if (model.conversationType &#x3D;&#x3D; ConversationType_PRIVATE) {&#x2F;&#x2F;å•èŠ<br>      WTMyConversationLisViewController *_conversationVC &#x3D; [[WTMyConversationLisViewController alloc]init];<br>      _conversationVC.conversationType &#x3D; model.conversationType;<br>      _conversationVC.targetId &#x3D; model.targetId;<br>      _conversationVC.title &#x3D; model.conversationTitle;<br>      [self.navigationController pushViewController:_conversationVC animated:YES];<br>  }else if (model.conversationType &#x3D;&#x3D; ConversationType_GROUP){&#x2F;&#x2F;ç¾¤èŠ<br>      WTMyConversationLisViewController *_conversationVC &#x3D; [[WTMyConversationLisViewController alloc]init];<br>      _conversationVC.conversationType &#x3D; model.conversationType;<br>      _conversationVC.title &#x3D; model.conversationTitle;<br>      _conversationVC.targetId &#x3D; model.targetId;<br>      [self.navigationController pushViewController:_conversationVC animated:YES];<br>  }<br>  }<br>}<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">### åœ¨ä»»æ„åœ°æ–¹è·å–èŠå¤©åˆ—è¡¨æ•°é‡åŠåˆ é™¤åˆ—è¡¨</span><br><span class="line"></span><br><span class="line">**è·å–èŠå¤©åˆ—è¡¨**   </span><br><span class="line"></span><br></pre></td></tr></table></figure>
NSArray *privateArr &#x3D; [[RCIMClient sharedRCIMClient] getConversationList:@[@(ConversationType_PRIVATE)]];<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">**åœ¨ConversationListæ·»åŠ å¯¹åº”ç±»å‹çš„èŠå¤©å°±å¯ä»¥è·å–å¯¹åº”ç±»å‹çš„èŠå¤©åˆ—è¡¨åˆ é™¤æ–¹æ³•ç±»ä¼¼**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
[[RCIMClient sharedRCIMClient] clearConversations:@[@(ConversationType_PRIVATE)]];</li>
</ul>
<pre><code>
### èƒŒæ™¯å›¾

&gt; èäº‘èŠå¤©åˆ—è¡¨æ²¡æœ‰æ•°æ®çš„é»˜è®¤å›¾ç‰‡ä¸‹é¢æœ‰ç‚¹å‡»å³ä¸Šè§’åŠ å…¥èŠå¤©ï¼Œå¯æ˜¯ä¸æ˜¯æ‰€æœ‰çš„èŠå¤©éƒ½æœ‰è¿™ä¸ªåŠŸèƒ½(æˆ‘çš„å°±æ²¡æœ‰)å¦‚ä½•æ²¡æœ‰å°±å¯ä»¥åœ¨èµ„æºæ–‡ä»¶ä¸­æ‰¾åˆ° no\_message\_img è¿™å¼ å›¾ç‰‡ç”¨pså»æ‰ä¸‹é¢çš„é‚£ä¸€è¡Œå­—

### å…¶å®ƒ

&gt; ä»¥ä¸Šå°±æ˜¯æˆ‘åœ¨ä½¿ç”¨èäº‘è¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜åŠè§£å†³æ–¹æ³•ï¼Œå¦‚æœæœ‰é”™è¯¯æˆ–è€…ä¸è¶³ä¹‹å¤„è¿˜æœ›æŒ‡æ­£ï¼Œè°¢è°¢ï¼
</code></pre>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>â€œiOSâ€</tag>
        <tag>â€œèäº‘â€</tag>
      </tags>
  </entry>
  <entry>
    <title>iOSå³æ—¶é€šè®¯å‘é€å›¾ç‰‡æ¶ˆæ¯å†…å­˜æš´æ¶¨ä¼˜åŒ–</title>
    <url>/2025/06/16/iOS%E5%8D%B3%E6%97%B6%E9%80%9A%E8%AE%AF%E5%8F%91%E9%80%81%E5%9B%BE%E7%89%87%E6%B6%88%E6%81%AF%E5%86%85%E5%AD%98%E6%9A%B4%E6%B6%A8%E4%BC%98%E5%8C%96/</url>
    <content><![CDATA[<h3 id="é—®é¢˜ï¼š"><a href="#é—®é¢˜ï¼š" class="headerlink" title="é—®é¢˜ï¼š"></a>é—®é¢˜ï¼š</h3><blockquote>
<p>å³æ—¶é€šè®¯Appåœ¨å‘é€å›¾ç‰‡æ¶ˆæ¯æ—¶å†…å­˜æš´æ¶¨å¯¼è‡´ç½‘ç»œè¯·æ±‚åˆå§‹åŒ–å¤±è´¥ï¼ˆå†…å­˜ä¸è¶³OOMï¼‰ï¼Œå‘é€æ¶ˆæ¯å¤±è´¥ã€‚</p>
</blockquote>
<h3 id="å¯èƒ½åŸå› åˆ†æï¼š"><a href="#å¯èƒ½åŸå› åˆ†æï¼š" class="headerlink" title="å¯èƒ½åŸå› åˆ†æï¼š"></a>å¯èƒ½åŸå› åˆ†æï¼š</h3><ol>
<li>æœ‰å†…å­˜æ³„æ¼ã€‚</li>
<li>å‘é€çš„å›¾ç‰‡æ¶ˆæ¯ï¼Œå¯èƒ½åŒ…å«å¤§å›¾ï¼Œæ²¡æœ‰è¿›è¡Œå‹ç¼©å¤„ç†ï¼Œå¯¼è‡´å†…å­˜å ç”¨è¿‡é«˜ã€‚</li>
<li>åœ¨å‘é€è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½åŒæ—¶è¿›è¡Œäº†å›¾ç‰‡çš„è¯»å–å’Œå¤„ç†ï¼Œå¦‚æœå›¾ç‰‡å¾ˆå¤§ï¼Œå¤„ç†è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿå¾ˆå¤§çš„å†…å­˜å³°å€¼ã€‚</li>
</ol>
<h3 id="è§£å†³æ–¹æ¡ˆï¼š"><a href="#è§£å†³æ–¹æ¡ˆï¼š" class="headerlink" title="è§£å†³æ–¹æ¡ˆï¼š"></a>è§£å†³æ–¹æ¡ˆï¼š</h3><ol>
<li><strong>å¯¹äºå‘é€æ¶ˆæ¯æ—¶çš„å†…å­˜æš´æ¶¨ï¼š</strong></li>
</ol>
<ul>
<li>æ£€æŸ¥æ˜¯å¦æœ‰å†…å­˜æ³„æ¼ï¼Œä½¿ç”¨Instrumentså·¥å…·æ£€æµ‹ã€‚</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-75e63fb317acf3a1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Instrumentså·¥å…·æ£€æµ‹ç»“æœ"></p>
<p><strong>æ£€æµ‹å‘ç°ç¡®å®æœ‰å†…å­˜æ³„æ¼ï¼Œè§£å†³åå‘ç°é—®é¢˜è¿˜æ˜¯å­˜åœ¨ã€‚</strong></p>
<ul>
<li><p>åœ¨å‘é€å›¾ç‰‡æ¶ˆæ¯å‰ï¼Œå¯¹å›¾ç‰‡è¿›è¡Œå‹ç¼©ï¼ˆåŒ…æ‹¬å‹ç¼©è´¨é‡å’Œå°ºå¯¸ï¼‰ï¼Œç„¶åå†å‘é€å‹ç¼©åçš„å›¾ç‰‡ã€‚</p>
</li>
<li><p>é¿å…ç›´æ¥æ“ä½œå¤§å›¾ï¼Œå¯ä»¥ä½¿ç”¨åå°çº¿ç¨‹è¿›è¡Œå¤„ç†ï¼Œé˜²æ­¢é˜»å¡ä¸»çº¿ç¨‹ã€‚</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</span><br><span class="line">    // 1. è¯»å–å›¾ç‰‡ï¼ˆé¿å…ä½¿ç”¨imageNamed:ï¼‰</span><br><span class="line">    UIImage *originalImage = [UIImage imageWithContentsOfFile:filePath];</span><br><span class="line">    </span><br><span class="line">    // 2. å°ºå¯¸å‹ç¼©ï¼ˆé™åˆ¶æœ€å¤§è¾¹é•¿ä¸º1024ï¼‰</span><br><span class="line">    CGFloat maxSize = 1024.0;</span><br><span class="line">    CGSize scaledSize = [self scaledSizeForImage:originalImage maxLength:maxSize];</span><br><span class="line">    </span><br><span class="line">    // 3. è´¨é‡å‹ç¼©ï¼ˆ70%è´¨é‡ï¼‰</span><br><span class="line">    UIImage *compressedImage = [self resizeImage:originalImage toSize:scaledSize];</span><br><span class="line">    NSData *imageData = UIImageJPEGRepresentation(compressedImage, 0.7);</span><br><span class="line">    </span><br><span class="line">    // 4. å‘é€å‹ç¼©åçš„æ•°æ®ï¼ˆéåŸå§‹å›¾ç‰‡ï¼‰</span><br><span class="line">    [self sendImageData:imageData];</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// è®¡ç®—ç¼©æ”¾å°ºå¯¸</span><br><span class="line">- (CGSize)scaledSizeForImage:(UIImage *)image maxLength:(CGFloat)maxLength &#123;</span><br><span class="line">    CGFloat ratio = MIN(maxLength / image.size.width, maxLength / image.size.height);</span><br><span class="line">    return CGSizeMake(image.size.width * ratio, image.size.height * ratio);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å›¾ç‰‡é‡ç»˜</span><br><span class="line">- (UIImage *)resizeImage:(UIImage *)image toSize:(CGSize)targetSize &#123;</span><br><span class="line">    UIGraphicsBeginImageContextWithOptions(targetSize, NO, UIScreen.mainScreen.scale);</span><br><span class="line">    [image drawInRect:CGRectMake(0, 0, targetSize.width, targetSize.height)];</span><br><span class="line">    UIImage *resizedImage = UIGraphicsGetImageFromCurrentImageContext();</span><br><span class="line">    UIGraphicsEndImageContext();</span><br><span class="line">    return resizedImage;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å‹ç¼©åçš„å›¾ç‰‡æ•°æ®è¦åŠæ—¶é‡Šæ”¾ä¸å¿…è¦çš„èµ„æºï¼Œé¿å…åœ¨å†…å­˜ä¸­åŒæ—¶å­˜åœ¨å¤šå¼ å›¾ç‰‡ï¼Œæ¯”å¦‚åœ¨å›¾ç‰‡å±•ç¤ºåï¼Œå¦‚æœåŸå›¾ä¸å†éœ€è¦ï¼Œå¯ä»¥å°†å…¶ç½®ä¸ºnilï¼Œå¸®åŠ©å†…å­˜å›æ”¶ã€‚ï¼ˆ@autoreleasepoolï¼‰ã€‚</li>
</ul>
<p><strong>å¤„ç†åˆ°æ­¤å†…å­˜æš´æ¶¨è§£å†³äº†ï¼Œä½†æ˜¯éšç€å‘é€å›¾ç‰‡å†…å­˜è¿˜æ˜¯åœ¨æŒç»­å¢åŠ ï¼Œç°åœ¨æ¯å‘é€ä¸€å¼ å›¾ç‰‡å†…å­˜è¿˜æ˜¯è¦æ¶¨10Mã€‚ï¼ˆmessage.compressRatio &#x3D; 1.0 &#x2F;&#x2F; è®¾ç½®å‹ç¼©ç‡ï¼‰ï¼Œmessage.compressRatio &#x3D; 0.2ï¼Œæ¯å‘é€ä¸€å¼ å›¾ç‰‡å†…å­˜ä¹Ÿè¦æ¶¨5Mã€‚</strong></p>
<h3 id="æ–°é—®é¢˜ï¼š"><a href="#æ–°é—®é¢˜ï¼š" class="headerlink" title="æ–°é—®é¢˜ï¼š"></a>æ–°é—®é¢˜ï¼š</h3><blockquote>
<p>å³æ—¶é€šè®¯Appåœ¨å‘é€å›¾ç‰‡æ¶ˆæ¯æ—¶æ¯æ¬¡å±•ç¤ºä¸€å¼ å›¾ç‰‡å†…å­˜æ¶¨10Må¤šã€‚</p>
</blockquote>
<h3 id="å¯èƒ½åŸå› åˆ†æï¼š-1"><a href="#å¯èƒ½åŸå› åˆ†æï¼š-1" class="headerlink" title="å¯èƒ½åŸå› åˆ†æï¼š"></a>å¯èƒ½åŸå› åˆ†æï¼š</h3><p>1.<strong>å›¾ç‰‡åŠ è½½æ–¹æ³•ä¸å¯¹</strong> </p>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-6e9d4b44497cf943.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Cellå›¾ç‰‡å±•ç¤º"></p>
<p><strong>[UIImage imageNamed:]çš„å†…å­˜ç¼“å­˜ç‰¹æ€§ï¼š</strong> </p>
<ul>
<li><p>ç³»ç»Ÿçº§ç¼“å­˜æ— æ³•è‡ªåŠ¨é‡Šæ”¾</p>
</li>
<li><p>ç‰¹åˆ«ä¸é€‚åˆå¤§å›¾å’Œåˆ—è¡¨å±•ç¤ºåœºæ™¯</p>
</li>
<li><p>ä¼šè‡ªåŠ¨ç¼“å­˜å›¾ç‰‡åˆ°ç³»ç»Ÿç¼“å­˜</p>
</li>
<li><p>é€‚åˆé‡å¤ä½¿ç”¨çš„å°å›¾æ ‡</p>
</li>
<li><p>ä¸é€‚åˆå¤§å›¾æˆ–å•æ¬¡ä½¿ç”¨çš„å›¾ç‰‡</p>
</li>
</ul>
<p>2.<strong>å†…å­˜å¢é•¿åŸå› ï¼š</strong></p>
<p><code>ä¸ºäº†æ”¯æŒ GIF/WebP ç­‰åŠ¨å›¾æ ¼å¼ï¼ŒshowImageViewä¸ºSDAnimatedImageViewï¼Œå®ƒè§£ç åçš„å¸§ç¼“å­˜ä¼šå¢åŠ å†…å­˜å ç”¨ã€‚ </code></p>
<ul>
<li><p>å¤§å›¾è¢«ç¼“å­˜ä¸”æ— æ³•åŠæ—¶é‡Šæ”¾</p>
</li>
<li><p>å›¾ç‰‡è§£ç åçš„ä½å›¾æ•°æ®å ç”¨å†…å­˜</p>
</li>
</ul>
<p>3.<strong>Cell å¤ç”¨æœºåˆ¶</strong></p>
<p>å¿«é€Ÿæ»‘åŠ¨æ—¶å¯èƒ½åŒæ—¶åŠ è½½å¤šå¼ å¤§å›¾ï¼Œæ—§å›¾ç‰‡æœªåŠæ—¶é‡Šæ”¾</p>
<h3 id="ä¼˜åŒ–æ–¹æ¡ˆï¼š"><a href="#ä¼˜åŒ–æ–¹æ¡ˆï¼š" class="headerlink" title="ä¼˜åŒ–æ–¹æ¡ˆï¼š"></a>ä¼˜åŒ–æ–¹æ¡ˆï¼š</h3><blockquote>
<p>é€šè¿‡ä»¥ä¸‹ä¼˜åŒ–æªæ–½ï¼Œå›¾ç‰‡å±•ç¤ºå†…å­˜é—®é¢˜åº”è¯¥èƒ½å¾—åˆ°æ˜¾è‘—æ”¹å–„ã€‚æ ¸å¿ƒè¦ç‚¹æ˜¯ï¼š</p>
</blockquote>
<ul>
<li><p>é¿å…ä½¿ç”¨ imageNamed: åŠ è½½å¤§å›¾</p>
</li>
<li><p>åˆç†é…ç½® SDAnimatedImageView</p>
</li>
<li><p>å®Œå–„ cell å¤ç”¨æœºåˆ¶</p>
</li>
<li><p>ä½¿ç”¨å›¾ç‰‡ä¸‹é‡‡æ ·æŠ€æœ¯</p>
</li>
<li><p>æ»‘åŠ¨æ—¶ä¼˜åŒ–èµ„æºä½¿ç”¨</p>
</li>
</ul>
<p><strong>1.ä½¿ç”¨æ­£ç¡®çš„å›¾ç‰‡åŠ è½½æ–¹å¼ï¼Œç”¨  [UIImage imageWithContentsOfFile:filePath]æ›¿ä»£[UIImage imageNamed:filePath]</strong></p>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li><p>ä¸ä¼šç¼“å­˜å›¾ç‰‡</p>
</li>
<li><p>é€‚åˆå¤§å›¾å’Œå•æ¬¡ä½¿ç”¨çš„å›¾ç‰‡</p>
</li>
</ul>
<p><strong>åå°çº¿ç¨‹è§£ç  + å°ºå¯¸é€‚é…</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// åå°çº¿ç¨‹å¤„ç†å›¾ç‰‡</span><br><span class="line">dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        // 1. ä»æ–‡ä»¶åŠ è½½</span><br><span class="line">        UIImage *originalImage = [UIImage imageWithContentsOfFile:filePath];</span><br><span class="line">        </span><br><span class="line">        // 2. å‹ç¼©å›¾ç‰‡å°ºå¯¸ (æŒ‰éœ€)</span><br><span class="line">        CGSize targetSize = CGSizeMake(800, 800); // æ ¹æ®éœ€æ±‚è°ƒæ•´</span><br><span class="line">        UIGraphicsBeginImageContextWithOptions(targetSize, NO, [UIScreen mainScreen].scale);</span><br><span class="line">        [originalImage drawInRect:CGRectMake(0, 0, targetSize.width, targetSize.height)];</span><br><span class="line">        UIImage *scaledImage = UIGraphicsGetImageFromCurrentImageContext();</span><br><span class="line">        UIGraphicsEndImageContext();</span><br><span class="line">        </span><br><span class="line">        // 3. ä¸»çº¿ç¨‹æ›´æ–°UI</span><br><span class="line">        dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            self.showImageView.image = scaledImage;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>2.ä½¿ç”¨ ImageIO æ¡†æ¶é«˜æ•ˆåŠ è½½</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#import &lt;ImageIO/ImageIO.h&gt;</span><br><span class="line"></span><br><span class="line">NSURL *imageURL = [NSURL fileURLWithPath:filePath];</span><br><span class="line">NSDictionary *options = @&#123;(id)kCGImageSourceShouldCache: @NO&#125;; // ç¦ç”¨è§£ç ç¼“å­˜</span><br><span class="line">CGImageSourceRef source = CGImageSourceCreateWithURL((CFURLRef)imageURL, NULL);</span><br><span class="line">CGImageRef imageRef = CGImageSourceCreateImageAtIndex(source, 0, (CFDictionaryRef)options);</span><br><span class="line">UIImage *image = [UIImage imageWithCGImage:imageRef];</span><br><span class="line">CGImageRelease(imageRef);</span><br><span class="line">CFRelease(source);</span><br><span class="line"></span><br><span class="line">self.showImageView.image = image;</span><br></pre></td></tr></table></figure>

<p><strong>3.ä½¿ç”¨ç¬¬ä¸‰æ–¹å›¾ç‰‡åŠ è½½åº“</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// ä½¿ç”¨SDWebImageç¤ºä¾‹</span><br><span class="line">#import &lt;SDWebImage/SDWebImage.h&gt;</span><br><span class="line"></span><br><span class="line">[self.showImageView sd_setImageWithURL:[NSURL fileURLWithPath:filePath]placeholderImage:nil</span><br><span class="line">                           completed:^(UIImage *image, NSError *error,</span><br><span class="line">                           SDImageCacheType cacheType, </span><br><span class="line">                           NSURL *imageURL) &#123;</span><br><span class="line">                               // åŠ è½½å®Œæˆå›è°ƒ</span><br><span class="line"> &#125;];</span><br></pre></td></tr></table></figure>

<p><strong>4.ä¼˜åŒ– SDAnimatedImageView é…ç½®</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- (SDAnimatedImageView *)showImageView &#123;</span><br><span class="line">    if (!_showImageView) &#123;</span><br><span class="line">        _showImageView = [[SDAnimatedImageView alloc] init];</span><br><span class="line">        _showImageView.contentMode = UIViewContentModeScaleAspectFill;</span><br><span class="line">        _showImageView.userInteractionEnabled = YES;</span><br><span class="line">        </span><br><span class="line">        // æ·»åŠ ä»¥ä¸‹ä¼˜åŒ–é…ç½®</span><br><span class="line">        _showImageView.shouldIncrementalLoad = YES; // æ¸è¿›å¼åŠ è½½</span><br><span class="line">        _showImageView.maxBufferSize = 1024 * 1024; // è®¾ç½®åˆç†çš„ç¼“å†²åŒºå¤§å°</span><br><span class="line">        _showImageView.runLoopMode = NSDefaultRunLoopMode; // æ»‘åŠ¨æ—¶æš‚åœåŠ¨ç”»</span><br><span class="line">    &#125;</span><br><span class="line">    return _showImageView;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>5.Cell å¤ç”¨æ—¶çš„å†…å­˜ç®¡ç†</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// åœ¨ cell çš„ prepareForReuse ä¸­æ¸…ç†</span><br><span class="line">- (void)prepareForReuse &#123;</span><br><span class="line">    [super prepareForReuse];</span><br><span class="line">    </span><br><span class="line">    // åœæ­¢åŠ¨ç”»å¹¶é‡Šæ”¾èµ„æº</span><br><span class="line">    [self.showImageView stopAnimating];</span><br><span class="line">    self.showImageView.currentFrame = nil;</span><br><span class="line">    self.showImageView.animationImages = nil;</span><br><span class="line">    </span><br><span class="line">    // å–æ¶ˆæœªå®Œæˆçš„å›¾ç‰‡åŠ è½½</span><br><span class="line">    [self.showImageView sd_cancelCurrentImageLoad];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>6.å›¾ç‰‡å°ºå¯¸ä¼˜åŒ–ï¼ˆé’ˆå¯¹å¤§å›¾ï¼‰</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// ä½¿ç”¨ ImageIO è¿›è¡Œä¸‹é‡‡æ ·</span><br><span class="line">- (UIImage *)downsampleImageAtPath:(NSString *)path toSize:(CGSize)size &#123;</span><br><span class="line">    NSURL *url = [NSURL fileURLWithPath:path];</span><br><span class="line">    NSDictionary *options = @&#123;</span><br><span class="line">        (id)kCGImageSourceShouldCache: @NO,</span><br><span class="line">        (id)kCGImageSourceShouldAllowFloat: @YES</span><br><span class="line">    &#125;;</span><br><span class="line">    CGImageSourceRef source = CGImageSourceCreateWithURL((CFURLRef)url, NULL);</span><br><span class="line">    </span><br><span class="line">    CGFloat maxDimension = MAX(size.width, size.height) * [UIScreen mainScreen].scale;</span><br><span class="line">    NSDictionary *downsampleOptions = @&#123;</span><br><span class="line">        (id)kCGImageSourceCreateThumbnailFromImageAlways: @YES,</span><br><span class="line">        (id)kCGImageSourceShouldCacheImmediately: @YES,</span><br><span class="line">        (id)kCGImageSourceThumbnailMaxPixelSize: @(maxDimension)</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    CGImageRef imageRef = CGImageSourceCreateThumbnailAtIndex(source, 0, (CFDictionaryRef)downsampleOptions);</span><br><span class="line">    UIImage *image = [UIImage imageWithCGImage:imageRef];</span><br><span class="line">    </span><br><span class="line">    if (imageRef) CFRelease(imageRef);</span><br><span class="line">    if (source) CFRelease(source);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    return image;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>7.æ»‘åŠ¨æ€§èƒ½ä¼˜åŒ–</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// åœ¨ scrollView ä»£ç†ä¸­å®ç°ä»¥ä¸‹æ–¹æ³•</span><br><span class="line">- (void)scrollViewDidScroll:(UIScrollView *)scrollView &#123;</span><br><span class="line">    // æš‚åœå±å¹•å¤– cell çš„åŠ¨ç”»</span><br><span class="line">    for (UITableViewCell *cell in self.tableView.visibleCells) &#123;</span><br><span class="line">        if ([cell isKindOfClass:[YourCellClass class]]) &#123;</span><br><span class="line">            YourCellClass *yourCell = (YourCellClass *)cell;</span><br><span class="line">            [yourCell.showImageView startAnimating];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // æš‚åœéå¯è§ cell çš„åŠ¨ç”»</span><br><span class="line">    NSArray *visiblePaths = [self.tableView indexPathsForVisibleRows];</span><br><span class="line">    for (NSIndexPath *indexPath in self.loadedIndexPaths) &#123;</span><br><span class="line">        if (![visiblePaths containsObject:indexPath]) &#123;</span><br><span class="line">            YourCellClass *cell = (YourCellClass *)[self.tableView cellForRowAtIndexPath:indexPath];</span><br><span class="line">            [cell.showImageView stopAnimating];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å…¶ä»–ä¼˜åŒ–å»ºè®®ï¼š"><a href="#å…¶ä»–ä¼˜åŒ–å»ºè®®ï¼š" class="headerlink" title="å…¶ä»–ä¼˜åŒ–å»ºè®®ï¼š"></a>å…¶ä»–ä¼˜åŒ–å»ºè®®ï¼š</h3><p><strong>1.å†…å­˜è­¦å‘Šå¤„ç†</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- (void)didReceiveMemoryWarning &#123;</span><br><span class="line">    [super didReceiveMemoryWarning];</span><br><span class="line">    // æ¸…é™¤æ‰€æœ‰å›¾ç‰‡ç¼“å­˜</span><br><span class="line">    [[SDImageCache sharedImageCache] clearMemory];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>2.ä½¿ç”¨åˆé€‚çš„ SDWebImage é€‰é¡¹ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[self.showImageView sd_setImageWithURL:imageURL</span><br><span class="line">                    placeholderImage:nil</span><br><span class="line">                           options:SDWebImageAvoidDecodeImage | </span><br><span class="line">                                   SDWebImageScaleDownLargeImages |</span><br><span class="line">                                   SDWebImageProgressiveLoad</span><br><span class="line">                          completed:nil];</span><br></pre></td></tr></table></figure>

<p><strong>3.ç›‘æ§å†…å­˜ä½¿ç”¨ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- (void)monitorMemoryUsage &#123;</span><br><span class="line">    struct task_basic_info info;</span><br><span class="line">    mach_msg_type_number_t size = sizeof(info);</span><br><span class="line">    kern_return_t kerr = task_info(mach_task_self(),</span><br><span class="line">                                 TASK_BASIC_INFO,</span><br><span class="line">                                 (task_info_t)&amp;info,</span><br><span class="line">                                 &amp;size);</span><br><span class="line">    if (kerr == KERN_SUCCESS) &#123;</span><br><span class="line">        NSLog(@&quot;Memory in use (in MB): %f&quot;, info.resident_size / 1024.0 / 1024.0);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>4.é…ç½® SDWebImage å…¨å±€å‚æ•°ï¼ˆAppDelegate ä¸­ï¼‰</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// è®¾ç½®å…¨å±€ç¼“å­˜ç­–ç•¥</span><br><span class="line">SDImageCacheConfig *cacheConfig = [SDImageCacheConfig defaultCacheConfig];</span><br><span class="line">cacheConfig.maxMemoryCost = 100 * 1024 * 1024; // 100MB å†…å­˜ç¼“å­˜</span><br><span class="line">cacheConfig.maxMemoryCount = 50; // æœ€å¤§ç¼“å­˜å›¾ç‰‡æ•°é‡</span><br><span class="line">cacheConfig.shouldDecompressImages = NO; // ç¦æ­¢è‡ªåŠ¨è§£å‹</span><br><span class="line">[SDImageCache sharedImageCache].config = cacheConfig;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-aabb2e60704bb072.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ€§èƒ½å¯¹æ¯”"></p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>â€œiOSâ€</tag>
        <tag>â€œIMSDKâ€</tag>
        <tag>UIImage</tag>
        <tag>ä¼˜åŒ–å†…å­˜</tag>
      </tags>
  </entry>
  <entry>
    <title>gitHub hexo ä¸ªäººåšå®¢</title>
    <url>/2016/07/16/gitHub-hexo-%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
    <content><![CDATA[<blockquote>
<p>ä¸€ç›´ä»¥æ¥å°±æƒ³æ­å»ºä¸€ä¸ªè‡ªå·±çš„åšå®¢ï¼Œä¸æƒ³å…¶å®ƒç½‘ç«™é‚£ä¹ˆæ‚ä¹±ï¼Œéœ€è¦ä¸€ä¸ªçº¯ç²¹çš„è®°å½•æˆé•¿ä¹‹è·¯çš„åœ°æ–¹ã€‚æŸ¥äº†å¾ˆå¤šèµ„æ–™ï¼Œæœ€åå†³å®šç”¨hexo æ­å»ºä¸€ä¸ªé™æ€ç½‘é¡µï¼Œæ‰˜ç®¡åœ¨gitHubä¸Šã€‚ä¸‹é¢æˆ‘å°±ä»‹ç»ä¸€ä¸‹æˆ‘çš„æ­å»ºä¹‹è·¯ï¼Œ<a href="https://gavincarter1991.github.io/">æˆ‘çš„æ­å»ºç½‘é¡µ</a>ã€‚</p>
</blockquote>
<h3 id="1-gitHub"><a href="#1-gitHub" class="headerlink" title="1. gitHub"></a>1. gitHub</h3><p>gitHub çš„æ³¨å†ŒåŠé…ç½®æˆ‘å°±ä¸ä»‹ç»äº†ï¼Œè¿™ä¸ªå“ªé‡Œéƒ½å¯ä»¥æŸ¥åˆ°ï¼Œæˆ‘ä»‹ç»ä¸€ä¸‹æ³¨å†Œè¿‡åè¿œç¨‹ä»“åº“çš„åˆ›å»ºã€‚<br>é¦–å…ˆåˆ›å»ºè¿œç¨‹ä»“åº“ï¼š<br><img src="https://i-blog.csdnimg.cn/blog_migrate/ea1e5de3d83fcb9ca8c0eb0e11086ab3.webp?x-image-process=image/format,png" alt="å±å¹•å¿«ç…§ 2016-07-16 02.49.16.png"><br>åœ¨åé¢çš„Respository name é‡Œé¢è¾“å…¥ï¼šgavincarter1991.github.io è¿™ä¸ªæ ¼å¼æ˜¯å®šçš„ï¼ˆgavincarter1991 éœ€è¦å¡«å†™ä½ çš„ç”¨æˆ·åï¼‰æˆ‘æ²¡æœ‰æµ‹è¯•è¿‡å¦‚æœä¸å¡«å†™è‡ªå·±ç”¨æˆ·åçš„åæœï¼Œä¸è¿‡æŸ¥äº†å¾ˆå¤šèµ„æ–™éƒ½æ¨èè¿™æ ·å¡«å†™ï¼Œæœ‰çš„è¿˜æ˜¯ä¸ä»¥è¿™æ ·çš„æ–¹å¼ä¼šæŠ¥é”™ï¼Œæ²¡æœ‰å®è·µï¼Œæˆ‘æ²¡æœ‰å‘è¨€æƒã€‚<br><img src="https://i-blog.csdnimg.cn/blog_migrate/c44f6c8a7f4544c550f966f205dd7848.webp?x-image-process=image/format,png" alt="å±å¹•å¿«ç…§ 2016-07-16 02.49.37.png"></p>
<h3 id="2-homebrewå®‰è£…"><a href="#2-homebrewå®‰è£…" class="headerlink" title="2. homebrewå®‰è£…"></a>2. homebrewå®‰è£…</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">brew install node</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹å®‰è£…æ˜¯å¦æˆåŠŸï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm -v</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">node -v</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å®‰è£…æˆåŠŸä¼šæ˜¾ç¤ºç‰ˆæœ¬å·ï¼š<br><img src="https://i-blog.csdnimg.cn/blog_migrate/257560df666479d7a2171dd37c11a68b.webp?x-image-process=image/format,png" alt="å±å¹•å¿«ç…§ 2016-07-16 03.09.16.png"></p>
<h3 id="3-å¼€å§‹å®‰è£…hexo"><a href="#3-å¼€å§‹å®‰è£…hexo" class="headerlink" title="3. å¼€å§‹å®‰è£…hexo"></a>3. å¼€å§‹å®‰è£…hexo</h3><p>é¦–å…ˆè¿›å…¥ä½ éœ€è¦å­˜æ”¾åšå®¢çš„æ–‡ä»¶å¤¹ï¼Œç„¶åï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install hexo -g</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹ç‰ˆæœ¬å·ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo version</span><br></pre></td></tr></table></figure>
<p>åˆå§‹åŒ–é¡¹ç›®ï¼š(ç±»ä¼¼äºgit)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo init</span><br></pre></td></tr></table></figure>

<h3 id="4-å¼€å§‹ä½¿ç”¨"><a href="#4-å¼€å§‹ä½¿ç”¨" class="headerlink" title="4. å¼€å§‹ä½¿ç”¨"></a>4. å¼€å§‹ä½¿ç”¨</h3><p>åˆ›å»ºé¡µé¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo new post &quot;My First Blog&quot;</span><br></pre></td></tr></table></figure>
<p>ç”Ÿæˆé™æ€æ–‡ä»¶(ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªæ–°çš„å«åšpublicçš„æ–‡ä»¶å¤¹)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo g # æˆ–è€…hexo generate</span><br></pre></td></tr></table></figure>
<p>å¼€å¯æœ¬åœ°æœåŠ¡ ç”¨äºåœ¨æœ¬åœ°æµè§ˆ Ctrl+Cé€€å‡ºæŸ¥çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo s # æˆ–è€…hexo serverï¼Œå¯ä»¥åœ¨è¾“å…¥http://localhost:4000/ æŸ¥çœ‹ æˆ–è€… æŒ‰ä½Command åŒå‡»å‘½ä»¤è¡Œä¸‹çš„ç½‘å€ï¼ˆhttp://localhost:4000/ï¼‰</span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶ç½‘é¡µå·²ç»æˆå‹äº†ã€‚</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯è¦éƒ¨ç½²åˆ°gitHubä¸Š åªéœ€è¦åœ¨é…ç½®æ–‡ä»¶_config.xmlä¸­ä½œå¦‚ä¸‹ä¿®æ”¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: git@github.com:gavincarter1991/gavincarter1991.github.io</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>
<p>å½“ç„¶gavincarter1991ä½ç½®è¿˜æ˜¯å¡«ä½ çš„ä¿¡æ¯</p>
<p>ç„¶åå®‰è£…ä¸€ä¸ªè‡ªåŠ¨å·¥å…·ï¼Œæ–¹ä¾¿ä»¥åé¡µé¢çš„éƒ¨ç½²ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>
<p>éƒ¨ç½²å»gitHubï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure>
<p>ä»¥åæ¯ä¸€æ¬¡éƒ¨ç½²çš„ä¸€èˆ¬æ­¥éª¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>
<h3 id="5-å†™æ–‡ç« "><a href="#5-å†™æ–‡ç« " class="headerlink" title="5.å†™æ–‡ç« "></a>5.å†™æ–‡ç« </h3><p>é¦–å…ˆï¼›</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo new post &quot;My First Blog&quot;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå»ç›®å½•ï¼šsource_postsä¸‹æ‰¾åˆ°My First Blog.mdï¼ˆmarkdownæ–‡ä»¶ï¼‰å¼€å§‹ç¼–è¾‘æ–‡ç« äº†ã€‚æˆ‘Macç”¨çš„æ˜¯Mouç¼–è¾‘å™¨ï¼Œä½ å¯ä»¥è‡ªç”±é€‰æ‹©é€‚åˆè‡ªå·±çš„markdownç¼–è¾‘å™¨ã€‚<a href="https://wizardforcel.gitbooks.io/markdown-simple-world/content/0.html">è¿™é‡Œæœ‰markdownä½¿ç”¨æŠ€å·§</a><br>å†™å¥½ä»¥åå°±å¯ä»¥æŒ‰ç…§å‰é¢çš„éƒ¨ç½²å¸¸ç”¨æ­¥éª¤è¿›è¡Œéƒ¨ç½²äº†ã€‚</p>
<h3 id="6-å…¶ä»–"><a href="#6-å…¶ä»–" class="headerlink" title="6. å…¶ä»–"></a>6. å…¶ä»–</h3><p>1.ä¸»é¢˜ï¼šhexoæœ‰å¾ˆå¤š<a href="https://github.com/hexojs/hexo/wiki/Themes">ç¬¬ä¸‰æ–¹ä¸»é¢˜</a>å¯ä»¥é€‰æ‹©ï¼Œé€šè¿‡git clone<br>2.é…ç½®ä¿®æ”¹å‚æ•°<a href="http://div.io/topic/1691">è¯¦è§</a> æˆ‘å†™å‡ ä¸ªå¸¸ç”¨çš„ï¼š<br>å¤´åƒï¼šæŠŠå›¾ç‰‡æ”¾åœ¨ä¸»é¢˜å†… source&#x2F;images&#x2F;ï¼Œå›¾ç‰‡é“¾æ¥åœ°å€å¯ä»¥å¡« &#x2F;images&#x2F;avatar.png  ç„¶ååœ¨å½“å‰ä¸»é¢˜çš„_config.yml ä¸æ˜¯æ ¹ç›®å½•çš„_config.ymlï¼ˆå¦‚æœä½ æ¢äº†ä¸»é¢˜ï¼Œéœ€è¦æ ¹æ®è‡ªå·±é€‰æ‹©çš„ä¸»é¢˜è¿›å…¥é‡Œé¢å»è®¾ç½®ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Sidebar Avatar</span><br><span class="line"># in theme directory(source/images): /images/avatar.jpg</span><br><span class="line"># in site  directory(source/uploads): /uploads/avatar.jpg</span><br><span class="line">avatar: /images/avatar.jpg</span><br></pre></td></tr></table></figure>
<p>ä¸ªäººä¸­å¿ƒé…ç½®ï¼šï¼ˆæ ¹ç›®å½•çš„_config.ymlï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Site</span><br><span class="line">title: Gavin</span><br><span class="line">subtitle: è®°å½•æˆé•¿è¿‡ç¨‹ä¸­çš„ç‚¹ç‚¹æ»´æ»´</span><br><span class="line">description: æˆ‘çˆ±æ•æ•</span><br><span class="line">author: kindyourself@163.com</span><br><span class="line">language: zh-Hans</span><br><span class="line">timezone:</span><br></pre></td></tr></table></figure>
<p>æ˜¾ç¤ºæ ‡ç­¾ä¸åˆ†ç±»ï¼šå–æ¶ˆå¯¹åº”æ³¨é‡Š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># When running the site in a subdirectory (e.g. domain.tld/blog), remove the leading slash (/archives -&gt; archives)</span><br><span class="line">menu:</span><br><span class="line">  home: /</span><br><span class="line">  categories: /categories</span><br><span class="line">  #about: /about</span><br><span class="line">  archives: /archives</span><br><span class="line">  tags: /tags</span><br><span class="line">  #commonweal: /404.html</span><br></pre></td></tr></table></figure>
<p>ç„¶ååˆ›å»ºåˆ†ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo new page &quot;categories&quot;</span><br></pre></td></tr></table></figure>
<p>åœ¨&#x2F;source&#x2F;categoriesä¸‹æœ‰ä¸ªindex.md æŒ‰ç…§å¦‚ä¸‹å¡«å†™ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: categories</span><br><span class="line">date: 2016-07-16 02:21:37</span><br><span class="line">type: &quot;categories&quot;</span><br><span class="line">comments: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>ä»¥ååœ¨å†™æ–‡ç« çš„æ—¶å€™åŠ ä¸Šåˆ†ç±»å°±ä¼šè‡ªåŠ¨åˆ›å»ºåˆ†ç±»äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">layout: &#x27;[layout]&#x27;</span><br><span class="line">title: iOS-è‡ªå®šä¹‰å¸¦æŠ½å±‰æ•ˆæœçš„tabBar</span><br><span class="line">date: 2016-07-12 23:19:35</span><br><span class="line">tags: [è‡ªå®šä¹‰ï¼ŒæŠ½å±‰ï¼ŒtabBar]</span><br><span class="line">categories: &quot;iOS&quot; // åˆ†ç±»</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºæ ‡ç­¾</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo new page &quot;tags&quot;</span><br></pre></td></tr></table></figure>
<p>åœ¨&#x2F;source&#x2F;tagsä¸‹æœ‰ä¸ªindex.md æŒ‰ç…§å¦‚ä¸‹å¡«å†™ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title: All tags</span><br><span class="line">date: 2016-07-16 02:11:12</span><br><span class="line">type: &quot;tags&quot;</span><br><span class="line">comments: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<p>ä»¥ååœ¨å†™æ–‡ç« çš„æ—¶å€™åŠ ä¸Šæ ‡ç­¾å°±ä¼šè‡ªåŠ¨è®¡å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">layout: &#x27;[layout]&#x27;</span><br><span class="line">title: iOS-è‡ªå®šä¹‰å¸¦æŠ½å±‰æ•ˆæœçš„tabBar</span><br><span class="line">date: 2016-07-12 23:19:35</span><br><span class="line">tags: [è‡ªå®šä¹‰ï¼ŒæŠ½å±‰ï¼ŒtabBar] // æ ‡ç­¾</span><br><span class="line">categories: &quot;iOS&quot;</span><br><span class="line">---</span><br></pre></td></tr></table></figure>
<p>ä¸‹è½½ä¸»é¢˜ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/iissnan/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure>

<h3 id="7-æ€»ç»“"><a href="#7-æ€»ç»“" class="headerlink" title="7. æ€»ç»“"></a>7. æ€»ç»“</h3><blockquote>
<p>è¿™ä¸ªåœ¨ç½‘ä¸Šè¿˜æœ‰å¾ˆå¤šå¾ˆè¯¦ç»†çš„æ•™ç¨‹ï¼Œè¿™æ˜¯æˆ‘çš„å¤§è‡´æ“ä½œæµç¨‹ã€‚æ„Ÿè§‰è¿™ä¸ªå¯ä»¥å¾ˆç®€å•ï¼Œå°±æ˜¯å°‘å»åŠ¨åŸç”Ÿçš„ã€‚å¦‚æœä½ æƒ³è¦å»æ£é¼“ä¼šå‘ç°è¿˜æ˜¯æœ‰å¾ˆå¤šå¯ä»¥æ£é¼“çš„ï¼Œå› ä¸ºä»–æœ‰å¾ˆå¤šçš„å‚æ•°å¯ä»¥é…ç½®ã€‚æˆ‘åªæ˜¯é…ç½®äº†ä¸€ä¸‹æˆ‘è§‰å¾—åœ¨æˆ‘çœ‹æ¥é‡è¦çš„ã€‚æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥å»æ£é¼“æ£é¼“ã€‚-å¤ªæ™šäº†ï¼Œéƒ½4ç‚¹äº†ï¼Œç¡è§‰å»</p>
</blockquote>
]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>â€œhexoâ€</tag>
        <tag>â€œä¸ªäººåšå®¢â€</tag>
        <tag>â€œgitHubâ€</tag>
      </tags>
  </entry>
  <entry>
    <title>Flutter-è¯¦è§£å¸ƒå±€</title>
    <url>/2025/07/07/Flutter-%E8%AF%A6%E8%A7%A3%E5%B8%83%E5%B1%80/</url>
    <content><![CDATA[<blockquote>
<p>ä¸Šä¸€ç« æˆ‘ä»¬è¯¦ç»†çš„å­¦ä¹ äº† Flutter ä¸­çš„<a href="https://www.jianshu.com/p/c6fe1cf0ff45">Widget</a>ï¼Œè¿™ä¸€ç« æˆ‘ä»¬å°†è¦å­¦ä¹  Flutter çš„<code>å¸ƒå±€</code>ï¼Œ åœ¨ä¸Šä¸€ç« æˆ‘ä»¬äº†è§£åˆ°äº†ï¼šEverything is a widgetï¼Œåœ¨ Flutter ä¸­å‡ ä¹æ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯ä¸€ä¸ª <code>Widget</code> ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬å¸ƒå±€ï¼ŒFlutter çš„å¸ƒå±€ç³»ç»ŸåŸºäº <code>Widget </code>æ ‘ï¼Œé€šè¿‡ç»„åˆä¸åŒçš„å¸ƒå±€ <code>Widget</code> å®ç°å¤æ‚çš„ UIï¼Œä½ åœ¨ Flutter åº”ç”¨ç¨‹åºä¸­èƒ½ç›´æ¥çœ‹åˆ°çš„å›¾åƒï¼Œå›¾æ ‡å’Œæ–‡æœ¬éƒ½æ˜¯ <code>Widget</code>ã€‚æ­¤å¤–ä¸èƒ½ç›´æ¥çœ‹åˆ°çš„ä¹Ÿæ˜¯ <code>Widget</code>ï¼Œå¦‚ç”¨æ¥æ’åˆ—ã€é™åˆ¶å’Œå¯¹é½å¯è§ <code>Widget</code> çš„è¡Œã€åˆ—å’Œç½‘æ ¼ã€‚</p>
</blockquote>
<p><a href="https://github.com/GavinCarter1991/flutter-layout-demo">DEMO</a></p>
<h1 id="å¸ƒå±€è§„åˆ™"><a href="#å¸ƒå±€è§„åˆ™" class="headerlink" title="å¸ƒå±€è§„åˆ™"></a>å¸ƒå±€è§„åˆ™</h1><p><strong>1.çº¦æŸç”±çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ å¯¼ï¼Œå¤§å°ç”±å­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä¼ å¯¼ï¼Œä½ç½®ç”±çˆ¶ç»„ä»¶å†³å®šã€‚</strong></p>
<p><strong>2.å¸ƒå±€Widgetæ˜¯Flutter UIçš„åŸºç¡€ï¼Œç†è§£å®ƒä»¬çš„è§„åˆ™å’Œé€‚ç”¨åœºæ™¯éå¸¸é‡è¦</strong></p>
<h1 id="æ ¸å¿ƒå¸ƒå±€æ§ä»¶-å¤šå­ç»„ä»¶"><a href="#æ ¸å¿ƒå¸ƒå±€æ§ä»¶-å¤šå­ç»„ä»¶" class="headerlink" title="æ ¸å¿ƒå¸ƒå±€æ§ä»¶ (å¤šå­ç»„ä»¶)"></a>æ ¸å¿ƒå¸ƒå±€æ§ä»¶ (å¤šå­ç»„ä»¶)</h1><h2 id="1-Row-amp-Column"><a href="#1-Row-amp-Column" class="headerlink" title="1. Row &amp; Column"></a>1. Row &amp; Column</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> Rowæ°´å¹³æ’åˆ—å­Widgetï¼ŒColumnå‚ç›´æ’åˆ—å­Widget</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> å­Widgetå¯ä»¥æ˜¯éå¼¹æ€§ï¼ˆä¸æ‰©å±•ï¼‰æˆ–å¼¹æ€§ï¼ˆExpandedï¼‰ã€‚ä¸»è½´-mainAxisAlignmentï¼ˆRow ä¸º X è½´ï¼ŒColumn ä¸º Y è½´ï¼‰å’Œäº¤å‰è½´-crossAxisAlignmentï¼ˆRow ä¸º Y è½´ï¼ŒColumn ä¸º X è½´ï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong></p>
</li>
<li><p>1.å½“å­Widgetçš„æ€»é•¿åº¦è¶…è¿‡ä¸»è½´é•¿åº¦æ—¶ï¼Œä¼šæº¢å‡ºï¼ˆå¸¸è§é”™è¯¯ï¼šé»„è‰²é»‘è‰²æ¡çº¹è­¦å‘Šï¼‰ã€‚å¯ä»¥ä½¿ç”¨Expandedæˆ–Flexibleæ¥é¿å…ï¼Œæˆ–è€…ä½¿ç”¨ListViewä»£æ›¿</p>
</li>
<li><p>2.å¦‚æœæ²¡æœ‰æŒ‡å®šä¸»è½´å¯¹é½æ–¹å¼ï¼ˆmainAxisAlignmentï¼‰å’Œäº¤å‰è½´å¯¹é½æ–¹å¼ï¼ˆcrossAxisAlignmentï¼‰ï¼Œé»˜è®¤æ˜¯startå’Œstretch</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ç”¨äºçº¿æ€§æ’åˆ—å¤šä¸ªå­Widgetï¼Œå¦‚ï¼šå¯¼èˆªæ ï¼ˆRowï¼‰ã€è¡¨å•é¡¹åˆ—è¡¨ï¼ˆColumnï¼‰ã€å›¾æ–‡æ··æ’ï¼ˆRow + Column åµŒå¥—ï¼‰ï¼Œå¦‚æœå­Widgetè¾ƒå¤šä¸”å¯èƒ½è¶…å‡ºå±å¹•ï¼Œè€ƒè™‘ä½¿ç”¨ListViewã€‚</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Row(</span><br><span class="line">  mainAxisAlignment: MainAxisAlignment.spaceBetween, // ä¸»è½´å‡åŒ€åˆ†å¸ƒ</span><br><span class="line">      crossAxisAlignment: CrossAxisAlignment.center, // äº¤å‰è½´å±…ä¸­</span><br><span class="line">  children: [</span><br><span class="line">    Container(width: 50, height: 50, color: Colors.red),</span><br><span class="line">    Expanded(child: Container(height: 30, color: Colors.green)), // å¼¹æ€§å¡«å……å‰©ä½™ç©ºé—´</span><br><span class="line">    Container(width: 50, height: 50, color: Colors.blue),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-0f77998e7ccc506f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ROW"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Column(</span><br><span class="line">  mainAxisAlignment: MainAxisAlignment.spaceBetween, // ä¸»è½´å‡åŒ€åˆ†å¸ƒ</span><br><span class="line">      crossAxisAlignment: CrossAxisAlignment.center, // äº¤å‰è½´å±…ä¸­</span><br><span class="line">  children: [</span><br><span class="line">    Container(width: 50, height: 50, color: Colors.red),</span><br><span class="line">    Expanded(child: Container(height: 30, color: Colors.green)), // å¼¹æ€§å¡«å……å‰©ä½™ç©ºé—´</span><br><span class="line">    Container(width: 50, height: 50, color: Colors.blue),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-9d2e8d107c3b5f44.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Column"></p>
<h2 id="2-Stack"><a href="#2-Stack" class="headerlink" title="2. Stack"></a>2. Stack</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> å°†å­Widgeté‡å åœ¨ä¸€èµ·ã€‚ç¬¬ä¸€ä¸ªå­Widgetåœ¨åº•éƒ¨ï¼Œåé¢çš„ä¾æ¬¡åœ¨ä¸Šå±‚</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> å­Widgetå¯ä»¥ä½¿ç”¨Positionedæ¥å®šä½ï¼Œå¦åˆ™æ”¾ç½®åœ¨å·¦ä¸Šè§’ã€‚å¦‚æœæ²¡æœ‰å®šä½ï¼Œåˆ™æ ¹æ®alignmentå±æ€§å¯¹é½ï¼ˆé»˜è®¤å·¦ä¸Šè§’ï¼‰,å­ Widget é¡ºåºå†³å®šç»˜åˆ¶é¡ºåºï¼ˆåç»˜åˆ¶çš„åœ¨ä¸Šå±‚ï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> å¦‚æœä¸ä½¿ç”¨Positionedï¼Œä¸”Stackæ²¡æœ‰æŒ‡å®šå¤§å°ï¼Œé‚£ä¹ˆStackä¼šè°ƒæ•´åˆ°åŒ…è£¹æ‰€æœ‰æœªå®šä½çš„å­Widgetï¼ˆä½†å¦‚æœæœ‰å®šä½çš„å­Widgetï¼Œåˆ™å®šä½çš„å­Widgetä¸å½±å“Stackå¤§å°ï¼‰, Positioned çš„å­ Widget å¯èƒ½è¶…å‡º Stack è¾¹ç•Œï¼ˆéœ€ <code>Clip</code> å¤„ç†ï¼‰</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ç”¨äºéœ€è¦é‡å çš„å¸ƒå±€ï¼Œå¦‚å›¾ç‰‡ä¸Šçš„æ ‡ç­¾ã€æµ®åŠ¨æŒ‰é’®ã€è‡ªå®šä¹‰è¿›åº¦æ¡</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Stack(</span><br><span class="line">  alignment: Alignment.center, // æ‰€æœ‰å­Widgetå±…ä¸­</span><br><span class="line">  children: [</span><br><span class="line">    Container(width: 200, height: 200, color: Colors.blue), // åº•å±‚</span><br><span class="line">    Positioned(</span><br><span class="line">      bottom: 10,</span><br><span class="line">      right: 10,</span><br><span class="line">      child: Container(width: 50, height: 50, color: Colors.red), // å®šä½åˆ°å³ä¸‹</span><br><span class="line">    ),</span><br><span class="line">    const Text(&quot;Stack Example&quot;), // æ–‡å­—å±…ä¸­</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-aa664a2dba537c26.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Stack"></p>
<h2 id="3-Wrap"><a href="#3-Wrap" class="headerlink" title="3. Wrap"></a>3. Wrap</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> å½“ä¸€è¡Œï¼ˆæˆ–ä¸€åˆ—ï¼‰æ”¾ä¸ä¸‹å­Widgetæ—¶ï¼Œè‡ªåŠ¨æ¢è¡Œï¼ˆæˆ–æ¢åˆ—ï¼‰</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> å¯ä»¥è®¾ç½®æ–¹å‘ï¼ˆæ°´å¹³æˆ–å‚ç›´ï¼‰ã€é—´è·ï¼ˆspacing-ä¸»è½´æ–¹å‘é—´è·ï¼‰å’Œè¡Œé—´è·ï¼ˆrunSpacing-äº¤å‰è½´æ–¹å‘è¡Œé—´è·ï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> ä¸Rowä¸åŒï¼ŒWrapä¸ä¼šæº¢å‡ºï¼Œè€Œæ˜¯æ¢è¡Œã€‚ä½†è¦æ³¨æ„å¦‚æœå­Widgetå¾ˆå¤§ä¸”æ²¡æœ‰è¶³å¤Ÿç©ºé—´ï¼Œå¯èƒ½ä¼šè¶…å‡ºå±å¹•ï¼ˆåœ¨æ¢è¡Œæ–¹å‘ï¼‰ï¼ŒæŒ‰éœ€æ¢è¡Œï¼Œé¿å…æº¢å‡ºï¼Œå­ Widget æ•°é‡æå¤§æ—¶åº”ç”¨ Wrap.builderï¼Œè®¡ç®—é—´è·ä¸è¦å¿½ç•¥ spacing å’Œ runSpacing ä¸ç„¶å®¹æ˜“å¯¼è‡´å¸ƒå±€é‡å </p>
</li>
<li><p><strong>æ¨èï¼š</strong> ç”¨äºæµå¼å¸ƒå±€ï¼Œå¦‚æ ‡ç­¾åˆ—è¡¨ã€ç­›é€‰æ¡ä»¶æ ã€è‡ªé€‚åº”æŒ‰é’®ç»„</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Wrap(</span><br><span class="line">  spacing: 8.0, // æ°´å¹³é—´è·</span><br><span class="line">  runSpacing: 4.0, // å‚ç›´é—´è·ï¼ˆè¡Œé—´è·ï¼‰</span><br><span class="line">  children: [</span><br><span class="line">    Chip(label: Text(&#x27;æ ‡ç­¾1&#x27;)),</span><br><span class="line">    Chip(label: Text(&#x27;æ ‡ç­¾2&#x27;)),</span><br><span class="line">    Chip(label: Text(&#x27;æ ‡ç­¾3&#x27;)),</span><br><span class="line">    Chip(label: Text(&#x27;æ ‡ç­¾4&#x27;)),</span><br><span class="line">    Chip(label: Text(&#x27;æ ‡ç­¾5&#x27;)),</span><br><span class="line">    Chip(label: Text(&#x27;æ ‡ç­¾6&#x27;)),</span><br><span class="line">    Chip(label: Text(&#x27;æ ‡ç­¾7&#x27;)),</span><br><span class="line">    Chip(label: Text(&#x27;æ ‡ç­¾8&#x27;)),</span><br><span class="line">    Chip(label: Text(&#x27;æ ‡ç­¾9&#x27;)),</span><br><span class="line">    Chip(label: Text(&#x27;æ ‡ç­¾10&#x27;)),</span><br><span class="line">    Chip(label: Text(&#x27;æ ‡ç­¾11&#x27;)),</span><br><span class="line">    Chip(label: Text(&#x27;æ ‡ç­¾12&#x27;)),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-c4a8a811e079ba1d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Wrap"></p>
<h2 id="4-Flow"><a href="#4-Flow" class="headerlink" title="4. Flow"></a>4. Flow</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> </p>
</li>
<li><p>1.Flow éœ€è¦è‡ªå®šä¹‰å¸ƒå±€é€»è¾‘æ—¶ä½¿ç”¨ï¼Œé€šè¿‡delegateæ§åˆ¶æ¯ä¸ªå­Widgetçš„ä½ç½®å’Œå¤§å°ã€‚æ€§èƒ½è¾ƒå¥½ï¼Œå› ä¸ºå­Widgetå¯ä»¥ç‹¬ç«‹å®šä½è€Œä¸å½±å“çˆ¶Widget</p>
</li>
<li><p>2.åŠ¨æ€å¢å‡å­å…ƒç´ ï¼šåœ¨delegateä¸­ç›‘å¬æ•°æ®å˜åŒ–ï¼Œè°ƒç”¨context.invalidateLayout()é‡å¸ƒå±€</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> Flowï¼šé«˜æ€§èƒ½è‡ªå®šä¹‰å¸ƒå±€ï¼ˆéœ€å®ç° FlowDelegateï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> é€šè¿‡å§”æ‰˜è®¡ç®—ï¼ˆdelegate-calculatedï¼‰å®ç°åŠ¨æ€è‡ªé€‚åº”ï¼Œèƒœä»»å¤æ‚åœºæ™¯ï¼Œå½“å¸ƒå±€å¤æ‚åº¦ä½æ—¶ï¼Œä¼˜å…ˆç”¨Wrapç®€åŒ–å¼€å‘</p>
</li>
<li><p><strong>æ¨èï¼š</strong> å¤æ‚åŠ¨ç”»å¸ƒå±€ï¼Œé¿å…Wrapçš„å¤šæ¬¡æµ‹é‡ï¼Œé€‚åˆåŠ¨æ€åŠ è½½&#x2F;é«˜é¢‘æ›´æ–°åœºæ™¯</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class MyFlowDelegate extends FlowDelegate &#123;</span><br><span class="line">  @override</span><br><span class="line">  void paintChildren(FlowPaintingContext context) &#123;</span><br><span class="line">    var x = 0.0, y = 0.0;</span><br><span class="line">    for (var i = 0; i &lt; context.childCount; i++) &#123;</span><br><span class="line">      // åŠ¨æ€è®¡ç®—æ¯ä¸ªå­ç»„ä»¶ä½ç½®</span><br><span class="line">      final childSize = context.getChildSize(i)!;</span><br><span class="line">      context.paintChild(i, transform: Matrix4.translationValues(x, y, 0));</span><br><span class="line">      x += childSize.width * 0.8; // é‡å æ•ˆæœ</span><br><span class="line">      y += childSize.height * 0.2;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  bool shouldRepaint(covariant FlowDelegate oldDelegate) =&gt; true;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Flow(</span><br><span class="line">  delegate: MyFlowDelegate(),</span><br><span class="line">  children: List.generate(</span><br><span class="line">      5,</span><br><span class="line">      (index) =&gt; Container(</span><br><span class="line">            width: 80,</span><br><span class="line">            height: 80,</span><br><span class="line">            color: Colors.primaries[index],</span><br><span class="line">          )),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-ce736ecf89cfae2b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Flow"></p>
<span id="more"></span>


<h2 id="5-ListView"><a href="#5-ListView" class="headerlink" title="5. ListView"></a>5. ListView</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> å¯æ»šåŠ¨çš„çº¿æ€§å¸ƒå±€ï¼Œæ”¯æŒæ°´å¹³å’Œå‚ç›´æ–¹å‘</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> å¦‚æœå­Widgetæ•°é‡å›ºå®šï¼Œä½¿ç”¨ListView(children: [â€¦])ï¼Œå¦‚æœæ•°é‡å¤šï¼Œä½¿ç”¨ListView.builderæŒ‰éœ€æ„å»º</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> ç›´æ¥ä½¿ç”¨childrenæ–¹å¼æ„å»ºå¤§é‡å­Widgetä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºä¼šä¸€æ¬¡æ€§æ„å»ºæ‰€æœ‰å­Widgetã€‚å¯¹äºé•¿åˆ—è¡¨ï¼ŒåŠ¡å¿…ä½¿ç”¨builderï¼ŒåµŒå¥— ListView æ—¶éœ€æ˜ç¡®æ»šåŠ¨æ–¹å‘</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ç”¨äºéœ€è¦æ»šåŠ¨çš„åˆ—è¡¨ï¼Œä¾‹å¦‚æ¶ˆæ¯åˆ—è¡¨ã€è®¾ç½®èœå•ã€é•¿æ•°æ®å±•ç¤º</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ListView.builder(</span><br><span class="line">    itemCount: 100,</span><br><span class="line">    itemBuilder: (context, index) &#123;</span><br><span class="line">      return ListTile(</span><br><span class="line">        title: Text(&#x27;Item $index&#x27;),</span><br><span class="line">      );</span><br><span class="line">    &#125;,</span><br><span class="line">  )</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-3fe3070d3e246234.gif?imageMogr2/auto-orient/strip" alt="ListView"></p>
<h2 id="6-GridView"><a href="#6-GridView" class="headerlink" title="6. GridView"></a>6. GridView</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ç½‘æ ¼å¸ƒå±€</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> æœ‰å¤šç§æ„é€ æ–¹å¼ï¼šGridView.countï¼ˆå›ºå®šåˆ—æ•°ï¼‰ã€GridView.extentï¼ˆå›ºå®šæœ€å¤§äº¤å‰è½´é•¿åº¦ï¼‰ã€GridView.builderï¼ˆæŒ‰éœ€æ„å»ºï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> åŒæ ·è¦æ³¨æ„æ€§èƒ½ï¼Œé•¿åˆ—è¡¨ä½¿ç”¨builderï¼Œè¦æ­£ç¡®è®¾ç½® childAspectRatio ä¸ç„¶å®¹æ˜“å¯¼è‡´å•å…ƒæ ¼å˜å½¢</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ç”¨äºå±•ç¤ºç½‘æ ¼çŠ¶å†…å®¹ï¼Œå¦‚å›¾ç‰‡å¢™ã€äº§å“ç½‘æ ¼ã€ä»ªè¡¨ç›˜å¡ç‰‡</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var array = [Colors.blue, Colors.red, Colors.yellow];</span><br><span class="line">GridView.count(</span><br><span class="line">  crossAxisCount: 3, // æ¯è¡Œ3åˆ—</span><br><span class="line">  childAspectRatio: 1.0, // å®½é«˜æ¯”</span><br><span class="line">  children: List.generate(</span><br><span class="line">      9,</span><br><span class="line">      (index) =&gt; Container(</span><br><span class="line">            decoration: BoxDecoration(</span><br><span class="line">              color: array[index % 3],</span><br><span class="line">              borderRadius: BorderRadius.circular(8.0),</span><br><span class="line">            ),</span><br><span class="line">            child: Center(child: Text(&#x27;Item $index&#x27;)),</span><br><span class="line">          )),</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-d7cab59e26a42a4c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="GridView"></p>
<h2 id="7-Table"><a href="#7-Table" class="headerlink" title="7. Table"></a>7. Table</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> æ˜¯ä¸€ç§åŸºäºè¡¨æ ¼æ¨¡å‹çš„å¸ƒå±€æ–¹å¼</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> æ¯ä¸€è¡Œçš„é«˜åº¦ç”±å†…å®¹å†³å®šï¼Œåˆ—å®½å¯é€šè¿‡ columnWidths å±æ€§è‡ªå®šä¹‰ã€‚<br>æ”¯æŒå¤šç§åˆ—å®½ç±»å‹ï¼šFixedColumnWidthï¼ˆå›ºå®šå®½åº¦ï¼‰ã€FlexColumnWidthï¼ˆå¼¹æ€§æ¯”ä¾‹ï¼‰ã€FractionColumnWidthï¼ˆç™¾åˆ†æ¯”ï¼‰ç­‰ï¼Œé€šè¿‡ rowHeight å±æ€§è®¾ç½®å›ºå®šè¡Œé«˜ï¼Œæˆ–é€šè¿‡ TableRow çš„ height å±æ€§å•ç‹¬è°ƒæ•´æŸä¸€è¡Œï¼Œåœ¨ TableRow ä¸­åµŒå¥— Rowã€Column æˆ–å…¶ä»–å¸ƒå±€ç»„ä»¶ï¼Œå®ç°å¤æ‚å†…å®¹æ’ç‰ˆï¼Œé€šè¿‡ MediaQuery åŠ¨æ€è°ƒæ•´åˆ—å®½æ¯”ä¾‹ï¼Œé€‚é…ä¸åŒå±å¹•å°ºå¯¸</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> é¿å…åœ¨å¤§é‡æ•°æ®ä¸­ç›´æ¥ä½¿ç”¨ Tableï¼Œæ¨èç»“åˆ ListView æˆ– CustomScrollView åˆ†é¡µåŠ è½½</p>
</li>
<li><p><strong>æ¨èï¼š</strong> é€‚ç”¨äºéœ€è¦è¡Œåˆ—å¯¹é½çš„å¤æ‚åœºæ™¯ï¼ŒStack + Tableï¼šåœ¨è¡¨æ ¼ä¸­å åŠ å…¶ä»–ç»„ä»¶ï¼ˆå¦‚æ‚¬æµ®æŒ‰é’®ï¼‰ï¼ŒWrap + Tableï¼šç»“åˆå¼¹æ€§å¸ƒå±€å®ç°è‡ªé€‚åº”è¡¨æ ¼</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Table(</span><br><span class="line">  columnWidths: const &#123;</span><br><span class="line">    0: FixedColumnWidth(80), // ç¬¬ä¸€åˆ—å›ºå®šå®½åº¦</span><br><span class="line">    1: FlexColumnWidth(2), // ç¬¬äºŒåˆ—å¼¹æ€§å®½åº¦ï¼ˆå æ¯”æ›´å¤§ï¼‰</span><br><span class="line">    2: IntrinsicColumnWidth(), // ç¬¬ä¸‰åˆ—è‡ªé€‚åº”å†…å®¹å®½åº¦</span><br><span class="line">  &#125;,</span><br><span class="line">  border: TableBorder.all(color: Colors.black, width: 1.0),</span><br><span class="line">  defaultVerticalAlignment: TableCellVerticalAlignment.middle, // å‚ç›´å±…ä¸­</span><br><span class="line">  children: const [</span><br><span class="line">    TableRow(</span><br><span class="line">      // è¡¨å¤´è¡Œ</span><br><span class="line">      decoration: BoxDecoration(color: Colors.grey),</span><br><span class="line">      children: [</span><br><span class="line">        Text(&#x27;å§“å&#x27;, textAlign: TextAlign.center),</span><br><span class="line">        Text(&#x27;æ€§åˆ«&#x27;, textAlign: TextAlign.center),</span><br><span class="line">        Text(&#x27;å¹´é¾„&#x27;, textAlign: TextAlign.center),</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">    TableRow(</span><br><span class="line">      // æ•°æ®è¡Œ</span><br><span class="line">      children: [</span><br><span class="line">        Text(&#x27;å¼ ä¸‰&#x27;),</span><br><span class="line">        Text(&#x27;ç”·&#x27;),</span><br><span class="line">        Text(&#x27;25&#x27;),</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-fc6e105cb97388d9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Table"></p>
<h2 id="8-CustomScrollView"><a href="#8-CustomScrollView" class="headerlink" title="8. CustomScrollView"></a>8. CustomScrollView</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> æ˜¯ Flutter å¤„ç†å¤æ‚æ»šåŠ¨åœºæ™¯çš„æ ¸å¿ƒå·¥å…·ï¼Œé€šè¿‡çµæ´»ç»„åˆ Sliver ç»„ä»¶ï¼Œå¯å®ç°å¤´éƒ¨æŠ˜å ã€å¤šç±»å‹å¸ƒå±€ã€å¸é¡¶ç­‰é«˜çº§äº¤äº’ï¼Œ</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> æ‰€æœ‰å­ç»„ä»¶å…±äº«åŒä¸€ä¸ªæ»šåŠ¨æ§åˆ¶å™¨ï¼Œç¡®ä¿è”åŠ¨æ»‘åŠ¨ï¼Œä»…æ¸²æŸ“å¯è§åŒºåŸŸçš„ Sliverï¼Œå…¶å­ç»„ä»¶å¿…é¡»æ˜¯ Sliver å®¶æ—æˆå‘˜ï¼ˆå¦‚ SliverListã€SliverGridã€SliverToBoxAdapter ç­‰ï¼‰ï¼Œæ™®é€šç»„ä»¶éœ€é€šè¿‡ SliverToBoxAdapter åŒ…è£¹æ‰èƒ½åµŒå…¥</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> Sliver çš„ä½¿ç”¨è§„èŒƒåŠæ€§èƒ½ä¼˜åŒ–ï¼Œå¿…è¦æ—¶ç»“åˆ <code>NestedScrollView</code> è§£å†³åµŒå¥—æ»šåŠ¨é—®é¢˜ï¼Œé¿å…åµŒå¥—æ»šåŠ¨ç»„ä»¶</p>
</li>
<li><p><strong>æ¨èï¼š</strong> å®ç°ç»Ÿä¸€ä¸”å¤æ‚çš„æ»šåŠ¨æ•ˆæœã€‚å®ƒåƒâ€œç²˜åˆå‰‚â€ä¸€æ ·å°†ä¸åŒå¸ƒå±€ç²˜åˆä¸ºæ•´ä½“æ»šåŠ¨åŒºåŸŸï¼Œè§£å†³åµŒå¥—æ»šåŠ¨å†²çªé—®é¢˜ï¼ˆä¾‹å¦‚ ListView åµŒå¥— GridView éœ€æ‰‹åŠ¨æŒ‡å®šé«˜åº¦ï¼‰</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Table(</span><br><span class="line">  columnWidths: const &#123;</span><br><span class="line">    0: FixedColumnWidth(80), // ç¬¬ä¸€åˆ—å›ºå®šå®½åº¦</span><br><span class="line">    1: FlexColumnWidth(2), // ç¬¬äºŒåˆ—å¼¹æ€§å®½åº¦ï¼ˆå æ¯”æ›´å¤§ï¼‰</span><br><span class="line">    2: IntrinsicColumnWidth(), // ç¬¬ä¸‰åˆ—è‡ªé€‚åº”å†…å®¹å®½åº¦</span><br><span class="line">  &#125;,</span><br><span class="line">  border: TableBorder.all(color: Colors.black, width: 1.0),</span><br><span class="line">  defaultVerticalAlignment: TableCellVerticalAlignment.middle, // å‚ç›´å±…ä¸­</span><br><span class="line">  children: const [</span><br><span class="line">    TableRow(</span><br><span class="line">      // è¡¨å¤´è¡Œ</span><br><span class="line">      decoration: BoxDecoration(color: Colors.grey),</span><br><span class="line">      children: [</span><br><span class="line">        Text(&#x27;å§“å&#x27;, textAlign: TextAlign.center),</span><br><span class="line">        Text(&#x27;æ€§åˆ«&#x27;, textAlign: TextAlign.center),</span><br><span class="line">        Text(&#x27;å¹´é¾„&#x27;, textAlign: TextAlign.center),</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">    TableRow(</span><br><span class="line">      // æ•°æ®è¡Œ</span><br><span class="line">      children: [</span><br><span class="line">        Text(&#x27;å¼ ä¸‰&#x27;),</span><br><span class="line">        Text(&#x27;ç”·&#x27;),</span><br><span class="line">        Text(&#x27;25&#x27;),</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-d7b7599d3b1a3a9f.gif?imageMogr2/auto-orient/strip" alt="CustomScrollView"></p>
<h2 id="9-IndexedStack"><a href="#9-IndexedStack" class="headerlink" title="9. IndexedStack"></a>9. IndexedStack</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> IndexedStack æ˜¯ Stack çš„å­ç±»ï¼ˆextends Stackï¼‰ï¼Œæ˜¯ä¸€ç§å±‚å å¸ƒå±€ç»„ä»¶ï¼Œä¸“é—¨ç”¨äºåœ¨åŒä¸€ä½ç½®åˆ‡æ¢æ˜¾ç¤ºä¸åŒå­ç»„ä»¶</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> IndexedStack ç»§æ‰¿è‡ª Stack ç»„ä»¶ï¼Œé€šè¿‡ index å±æ€§æ§åˆ¶å½“å‰æ˜¾ç¤ºçš„å­ç»„ä»¶ã€‚ä¸ Stack çš„å åŠ æ˜¾ç¤ºä¸åŒï¼ŒIndexedStack ä»…æ¸²æŸ“æŒ‡å®šç´¢å¼•çš„å­é¡¹ï¼Œå…¶ä»–å­é¡¹å¤„äºéšè—çŠ¶æ€ï¼Œå°ºå¯¸ç”±æœ€å¤§çš„å­ç»„ä»¶å†³å®šï¼Œä¸å½“å‰æ˜¾ç¤ºçš„ index æ— å…³ã€‚æ”¯æŒ alignment å¯¹é½å±æ€§ï¼Œå¯ç»“åˆ Positioned å®ç°ç²¾ç¡®å®šä½ï¼Œæ‰€æœ‰å­ç»„ä»¶ä¼šé¢„å…ˆåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œé€‚åˆéœ€è¦ä¿æŒé¢çŠ¶æ€çš„åœºæ™¯ï¼ˆå¦‚ Tab åˆ‡æ¢ï¼‰ã€‚é€šè¿‡ Offstage éšè—éæ´»è·ƒå­é¡¹ï¼Œè€Œéé”€æ¯</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> å­ç»„ä»¶è¿‡å¤šæˆ–å¤æ‚æ—¶å¯èƒ½å¼•å‘å†…å­˜å‹åŠ›ï¼Œé€šè¿‡ setState ä¿®æ”¹ index å®ç°æ— åŠ¨ç”»åˆ‡æ¢ï¼Œé€‚åˆé«˜é¢‘æ“ä½œåœºæ™¯ï¼Œå¯é€šè¿‡ RepaintBoundary ä¼˜åŒ–ç»˜åˆ¶æ€§èƒ½ï¼Œéœ€è¦ç²¾ç¡®å®šä½æ—¶ï¼Œæ¨èç»„åˆä½¿ç”¨ Positioned è€Œé Align</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ä¼˜å…ˆç”¨äºå°‘é‡å­é¡¹çš„åœºæ™¯ï¼Œå¤æ‚é¡µé¢å»ºè®®ç»“åˆ PageView ä½¿ç”¨</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class DynamicIndexedStack extends StatefulWidget &#123;</span><br><span class="line">  @override </span><br><span class="line">  _DynamicIndexedStackState createState() =&gt; _DynamicIndexedStackState();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">class _DynamicIndexedStackState extends State&lt;DynamicIndexedStack&gt; &#123;</span><br><span class="line">  int _currentIndex = 0;</span><br><span class="line"> </span><br><span class="line">  final List&lt;Widget&gt; _pages = [</span><br><span class="line">    PageWidget(title: &quot;é¡µé¢1&quot;, color: Colors.red), </span><br><span class="line">    PageWidget(title: &quot;é¡µé¢2&quot;, color: Colors.green), </span><br><span class="line">    PageWidget(title: &quot;é¡µé¢3&quot;, color: Colors.blue), </span><br><span class="line">  ];</span><br><span class="line"> </span><br><span class="line">  @override </span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    return Column(</span><br><span class="line">      children: [</span><br><span class="line">        // åˆ‡æ¢æŒ‰é’® </span><br><span class="line">        Row(</span><br><span class="line">          mainAxisAlignment: MainAxisAlignment.center, </span><br><span class="line">          children: [</span><br><span class="line">            _buildButton(0, &quot;é¡µé¢1&quot;),</span><br><span class="line">            _buildButton(1, &quot;é¡µé¢2&quot;),</span><br><span class="line">            _buildButton(2, &quot;é¡µé¢3&quot;),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">        </span><br><span class="line">        // IndexedStackåŒºåŸŸ </span><br><span class="line">        Expanded(</span><br><span class="line">          child: IndexedStack(</span><br><span class="line">            index: _currentIndex,</span><br><span class="line">            children: _pages,</span><br><span class="line">          ),</span><br><span class="line">        )</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  Widget _buildButton(int index, String text) &#123;</span><br><span class="line">    return ElevatedButton(</span><br><span class="line">      onPressed: () =&gt; setState(() =&gt; _currentIndex = index),</span><br><span class="line">      style: ElevatedButton.styleFrom( </span><br><span class="line">        backgroundColor: _currentIndex == index ? Colors.amber  : null,</span><br><span class="line">      ),</span><br><span class="line">      child: Text(text),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// å¸¦çŠ¶æ€çš„é¡µé¢ç»„ä»¶ï¼ˆéªŒè¯çŠ¶æ€ä¿ç•™ï¼‰</span><br><span class="line">class PageWidget extends StatefulWidget &#123;</span><br><span class="line">  final String title;</span><br><span class="line">  final Color color;</span><br><span class="line"> </span><br><span class="line">  PageWidget(&#123;required this.title,  required this.color&#125;); </span><br><span class="line"> </span><br><span class="line">  @override </span><br><span class="line">  _PageWidgetState createState() =&gt; _PageWidgetState();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">class _PageWidgetState extends State&lt;PageWidget&gt; &#123;</span><br><span class="line">  int _counter = 0;</span><br><span class="line"> </span><br><span class="line">  @override </span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    return Container(</span><br><span class="line">      color: widget.color.withOpacity(0.3), </span><br><span class="line">      child: Center(</span><br><span class="line">        child: Column(</span><br><span class="line">          mainAxisSize: MainAxisSize.min, </span><br><span class="line">          children: [</span><br><span class="line">            Text(widget.title,  style: TextStyle(fontSize: 24)),</span><br><span class="line">            ElevatedButton(</span><br><span class="line">              onPressed: () =&gt; setState(() =&gt; _counter++),</span><br><span class="line">              child: Text(&quot;è®¡æ•°: $_counter&quot;),</span><br><span class="line">            ),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-2e56190732b81b76.gif?imageMogr2/auto-orient/strip" alt="IndexedStack"></p>
<h2 id="10-Flex"><a href="#10-Flex" class="headerlink" title="10. Flex"></a>10. Flex</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> åŠ¨æ€å¢å‡å­å…ƒç´ ï¼šä½¿ç”¨Keyè§¦å‘å­æ ‘é‡å»º</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> Flexï¼šæ›´åº•å±‚çš„ Row&#x2F;Columnï¼ˆéœ€é…åˆ Flexibleï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> é€šè¿‡çº¦æŸé©±åŠ¨ï¼ˆconstraint-drivenï¼‰å®ç°ç©ºé—´æ¯”ä¾‹åˆ†é…ï¼Œé€‚åˆç»“æ„åŒ–ç•Œé¢</p>
</li>
<li><p><strong>æ¨èï¼š</strong> è‡ªå®šä¹‰æ’ç‰ˆ</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Flex(</span><br><span class="line">  // ç­‰ä»·äºColumn</span><br><span class="line">  direction: Axis.vertical,</span><br><span class="line">  children: [</span><br><span class="line">    Expanded(</span><br><span class="line">      flex: 1, // å 1/3é«˜åº¦</span><br><span class="line">      child: Container(color: Colors.red),</span><br><span class="line">    ),</span><br><span class="line">    Expanded(</span><br><span class="line">      flex: 2, // å 2/3é«˜åº¦</span><br><span class="line">      child: Container(color: Colors.blue),</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-c2b3f0670fcb1fef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Flex"></p>
<h2 id="11-ListBody"><a href="#11-ListBody" class="headerlink" title="11. ListBody"></a>11. ListBody</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> æ˜¯ä¸€ä¸ªæ²¿æŒ‡å®šè½´æ–¹å‘é¡ºåºæ’åˆ—å­ç»„ä»¶çš„å¸ƒå±€æ§ä»¶ï¼Œå…¶æ ¸å¿ƒç‰¹æ€§æ˜¯ä¸é™åˆ¶ä¸»è½´ç©ºé—´ï¼Œéœ€é…åˆçˆ¶å®¹å™¨çº¦æŸä½¿ç”¨</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> å¿…é¡»åµŒå¥—åœ¨ListViewã€Columnç­‰æœ‰ç•Œå®¹å™¨å†…ï¼Œå­ç»„ä»¶åœ¨äº¤å‰è½´ï¼ˆå¦‚æ°´å¹³æ–¹å‘ï¼‰è‡ªåŠ¨æ‹‰ä¼¸ï¼Œæ— éœ€é¢å¤–è®¾ç½®ï¼ŒListBodyä»…è´Ÿè´£çº¿æ€§æ’åˆ—ï¼Œä¸åŒ…å«æ»šåŠ¨æœºåˆ¶ï¼ŒListView &#x3D; ListBody + æ»šåŠ¨åŠŸèƒ½ï¼Œé€‚åˆé•¿åˆ—è¡¨</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> å­é¡¹æ•°é‡åŠ¨æ€æˆ–å¯èƒ½è¶…å‡ºå±å¹•æ—¶ï¼Œå¿…é¡»ç”¨ListViewæ›¿ä»£ï¼Œé¿å…å¸ƒå±€æº¢å‡ºï¼Œå­ç»„ä»¶å°ºå¯¸å˜åŒ–ä¼šè§¦å‘æ•´ä¸ªListBodyé‡æ–°å¸ƒå±€ï¼Œå½±å“æ€§èƒ½ï¼Œå¯¹åŠ¨æ€å­é¡¹ä¼˜å…ˆä½¿ç”¨ListView.builder ï¼Œä»…æ„å»ºå¯è§åŒºåŸŸç»„ä»¶</p>
</li>
<li><p><strong>æ¨èï¼š</strong> å›ºå®šæ•°é‡å­é¡¹çš„çº¿æ€§æ’åˆ—ï¼ˆå¦‚é™æ€èœå•æ ã€å¡ç‰‡ç»„ï¼‰ï¼Œéœ€çˆ¶å®¹å™¨æ˜ç¡®å°ºå¯¸çº¦æŸï¼ˆå¦‚SizedBoxã€ConstrainedBoxï¼‰</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SingleChildScrollView(</span><br><span class="line">  // æä¾›æ»šåŠ¨æ”¯æŒ</span><br><span class="line">  child: ListBody(</span><br><span class="line">    mainAxis: Axis.vertical,</span><br><span class="line">    reverse: false,</span><br><span class="line">    children: &lt;Widget&gt;[</span><br><span class="line">      Container(height: 100, color: Colors.blue[50]),</span><br><span class="line">      Container(height: 100, color: Colors.blue[100]),</span><br><span class="line">      Container(height: 100, color: Colors.blue[200]),</span><br><span class="line">    ],</span><br><span class="line">  ),</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-d9eb3bba462142d4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ListBody"></p>
<h1 id="å•å­ç»„ä»¶å¸ƒå±€æ§ä»¶"><a href="#å•å­ç»„ä»¶å¸ƒå±€æ§ä»¶" class="headerlink" title="å•å­ç»„ä»¶å¸ƒå±€æ§ä»¶"></a>å•å­ç»„ä»¶å¸ƒå±€æ§ä»¶</h1><h2 id="1-Container"><a href="#1-Container" class="headerlink" title="1. Container"></a>1. Container</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> æœ€å¸¸ç”¨çš„å¸ƒå±€ Widgetï¼Œå¯ä»¥åŒ…å«ä¸€ä¸ªå­Widgetï¼Œå¹¶å¯ä»¥è®¾ç½® paddingã€marginã€è¾¹æ¡†ã€èƒŒæ™¯ç­‰</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> å¦‚æœæ²¡æœ‰å­ Widgetï¼ŒContainer ä¼šå°½å¯èƒ½å¤§ï¼›å¦‚æœæœ‰å­ Widgetï¼Œåˆ™æ ¹æ®å­ Widget å’Œè‡ªèº«çº¦æŸè°ƒæ•´å¤§å°</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> åœ¨æ²¡æœ‰çº¦æŸçš„æƒ…å†µä¸‹ï¼ŒContainerä¼šå°½å¯èƒ½å¤§ï¼ˆæ¯”å¦‚å æ»¡æ•´ä¸ªå±å¹•ï¼‰ï¼›åœ¨æœ‰çº¦æŸçš„æƒ…å†µä¸‹ï¼ˆå¦‚çˆ¶Widgetæ˜¯Columnï¼‰ï¼ŒContainerå¦‚æœæ²¡æœ‰å­Widgetï¼Œåˆ™ä¼šæ”¶ç¼©åˆ°æ²¡æœ‰å¤§å°</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ä½œä¸ºå…¶ä»–Widgetçš„å®¹å™¨ï¼Œç”¨äºè£…é¥°æˆ–è®¾ç½®é—´è·</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Container(</span><br><span class="line">  padding: const EdgeInsets.all(8.0),</span><br><span class="line">  margin: const EdgeInsets.all(16.0),</span><br><span class="line">  decoration: BoxDecoration(</span><br><span class="line">    color: Colors.blue,</span><br><span class="line">    borderRadius: BorderRadius.circular(8.0),</span><br><span class="line">  ),</span><br><span class="line">  child: const Text(&#x27;Hello World&#x27;),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-419c86fa35335118.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Containeré¡µé¢"></p>
<h2 id="2-Padding"><a href="#2-Padding" class="headerlink" title="2. Padding"></a>2. Padding</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ç»™å­Widgetè®¾ç½®å†…è¾¹è·</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> åªæœ‰ä¸€ä¸ªå­Widget</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> ä¸Containerçš„paddingä¸åŒï¼ŒPaddingæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„Widget</p>
</li>
<li><p><strong>æ¨èï¼š</strong> å½“éœ€è¦å†…è¾¹è·ä½†ä¸éœ€è¦Containerçš„å…¶ä»–è£…é¥°æ—¶ä½¿ç”¨</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Container(</span><br><span class="line">  decoration: BoxDecoration(</span><br><span class="line">    color: Colors.blue,</span><br><span class="line">    borderRadius: BorderRadius.circular(12),</span><br><span class="line">  ),</span><br><span class="line">  child: const Padding(</span><br><span class="line">    padding: EdgeInsets.symmetric(horizontal: 24, vertical: 16),</span><br><span class="line">    child: Text(</span><br><span class="line">      &quot;Flutter Padding èƒŒæ™¯é¢œè‰²ç¤ºä¾‹&quot;,</span><br><span class="line">      style: TextStyle(color: Colors.white),</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-7fcd47aa694b5566.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Padding"></p>
<h2 id="3-Align"><a href="#3-Align" class="headerlink" title="3. Align"></a>3. Align</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> æ§åˆ¶å­Widgetåœ¨çˆ¶Widgetä¸­çš„å¯¹é½æ–¹å¼</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> é€šè¿‡alignmentå±æ€§è®¾ç½®å¯¹é½æ–¹å¼ï¼ˆå¦‚Alignment.centerï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> å¦‚æœçˆ¶Widgetæ²¡æœ‰çº¦æŸï¼ŒAlignä¼šå°½å¯èƒ½å¤§ï¼›å¦‚æœæœ‰çº¦æŸï¼Œåˆ™æ ¹æ®çº¦æŸè°ƒæ•´å¤§å°ï¼Œå¹¶å°†å­Widgetå¯¹é½</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ç”¨äºç²¾ç¡®æ§åˆ¶å­Widgetçš„ä½ç½®</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Container(</span><br><span class="line">  height: 200,</span><br><span class="line">  width: 200,</span><br><span class="line">  color: Colors.grey,</span><br><span class="line">  child: Align(</span><br><span class="line">    alignment: Alignment.bottomRight,</span><br><span class="line">    child: Container(width: 50, height: 50, color: Colors.red),</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-8ee9f7561ef7216b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Align"></p>
<h2 id="4-Center"><a href="#4-Center" class="headerlink" title="4. Center"></a>4. Center</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ç”¨äºå°†å­ç»„ä»¶åœ¨çˆ¶ç»„ä»¶ä¸­æ°´å¹³å’Œå‚ç›´å±…ä¸­æ˜¾ç¤ºï¼ˆæ˜¯Align(alignment: Alignment.center)çš„ç®€å†™ï¼‰ï¼ŒCenter ç»„ä»¶ç»§æ‰¿è‡ª Alignï¼Œå› æ­¤å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç®€åŒ–ç‰ˆçš„ Alignï¼Œä¸“é—¨ç”¨äºå±…ä¸­å¸ƒå±€</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> å¦‚æœ Center æ²¡æœ‰å­ç»„ä»¶ä¸”çˆ¶å®¹å™¨æä¾›æ— ç•Œçº¦æŸï¼ˆunboundedï¼‰ï¼Œåˆ™ Center ä¼šå°½å¯èƒ½ç¼©å°è‡ªèº«å°ºå¯¸ï¼Œå¦‚æœçˆ¶å®¹å™¨æä¾›æœ‰ç•Œçº¦æŸï¼ˆboundedï¼‰ï¼Œåˆ™ Center ä¼šæ‰©å±•åˆ°çˆ¶å®¹å™¨çš„å¤§å°ã€‚æœ‰å­ç»„ä»¶æ—¶ï¼ŒCenter çš„å°ºå¯¸ä¼šæ ¹æ®å­ç»„ä»¶çš„å¤§å°å’Œçˆ¶å®¹å™¨çš„çº¦æŸåŠ¨æ€è°ƒæ•´ã€‚<br>å¦‚æœè®¾ç½®äº† widthFactor æˆ– heightFactorï¼Œå­ç»„ä»¶çš„å°ºå¯¸ä¼šæŒ‰æ¯”ä¾‹ç¼©æ”¾ï¼ˆä¾‹å¦‚ widthFactor: 2 ä¼šä½¿å­ç»„ä»¶å®½åº¦ç¿»å€ï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> widthFactor å’Œ heightFactorç”¨äºè°ƒæ•´å­ç»„ä»¶çš„å®½åº¦å’Œé«˜åº¦æ¯”ä¾‹ï¼Œé¿å…åµŒå¥—è¿‡å¤šå±‚çº§ï¼Œå¦‚æœçˆ¶å®¹å™¨é™åˆ¶äº†å°ºå¯¸ï¼ˆå¦‚ <code>SizedBox</code>ï¼‰ï¼Œéœ€ç¡®ä¿ <code>Center</code> çš„å­ç»„ä»¶å°ºå¯¸åœ¨çº¦æŸèŒƒå›´å†…</p>
</li>
<li><p><strong>æ¨èï¼š</strong> å¿«é€Ÿå±…ä¸­å•ä¸ªç»„ä»¶ï¼Œä¸å¤æ‚å¸ƒå±€ç»“åˆï¼Œå“åº”å¼å¸ƒå±€</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Center(</span><br><span class="line">  child: Container(</span><br><span class="line">    width: 200,</span><br><span class="line">    height: 100,</span><br><span class="line">    color: Colors.blue,</span><br><span class="line">    child: const Text(</span><br><span class="line">      &quot;å±…ä¸­å†…å®¹&quot;,</span><br><span class="line">      style: TextStyle(color: Colors.white),</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-40e2db3a630d7d19.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Center"></p>
<h2 id="5-AspectRatio"><a href="#5-AspectRatio" class="headerlink" title="5. AspectRatio"></a>5. AspectRatio</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> å¼ºåˆ¶å­Widgetä¿æŒæŒ‡å®šçš„å®½é«˜æ¯”</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> éœ€è¦è®¾ç½®aspectRatioå±æ€§ï¼ˆå®½&#x2F;é«˜ï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> çˆ¶Widgetå¿…é¡»æä¾›çº¦æŸï¼Œå¦åˆ™æ— æ³•è®¡ç®—</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ç”¨äºéœ€è¦å›ºå®šå®½é«˜æ¯”çš„åœºæ™¯ï¼Œå¦‚æ’­æ”¾å™¨</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AspectRatio(</span><br><span class="line">  aspectRatio: 16 / 9,</span><br><span class="line">  child: Container(color: Colors.blue),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-7410e57ee840cd9c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="AspectRatio"></p>
<h2 id="6-ConstrainedBox"><a href="#6-ConstrainedBox" class="headerlink" title="6. ConstrainedBox"></a>6. ConstrainedBox</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> å¯¹å­Widgetæ–½åŠ é¢å¤–çš„çº¦æŸï¼ˆBoxConstraintsï¼‰</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> å¯ä»¥è®¾ç½®æœ€å°ã€æœ€å¤§å®½é«˜</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> å¦‚æœå­Widgetæœ¬èº«æœ‰çº¦æŸï¼Œå¯èƒ½ä¼šå†²çªï¼Œæ­¤æ—¶ä»¥æ›´ç´§çš„çº¦æŸä¸ºå‡†</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ç”¨äºéœ€è¦é™åˆ¶å­Widgetå¤§å°çš„æƒ…å†µ</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ConstrainedBox(</span><br><span class="line">  constraints: const BoxConstraints(</span><br><span class="line">    minWidth: 100,</span><br><span class="line">    maxWidth: 200,</span><br><span class="line">    minHeight: 50,</span><br><span class="line">    maxHeight: 100,</span><br><span class="line">  ),</span><br><span class="line">  child: Container(color: Colors.red),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-5858d221ad0961c1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ConstrainedBox"></p>
<h2 id="7-UnconstrainedBox"><a href="#7-UnconstrainedBox" class="headerlink" title="7. UnconstrainedBox"></a>7. UnconstrainedBox</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> è§£é™¤çˆ¶å®¹å™¨çš„çº¦æŸï¼Œå…è®¸å­æ§ä»¶æŒ‰ç…§è‡ªèº«å¤§å°ç»˜åˆ¶ï¼Œç„¶åæ ¹æ®å®é™…å¤§å°å†çº¦æŸ</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> å­ç»„ä»¶ï¼Œå…¶å°ºå¯¸ä¸ä¼šå—åˆ°UnconstrainedBoxçš„çº¦æŸï¼Œè‹¥å­ç»„ä»¶å°ºå¯¸è¶…è¿‡çˆ¶å®¹å™¨åŒºåŸŸï¼ŒDebugæ¨¡å¼ä¸‹ä¼šæ˜¾ç¤ºé»„è‰²æº¢å‡ºè­¦å‘Šï¼ˆReleaseæ¨¡å¼ä¼šè£å‰ªï¼‰ï¼Œè‹¥çˆ¶çº§æœ‰å¤šä¸ªçº¦æŸç»„ä»¶ï¼ˆå¦‚åµŒå¥—çš„ConstrainedBoxï¼‰ï¼ŒUnconstrainedBoxåªèƒ½çªç ´ç›´æ¥çˆ¶çº§çš„çº¦æŸï¼Œæ— æ³•çªç ´æ›´é«˜å±‚çº¦æŸ</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> constrainedAxisï¼šnullï¼ˆé»˜è®¤ï¼‰ï¼šå®Œå…¨è§£é™¤çº¦æŸ &#x2F; Axis.horizontal ï¼šä»…æ°´å¹³æ–¹å‘è§£é™¤çº¦æŸï¼Œå‚ç›´æ–¹å‘ä»å—çˆ¶çº§é™åˆ¶ &#x2F; Axis.vertical ï¼šä»…å‚ç›´æ–¹å‘è§£é™¤çº¦æŸï¼Œæ°´å¹³æ–¹å‘å—é™åˆ¶ï¼Œè¿‡åº¦ä½¿ç”¨å¯èƒ½å¯¼è‡´å¸ƒå±€è®¡ç®—å¤æ‚åŒ–ï¼Œå»ºè®®ä»…åœ¨å¿…è¦æ—¶ä½¿ç”¨</p>
</li>
<li><p><strong>æ¨èï¼š</strong> é€‚ç”¨äºéœ€è¦çªç ´çˆ¶å®¹å™¨çº¦æŸçš„åœºæ™¯ï¼Œä¾‹å¦‚åœ¨ListViewæˆ–AppBarä¸­ä¿æŒå­ç»„ä»¶åŸå§‹å°ºå¯¸</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ListView(</span><br><span class="line">  children: [</span><br><span class="line">    // åŸå§‹Containerè¢«æ‹‰ä¼¸è‡³å±å¹•å®½åº¦ </span><br><span class="line">    Container(width: 200, height: 100, color: Colors.red), </span><br><span class="line">    </span><br><span class="line">    // ä½¿ç”¨UnconstrainedBoxä¿æŒåŸå§‹å°ºå¯¸</span><br><span class="line">    UnconstrainedBox(</span><br><span class="line">      child: Container(width: 200, height: 100, color: Colors.blue), </span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-ffe0106484ea43f1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="UnconstrainedBox"></p>
<h2 id="8-SizedBox"><a href="#8-SizedBox" class="headerlink" title="8. SizedBox"></a>8. SizedBox</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> å¯ä»¥æŒ‡å®šå›ºå®šå¤§å°çš„ç›’å­ï¼Œä¹Ÿå¯ä»¥ç”¨äºè®¾ç½®é—´éš”</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> å¦‚æœæŒ‡å®šäº†widthå’Œheightï¼Œåˆ™å¼ºåˆ¶å­Widgetä½¿ç”¨è¯¥å¤§å°ï¼ˆå¦‚æœå­Widgetæœ‰çº¦æŸï¼Œåˆ™å¯èƒ½ä¼šå¼ºåˆ¶è°ƒæ•´ï¼‰</p>
</li>
</ul>
</blockquote>
<ol>
<li>SizedBox.shrink()	é›¶å°ºå¯¸å ä½ç¬¦</li>
<li>SizedBox.expand()	æ‰©å±•å¡«å……å ä½ç¬¦</li>
<li>SizedBox.fromSize()	æŒ‡å®šå°ºå¯¸å ä½ç¬¦<blockquote>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> å½“æ²¡æœ‰å­Widgetæ—¶ï¼ŒSizedBoxä¼šå æ®æŒ‡å®šå¤§å°çš„ç©ºé—´ï¼›æœ‰å­Widgetæ—¶ï¼Œåˆ™å¼ºåˆ¶å­Widgetå¤§å°ä¸ºæŒ‡å®šå¤§å°</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ç”¨äºå›ºå®šå°ºå¯¸çš„ç›’å­æˆ–é—´éš”ï¼ˆå¦‚SizedBox(width: 10)ï¼‰</p>
</li>
</ul>
</blockquote>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SizedBox(</span><br><span class="line">  width: 100,</span><br><span class="line">  height: 100,</span><br><span class="line">  child: Container(color: Colors.green),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-e740fea4b1386c95.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="SizedBox"></p>
<h2 id="9-FractionallySizedBox"><a href="#9-FractionallySizedBox" class="headerlink" title="9. FractionallySizedBox"></a>9. FractionallySizedBox</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> å­Widgetçš„å¤§å°ç›¸å¯¹äºçˆ¶Widgetçš„ç™¾åˆ†æ¯”</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> éœ€è¦è®¾ç½®widthFactorå’ŒheightFactorï¼ˆ0.0åˆ°1.0ï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> çˆ¶Widgetå¿…é¡»æä¾›çº¦æŸï¼Œå¦åˆ™æ— æ³•è®¡ç®—ç™¾åˆ†æ¯”</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ç”¨äºéœ€è¦ç›¸å¯¹çˆ¶å®¹å™¨ç™¾åˆ†æ¯”å¤§å°çš„åœºæ™¯</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Container(</span><br><span class="line">  width: 200,</span><br><span class="line">  height: 200,</span><br><span class="line">  color: Colors.blue,</span><br><span class="line">  child: FractionallySizedBox(</span><br><span class="line">    widthFactor: 0.5,</span><br><span class="line">    heightFactor: 0.5,</span><br><span class="line">    child: Container(color: Colors.red),</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-b0f9ae5d677c6ee7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="FractionallySizedBox"></p>
<h2 id="10-Transform"><a href="#10-Transform" class="headerlink" title="10. Transform"></a>10. Transform</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> å¯¹å­Widgetè¿›è¡ŒçŸ©é˜µå˜æ¢ï¼ˆå¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾ç­‰ï¼‰</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> å˜æ¢ä¸å½±å“å¸ƒå±€ï¼Œå˜æ¢æ˜¯åœ¨å¸ƒå±€ä¹‹åè¿›è¡Œçš„ï¼Œæ‰€ä»¥å¯èƒ½ä¼šè¶…å‡ºçˆ¶WidgetåŒºåŸŸ</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> å˜æ¢åå¯èƒ½ä¼šè¶…å‡ºçˆ¶WidgetèŒƒå›´ï¼Œå¯¼è‡´è¢«è£å‰ªï¼ˆå¯ä»¥ä½¿ç”¨Clip.noneé¿å…ï¼‰</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ç”¨äºéœ€è¦å˜æ¢çš„åœºæ™¯ï¼Œå¦‚æ—‹è½¬ä¸€ä¸ªå›¾æ ‡</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Transform.rotate(</span><br><span class="line">  angle: 3.14 / 4, // 45åº¦</span><br><span class="line">  child: Container(width: 100, height: 100, color: Colors.blue),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-d10cddf8801e61d7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Transform"></p>
<h2 id="11-Baseline"><a href="#11-Baseline" class="headerlink" title="11. Baseline"></a>11. Baseline</h2><blockquote>
<ul>
<li><strong>è¯´æ˜ï¼š</strong> æ ¹æ®å­Widgetçš„åŸºçº¿å¯¹é½ï¼ˆå¸¸ç”¨äºæ–‡æœ¬ï¼‰, Baseline çš„å¯¹é½æ–¹å¼æœ‰ä¸¤ç§ç±»å‹:</li>
</ul>
<p> <strong>alphabeticï¼š</strong> å¯¹é½å­—æ¯åº•éƒ¨åŸºçº¿ï¼ˆé€‚ç”¨äºè‹±æ–‡ç­‰æ‹‰ä¸æ–‡å­—ï¼‰</p>
<p> <strong>ideographicï¼š</strong> å¯¹é½è¡¨æ„æ–‡å­—åŸºçº¿ï¼ˆé€‚ç”¨äºä¸­æ–‡ã€æ—¥æ–‡ç­‰ï¼‰</p>
<ul>
<li><p><strong>è§„åˆ™ï¼š</strong> éœ€è¦è®¾ç½®baselineå’ŒbaselineTypeï¼ˆå¦‚TextBaseline.alphabeticï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> éœ€è¦å­Widgetæœ‰åŸºçº¿ï¼ˆå¦‚Textï¼‰ï¼Œå¦åˆ™æ— æ•ˆ</p>
</li>
<li><p><strong>æ¨èï¼š</strong> å°¤å…¶é€‚ç”¨äºæ–‡å­—æ’ç‰ˆåœºæ™¯ï¼Œå¤„ç†æ··åˆæ–‡å­—ï¼ˆå¦‚ä¸­è‹±æ–‡ï¼‰æ—¶ï¼Œé€šè¿‡baselineTypeåŒºåˆ†åŸºçº¿ç±»å‹ï¼Œé¿å…æ’ç‰ˆé”™ä¹±</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const Row(</span><br><span class="line">  children: [</span><br><span class="line">    Baseline(</span><br><span class="line">      baseline: 50.0,</span><br><span class="line">      baselineType: TextBaseline.alphabetic,</span><br><span class="line">      child: Text(&#x27;Hello&#x27;, style: TextStyle(fontSize: 20)),</span><br><span class="line">    ),</span><br><span class="line">    Baseline(</span><br><span class="line">      baseline: 50.0,</span><br><span class="line">      baselineType: TextBaseline.alphabetic,</span><br><span class="line">      child: Text(&#x27;World&#x27;, style: TextStyle(fontSize: 30)),</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-cb638ee25dbc7368.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Baseline"></p>
<h2 id="12-FittedBox"><a href="#12-FittedBox" class="headerlink" title="12. FittedBox"></a>12. FittedBox</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> å¯¹å­Widgetè¿›è¡Œç¼©æ”¾å’Œä½ç½®è°ƒæ•´ï¼Œä»¥ä½¿å…¶é€‚åº”å¯ç”¨ç©ºé—´</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> é€šè¿‡fitå±æ€§è®¾ç½®é€‚åº”æ–¹å¼ï¼ˆå¦‚BoxFit.containï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> å¦‚æœå­Widgetæ²¡æœ‰çº¦æŸï¼Œå¯èƒ½ä¼šå‡ºç°é—®é¢˜</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ç”¨äºéœ€è¦ç¼©æ”¾çš„åœºæ™¯ï¼Œå¦‚ä¿æŒå›¾ç‰‡æ¯”ä¾‹å¹¶é€‚åº”å®¹å™¨</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Container(</span><br><span class="line">  width: 200,</span><br><span class="line">  height: 100,</span><br><span class="line">  color: Colors.amber,</span><br><span class="line">  child: FittedBox(</span><br><span class="line">    fit: BoxFit.contain,</span><br><span class="line">    child: Image.network(</span><br><span class="line">        &#x27;https://upload-images.jianshu.io/upload_images/1976231-cb638ee25dbc7368.png&#x27;),</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-cba023ab829a3898.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="FittedBox"></p>
<h2 id="13-OverflowBox"><a href="#13-OverflowBox" class="headerlink" title="13. OverflowBox"></a>13. OverflowBox</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> å…è®¸å­Widgetè¶…å‡ºçˆ¶Widgetçš„çº¦æŸï¼Œä»è€Œåœ¨çˆ¶å®¹å™¨ä¹‹å¤–æ˜¾ç¤º</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> è®¾ç½®è‡ªå·±çš„çº¦æŸï¼Œå­Widgetå¯ä»¥çªç ´çˆ¶Widgetçš„çº¦æŸ</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> å¯èƒ½å¯¼è‡´å¸ƒå±€æº¢å‡ºï¼ˆæ— è­¦å‘Šï¼‰ï¼Œä½¿ç”¨æ—¶éœ€æ³¨æ„</p>
</li>
<li><p><strong>æ¨èï¼š</strong> åœ¨éœ€è¦çªç ´çº¦æŸæ—¶ä½¿ç”¨ï¼Œä½†éœ€è°¨æ…</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Container(</span><br><span class="line">  color: Colors.green,</span><br><span class="line">  width: 200.0,</span><br><span class="line">  height: 200.0,</span><br><span class="line">  padding: const EdgeInsets.all(50.0),</span><br><span class="line">  child: OverflowBox(</span><br><span class="line">    alignment: Alignment.topLeft,</span><br><span class="line">    maxWidth: 400.0,</span><br><span class="line">    maxHeight: 400.0,</span><br><span class="line">    child: Container(</span><br><span class="line">      color: Colors.blueGrey,</span><br><span class="line">      width: 300.0,</span><br><span class="line">      height: 300.0,</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-91814fc4a7d45d92.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="OverflowBox"></p>
<h2 id="14-LimitedBox"><a href="#14-LimitedBox" class="headerlink" title="14. LimitedBox"></a>14. LimitedBox</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ä¸€ä¸ªç”¨äºé™åˆ¶å­ç»„ä»¶æœ€å¤§å°ºå¯¸çš„å¸ƒå±€ç»„ä»¶ï¼Œå½“çˆ¶Widgetæ²¡æœ‰çº¦æŸæ—¶ï¼Œé™åˆ¶å­Widgetçš„æœ€å¤§å®½é«˜</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> åœ¨æ— çº¦æŸæ—¶ç”Ÿæ•ˆï¼ˆå¦‚åœ¨ListViewä¸­ï¼ŒListViewæ²¿ç€ä¸»è½´æ–¹å‘æœ‰çº¦æŸï¼Œä½†äº¤å‰è½´æ–¹å‘æ— çº¦æŸï¼Œæ­¤æ—¶åœ¨äº¤å‰è½´æ–¹å‘ä½¿ç”¨LimitedBoxå¯ä»¥é™åˆ¶æœ€å¤§å®½é«˜ï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> åœ¨çˆ¶Widgetæœ‰çº¦æŸæ—¶æ— æ•ˆ</p>
</li>
<li><p><strong>æ¨èï¼š</strong> åœ¨ListViewä¸­é™åˆ¶äº¤å‰è½´æ–¹å‘çš„å¤§å°</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Row(</span><br><span class="line">  children: [</span><br><span class="line">    Container(</span><br><span class="line">      color: Colors.grey,</span><br><span class="line">      width: 100.0,</span><br><span class="line">    ),</span><br><span class="line">    LimitedBox(</span><br><span class="line">      maxWidth: 150.0,</span><br><span class="line">      maxHeight: 150.0,</span><br><span class="line">      child: Container(</span><br><span class="line">        color: Colors.lightGreen,</span><br><span class="line">        width: 250.0,</span><br><span class="line">        height: 250.0,</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-d1f241904b33084f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="LimitedBox"></p>
<h2 id="15-IntrinsicWidth-x2F-IntrinsicHeight"><a href="#15-IntrinsicWidth-x2F-IntrinsicHeight" class="headerlink" title="15. IntrinsicWidth&#x2F;IntrinsicHeight"></a>15. IntrinsicWidth&#x2F;IntrinsicHeight</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> è°ƒæ•´å­Widgetåˆ°å…¶å†…éƒ¨å†…å®¹çš„é«˜åº¦æˆ–å®½åº¦ï¼ˆæœ‰æ€§èƒ½é—®é¢˜ï¼Œæ…ç”¨ï¼‰</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> è¿«ä½¿å­Widgetè®¡ç®—å…¶å†…éƒ¨å†…å®¹çš„æœ€å¤§é«˜åº¦æˆ–å®½åº¦ï¼Œå¹¶è°ƒæ•´å…¶ä»–å­Widgetåˆ°ç›¸åŒé«˜åº¦æˆ–å®½åº¦</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> æ€§èƒ½å·®ï¼Œå› ä¸ºéœ€è¦éå†å­Widgetä¸¤æ¬¡ï¼ˆä¸€æ¬¡æµ‹é‡ï¼Œä¸€æ¬¡å¸ƒå±€ï¼‰</p>
</li>
<li><p><strong>æ¨èï¼š</strong> å°½é‡é¿å…ä½¿ç”¨ï¼Œå¯»æ‰¾å…¶ä»–å¸ƒå±€æ–¹å¼æ›¿ä»£ã€‚å¦‚æœå¿…é¡»ä½¿ç”¨ï¼Œæ³¨æ„æ€§èƒ½å½±å“</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Column(</span><br><span class="line">  mainAxisAlignment: MainAxisAlignment.start,</span><br><span class="line">  children: [</span><br><span class="line">    IntrinsicWidth(</span><br><span class="line">      stepWidth: 100,</span><br><span class="line">      child: Container(</span><br><span class="line">        color: Colors.blue,</span><br><span class="line">        child: Center(</span><br><span class="line">          child: Container(</span><br><span class="line">            color: Colors.red,</span><br><span class="line">            width: 50,</span><br><span class="line">            height: 50,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-c8063e592d34fd20.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="IntrinsicWidth"></p>
<h2 id="16-CustomSingleChildLayout-x2F-CustomMultiChildLayout"><a href="#16-CustomSingleChildLayout-x2F-CustomMultiChildLayout" class="headerlink" title="16. CustomSingleChildLayout&#x2F;CustomMultiChildLayout"></a>16. CustomSingleChildLayout&#x2F;CustomMultiChildLayout</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ä½¿ç”¨è‡ªå®šä¹‰çš„å¸ƒå±€ä»£ç†è¿›è¡Œå¸ƒå±€ï¼Œå¯ä»¥å®ç°å¤æ‚çš„å¸ƒå±€æ•ˆæœï¼Œ<strong>CustomSingleChildLayout</strong> æ˜¯ä¸€ä¸ªç”¨äºæ§åˆ¶å•ä¸ªå­ç»„ä»¶å¸ƒå±€çš„ç»„ä»¶ï¼Œ<strong>CustomMultiChildLayout</strong> æ˜¯ä¸€ä¸ªç”¨äºæ§åˆ¶å¤šä¸ªå­ç»„ä»¶å¸ƒå±€çš„ç»„ä»¶</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> éœ€è¦è‡ªå®šä¹‰LayoutDelegateï¼ŒSingleChildLayoutDelegate æ¥å®ç°å¸ƒå±€é€»è¾‘ã€‚è¯¥ç»„ä»¶é€‚ç”¨äºéœ€è¦å¯¹å•ä¸ªå­ç»„ä»¶è¿›è¡Œå¤æ‚æˆ–éå¸¸è§„å¸ƒå±€çš„åœºæ™¯ï¼Œä¾‹å¦‚éœ€è¦ç²¾ç¡®æ§åˆ¶å­ç»„ä»¶çš„ä½ç½®æˆ–å°ºå¯¸æ—¶ï¼ŒMultiChildLayoutDelegate æ¥å®ç°å¸ƒå±€é€»è¾‘ï¼Œé€‚ç”¨äºéœ€è¦å¯¹å¤šä¸ªå­ç»„ä»¶è¿›è¡Œå¤æ‚å¸ƒå±€çš„åœºæ™¯</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦è‡ªå·±å®ç°å¸ƒå±€é€»è¾‘</p>
</li>
<li><p><strong>æ¨èï¼š</strong>å½“å…¶ä»–å¸ƒå±€Widgetæ— æ³•æ»¡è¶³éœ€æ±‚æ—¶ä½¿ç”¨ï¼Œè‡ªå®šä¹‰çš„ç½‘æ ¼å¸ƒå±€ã€å±‚å å¸ƒå±€</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CustomSingleChildLayout(</span><br><span class="line">  delegate: _MyDelegate(),</span><br><span class="line">  child: Container(color: Colors.blue), </span><br><span class="line">)</span><br><span class="line"> </span><br><span class="line">class _MyDelegate extends SingleChildLayoutDelegate &#123;</span><br><span class="line">  @override</span><br><span class="line">  BoxConstraints getConstraintsForChild(BoxConstraints constraints) &#123;</span><br><span class="line">    return constraints.loosen();  // è§£é™¤å­ç»„ä»¶çº¦æŸ </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  @override</span><br><span class="line">  Offset getPositionForChild(Size size, Size childSize) &#123;</span><br><span class="line">    return Offset(size.width/2,  0); // é¡¶éƒ¨å±…ä¸­</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  @override</span><br><span class="line">  bool shouldRelayout(covariant SingleChildLayoutDelegate oldDelegate) &#123;</span><br><span class="line">    // TODO: implement shouldRelayout</span><br><span class="line">    throw UnimplementedError();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-c723cf1e5f55eb82.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="CustomSingleChildLayout"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Container(</span><br><span class="line">  width: 200.0,</span><br><span class="line">  height: 100.0,</span><br><span class="line">  color: Colors.yellow,</span><br><span class="line">  child: CustomMultiChildLayout(</span><br><span class="line">    delegate: TestLayoutDelegate(),</span><br><span class="line">    children: &lt;Widget&gt;[</span><br><span class="line">      LayoutId(</span><br><span class="line">        id: TestLayoutDelegate.title,</span><br><span class="line">        child: Container(</span><br><span class="line">          color: Colors.red,</span><br><span class="line">          child: const Text(&#x27;Title&#x27;),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">      LayoutId(</span><br><span class="line">        id: TestLayoutDelegate.description,</span><br><span class="line">        child: Container(</span><br><span class="line">          color: Colors.green,</span><br><span class="line">          child: const Text(&#x27;Description&#x27;),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    ],</span><br><span class="line">  ),</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">class TestLayoutDelegate extends MultiChildLayoutDelegate &#123;</span><br><span class="line">  static const String title = &#x27;title&#x27;;</span><br><span class="line">  static const String description = &#x27;description&#x27;;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  void performLayout(Size size) &#123;</span><br><span class="line">    final BoxConstraints constraints = BoxConstraints(maxWidth: size.width);</span><br><span class="line">    final Size titleSize = layoutChild(title, constraints);</span><br><span class="line">    positionChild(title, const Offset(0.0, 0.0));</span><br><span class="line">    final double descriptionY = titleSize.height;</span><br><span class="line">    layoutChild(description, constraints);</span><br><span class="line">    positionChild(description, Offset(0.0, descriptionY));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  bool shouldRelayout(TestLayoutDelegate oldDelegate) =&gt; false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-697fa21cb3fbdfa3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="CustomMultiChildLayout"></p>
<h2 id="17-Placeholder"><a href="#17-Placeholder" class="headerlink" title="17. Placeholder"></a>17. Placeholder</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ä¸»è¦ç”¨äºåœ¨å¼€å‘è¿‡ç¨‹ä¸­å¿«é€Ÿæ„å»ºé¡µé¢éª¨æ¶ï¼ŒåŠ é€Ÿé¡µé¢æµç¨‹çš„è¿è¡Œã€‚å®ƒå¯ä»¥åœ¨å¸ƒå±€ä¸­å ä½ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿé¢„è§ˆé¡µé¢ç»“æ„ã€‚Placeholder çš„å¤§å°é»˜è®¤é€‚åˆå…¶å®¹å™¨ï¼Œè‹¥ä½äºæ— ç•Œç©ºé—´ï¼ˆunbounded spaceï¼‰ï¼Œåˆ™æ ¹æ® fallbackWidth å’Œ fallbackHeight è°ƒæ•´å¤§å°ã€‚Placeholder æ”¯æŒè‡ªå®šä¹‰é¢œè‰²ã€çº¿æ¡å®½åº¦ã€fallbackHeight å’Œ fallbackWidth</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> å¯ä»¥åœ¨ Row æˆ– Column ä¸­ä½¿ç”¨ Placeholderï¼Œä½†éœ€è¦é€šè¿‡ fallbackHeight å’Œ fallbackWidth é™å®šå¤§å°ï¼Œåœ¨æ— ç•Œç©ºé—´ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ fallbackWidth å’Œ fallbackHeight æ¥é™å®šå ä½ç¬¦çš„å¤§å°</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> è™½ç„¶ Placeholder æ˜¯ä¸€ä¸ªç®€å•çš„å ä½ç¬¦ï¼Œä½†åœ¨å¤æ‚çš„å¸ƒå±€ä¸­è¿‡å¤šä½¿ç”¨å¯èƒ½ä¼šå½±å“æ€§èƒ½ï¼Œå› æ­¤åº”åˆç†ä½¿ç”¨</p>
</li>
<li><p><strong>æ¨èï¼š</strong> åœ¨é¡µé¢å¼€å‘åˆæœŸï¼Œå¯ä»¥ä½¿ç”¨ Placeholder æ¥å¿«é€Ÿæ„å»ºé¡µé¢éª¨æ¶ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿé¢„è§ˆé¡µé¢ç»“æ„</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const Center(</span><br><span class="line">  child: Column(</span><br><span class="line">    mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">    children: &lt;Widget&gt;[</span><br><span class="line">      SizedBox(</span><br><span class="line">        height: 100,</span><br><span class="line">        child: Row(</span><br><span class="line">          children: [</span><br><span class="line">            Placeholder(</span><br><span class="line">              fallbackWidth: 100,</span><br><span class="line">              color: Colors.green,</span><br><span class="line">              strokeWidth: 10,</span><br><span class="line">            ),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">      SizedBox(</span><br><span class="line">        width: 100,</span><br><span class="line">        child: Column(</span><br><span class="line">          children: [</span><br><span class="line">            Placeholder(</span><br><span class="line">              fallbackHeight: 100,</span><br><span class="line">              color: Colors.green,</span><br><span class="line">              strokeWidth: 10,</span><br><span class="line">            ),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    ],</span><br><span class="line">  ),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-6ada42602ae47cb1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Placeholder"></p>
<h1 id="å¼¹æ€§å¸ƒå±€è¾…åŠ©æ§ä»¶"><a href="#å¼¹æ€§å¸ƒå±€è¾…åŠ©æ§ä»¶" class="headerlink" title="å¼¹æ€§å¸ƒå±€è¾…åŠ©æ§ä»¶"></a>å¼¹æ€§å¸ƒå±€è¾…åŠ©æ§ä»¶</h1><h2 id="1-Expanded"><a href="#1-Expanded" class="headerlink" title="1. Expanded"></a>1. Expanded</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ä½œä¸ºRowã€Columnæˆ–Flexçš„å­Widgetï¼Œå¯ä»¥æ‰©å±•ä»¥å¡«å……ä¸»è½´ä¸Šçš„å¯ç”¨ç©ºé—´</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> å¿…é¡»ä½äºRowã€Columnæˆ–Flexå†…ã€‚flexå‚æ•°ç”¨äºåˆ†é…å‰©ä½™ç©ºé—´çš„æ¯”ä¾‹ï¼ˆé»˜è®¤ä¸º1ï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> åœ¨Rowæˆ–Columnä¸­ï¼Œå¦‚æœå­Widgetçš„æ€»ä¸»è½´é•¿åº¦è¶…è¿‡å¯ç”¨ç©ºé—´ï¼Œä½¿ç”¨Expandedå¯ä»¥é¿å…æº¢å‡ºï¼Œå› ä¸ºå®ƒä¼šå‹ç¼©å­Widgetï¼ˆå¼ºåˆ¶å­Widgeté€‚åº”åˆ†é…çš„ç©ºé—´ï¼‰</p>
</li>
<li><p><strong>æ¨èï¼š</strong> åœ¨éœ€è¦å­WidgetæŒ‰æ¯”ä¾‹åˆ†é…ç©ºé—´æ—¶ä½¿ç”¨ï¼Œæ¯”ä¾‹åˆ†å‰²å¸ƒå±€ï¼ˆå¦‚ 70%-30% é¢æ¿ï¼‰</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Row(</span><br><span class="line">  children: [</span><br><span class="line">    Expanded(flex: 2, child: Container(color: Colors.red)), // å 2/3ç©ºé—´</span><br><span class="line">    Expanded(flex: 1, child: Container(color: Colors.green)), // å 1/3ç©ºé—´</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-96eab57e36b14c38.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Expanded"></p>
<h2 id="2-Flexible"><a href="#2-Flexible" class="headerlink" title="2. Flexible"></a>2. Flexible</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ä¸Expandedç±»ä¼¼ï¼Œä½†æ›´çµæ´»ã€‚Expandedæ˜¯Flexible(fit: FlexFit.tight)çš„ç®€å†™ã€‚Flexibleçš„é»˜è®¤fitæ˜¯FlexFit.looseï¼Œå³å­Widgetä¸éœ€è¦å¡«æ»¡åˆ†é…çš„ç©ºé—´</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> åŒæ ·å¿…é¡»ä½äºRowã€Columnæˆ–Flexå†…</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> Flexibleä¸Expandedçš„åŒºåˆ«ï¼šExpandedä¼šå¼ºåˆ¶å­Widgetå¡«æ»¡ç©ºé—´ï¼Œè€ŒFlexibleåˆ™å…è®¸å­Widgetä½¿ç”¨æ›´å°çš„ç©ºé—´</p>
</li>
<li><p><strong>æ¨èï¼š</strong> å½“éœ€è¦å­Widgetæœ‰å¼¹æ€§ä½†ä¸éœ€è¦å¼ºåˆ¶å¡«æ»¡æ—¶ä½¿ç”¨ï¼Œè‡ªé€‚åº”è¡¨æ ¼åˆ—</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Row(</span><br><span class="line">  children: [</span><br><span class="line">    Flexible(</span><br><span class="line">      child: Container(height: 50, color: Colors.red),</span><br><span class="line">    ),</span><br><span class="line">    </span><br><span class="line">    Flexible(</span><br><span class="line">      child: Container(</span><br><span class="line">          height: 100,</span><br><span class="line">          color: Colors</span><br><span class="line">              .green), // è¿™ä¸ªå®¹å™¨é«˜åº¦100ï¼Œä½†Rowé«˜åº¦ç”±æœ€é«˜å­Widgetå†³å®šï¼ˆ100ï¼‰ï¼Œçº¢è‰²å®¹å™¨é«˜åº¦50ï¼Œä½†ä¼šè¢«æ‹‰ä¼¸åˆ°100ï¼ˆå› ä¸ºRowäº¤å‰è½´æ˜¯å‚ç›´æ–¹å‘ï¼Œé»˜è®¤æ˜¯stretchï¼‰</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><code>æ³¨æ„ï¼šRowçš„äº¤å‰è½´å¯¹é½é»˜è®¤æ˜¯stretchï¼Œæ‰€ä»¥å­Widgetåœ¨å‚ç›´æ–¹å‘ä¼šè¢«æ‹‰ä¼¸ã€‚å¦‚æœä¸æƒ³è¢«æ‹‰ä¼¸ï¼Œå¯ä»¥è®¾ç½®crossAxisAlignment: CrossAxisAlignment.startã€‚</code></p>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-9f0780f4fe1947a3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Flexible"></p>
<h2 id="3-Spacer"><a href="#3-Spacer" class="headerlink" title="3. Spacer"></a>3. Spacer</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> åœ¨å¼¹æ€§å¸ƒå±€ä¸­å æ®å‰©ä½™ç©ºé—´ï¼ˆç›¸å½“äº<code>Expanded</code>åŒ…è£¹ä¸€ä¸ªç©ºçš„<code>SizedBox</code>ï¼‰,æ˜¯ä¸€ä¸ªç”¨äºåœ¨ Rowã€Column æˆ– Flex å¸ƒå±€ä¸­å¡«å……å‰©ä½™ç©ºé—´çš„ç©ºç™½ç»„ä»¶</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> å®ƒä¼šæ ¹æ® flex å‚æ•°æŒ‰æ¯”ä¾‹å æ®ä¸»è½´ï¼ˆæ°´å¹³æˆ–å‚ç›´æ–¹å‘ï¼‰çš„å¯ç”¨ç©ºé—´ï¼Œç±»ä¼¼å¼¹æ€§å¸ƒå±€ä¸­çš„â€œå¼¹ç°§â€ï¼Œflexï¼ˆé»˜è®¤å€¼ä¸º1ï¼‰ï¼šæŒ‡å®šç©ºé—´åˆ†é…æ¯”ä¾‹ã€‚ä¾‹å¦‚ï¼Œä¸¤ä¸ª Spacer(flex: 2) å’Œ Spacer(flex: 1) ä¼šæŒ‰ 2:1 åˆ†é…å‰©ä½™ç©ºé—´</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> å¿…é¡»ä½œä¸º Rowã€Column æˆ– Flex çš„ç›´æ¥å­ç»„ä»¶ï¼Œç©ºé—´ä¸è¶³æ—¶å¯èƒ½å¼•å‘æº¢å‡ºé”™è¯¯ï¼ˆéœ€ç¡®ä¿çˆ¶å®¹å™¨æœ‰è¶³å¤Ÿç©ºé—´ï¼‰</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ç­‰é—´è·æŒ‰é’®ç»„ï¼Œå·¦å³å¯¹é½å…ƒç´ ï¼Œå¤šæ¯”ä¾‹ç©ºé—´åˆ†é…</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Column(</span><br><span class="line">  children: [</span><br><span class="line">    const Text(</span><br><span class="line">      &quot;é¡¶éƒ¨æ ‡é¢˜&quot;,</span><br><span class="line">      style: TextStyle(</span><br><span class="line">        color: Colors.blue,</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">    const Spacer(flex: 1),</span><br><span class="line">    const Row(</span><br><span class="line">      children: [</span><br><span class="line">        Text(</span><br><span class="line">          &quot;å·¦ä¾§æ–‡æœ¬&quot;,</span><br><span class="line">          style: TextStyle(</span><br><span class="line">            color: Colors.black,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">        Spacer(flex: 2),</span><br><span class="line">        Text(&quot;ä¸­é—´æ–‡æœ¬&quot;,</span><br><span class="line">            style: TextStyle(</span><br><span class="line">              color: Colors.red,</span><br><span class="line">            )),</span><br><span class="line">        Spacer(flex: 1),</span><br><span class="line">        Icon(Icons.star),</span><br><span class="line">      ],</span><br><span class="line">    ),</span><br><span class="line">    const Spacer(flex: 3), // ä¸‹æ–¹å¤§é¢ç§¯ç•™ç™½</span><br><span class="line">    ElevatedButton(</span><br><span class="line">      onPressed: () &#123;&#125;,</span><br><span class="line">      child: const Text(</span><br><span class="line">        &quot;ç¡®è®¤&quot;,</span><br><span class="line">        style: TextStyle(</span><br><span class="line">          color: Colors.blue,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-252bd90059c6ef74.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Spacer"></p>
<h1 id="å±‚å å¸ƒå±€è¾…åŠ©æ§ä»¶"><a href="#å±‚å å¸ƒå±€è¾…åŠ©æ§ä»¶" class="headerlink" title="å±‚å å¸ƒå±€è¾…åŠ©æ§ä»¶"></a>å±‚å å¸ƒå±€è¾…åŠ©æ§ä»¶</h1><h2 id="1-Positioned"><a href="#1-Positioned" class="headerlink" title="1. Positioned"></a>1. Positioned</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ä»…ä½œä¸º Stack çš„ç›´æ¥å­ç»„ä»¶ä½¿ç”¨ï¼Œç”¨äºåœ¨å±‚å å¸ƒå±€ä¸­ç²¾ç¡®å®šä½å­ç»„ä»¶ï¼Œç±»ä¼¼ CSS çš„ç»å¯¹å®šä½</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> leftã€rightã€topã€bottomï¼ˆæ§åˆ¶å­ç»„ä»¶ç›¸å¯¹äºçˆ¶ Stack è¾¹ç¼˜çš„è·ç¦»ï¼‰ï¼Œwidthã€heightï¼ˆå¯é€‰ï¼Œç”¨äºå›ºå®šå­ç»„ä»¶å°ºå¯¸ï¼‰ï¼Œæ”¯æŒ Positioned(topLeft&#x2F;bottomRight) ç­‰å¿«æ·æ–¹å¼</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> è‹¥è®¾ç½® left + rightï¼Œåˆ™ä¸èƒ½åŒæ—¶è®¾ç½® widthï¼›åŒç†é€‚ç”¨äº top + bottom ä¸ height çš„å†²çªï¼Œæœªè®¾ç½®å°ºå¯¸æ—¶ï¼Œéœ€è‡³å°‘æŒ‡å®šä¸¤ä¸ªç›¸å¯¹å®šä½å±æ€§ï¼ˆå¦‚ left å’Œ rightï¼‰ä»¥ç¡®å®šå¸ƒå±€èŒƒå›´</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ç»“åˆ MediaQuery åŠ¨æ€è®¡ç®—å®šä½å€¼ï¼Œé€‚é…ä¸åŒå±å¹•å°ºå¯¸ï¼Œä½¿ç”¨ Align ç®€åŒ–å¯¹é½é€»è¾‘</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Stack(</span><br><span class="line">  fit: StackFit.expand, // å¡«å……çˆ¶å®¹å™¨</span><br><span class="line">  children: [</span><br><span class="line">    Positioned(</span><br><span class="line">      left: 10,</span><br><span class="line">      right: 10,</span><br><span class="line">      height: 80,</span><br><span class="line">      child: Container(color: Colors.orange), // æ°´å¹³å±…ä¸­ä¸”å®½åº¦è‡ªé€‚åº”</span><br><span class="line">    ),</span><br><span class="line">    Positioned(</span><br><span class="line">      top: 10,</span><br><span class="line">      bottom: 10,</span><br><span class="line">      width: 80,</span><br><span class="line">      child: Container(color: Colors.purple), // å‚ç›´å±…ä¸­ä¸”é«˜åº¦è‡ªé€‚åº”</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-676bbb12f2ea47dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Positioned"></p>
<h2 id="2-PositionedDirectional"><a href="#2-PositionedDirectional" class="headerlink" title="2. PositionedDirectional"></a>2. PositionedDirectional</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> å®ƒç”¨äºåœ¨ Stack ä¸­æ ¹æ® textDirection çš„æ–¹å‘æ¥å®šä½å­éƒ¨ä»¶ã€‚ä¸ Positioned ä¸åŒï¼ŒPositionedDirectional æ¥å—çš„æ˜¯ä¸€ä¸ªåç§»é‡å’Œä¸€ä¸ª textDirection å‚æ•°ï¼Œä»è€Œå†³å®šå­éƒ¨ä»¶ç›¸å¯¹ Stack çš„ä½ç½®ã€‚è¿™ä½¿å¾—åœ¨å¸ƒå±€ä¸­ä½¿ç”¨ PositionedDirectional æ›´åŠ çµæ´»å’Œæ–¹ä¾¿</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> startï¼šåœ¨ TextDirection.ltr ï¼ˆä»å·¦åˆ°å³ï¼‰æ—¶å¯¹åº” leftï¼Œåœ¨ TextDirection.rtl ï¼ˆä»å³åˆ°å·¦ï¼‰æ—¶å¯¹åº” rightã€‚endï¼šåœ¨ TextDirection.ltr æ—¶å¯¹åº” rightï¼Œåœ¨ TextDirection.rtl æ—¶å¯¹åº” leftã€‚top å’Œ bottom ä¿æŒå›ºå®šæ–¹å‘ï¼Œä¸å—æ–‡æœ¬æ–¹å‘å½±å“</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> å¿…é¡»ä½œä¸º Stack çš„ç›´æ¥å­ç»„ä»¶ï¼Œå¦åˆ™ä¼šæŠ›å‡ºé”™è¯¯ï¼Œæ”¯æŒ width å’Œ height å±æ€§ï¼Œä½†éœ€æ³¨æ„ä¸ start&#x2F;end å’Œ top&#x2F;bottom çš„ç»„åˆè§„åˆ™</p>
</li>
<li><p><strong>æ¨èï¼š</strong> å¯é€šè¿‡ AnimatedPositionedDirectional å®ç°ä½ç½®å˜åŒ–çš„åŠ¨ç”»æ•ˆæœï¼Œé€‚é…ä¸åŒè¯­è¨€æ–¹å‘çš„å¸ƒå±€ï¼ˆå¦‚é˜¿æ‹‰ä¼¯è¯­ã€å¸Œä¼¯æ¥è¯­ï¼‰</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Directionality(</span><br><span class="line">  // è®¾ç½®æ–‡æœ¬æ–¹å‘ï¼ˆltr æˆ– rtlï¼‰</span><br><span class="line">  textDirection: TextDirection.rtl,</span><br><span class="line">  child: Stack(</span><br><span class="line">    children: [</span><br><span class="line">      PositionedDirectional(</span><br><span class="line">        start: 20.0, // åœ¨ rtl ç¯å¢ƒä¸‹å¯¹åº” right=20</span><br><span class="line">        top: 50.0,</span><br><span class="line">        child: Container(</span><br><span class="line">          width: 100,</span><br><span class="line">          height: 100,</span><br><span class="line">          color: Colors.blue,</span><br><span class="line">          child: const Center(child: Text(&#x27;åŠ¨æ€å®šä½&#x27;)),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">      // å…¶ä»–å­ç»„ä»¶...</span><br><span class="line">    ],</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-1fa3d07137ff4111.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="PositionedDirectional"></p>
<h1 id="æ»šåŠ¨å¸ƒå±€ç›¸å…³æ§ä»¶"><a href="#æ»šåŠ¨å¸ƒå±€ç›¸å…³æ§ä»¶" class="headerlink" title="æ»šåŠ¨å¸ƒå±€ç›¸å…³æ§ä»¶"></a>æ»šåŠ¨å¸ƒå±€ç›¸å…³æ§ä»¶</h1><h2 id="1-SingleChildScrollView"><a href="#1-SingleChildScrollView" class="headerlink" title="1. SingleChildScrollView"></a>1. SingleChildScrollView</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ä¸ºå•ä¸ªå­æ§ä»¶æ·»åŠ æ»šåŠ¨åŠŸèƒ½ï¼Œæ”¯æŒå‚ç›´æˆ–æ°´å¹³æ»šåŠ¨ï¼Œç±»ä¼¼äº Android ä¸­çš„ ScrollView æˆ– iOS ä¸­çš„ UIScrollView</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong></p>
</li>
</ul>
</blockquote>
<ol>
<li><strong>scrollDirectionï¼š</strong> æ»šåŠ¨æ–¹å‘ï¼Œé»˜è®¤ä¸ºå‚ç›´æ–¹å‘ï¼ˆAxis.verticalï¼‰ã€‚</li>
<li><strong>reverseï¼š</strong> æ˜¯å¦åè½¬æ»šåŠ¨æ–¹å‘ï¼Œé»˜è®¤ä¸º falseã€‚</li>
<li><strong>paddingï¼š</strong> å­ç»„ä»¶çš„å†…è¾¹è·ã€‚</li>
<li><strong>primaryï¼š</strong> æ˜¯å¦ä¸ºä¸»æ»šåŠ¨è§†å›¾ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦è‡ªåŠ¨ç”Ÿæˆæ§åˆ¶å™¨ã€‚</li>
<li><strong>physicsï¼š</strong> æ§åˆ¶æ»šåŠ¨è¡Œä¸ºï¼Œå¦‚æ»‘åŠ¨é€Ÿåº¦å’Œè¾¹ç¼˜æ•ˆåº”ã€‚</li>
<li><strong>controllerï¼š</strong> ç”¨äºæ§åˆ¶æ»šåŠ¨ä½ç½®çš„å¯¹è±¡ã€‚</li>
<li><strong>childï¼š</strong> è¦åŒ…å«åœ¨ SingleChildScrollView ä¸­çš„å­ç»„ä»¶ã€‚</li>
<li><strong>dragStartBehaviorï¼š</strong> æ‹–åŠ¨å¼€å§‹è¡Œä¸ºï¼Œé»˜è®¤ä¸º DragStartBehavior.startã€‚</li>
<li><strong>clipBehaviorï¼š</strong> è£å‰ªè¡Œä¸ºï¼Œé»˜è®¤ä¸º Clip.hardEdgeã€‚</li>
<li><strong>restorationIdï¼š</strong> æ¢å¤æ ‡è¯†ã€‚</li>
<li><strong>keyboardDismissBehaviorï¼š</strong> é”®ç›˜å…³é—­è¡Œä¸ºï¼Œé»˜è®¤ä¸º<br>ScrollViewKeyboardDismissBehavior.manualã€‚<blockquote>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> ä¸æ”¯æŒ Sliver å»¶è¿ŸåŠ è½½ï¼Œå†…å®¹è¿‡å¤šæ—¶æ€§èƒ½è¾ƒå·®ï¼Œå»ºè®®æ”¹ç”¨ ListViewï¼Œé€‚ç”¨äºå†…å®¹ä¸ä¼šè¶…è¿‡å±å¹•å°ºå¯¸å¤ªå¤šçš„æƒ…å†µï¼Œå› ä¸ºå½“å†…å®¹è¶…å‡ºå±å¹•å°ºå¯¸è¾ƒå¤šæ—¶ï¼Œæ€§èƒ½ä¼šå—åˆ°å½±å“</p>
</li>
<li><p><strong>æ¨èï¼š</strong> å•ä¸ªå­ç»„ä»¶çš„æ»šåŠ¨ï¼ˆå¦‚è¡¨å•ã€æ–‡ç« è¯¦æƒ…é¡µï¼‰ï¼Œå†…å®¹é‡è¾ƒå°ï¼Œæ— éœ€åŠ¨æ€åŠ è½½çš„åœºæ™¯</p>
</li>
</ul>
</blockquote>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Scrollbar(</span><br><span class="line">  child: SingleChildScrollView(</span><br><span class="line">    scrollDirection: Axis.vertical,</span><br><span class="line">    child: Center(</span><br><span class="line">      child: Column(</span><br><span class="line">        children: &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br><span class="line">            .split(&#x27;&#x27;)</span><br><span class="line">            .map((c) =&gt; Container(</span><br><span class="line">                  margin: const EdgeInsets.all(8.0),</span><br><span class="line">                  padding: const EdgeInsets.all(16.0),</span><br><span class="line">                  decoration: BoxDecoration(</span><br><span class="line">                    color: Colors.red,</span><br><span class="line">                    borderRadius: BorderRadius.circular(8.0),</span><br><span class="line">                    boxShadow: [</span><br><span class="line">                      BoxShadow(</span><br><span class="line">                        color: Colors.black.withOpacity(0.5),</span><br><span class="line">                        blurRadius: 4.0,</span><br><span class="line">                        offset: const Offset(2.0, 2.0),</span><br><span class="line">                      ),</span><br><span class="line">                    ],</span><br><span class="line">                  ),</span><br><span class="line">                  child: Text(</span><br><span class="line">                    c,</span><br><span class="line">                    style: const TextStyle(</span><br><span class="line">                        color: Colors.white, fontSize: 24.0),</span><br><span class="line">                  ),</span><br><span class="line">                ))</span><br><span class="line">            .toList(),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-49419b2a0ccc31e5.gif?imageMogr2/auto-orient/strip" alt="SingleChildScrollView"></p>
<h2 id="2-PageView"><a href="#2-PageView" class="headerlink" title="2. PageView"></a>2. PageView</h2><blockquote>
<ul>
<li><strong>è¯´æ˜ï¼š</strong> æ˜¯ä¸€ä¸ªåˆ†é¡µæ»šåŠ¨è§†å›¾ï¼Œç”¨äºå®ç°å¯æ»‘åŠ¨çš„é¡µé¢åˆ‡æ¢ï¼ˆæ°´å¹³&#x2F;å‚ç›´ï¼‰</li>
</ul>
</blockquote>
<ol>
<li>PageView()ï¼šé™æ€é¡µé¢åˆ—è¡¨</li>
<li>PageView.builder() ï¼šåŠ¨æ€æ‡’åŠ è½½ï¼ˆå¤§æ•°æ®é‡ä¼˜åŒ–ï¼‰</li>
<li>PageView.custom() ï¼šé«˜åº¦è‡ªå®šä¹‰å­ç»„ä»¶<blockquote>
<ul>
<li><strong>è§„åˆ™ï¼š</strong></li>
</ul>
</blockquote>
</li>
<li><strong>scrollDirectionï¼š</strong> è§†å›¾æ»šåŠ¨æ–¹å‘ï¼Œé»˜è®¤ä¸ºæ°´å¹³æ–¹å‘ï¼ˆAxis.horizontalï¼‰ã€‚</li>
<li><strong>reverseï¼š</strong> æ˜¯å¦åè½¬æ–¹å‘ï¼Œé»˜è®¤ä¸º falseã€‚</li>
<li><strong>controllerï¼š</strong> ç”¨äºç›‘å¬è§†å›¾æ»šåŠ¨æƒ…å†µçš„æ§åˆ¶å™¨ã€‚</li>
<li><strong>onPageChangedï¼š</strong> ç´¢å¼•æ”¹å˜æ—¶çš„å›è°ƒå‡½æ•°ã€‚</li>
<li><strong>physicsï¼š</strong> æ»šåŠ¨é€»è¾‘ï¼Œå¯ä»¥è®¾ç½®ä¸ºä¸æ»šåŠ¨ã€æ»šåŠ¨æˆ–æ»šåŠ¨åˆ°è¾¹ç¼˜æ˜¯å¦åå¼¹ç­‰ã€‚</li>
<li><strong>pageSnappingï¼š</strong> æ˜¯å¦å¯ç”¨é¡µé¢å¯¹é½ï¼Œé»˜è®¤ä¸º trueã€‚</li>
<li><strong>allowImplicitScrollingï¼š</strong> æ˜¯å¦å…è®¸éšå¼æ»šåŠ¨ï¼Œé»˜è®¤ä¸º falseã€‚<blockquote>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> ä½¿ç”¨ PageView.builder é¿å…ä¸€æ¬¡æ€§æ„å»ºæ‰€æœ‰é¡µé¢ï¼Œæ­é… AutomaticKeepAliveClientMixin ç¼“å­˜é¡µé¢çŠ¶æ€ï¼ŒåµŒå¥— ListView æ—¶è®¾ç½® physics: NeverScrollableScrollPhysics() ç¦ç”¨çˆ¶çº§æ»‘åŠ¨ï¼Œé¿å…å‚ç›´æ»‘åŠ¨å†²çª</p>
</li>
<li><p><strong>æ¨èï¼š</strong> é€‚ç”¨äºå¼•å¯¼é¡µã€è½®æ’­å›¾ã€å…¨å±æ»‘åŠ¨è§†å›¾ç­‰åœºæ™¯</p>
</li>
</ul>
</blockquote>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PageView(</span><br><span class="line">  children: &lt;Widget&gt;[</span><br><span class="line">    Container(</span><br><span class="line">      alignment: Alignment.center,</span><br><span class="line">      decoration: const BoxDecoration(color: Colors.green),</span><br><span class="line">      child: const Text(&quot;é¡µé¢ 0&quot;,</span><br><span class="line">          style: TextStyle(fontSize: 20, color: Colors.black)),</span><br><span class="line">    ),</span><br><span class="line">    Container(</span><br><span class="line">      alignment: Alignment.center,</span><br><span class="line">      decoration: const BoxDecoration(color: Colors.red),</span><br><span class="line">      child: const Text(&quot;é¡µé¢ 1&quot;,</span><br><span class="line">          style: TextStyle(fontSize: 20, color: Colors.white)),</span><br><span class="line">    ),</span><br><span class="line">    Container(</span><br><span class="line">      alignment: Alignment.center,</span><br><span class="line">      decoration: const BoxDecoration(color: Colors.blue),</span><br><span class="line">      child: const Text(&quot;é¡µé¢ 2&quot;,</span><br><span class="line">          style: TextStyle(fontSize: 20, color: Colors.white)),</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-105ffc0ea9ac9933.gif?imageMogr2/auto-orient/strip" alt="PageView"></p>
<h2 id="3-Scrollbar"><a href="#3-Scrollbar" class="headerlink" title="3. Scrollbar"></a>3. Scrollbar</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ä¸€ä¸ª Material é£æ ¼çš„æ»šåŠ¨æŒ‡ç¤ºå™¨ï¼ŒFlutter çš„æ»šåŠ¨è§†å›¾ï¼ˆå¦‚ ListViewã€GridView ç­‰ï¼‰æ²¡æœ‰æ»šåŠ¨æ¡ï¼Œä½†å¯ä»¥é€šè¿‡å°†æ»šåŠ¨è§†å›¾åŒ…è£¹åœ¨ Scrollbar ç»„ä»¶ä¸­æ¥æ·»åŠ æ»šåŠ¨æ¡</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong></p>
</li>
</ul>
</blockquote>
<ol>
<li><strong>childï¼š</strong> å¿…éœ€å±æ€§ï¼Œç”¨äºæŒ‡å®šéœ€è¦æ»šåŠ¨çš„å†…å®¹ã€‚</li>
<li><strong>controllerï¼š</strong> å¯é€‰å±æ€§ï¼Œç”¨äºæ§åˆ¶æ»šåŠ¨è¡Œä¸ºã€‚</li>
<li><strong>isAlwaysShownï¼š</strong> å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å§‹ç»ˆæ˜¾ç¤ºæ»šåŠ¨æ¡ã€‚é»˜è®¤ä¸º falseï¼Œéœ€è¦è®¾ç½® controller æ‰èƒ½æ˜¾ç¤ºã€‚</li>
<li><strong>thicknessï¼š</strong> æ»šåŠ¨æ¡çš„å®½åº¦ã€‚</li>
<li><strong>radiusï¼š</strong> æ»šåŠ¨æ¡çš„åœ†è§’åŠå¾„ã€‚</li>
<li><strong>showTrackOnHoverï¼š</strong> å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“é¼ æ ‡æ‚¬åœåœ¨æ»šåŠ¨æ¡ä¸Šæ—¶æ˜¯å¦æ˜¾ç¤ºè½¨é“ã€‚</li>
<li><strong>hoverThicknessï¼š</strong> é¼ æ ‡æ‚¬åœæ—¶æ»šåŠ¨æ¡çš„å®½åº¦ã€‚</li>
<li><strong>notificationPredicateï¼š</strong> ç”¨äºè¿‡æ»¤æ»šåŠ¨é€šçŸ¥çš„è°“è¯ã€‚</li>
<li><strong>interactiveï¼š</strong> å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ»šåŠ¨æ¡æ˜¯å¦å¯ä»¥äº¤äº’ã€‚</li>
<li><strong>scrollbarOrientationï¼š</strong> æ»šåŠ¨æ¡çš„æ–¹å‘ã€‚<blockquote>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> Scrollbar éœ€è¦åŒ…è£¹å¯æ»šåŠ¨ç»„ä»¶ï¼ˆå¦‚ ListViewï¼‰ï¼Œä½†ä¸è¦æ±‚ç›´æ¥ä½œä¸ºçˆ¶çº§ï¼Œåªè¦åœ¨ç»„ä»¶æ ‘ä¸­å­˜åœ¨å³å¯</p>
</li>
<li><p><strong>æ¨èï¼š</strong> è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ ã€æ˜¾ç¤ºæ»šåŠ¨æ¡</p>
</li>
</ul>
</blockquote>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Scrollbar(</span><br><span class="line">  child: ListView.builder(</span><br><span class="line">    itemCount: 40,</span><br><span class="line">    itemBuilder: (context, index) &#123;</span><br><span class="line">      return Card(</span><br><span class="line">        child: Container(</span><br><span class="line">          height: 45,</span><br><span class="line">          alignment: Alignment.center,</span><br><span class="line">          child: Text(&#x27;$index&#x27;),</span><br><span class="line">        ),</span><br><span class="line">      );</span><br><span class="line">    &#125;,</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-7fb3930b1c3ee34f.gif?imageMogr2/auto-orient/strip" alt="Scrollbar"></p>
<h2 id="4-RefreshIndicator"><a href="#4-RefreshIndicator" class="headerlink" title="4. RefreshIndicator"></a>4. RefreshIndicator</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> å®ç° Material é£æ ¼ä¸‹æ‹‰åˆ·æ–°åŠŸèƒ½çš„ç»„ä»¶ï¼Œé€šå¸¸åŒ…è£¹åœ¨å¯æ»šåŠ¨çš„å­ç»„ä»¶ï¼ˆå¦‚ ListViewã€CustomScrollViewï¼‰å¤–å±‚ã€‚å½“ç”¨æˆ·ä¸‹æ‹‰è¶…è¿‡ä¸€å®šè·ç¦»æ—¶ï¼Œä¼šè§¦å‘å›è°ƒå‡½æ•°æ‰§è¡Œåˆ·æ–°æ“ä½œï¼Œå¹¶æ˜¾ç¤ºåŠ è½½åŠ¨ç”»</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong></p>
</li>
</ul>
</blockquote>
<ol>
<li><strong>childï¼š</strong> å¿…éœ€å‚æ•°ï¼Œé€šå¸¸ä¸º ListView æˆ– CustomScrollViewã€‚</li>
<li><strong>displacementï¼š</strong> å¯é€‰å‚æ•°ï¼Œä»å­ç»„ä»¶çš„é¡¶éƒ¨æˆ–åº•éƒ¨è¾¹ç¼˜åˆ°åˆ·æ–°æŒ‡ç¤ºç¬¦æ‰€åœ¨ä½ç½®çš„è·ç¦»ã€‚</li>
<li><strong>onRefreshï¼š</strong> å¿…éœ€å‚æ•°ï¼Œå½“ç”¨æˆ·å°†åˆ·æ–°æŒ‡ç¤ºå™¨æ‹–åˆ°è¶³å¤Ÿè¿œä»¥è¡¨æ˜ä»–ä»¬å¸Œæœ›åº”ç”¨åˆ·æ–°æ—¶è°ƒç”¨çš„å‡½æ•°ã€‚</li>
<li><strong>colorï¼š</strong> å¯é€‰å‚æ•°ï¼Œè¿›åº¦æŒ‡ç¤ºå™¨å‰æ™¯è‰²ã€‚</li>
<li><strong>backgroundColorï¼š</strong> å¯é€‰å‚æ•°ï¼Œè¿›åº¦æŒ‡ç¤ºå™¨èƒŒæ™¯è‰²ã€‚</li>
<li><strong>notificationPredicateï¼š</strong> å¯é€‰å‚æ•°ï¼Œç”¨äºè¿‡æ»¤æ»šåŠ¨é€šçŸ¥ã€‚</li>
<li><strong>semanticsLabelï¼š</strong> å¯é€‰å‚æ•°ï¼Œè¯­ä¹‰æ ‡ç­¾ã€‚</li>
<li><strong>semanticsValueï¼š</strong> å¯é€‰å‚æ•°ï¼Œè¯­ä¹‰å€¼ã€‚<blockquote>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> ä¸Šæ‹‰åŠ è½½ï¼šéœ€ç»“åˆ <code>ScrollController</code> ç›‘å¬æ»šåŠ¨ä½ç½®ï¼Œå®ç° <code>LoadMore</code> åŠŸèƒ½ï¼Œ<code>onRefresh</code> å¿…é¡»è¿”å› <code>Future</code>ï¼Œä¸”éœ€åœ¨æ•°æ®åŠ è½½å®Œæˆåå®Œæˆè¯¥ <code>Future</code>ï¼Œå¦åˆ™åˆ·æ–°åŠ¨ç”»ä¸ä¼šåœæ­¢</p>
</li>
<li><p><strong>æ¨èï¼š</strong> åˆ—è¡¨æ•°æ®åˆ·æ–°</p>
</li>
</ul>
</blockquote>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">List&lt;String&gt; _items = List.generate(20, (index) =&gt; &quot;Item $index&quot;);</span><br><span class="line"></span><br><span class="line">Future&lt;void&gt; _refresh() async &#123;</span><br><span class="line">  await Future.delayed(Duration(seconds: 2));</span><br><span class="line">  setState(() &#123;</span><br><span class="line">    _items = List.generate(20, (index) =&gt; &quot;Refreshed Item $index&quot;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"> RefreshIndicator(</span><br><span class="line">  onRefresh: _refresh,</span><br><span class="line">  child: ListView.builder(</span><br><span class="line">    itemCount: _items.length,</span><br><span class="line">    itemBuilder: (context, index) &#123;</span><br><span class="line">      return ListTile(</span><br><span class="line">        title: Text(_items[index]),</span><br><span class="line">      );</span><br><span class="line">    &#125;,</span><br><span class="line">  ),</span><br><span class="line">) </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-4b56b92150f6a399.gif?imageMogr2/auto-orient/strip" alt="RefreshIndicator"></p>
<h2 id="5-DraggableScrollableSheet"><a href="#5-DraggableScrollableSheet" class="headerlink" title="5. DraggableScrollableSheet"></a>5. DraggableScrollableSheet</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> å…è®¸ç”¨æˆ·é€šè¿‡æ‰‹åŠ¿æ“ä½œæ¥æ‹–åŠ¨ä¸€ä¸ªå¯æ»šåŠ¨çš„åŒºåŸŸã€‚å®ƒå¸¸ç”¨äºåˆ›å»ºåº•éƒ¨å¼¹å‡ºå¼é¢æ¿æˆ–å¯æ‹–åŠ¨çš„æ§ä»¶ï¼Œç±»ä¼¼äºé«˜å¾·åœ°å›¾é¦–é¡µä»åº•éƒ¨æ»‘åŠ¨å‘ä¸Šçš„æ•ˆæœã€‚è¯¥ç»„ä»¶ç»§æ‰¿è‡ª StatefulWidgetï¼Œé€šè¿‡è°ƒæ•´æ»šåŠ¨åŒºåŸŸçš„å¤§å°æ¥å“åº”æ‹–åŠ¨æ‰‹åŠ¿ï¼Œç›´åˆ°è¾¾åˆ°é™åˆ¶ï¼Œç„¶åå¼€å§‹æ»šåŠ¨</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong></p>
</li>
</ul>
</blockquote>
<p><strong>1. initialChildSizeï¼š</strong> è®¾ç½®åˆå§‹é«˜åº¦å å±å¹•çš„æ¯”ä¾‹ï¼ŒèŒƒå›´ä¸º 0 åˆ° 1ï¼Œé»˜è®¤ä¸º 0.5ã€‚</p>
<p><strong>2. minChildSizeï¼š</strong> æŒ‡å®šæœ€å°é«˜åº¦å å±å¹•çš„æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º 0.25ã€‚</p>
<p><strong>3. maxChildSizeï¼š</strong> æŒ‡å®šæœ€å¤§é«˜åº¦å å±å¹•çš„æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º 1.0ã€‚</p>
<p><strong>4. expandï¼š</strong> æ§åˆ¶æ˜¯å¦å…è®¸åœ¨å†…å®¹å°äºå±å¹•é«˜åº¦æ—¶æ‰©å±•ä»¥å¡«å……å±å¹•ï¼Œé»˜è®¤ä¸º trueã€‚</p>
<p><strong>5. snapï¼š</strong> å¸ƒå°”å€¼ï¼Œç”¨äºæ§åˆ¶æ»šåŠ¨åœæ­¢æ—¶æ˜¯å¦è‡ªåŠ¨æ•æ‰åˆ°æ¥è¿‘çš„æœ€å°æˆ–æœ€å¤§å€¼ï¼Œé»˜è®¤ä¸º falseã€‚</p>
<p><strong>6. builderï¼š</strong> æ„å»ºå‡½æ•°ï¼Œç”¨äºæ„å»º DraggableScrollableSheet çš„å†…å®¹ï¼Œæ¥å—ä¸¤ä¸ªå‚æ•°ï¼š<br>BuildContext å’Œ ScrollControllerï¼Œè¿”å›ä¸€ä¸ª Widgetï¼Œé€šå¸¸æ˜¯ SingleChildScrollView æˆ– ListViewã€‚</p>
<blockquote>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> ç¡®ä¿ maxChildSize &gt;&#x3D; initialChildSize &gt;&#x3D; minChildSizeï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸</p>
</li>
<li><p><strong>æ¨èï¼š</strong> åº•éƒ¨å¼¹å‡ºå¼é¢æ¿è¯„è®ºåŒºã€è¯¦ç»†ä¿¡æ¯å±•ç¤º</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Stack(</span><br><span class="line">  children: [</span><br><span class="line">    Positioned(</span><br><span class="line">      top: 0,</span><br><span class="line">      bottom: 0,</span><br><span class="line">      left: 0,</span><br><span class="line">      right: 0,</span><br><span class="line">      child: Container(</span><br><span class="line">        color: Colors.grey[300],</span><br><span class="line">        child: Center(</span><br><span class="line">          child: Text(&#x27;èƒŒæ™¯å†…å®¹&#x27;),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">    DraggableScrollableSheet(</span><br><span class="line">      initialChildSize: 0.5,</span><br><span class="line">      minChildSize: 0.3,</span><br><span class="line">      maxChildSize: 1.0,</span><br><span class="line">      builder: (_, controller) &#123;</span><br><span class="line">        return Container(</span><br><span class="line">          color: Theme.of(context).cardColor,</span><br><span class="line">          child: Scrollbar(</span><br><span class="line">            child: ListView.builder(</span><br><span class="line">              controller: controller,</span><br><span class="line">              itemCount: 20,</span><br><span class="line">              itemBuilder: (context, index) &#123;</span><br><span class="line">                return ListTile(</span><br><span class="line">                  title: Text(&#x27;Item $index&#x27;),</span><br><span class="line">                );</span><br><span class="line">              &#125;,</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        );</span><br><span class="line">      &#125;,</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-7ea2aba6755849b2.gif?imageMogr2/auto-orient/strip" alt="DraggableScrollableSheet"></p>
<h2 id="6-NestedScrollView"><a href="#6-NestedScrollView" class="headerlink" title="6. NestedScrollView"></a>6. NestedScrollView</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ç”¨äºåè°ƒå¤šä¸ªç‹¬ç«‹æ»šåŠ¨åŒºåŸŸçš„å®¹å™¨ç»„ä»¶ã€‚å®ƒé€šè¿‡ NestedScrollViewCoordinator åè°ƒä¸¤ä¸ªæ»šåŠ¨æ§åˆ¶å™¨ï¼šå¤–å±‚æ»šåŠ¨ï¼ˆHeaderï¼‰å’Œå†…å±‚æ»šåŠ¨ï¼ˆBodyï¼‰ã€‚å¤–å±‚æ»šåŠ¨ç”± headerSliverBuilder å®šä¹‰çš„ Sliver ç»„ä»¶ç»„æˆï¼ˆå¦‚ SliverAppBarï¼‰ï¼Œå— PrimaryScrollController æ§åˆ¶ï¼›å†…å±‚æ»šåŠ¨ç”± body å®šä¹‰çš„æ™®é€šæ»šåŠ¨ç»„ä»¶ï¼ˆå¦‚ ListViewï¼‰ï¼Œæ‹¥æœ‰ç‹¬ç«‹çš„ ScrollController</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong></p>
</li>
</ul>
<p><strong>1.å¤–å±‚æ»šåŠ¨ä¼˜å…ˆï¼š</strong> å½“ç”¨æˆ·å‘ä¸‹æ»‘åŠ¨æ—¶ï¼Œå¤–å±‚æ»šåŠ¨å…ˆæ¶ˆè€—æ»šåŠ¨äº‹ä»¶ï¼Œç›´åˆ°å¤–å±‚å®Œå…¨æŠ˜å åï¼Œå†…å±‚æ»šåŠ¨æ¥ç®¡ã€‚<br><strong>2.å†…å±‚åå‘ä¼˜å…ˆï¼š</strong> å½“å†…å±‚æ»šåŠ¨åˆ°è¾¾é¡¶éƒ¨ä¸”ç”¨æˆ·ç»§ç»­ä¸Šæ»‘æ—¶ï¼Œå¤–å±‚æ»šåŠ¨ä¼šå±•å¼€</p>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> ç¡®ä¿å†…éƒ¨å¯æ»šåŠ¨ç»„ä»¶ï¼ˆbodyï¼‰çš„ physics å±æ€§è®¾ç½®æ­£ç¡®ï¼Œä»¥é¿å…æ»šåŠ¨å†²çª</p>
</li>
<li><p><strong>æ¨èï¼š</strong> æŠ˜å å¤´éƒ¨å›¾ç‰‡æ•ˆæœ</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">NestedScrollView(</span><br><span class="line">          headerSliverBuilder: (BuildContext context, bool innerBoxIsScrolled) &#123;</span><br><span class="line">    return &lt;Widget&gt;[</span><br><span class="line">      SliverAppBar(</span><br><span class="line">        title: const Text(&#x27;NestedScrollView Example&#x27;),</span><br><span class="line">        pinned: true,</span><br><span class="line">        floating: true,</span><br><span class="line">        forceElevated: innerBoxIsScrolled,</span><br><span class="line">        expandedHeight: 160.0,</span><br><span class="line">        flexibleSpace: FlexibleSpaceBar(</span><br><span class="line">          background: Image.network(</span><br><span class="line">            &quot;https://miaobi-lite.bj.bcebos.com/miaobi/5mao/b%275aS05YOPYXBwXzE3MzM3NjcxODMuODQyNDgz%27/0.png&quot;,</span><br><span class="line">            fit: BoxFit.cover,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    ];</span><br><span class="line">  &#125;,</span><br><span class="line">  body: ListView.builder(</span><br><span class="line">    itemCount: 50,</span><br><span class="line">    itemBuilder: (BuildContext context, int index) &#123;</span><br><span class="line">      return ListTile(</span><br><span class="line">        title: Text(&#x27;List Item $index&#x27;),</span><br><span class="line">      );</span><br><span class="line">    &#125;,</span><br><span class="line">  ),</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-52f9c772406edf5f.gif?imageMogr2/auto-orient/strip" alt="NestedScrollView"></p>
<h2 id="7-ScrollConfiguration"><a href="#7-ScrollConfiguration" class="headerlink" title="7. ScrollConfiguration"></a>7. ScrollConfiguration</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ç”¨äºç»Ÿä¸€æ§åˆ¶å­ç»„ä»¶æ ‘çš„æ»šåŠ¨è¡Œä¸ºï¼ˆå¦‚æ»šåŠ¨æ¡æ ·å¼ã€æ‹–æ‹½åé¦ˆç­‰ï¼‰ï¼Œå°¤å…¶é€‚ç”¨äºå®šåˆ¶ä¸åŒå¹³å°çš„æ»šåŠ¨ä½“éªŒ</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> ScrollConfiguration åº”è¯¥ç›´æ¥æ”¾ç½®åœ¨åˆ—è¡¨ç»„ä»¶çš„çˆ¶ç»„ä»¶ä¸‹ï¼Œä»¥é¿å…ä¸å…¶ä»–åˆ—è¡¨ç»„ä»¶å‘ç”Ÿå†²çªï¼Œè‹¥éœ€è¦å…¨å±€è®¾ç½®æ•´ä¸ªåº”ç”¨ç¨‹åºçš„æ‰€æœ‰åˆ—è¡¨é»˜è®¤æ ·å¼ï¼Œåˆ™å¯å°† ScrollConfiguration ç»„ä»¶æ’å…¥æ¥è¿‘ç»„ä»¶æ ‘æ ¹éƒ¨çš„ä½ç½®</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> ç”±äº ScrollConfiguration çš„å­ç»„ä»¶å¯èƒ½ä¸º nullï¼Œå› æ­¤åœ¨ä½¿ç”¨æ—¶éœ€è¦è¿›è¡Œ null æ£€æŸ¥ï¼Œä»¥é¿å…æ½œåœ¨çš„é”™è¯¯</p>
</li>
<li><p><strong>æ¨èï¼š</strong> è‡ªå®šä¹‰æ»šåŠ¨æ¡çš„æ ·å¼ï¼Œå¦‚é¢œè‰²ã€åšåº¦</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ScrollConfiguration(</span><br><span class="line">  behavior: MyCustomBehavior(),</span><br><span class="line">  child: ListView.separated(</span><br><span class="line">    itemCount: 20,</span><br><span class="line">    separatorBuilder: (_, __) =&gt; Divider(),</span><br><span class="line">    itemBuilder: (_, index) &#123;</span><br><span class="line">      return Container(</span><br><span class="line">        height: 56,</span><br><span class="line">        alignment: Alignment.center,</span><br><span class="line">        child: Text(&quot;è¿™æ˜¯ç¬¬ $&#123;index + 1&#125; é¡¹&quot;),</span><br><span class="line">      );</span><br><span class="line">    &#125;,</span><br><span class="line">  ),</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">class MyCustomBehavior extends ScrollBehavior &#123;</span><br><span class="line">  @override</span><br><span class="line">  Widget buildViewportChrome(BuildContext context, Widget child, AxisDirection axisDirection) &#123;</span><br><span class="line">    // è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼</span><br><span class="line">    return GlowingOverscrollIndicator(</span><br><span class="line">      axisDirection: axisDirection,</span><br><span class="line">      color: Colors.grey, // è®¾ç½®æ»šåŠ¨æ¡é¢œè‰²ä¸ºç°è‰²</span><br><span class="line">      child: child,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  ScrollPhysics getScrollPhysics(BuildContext context) &#123;</span><br><span class="line">    // ä½¿ç”¨ ClampingScrollPhysics é˜²æ­¢è¿‡åº¦æ»šåŠ¨</span><br><span class="line">    return ClampingScrollPhysics();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-286ad153ba6dc757.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ScrollConfiguration"></p>
<h1 id="Sliver-ç³»åˆ—æ§ä»¶-ç”¨äº-CustomScrollView"><a href="#Sliver-ç³»åˆ—æ§ä»¶-ç”¨äº-CustomScrollView" class="headerlink" title="Sliver ç³»åˆ—æ§ä»¶ (ç”¨äº CustomScrollView)"></a>Sliver ç³»åˆ—æ§ä»¶ (ç”¨äº CustomScrollView)</h1><h2 id="1-SliverList"><a href="#1-SliverList" class="headerlink" title="1. SliverList"></a>1. SliverList</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> åˆ›å»ºçº¿æ€§å¯æ»šåŠ¨åˆ—è¡¨çš„ç»„ä»¶ï¼Œå®ƒå±äº Sliver å®¶æ—çš„ä¸€éƒ¨åˆ†ï¼ŒSliverList éœ€è¦ä¸ CustomScrollView ç»“åˆä½¿ç”¨ï¼Œä»¥å®ç°å¤æ‚çš„æ»šåŠ¨æ•ˆæœ</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> ä½¿ç”¨ SliverChildDelegate æ¥æ„å»ºå­ç»„ä»¶ã€‚å¸¸ç”¨çš„å®ç°æ˜¯ SliverChildBuilderDelegate å’Œ SliverChildListDelegateã€‚SliverChildListDelegate: ï¼ˆé™æ€åˆ—è¡¨ï¼‰é€‚ç”¨äºå·²çŸ¥æ•°é‡çš„å­ç»„ä»¶ï¼Œä¸€æ¬¡æ€§å…¨éƒ¨æ¸²æŸ“ã€‚<br>SliverChildBuilderDelegate: ï¼ˆåŠ¨æ€æ„å»ºåˆ—è¡¨é¡¹ï¼‰é€‚ç”¨äºæœªçŸ¥æ•°é‡çš„å­ç»„ä»¶ï¼ŒæŒ‰éœ€åŠ è½½å’Œé”€æ¯åˆ—è¡¨é¡¹ï¼Œæå‡æ€§èƒ½ã€‚</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> å¿…é¡»é€šè¿‡ä»£ç†ç”Ÿæˆå­é¡¹ï¼Œå…¶æ ¸å¿ƒç‰¹ç‚¹æ˜¯æ”¯æŒç»Ÿä¸€æ»šåŠ¨ã€é¿å…æ»‘åŠ¨å†²çª</p>
</li>
<li><p><strong>æ¨èï¼š</strong> æ»šåŠ¨æ—¶ä¸¤ä¸ªåˆ—è¡¨æ— ç¼è¡”æ¥ï¼Œæ— æ»‘åŠ¨å†²çªï¼Œå®ç°å¸é¡¶ AppBar å’Œåˆ—è¡¨è”åŠ¨</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CustomScrollView(</span><br><span class="line">  slivers: &lt;Widget&gt;[</span><br><span class="line">    const SliverAppBar(</span><br><span class="line">      expandedHeight: 250,</span><br><span class="line">      flexibleSpace: FlexibleSpaceBar(</span><br><span class="line">        title: Text(&#x27;SliverList ç¤ºä¾‹&#x27;),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">    SliverList(</span><br><span class="line">      delegate: SliverChildBuilderDelegate(</span><br><span class="line">        (BuildContext context, int index) &#123;</span><br><span class="line">          return ListTile(</span><br><span class="line">            title: Text(&#x27;Item #$index&#x27;),</span><br><span class="line">          );</span><br><span class="line">        &#125;,</span><br><span class="line">        childCount: 20, // åˆ—è¡¨é¡¹æ•°ç›®</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">    SliverFixedExtentList(</span><br><span class="line">      itemExtent: 50.0,</span><br><span class="line">      delegate: SliverChildBuilderDelegate(</span><br><span class="line">        (BuildContext context, int index) &#123;</span><br><span class="line">          return Container(</span><br><span class="line">            alignment: Alignment.center,</span><br><span class="line">            color: Colors.blue[100 * (index % 9)],</span><br><span class="line">            child: Text(&quot;list item $index&quot;),</span><br><span class="line">          );</span><br><span class="line">        &#125;,</span><br><span class="line">        childCount: 50,</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-5a49215fabf128ae.gif?imageMogr2/auto-orient/strip" alt="SliverList"></p>
<h2 id="2-SliverGrid"><a href="#2-SliverGrid" class="headerlink" title="2. SliverGrid"></a>2. SliverGrid</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> åˆ›å»ºç½‘æ ¼å¸ƒå±€çš„ Sliver ç»„ä»¶ï¼Œå®ƒéå¸¸é€‚åˆä¸å…¶ä»– Sliver ç»„ä»¶ç»“åˆä½¿ç”¨ï¼Œä»¥æ„å»ºå¤æ‚çš„å¯æ»šåŠ¨å¸ƒå±€ï¼Œ</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> SliverGrid éœ€è¦æŒ‡å®š gridDelegate å’Œ delegate å±æ€§ã€‚gridDelegate æ§åˆ¶ç½‘æ ¼å¸ƒå±€ï¼Œè€Œ delegate ç”¨äºæ„å»ºæ¯ä¸ªç½‘æ ¼å•å…ƒçš„å†…å®¹ï¼ŒSliverGrid æä¾›äº†ä¸‰ç§ä¸»è¦çš„æ„é€ æ–¹æ³•ï¼š1.SliverGridï¼šé€‚ç”¨äºåŠ¨æ€æ˜¾ç¤ºå†…å®¹ï¼ˆä»æ•°æ®åº“æˆ– API è·å–ï¼‰ã€‚2.SliverGrid.extentï¼šå…è®¸æŒ‡å®šå­é¡¹çš„æœ€å¤§è·¨è½´èŒƒå›´ã€‚3.SliverGrid.countï¼šç”¨äºæŒ‡å®šè·¨è½´ä¸Šå›ºå®šæ•°é‡çš„å­é¡¹</p>
</li>
</ul>
</blockquote>
<ol>
<li><strong>delegateï¼š</strong> æ§åˆ¶å­é¡¹ç”Ÿæˆï¼Œå¸¸ç”¨ï¼š</li>
</ol>
<ul>
<li><strong>SliverChildListDelegateï¼š</strong> é™æ€å­é¡¹åˆ—è¡¨</li>
<li><strong>SliverChildBuilderDelegateï¼š</strong> åŠ¨æ€æ‡’åŠ è½½å­é¡¹</li>
</ul>
<ol start="4">
<li><strong>gridDelegateï¼š</strong> æ§åˆ¶ç½‘æ ¼å¸ƒå±€ï¼Œä¸¤ç§å®ç°ï¼š</li>
</ol>
<ul>
<li><strong>SliverGridDelegateWithFixedCrossAxisCountï¼š</strong> å›ºå®šåˆ—æ•°</li>
<li><strong>SliverGridDelegateWithMaxCrossAxisExtentï¼š</strong> é™åˆ¶å­é¡¹æœ€å¤§å®½åº¦<blockquote>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> æŒ‰éœ€åŠ è½½å­é¡¹ï¼Œæ€§èƒ½ä¼˜äºä¸€æ¬¡æ€§æ„å»ºæ‰€æœ‰å­é¡¹çš„ GridViewï¼Œä¸æ™®é€šçš„ç½‘æ ¼å¸ƒå±€ç»„ä»¶ï¼ˆå¦‚ GridViewï¼‰ä¸åŒï¼ŒSliverGrid ä¸ä¼šæå‰æ¸²æŸ“æ‰€æœ‰ç½‘æ ¼é¡¹ï¼Œè€Œæ˜¯åœ¨æ»šåŠ¨æ—¶åŠ¨æ€æ¸²æŸ“å½“å‰å¯è§çš„éƒ¨åˆ†ï¼Œä»è€ŒèŠ‚çœå†…å­˜å’Œæ¸²æŸ“æ—¶é—´</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ä¸‹æ‹‰åˆ·æ–°ã€åµŒå¥—æ»šåŠ¨</p>
</li>
</ul>
</blockquote>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CustomScrollView(</span><br><span class="line">  slivers: [</span><br><span class="line">    SliverAppBar(</span><br><span class="line">      // å¯æŠ˜å æ ‡é¢˜æ </span><br><span class="line">      expandedHeight: 200,</span><br><span class="line">      flexibleSpace: FlexibleSpaceBar(</span><br><span class="line">          background: Image.network(</span><br><span class="line">              &#x27;https://miaobi-lite.bj.bcebos.com/miaobi/5mao/b%275aS05YOPYXBwXzE3MzM3NjcxODMuODQyNDgz%27/0.png&#x27;,</span><br><span class="line">              fit: BoxFit.cover)),</span><br><span class="line">    ),</span><br><span class="line">    SliverGrid(</span><br><span class="line">      // ç½‘æ ¼åŒºåŸŸ</span><br><span class="line">      delegate: SliverChildBuilderDelegate((ctx, i) =&gt; Container(</span><br><span class="line">            color: [</span><br><span class="line">              Colors.red,</span><br><span class="line">              Colors.blue,</span><br><span class="line">              Colors.black,</span><br><span class="line">              Colors.yellow,</span><br><span class="line">              Colors.green</span><br><span class="line">            ][i % 5],</span><br><span class="line">          )),</span><br><span class="line">      gridDelegate: const SliverGridDelegateWithMaxCrossAxisExtent(</span><br><span class="line">        maxCrossAxisExtent: 150, // è‡ªé€‚åº”å®½åº¦</span><br><span class="line">        mainAxisSpacing: 10,</span><br><span class="line">        crossAxisSpacing: 10,</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-3edae1a2e0488831.gif?imageMogr2/auto-orient/strip" alt="SliverGrid"></p>
<h2 id="3-SliverAppBar"><a href="#3-SliverAppBar" class="headerlink" title="3. SliverAppBar"></a>3. SliverAppBar</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> åˆ›å»ºå¯æ»šåŠ¨åº”ç”¨æ çš„ç»„ä»¶ï¼Œå®ƒå¯ä»¥åœ¨æ»šåŠ¨è¿‡ç¨‹ä¸­åŠ¨æ€å˜åŒ–ï¼Œå¦‚å±•å¼€ã€æ”¶ç¼©æˆ–å›ºå®šåœ¨é¡¶éƒ¨ã€‚SliverAppBar é€šå¸¸ä¸ CustomScrollView æ­é…ä½¿ç”¨ï¼Œå¯ä»¥å®ç°å¤æ‚çš„æ»šåŠ¨æ•ˆæœï¼Œç±»ä¼¼äº Android ä¸­çš„ CollapsingToolbarLayout</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong></p>
</li>
</ul>
</blockquote>
<ol>
<li><strong>expandedHeightï¼š</strong> æŒ‡å®š SliverAppBar å±•å¼€æ—¶çš„é«˜åº¦ã€‚</li>
<li><strong>pinnedï¼š</strong> è®¾ç½®ä¸º true æ—¶ï¼ŒAppBar å°†åœ¨æ»šåŠ¨åˆ°é¡¶éƒ¨æ—¶å›ºå®šåœ¨å±å¹•é¡¶éƒ¨ã€‚</li>
<li><strong>floatingï¼š</strong> è®¾ç½®ä¸º true æ—¶ï¼Œå½“å‘ä¸‹æ»šåŠ¨æ—¶ï¼ŒAppBar ä¼šé‡æ–°å‡ºç°ã€‚</li>
<li><strong>snapï¼š</strong> é…åˆ floating å±æ€§ä½¿ç”¨ï¼Œå½“è®¾ç½®ä¸º true æ—¶ï¼ŒSliverAppBar ä¼šåœ¨æ»‘åŠ¨è¿‡ç¨‹ä¸­è‡ªåŠ¨â€œå¸é™„â€åˆ°é¡¶éƒ¨æˆ–æ¶ˆå¤±ã€‚</li>
<li><strong>flexibleSpaceï¼š</strong> ç”¨äºå®šä¹‰å¯ä¼¸ç¼©çš„ç©ºé—´ï¼Œé€šå¸¸ä½¿ç”¨ FlexibleSpaceBarã€‚</li>
<li><strong>backgroundColorï¼š</strong> è®¾ç½® AppBar çš„èƒŒæ™¯è‰²ã€‚</li>
<li><strong>titleï¼š</strong> è®¾ç½® AppBar çš„æ ‡é¢˜ã€‚</li>
<li><strong>leadingï¼š</strong> è®¾ç½® AppBar å‰é¢æ˜¾ç¤ºçš„ä¸€ä¸ªæ§ä»¶ã€‚</li>
<li><strong>actionsï¼š</strong> è®¾ç½® AppBar çš„æ“ä½œæŒ‰é’®ã€‚</li>
<li><strong>bottomï¼š</strong> è®¾ç½® AppBar çš„åº•éƒ¨åŒºåŸŸï¼Œé€šå¸¸ç”¨äºæ·»åŠ  TabBarã€‚<blockquote>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> pinned å’Œ floating ä¸å¯åŒæ—¶ä¸º trueï¼Œå¦åˆ™å¼•å‘å¸ƒå±€å†²çªï¼Œå¿…é¡»åµŒå¥—åœ¨ Sliver å®¹å™¨ï¼Œé¿å…åœ¨ flexibleSpace ä¸­ä½¿ç”¨å¤æ‚åŠ¨ç”»ï¼Œå¯èƒ½å¯¼è‡´æ»šåŠ¨å¡é¡¿ï¼Œå¦‚æœéœ€è¦å®ç°æ»šåŠ¨æŠ˜å æ•ˆæœï¼ŒflexibleSpace å¿…é¡»åŒ…å« FlexibleSpaceBar</p>
</li>
<li><p><strong>æ¨èï¼š</strong> æŠ˜å å¼å›¾ç‰‡æ ‡é¢˜ã€å¿«é€Ÿå±•å¼€çš„æœç´¢æ ã€å¸¦æ‚¬æµ® Tab çš„åˆ†é¡µå¸ƒå±€</p>
</li>
</ul>
</blockquote>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DefaultTabController(</span><br><span class="line">  length: 2,</span><br><span class="line">  child: Scaffold(</span><br><span class="line">    body: NestedScrollView(</span><br><span class="line">      headerSliverBuilder:</span><br><span class="line">          (BuildContext context, bool innerBoxIsScrolled) &#123;</span><br><span class="line">        return &lt;Widget&gt;[</span><br><span class="line">          SliverAppBar(</span><br><span class="line">            expandedHeight: 200.0,</span><br><span class="line">            floating: false,</span><br><span class="line">            pinned: true,</span><br><span class="line">            flexibleSpace: FlexibleSpaceBar(</span><br><span class="line">              title: const Text(&#x27;SliverAppBar Example&#x27;),</span><br><span class="line">              background: Image.network(</span><br><span class="line">                &#x27;https://img.win3000.com/m00/76/6a/3fb7a5729f51fedf4261cb02addbd133.jpg&#x27;,</span><br><span class="line">                fit: BoxFit.cover,</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">            bottom: const TabBar(</span><br><span class="line">              tabs: [</span><br><span class="line">                Tab(icon: Icon(Icons.home), text: &#x27;Home&#x27;),</span><br><span class="line">                Tab(icon: Icon(Icons.settings), text: &#x27;Settings&#x27;),</span><br><span class="line">              ],</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        ];</span><br><span class="line">      &#125;,</span><br><span class="line">      body: TabBarView(</span><br><span class="line">        children: [</span><br><span class="line">          CustomScrollView(</span><br><span class="line">            slivers: [</span><br><span class="line">              SliverList(</span><br><span class="line">                delegate: SliverChildBuilderDelegate(</span><br><span class="line">                  (BuildContext context, int index) &#123;</span><br><span class="line">                    return Container(</span><br><span class="line">                      height: 85,</span><br><span class="line">                      alignment: Alignment.center,</span><br><span class="line">                      color: Colors</span><br><span class="line">                          .primaries[index % Colors.primaries.length],</span><br><span class="line">                      child: Text(</span><br><span class="line">                        &#x27;$index&#x27;,</span><br><span class="line">                        style: const TextStyle(</span><br><span class="line">                            color: Colors.white, fontSize: 20.0),</span><br><span class="line">                      ),</span><br><span class="line">                    );</span><br><span class="line">                  &#125;,</span><br><span class="line">                  childCount: 25,</span><br><span class="line">                ),</span><br><span class="line">              ),</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">          CustomScrollView(</span><br><span class="line">            slivers: [</span><br><span class="line">              SliverList(</span><br><span class="line">                delegate: SliverChildBuilderDelegate(</span><br><span class="line">                  (BuildContext context, int index) &#123;</span><br><span class="line">                    return Container(</span><br><span class="line">                      height: 85,</span><br><span class="line">                      alignment: Alignment.center,</span><br><span class="line">                      color: Colors</span><br><span class="line">                          .primaries[index % Colors.primaries.length],</span><br><span class="line">                      child: Text(</span><br><span class="line">                        &#x27;$index&#x27;,</span><br><span class="line">                        style: const TextStyle(</span><br><span class="line">                            color: Colors.white, fontSize: 20.0),</span><br><span class="line">                      ),</span><br><span class="line">                    );</span><br><span class="line">                  &#125;,</span><br><span class="line">                  childCount: 25,</span><br><span class="line">                ),</span><br><span class="line">              ),</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-381c79d850c5f7c6.gif?imageMogr2/auto-orient/strip" alt="SliverAppBar"></p>
<h2 id="4-SliverPadding"><a href="#4-SliverPadding" class="headerlink" title="4. SliverPadding"></a>4. SliverPadding</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ä¸“é—¨ç”¨äºåœ¨ æ»šåŠ¨å¸ƒå±€ï¼ˆå¦‚ CustomScrollViewï¼‰ä¸­ä¸ºå­ Sliver ç»„ä»¶æ·»åŠ å†…è¾¹è·çš„ç»„ä»¶ã€‚å®ƒå±äº Sliver å®¶æ—ï¼Œé€‚ç”¨äºéœ€è¦ç²¾ç»†æ§åˆ¶æ»šåŠ¨åŒºåŸŸé—´è·çš„åœºæ™¯ï¼Œä¾‹å¦‚åœ¨ SliverListã€SliverGrid ç­‰ç»„ä»¶å¤–éƒ¨åŒ…è£¹è¾¹è·</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> ä»…èƒ½ä½œä¸º CustomScrollView çš„ slivers æ•°ç»„çš„ç›´æ¥å­ç»„ä»¶ä½¿ç”¨ï¼Œä¸å¯å•ç‹¬ç”¨äºæ™®é€šå¸ƒå±€ã€‚SliverPadding çš„ sliver å±æ€§å¿…é¡»æ˜¯ä¸€ä¸ª Sliver ç±»å‹çš„ç»„ä»¶ï¼Œå¦åˆ™ä¼šå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯</p>
</li>
</ul>
<p>æ ¸å¿ƒå‚æ•°ï¼š<br>paddingï¼ˆå¿…å¡«ï¼‰ï¼šé€šè¿‡ EdgeInsets è®¾ç½®è¾¹è·ï¼ˆä¸Šã€ä¸‹ã€å·¦ã€å³æˆ–å¯¹ç§°è¾¹è·ï¼‰ã€‚<br>sliverï¼ˆå¿…å¡«ï¼‰ï¼šæ¥å—ä»»æ„ Sliver ç»„ä»¶ï¼ˆå¦‚ SliverListã€SliverGridï¼‰</p>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> æ™®é€š Padding ç”¨äºé™æ€å¸ƒå±€ï¼Œè€Œ SliverPadding ä¸“ä¸ºæ»šåŠ¨è§†å›¾ä¼˜åŒ–ï¼Œèƒ½æ­£ç¡®è®¡ç®—æ»šåŠ¨åŒºåŸŸå’Œè§†å£è¾¹ç•Œï¼Œé¿å…åœ¨ SliverPadding å†…åµŒå¥—å¤šå±‚ Sliver ç»„ä»¶ï¼Œæ¨èç›´æ¥åŒ…è£¹ç›®æ ‡ç»„ä»¶ï¼Œå¦‚éœ€é¿å¼€åˆ˜æµ·å±æˆ–åº•éƒ¨å¯¼èˆªæ ï¼Œä¼˜å…ˆä½¿ç”¨ SliverSafeArea è€Œé SliverPadding</p>
</li>
<li><p><strong>æ¨èï¼š</strong> åˆ—è¡¨&#x2F;ç½‘æ ¼çš„å…¨å±€è¾¹è·ã€å¤æ‚æ»šåŠ¨å¸ƒå±€çš„é—´éš”æ§åˆ¶</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CustomScrollView(</span><br><span class="line">  slivers: [</span><br><span class="line">    const SliverAppBar(title: Text(&#x27;SliverPadding ç¤ºä¾‹&#x27;)),</span><br><span class="line">    SliverPadding(</span><br><span class="line">      padding: const EdgeInsets.all(20), // å…¨å±€è¾¹è·</span><br><span class="line">      sliver: SliverList(</span><br><span class="line">        delegate: SliverChildBuilderDelegate(</span><br><span class="line">          (context, index) =&gt; ListTile(</span><br><span class="line">            title: Text(&quot;åˆ—è¡¨é¡¹ $index&quot;),</span><br><span class="line">          ),</span><br><span class="line">          childCount: 20,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">    SliverPadding(</span><br><span class="line">      padding: const EdgeInsets.only(top: 30, bottom: 50), // ä»…ä¸Šä¸‹è¾¹è·</span><br><span class="line">      sliver: SliverGrid(</span><br><span class="line">        gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(</span><br><span class="line">          crossAxisCount: 2,</span><br><span class="line">          crossAxisSpacing: 10,</span><br><span class="line">          mainAxisSpacing: 10,</span><br><span class="line">        ),</span><br><span class="line">        delegate: SliverChildBuilderDelegate(</span><br><span class="line">          (context, index) =&gt; Container(</span><br><span class="line">            color: Colors.blue,</span><br><span class="line">            child: Center(child: Text(&quot;ç½‘æ ¼ $index&quot;)),</span><br><span class="line">          ),</span><br><span class="line">          childCount: 6,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-702f268897f0da9b.gif?imageMogr2/auto-orient/strip" alt="SliverPadding"></p>
<h2 id="5-SliverToBoxAdapter"><a href="#5-SliverToBoxAdapter" class="headerlink" title="5. SliverToBoxAdapter"></a>5. SliverToBoxAdapter</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> å°†æ™®é€š ç›’æ¨¡å‹å¸ƒå±€ç»„ä»¶ï¼ˆå¦‚ Containerã€Text ç­‰ï¼‰åµŒå…¥åˆ° Sliver æ»šåŠ¨å¸ƒå±€ï¼ˆå¦‚ CustomScrollViewï¼‰ä¸­çš„é€‚é…å™¨ã€‚å®ƒå…è®¸é Sliver ç»„ä»¶ï¼ˆå³éæ»šåŠ¨ä¸“ç”¨ç»„ä»¶ï¼‰ä½œä¸º Sliver åˆ—è¡¨çš„ä¸€éƒ¨åˆ†å‚ä¸æ»šåŠ¨ï¼Œåœ¨ CustomScrollView çš„ slivers åˆ—è¡¨ä¸­æ··åˆä½¿ç”¨å¸¸è§„ Widget ä¸ Sliver ç»„ä»¶ï¼ˆå¦‚ SliverListã€SliverGridï¼‰</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> åªèƒ½ç”¨äº CustomScrollView.slivers æˆ–åµŒå¥—çš„ Sliver å®¹å™¨ï¼ˆå¦‚ SliverPaddingï¼‰ï¼Œé Sliver ç»„ä»¶ï¼ˆå¦‚ Containerï¼‰å¿…é¡»æŒ‡å®šé«˜åº¦æˆ–å®½åº¦ï¼Œå¦åˆ™ä¼šå› æ— é™ç©ºé—´çº¦æŸå¯¼è‡´å¸ƒå±€é”™è¯¯ï¼Œè‹¥å­ç»„ä»¶åŒ…å« ListView ç­‰è‡ªèº«å¯æ»šåŠ¨çš„ Widgetï¼Œéœ€ç¦ç”¨å…¶æ»šåŠ¨è¡Œä¸ºï¼ˆå¦‚ physics: NeverScrollableScrollPhysics()ï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> å°½é‡é¿å…åœ¨ SliverToBoxAdapter ä¸­åµŒå¥—è¿‡å¤šçš„å¤æ‚å¸ƒå±€ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å¸ƒå±€è®¡ç®—å˜æ…¢ï¼Œè™½ç„¶ SliverToBoxAdapter æä¾›äº†ä¾¿åˆ©æ€§ï¼Œä½†åœ¨å¤§é‡ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„æ€§èƒ½é—®é¢˜ï¼Œå°½é‡å‡å°‘ä¸å¿…è¦çš„åŒ…è£¹ï¼Œå¦‚æœ child çš„é«˜åº¦æ²¡æœ‰æ˜ç¡®è®¾ç½®ï¼Œå¯èƒ½ä¼šå¯¼è‡´å¸ƒå±€é—®é¢˜æˆ–æ¸²æŸ“é”™è¯¯</p>
</li>
<li><p><strong>æ¨èï¼š</strong> åˆ—è¡¨å¤´éƒ¨&#x2F;å°¾éƒ¨æ·»åŠ ç‹¬ç«‹ Widgetï¼ˆå¦‚ Bannerã€æ ‡é¢˜ã€æŒ‰é’®ï¼‰</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CustomScrollView(</span><br><span class="line">  slivers: [</span><br><span class="line">    // 1. é¡¶éƒ¨ Banner</span><br><span class="line">    SliverToBoxAdapter(</span><br><span class="line">      child: Container(</span><br><span class="line">        height: 200,</span><br><span class="line">        decoration: const BoxDecoration(</span><br><span class="line">          gradient: LinearGradient(colors: [Colors.blue, Colors.green]),</span><br><span class="line">        ),</span><br><span class="line">        child: const Center(</span><br><span class="line">            child: Text(&#x27;æ¬¢è¿é¡µ&#x27;, style: TextStyle(fontSize: 24))),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line"></span><br><span class="line">    // 2. åˆ†éš”æ ‡é¢˜</span><br><span class="line">    SliverToBoxAdapter(</span><br><span class="line">      child: Padding(</span><br><span class="line">        padding: const EdgeInsets.all(16),</span><br><span class="line">        child: Text(&#x27;äº§å“åˆ—è¡¨&#x27;,</span><br><span class="line">            style: Theme.of(context).textTheme.headlineSmall),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line"></span><br><span class="line">    // 3. ç½‘æ ¼å¸ƒå±€</span><br><span class="line">    SliverGrid(</span><br><span class="line">      gridDelegate: const SliverGridDelegateWithFixedCrossAxisCount(</span><br><span class="line">        crossAxisCount: 2,</span><br><span class="line">        childAspectRatio: 1.5,</span><br><span class="line">      ),</span><br><span class="line">      delegate: SliverChildBuilderDelegate(</span><br><span class="line">        (context, index) =&gt;</span><br><span class="line">            Card(child: Center(child: Text(&#x27;äº§å“ $index&#x27;))),</span><br><span class="line">        childCount: 6,</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line"></span><br><span class="line">    // 4. åº•éƒ¨æŒ‰é’®</span><br><span class="line">    SliverToBoxAdapter(</span><br><span class="line">      child: Padding(</span><br><span class="line">        padding: const EdgeInsets.symmetric(vertical: 20),</span><br><span class="line">        child: ElevatedButton(</span><br><span class="line">          onPressed: () &#123;&#125;,</span><br><span class="line">          child: const Text(&#x27;åŠ è½½æ›´å¤š&#x27;),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-01d7b324eb8d37e0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="SliverToBoxAdapter"></p>
<h2 id="6-SliverFillRemaining"><a href="#6-SliverFillRemaining" class="headerlink" title="6. SliverFillRemaining"></a>6. SliverFillRemaining</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ç”¨äº å¡«å……æ»šåŠ¨è§†å›¾å‰©ä½™ç©ºé—´ çš„ Sliver å¸ƒå±€ç»„ä»¶ã€‚å®ƒä¼šæ ¹æ®çˆ¶å®¹å™¨çš„å‰©ä½™é«˜åº¦æˆ–å®½åº¦è‡ªåŠ¨è°ƒæ•´è‡ªèº«å¤§å°ï¼Œç¡®ä¿å†…å®¹åŒºåŸŸå æ»¡å±å¹•å¯è§†åŒºåŸŸã€‚é€‚ç”¨äºéœ€è¦åŠ¨æ€é€‚é…å‰©ä½™ç©ºé—´çš„åœºæ™¯</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> ä½œä¸º CustomScrollView çš„ slivers åˆ—è¡¨ä¸­çš„æœ€åä¸€ä¸ªç»„ä»¶ï¼Œç”¨äºå¡«å……å‰©ä½™ç©ºé—´ï¼Œå…è®¸ç»„ä»¶è‡ªé€‚åº”åœ°å¡«å……å‰©ä½™ç©ºé—´ï¼Œæ— è®ºå‰©ä½™ç©ºé—´å¦‚ä½•å˜åŒ–</p>
</li>
</ul>
<p><strong>å…³é”®å‚æ•°</strong><br><strong>1. childï¼š</strong> å¿…å¡«ï¼Œç”¨äºå¡«å……å‰©ä½™ç©ºé—´çš„å­ç»„ä»¶ã€‚<br><strong>2. hasScrollBodyï¼š</strong></p>
</blockquote>
<ul>
<li>é»˜è®¤ trueï¼šå­ç»„ä»¶å¯æ»šåŠ¨ï¼ˆå¦‚ ListViewï¼‰ï¼Œé€‚ç”¨äºå†…å®¹è¶…å‡ºå‰©ä½™ç©ºé—´çš„æƒ…å†µã€‚</li>
<li>falseï¼šå­ç»„ä»¶ä¸å¯æ»šåŠ¨ï¼ˆå¦‚ Columnï¼‰ï¼Œå†…å®¹é«˜åº¦ä¸è¶…è¿‡å‰©ä½™ç©ºé—´ 710ã€‚<br><strong>3. fillOverscrollï¼š</strong></li>
<li>trueï¼šåœ¨è¿‡åº¦æ»šåŠ¨æ—¶ç»§ç»­å¡«å……ï¼ˆå¦‚ iOS å›å¼¹æ•ˆæœï¼‰ã€‚</li>
<li>falseï¼šä»…å¡«å……æœªæ»šåŠ¨åŒºåŸŸï¼ˆé»˜è®¤å€¼ï¼‰<blockquote>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> å½“ hasScrollBody: true æ—¶ï¼Œå­ç»„ä»¶å¿…é¡»æ˜¯å¯æ»šåŠ¨çš„ï¼ˆå¦‚ ListViewï¼‰ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¸ƒå±€é”™è¯¯ï¼ŒSliverFillRemaining åœ¨æ»šåŠ¨è§†å›¾ä¸­åŠ¨æ€å¡«å……å‰©ä½™ç©ºé—´ï¼Œè€Œ SingleChildScrollView ä¼šå°è¯•åŒ…è£¹æ•´ä¸ªå†…å®¹ï¼Œå¯èƒ½å¯¼è‡´å¸ƒå±€æº¢å‡ºï¼Œåœ¨é•¿åˆ—è¡¨åº•éƒ¨ä½¿ç”¨ SliverFillRemaining æ—¶ï¼Œé¿å…åœ¨ child ä¸­åµŒå¥—å¤æ‚å¸ƒå±€ï¼Œé˜²æ­¢é‡å¤æ„å»º</p>
</li>
<li><p><strong>æ¨èï¼š</strong> è¡¨å•åº•éƒ¨å›ºå®šæŒ‰é’®ã€åˆ†é¡µåŠ è½½å ä½ã€å…¨å±å†…å®¹é€‚é…</p>
</li>
</ul>
</blockquote>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CustomScrollView(</span><br><span class="line">  slivers: &lt;Widget&gt;[</span><br><span class="line">    const SliverAppBar(</span><br><span class="line">      expandedHeight: 200.0,</span><br><span class="line">      flexibleSpace: FlexibleSpaceBar(</span><br><span class="line">        title: Text(&#x27;Flexible Space&#x27;),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">    SliverList(</span><br><span class="line">      delegate: SliverChildListDelegate(</span><br><span class="line">        [</span><br><span class="line">          Container(</span><br><span class="line">            height: 500,</span><br><span class="line">            color: Colors.amber,</span><br><span class="line">            alignment: Alignment.center,</span><br><span class="line">            child: const Text(&#x27;List Item&#x27;),</span><br><span class="line">          ),</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">    SliverFillRemaining(</span><br><span class="line">      hasScrollBody: false,</span><br><span class="line">      child: Container(</span><br><span class="line">        color: Colors.blue,</span><br><span class="line">        alignment: Alignment.center,</span><br><span class="line">        child: const Text(&#x27;Fill Remaining Space&#x27;,</span><br><span class="line">            style: TextStyle(color: Colors.white)),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-fd770d6ba2b08b9d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="SliverFillRemaining"></p>
<h2 id="7-SliverPersistentHeader"><a href="#7-SliverPersistentHeader" class="headerlink" title="7. SliverPersistentHeader"></a>7. SliverPersistentHeader</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> åˆ›å»ºå¯æŠ˜å &#x2F;æ‚¬æµ®çš„å¤´éƒ¨çš„Sliverç»„ä»¶ï¼Œåœ¨æ»šåŠ¨è§†å›¾ä¸­åˆ›å»ºä¸€ä¸ªæŒä¹…åŒ–çš„å¤´éƒ¨ç»„ä»¶ï¼Œè¯¥å¤´éƒ¨ç»„ä»¶å¯ä»¥æ ¹æ®æ»šåŠ¨ä½ç½®è‡ªåŠ¨è°ƒæ•´å¤§å°ã€é€æ˜åº¦æˆ–å…¶ä»–å±æ€§ã€‚å¯ä»¥å›ºå®šåœ¨é¡µé¢é¡¶éƒ¨æˆ–åº•éƒ¨ï¼Œä¹Ÿå¯ä»¥éšç€æ»šåŠ¨è€ŒåŠ¨æ€å˜åŒ–ï¼Œä»è€Œå®ç°æ›´åŠ çµæ´»çš„å¸ƒå±€æ•ˆæœ</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong></p>
</li>
</ul>
</blockquote>
<p><strong>1. delegateï¼š</strong> å¿…éœ€å±æ€§ï¼Œç”¨äºå®šä¹‰å¤´éƒ¨ç»„ä»¶çš„æ„å»ºé€»è¾‘ã€‚<br><strong>2. pinnedï¼š</strong> å¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸º falseï¼Œå½“è®¾ç½®ä¸º true æ—¶ï¼Œå¤´éƒ¨ç»„ä»¶ä¼šåœ¨æ»šåŠ¨åˆ°é¡¶éƒ¨æ—¶å›ºå®šåœ¨è§†å›¾ä¸­ã€‚<br><strong>3. floatingï¼š</strong> å¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸º falseï¼Œå½“è®¾ç½®ä¸º true æ—¶ï¼Œå¤´éƒ¨ç»„ä»¶ä¼šåœ¨æ»šåŠ¨åˆ°é¡¶éƒ¨æ—¶çŸ­æš‚æ˜¾ç¤ºï¼Œç„¶åéšè—ã€‚</p>
<blockquote>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> pinned å’Œ floating å±æ€§ä¸èƒ½åŒæ—¶ä¸º trueï¼Œé¿å…åœ¨build()æ–¹æ³•ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œï¼Œæ¨èä½¿ç”¨constç»„ä»¶æˆ–StatelessWidgetã€‚è‹¥å†…å®¹å¤æ‚ï¼Œç”¨AutoDisposeæ··åˆRiverpodç®¡ç†çŠ¶æ€ï¼Œä¸å¯ç›´æ¥åµŒå¥—ListViewç­‰æ»šåŠ¨ç»„ä»¶ï¼Œéœ€é€šè¿‡SliverToBoxAdapterï¼Œç¡®ä¿minExtentå’ŒmaxExtentç²¾ç¡®è®¡ç®—ï¼Œé¿å…å°æ•°ç²¾åº¦è¯¯å·®ã€‚å¿…é¡»æ˜¾å¼æŒ‡å®šå¤´éƒ¨ç»„ä»¶çš„é«˜åº¦èŒƒå›´ï¼ˆminExtent å’Œ maxExtentï¼‰ã€‚å¦‚æœä¾èµ– overlapsContent å‚æ•°æ„å»ºå­ç»„ä»¶ï¼Œåˆ™å¿…é¡»ä¿è¯ä¹‹å‰è‡³å°‘è¿˜æœ‰ä¸€ä¸ª SliverPersistentHeader æˆ– SliverAppBar</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ç”µå•†åˆ†ç±»å¯¼èˆªã€æ¸å˜æ”¶ç¼©çš„Bannerå›¾</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CustomScrollView(</span><br><span class="line">  slivers: &lt;Widget&gt;[</span><br><span class="line">    // åˆ›å»ºä¸€ä¸ªå›ºå®šåœ¨é¡µé¢é¡¶éƒ¨çš„ SliverPersistentHeader</span><br><span class="line">    SliverPersistentHeader(</span><br><span class="line">      pinned: true, // å›ºå®šåœ¨é¡µé¢é¡¶éƒ¨</span><br><span class="line">      delegate: _MyHeaderDelegate(),</span><br><span class="line">    ),</span><br><span class="line">    // æ·»åŠ ä¸€ä¸ªæ™®é€šçš„ SliverList</span><br><span class="line">    SliverList(</span><br><span class="line">      delegate: SliverChildBuilderDelegate(</span><br><span class="line">        (BuildContext context, int index) &#123;</span><br><span class="line">          return ListTile(</span><br><span class="line">            title: Text(&#x27;Item $index&#x27;),</span><br><span class="line">            leading: CircleAvatar(child: Text(&#x27;$index&#x27;)),</span><br><span class="line">          );</span><br><span class="line">        &#125;,</span><br><span class="line">        childCount: 50,</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">class _MyHeaderDelegate extends SliverPersistentHeaderDelegate &#123;</span><br><span class="line">  @override</span><br><span class="line">  Widget build(</span><br><span class="line">      BuildContext context, double shrinkOffset, bool overlapsContent) &#123;</span><br><span class="line">    // è·å–çŠ¶æ€æ é«˜åº¦</span><br><span class="line">    final double statusBarHeight = MediaQuery.of(context).padding.top;</span><br><span class="line">    // æ„å»ºå¤´éƒ¨ç»„ä»¶</span><br><span class="line">    return Container(</span><br><span class="line">      padding: EdgeInsets.only(top: statusBarHeight),</span><br><span class="line">      color: Colors.blue,</span><br><span class="line">      alignment: Alignment.center,</span><br><span class="line">      child: const Text(&#x27;Header&#x27;),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  double get maxExtent =&gt; 120; // æœ€å¤§é«˜åº¦</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  double get minExtent =&gt; 40; // æœ€å°é«˜åº¦</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  bool shouldRebuild(covariant SliverPersistentHeaderDelegate oldDelegate) =&gt;</span><br><span class="line">      false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-e01779df913a06ea.gif?imageMogr2/auto-orient/strip" alt="SliverPersistentHeader"></p>
<h2 id="è¿˜æœ‰å…¶ä»–çš„ä¸€äº›Sliverå¸ƒå±€æ§ä»¶"><a href="#è¿˜æœ‰å…¶ä»–çš„ä¸€äº›Sliverå¸ƒå±€æ§ä»¶" class="headerlink" title="è¿˜æœ‰å…¶ä»–çš„ä¸€äº›Sliverå¸ƒå±€æ§ä»¶"></a>è¿˜æœ‰å…¶ä»–çš„ä¸€äº›Sliverå¸ƒå±€æ§ä»¶</h2><blockquote>
<p><strong>SliverFillViewportï¼šå¡«å……è§†å£</strong></p>
<p><strong>SliverAnimatedListï¼šåŠ¨ç”»åˆ—è¡¨</strong></p>
<p><strong>SliverAnimatedOpacityï¼šåŠ¨ç”»é€æ˜åº¦</strong></p>
<p><strong>SliverIgnorePointerï¼šå¿½ç•¥æŒ‡é’ˆäº‹ä»¶</strong></p>
<p><strong>SliverOpacityï¼šé€æ˜åº¦æ•ˆæœ</strong></p>
<p><strong>SliverSafeAreaï¼šå®‰å…¨åŒºåŸŸ</strong></p>
<p><strong>SliverOverlapInjectorï¼šå¤„ç†é‡å </strong></p>
<p><strong>SliverOverlapAbsorberï¼šå¸æ”¶é‡å </strong></p>
</blockquote>
<h1 id="å“åº”å¼å¸ƒå±€æ§ä»¶"><a href="#å“åº”å¼å¸ƒå±€æ§ä»¶" class="headerlink" title="å“åº”å¼å¸ƒå±€æ§ä»¶"></a>å“åº”å¼å¸ƒå±€æ§ä»¶</h1><h2 id="1-LayoutBuilder"><a href="#1-LayoutBuilder" class="headerlink" title="1. LayoutBuilder"></a>1. LayoutBuilder</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ç”¨äºæ ¹æ®çˆ¶å®¹å™¨çš„çº¦æŸå¯¹å…¶å­ç»„ä»¶è¿›è¡Œå¸ƒå±€ã€‚å®ƒåœ¨å¸ƒå±€è¿‡ç¨‹ä¸­è·å–çˆ¶ç»„ä»¶ä¼ é€’çš„çº¦æŸä¿¡æ¯ï¼Œä»è€ŒåŠ¨æ€æ„å»ºå¸ƒå±€ã€‚è¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥æ ¹æ®çˆ¶å®¹å™¨çš„å°ºå¯¸æ¥è°ƒæ•´å­ç»„ä»¶çš„å¸ƒå±€ï¼Œéå¸¸é€‚åˆå®ç°å“åº”å¼å¸ƒå±€</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> æ ¹æ®è®¾å¤‡å°ºå¯¸åŠ¨æ€è°ƒæ•´å¸ƒå±€ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­è·å–å’Œè°ƒè¯•çº¦æŸä¿¡æ¯ï¼Œä¾¿äºæ’æŸ¥é—®é¢˜ï¼Œå¦‚æœæ˜¯ Sliver å¸ƒå±€ï¼Œå¯ä»¥ä½¿ç”¨ SliverLayoutBuilder</p>
</li>
</ul>
</blockquote>
<ol>
<li>constraints.maxWidth&#x2F;constraints.maxHeight ï¼šçˆ¶å®¹å™¨è¦æ±‚çš„æœ€å¤§å°ºå¯¸</li>
<li>constraints.minWidth&#x2F;minHeight ï¼šçˆ¶å®¹å™¨è¦æ±‚çš„æœ€å°å°ºå¯¸<blockquote>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> å¦‚æœå­ç»„ä»¶è¶…å‡ºæ˜¾ç¤ºå¤§å°ï¼Œå¯èƒ½ä¼šå¯¼è‡´é¢‘ç¹çš„ rebuildã€‚è§£å†³æ–¹æ¡ˆæ˜¯å°† constraints ä¿å­˜ä¸ºæˆå‘˜å˜é‡ï¼Œé¿å…æ¯æ¬¡ build éƒ½é€šè¿‡ LayoutBuilder è·å– constraintsï¼Œå½“çˆ¶å®¹å™¨çš„çº¦æŸå˜åŒ–ï¼ˆå¦‚å±å¹•æ—‹è½¬ã€çˆ¶å®¹å™¨å°ºå¯¸è°ƒæ•´ï¼‰æ—¶ï¼Œbuilder ä¼šé‡æ–°è°ƒç”¨ï¼Œè€ƒè™‘å¸ƒå±€çš„å¤æ‚åº¦å’ŒåŠ¨ç”»æ•ˆæœï¼Œé¿å…è¿‡é‡çš„è®¡ç®—å’Œä¸å¿…è¦çš„é‡ç»˜</p>
</li>
<li><p><strong>æ¨èï¼š</strong> è¦æ ¹æ®å±å¹•å°ºå¯¸è°ƒæ•´å¸ƒå±€ã€è·å–çº¦æŸä¿¡æ¯ï¼Œå¸®åŠ©è°ƒè¯•å¸ƒå±€é—®é¢˜</p>
</li>
</ul>
</blockquote>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Center(</span><br><span class="line">  child: Container(</span><br><span class="line">    width: 300, // çˆ¶å®¹å™¨å®½åº¦</span><br><span class="line">    height: 200, // çˆ¶å®¹å™¨é«˜åº¦</span><br><span class="line">    color: Colors.blue,</span><br><span class="line">    child: LayoutBuilder(</span><br><span class="line">      builder: (context, constraints) &#123;</span><br><span class="line">        // æ ¹æ®çˆ¶å®¹å™¨å®½åº¦åŠ¨æ€åˆ‡æ¢å¸ƒå±€</span><br><span class="line">        if (constraints.maxWidth &gt; 200) &#123;</span><br><span class="line">          return _buildWideLayout(constraints);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          return _buildNarrowLayout(constraints);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    ),</span><br><span class="line">  ),</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// å®½å¸ƒå±€ï¼šæ°´å¹³æ’åˆ—</span><br><span class="line">Widget _buildWideLayout(BoxConstraints constraints) &#123;</span><br><span class="line">return Row(</span><br><span class="line">  mainAxisAlignment: MainAxisAlignment.spaceEvenly,</span><br><span class="line">  children: [</span><br><span class="line">    Container(</span><br><span class="line">      width: constraints.maxWidth * 0.3, // å®½åº¦å çˆ¶çº§30%</span><br><span class="line">      height: 50,</span><br><span class="line">      color: Colors.red,</span><br><span class="line">    ),</span><br><span class="line">    Container(</span><br><span class="line">      width: constraints.maxWidth * 0.5, // å®½åº¦å çˆ¶çº§50%</span><br><span class="line">      height: 80,</span><br><span class="line">      color: Colors.green,</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  // çª„å¸ƒå±€ï¼šå‚ç›´æ’åˆ—</span><br><span class="line">Widget _buildNarrowLayout(BoxConstraints constraints) &#123;</span><br><span class="line">return Column(</span><br><span class="line">  mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">  children: [</span><br><span class="line">    Container(</span><br><span class="line">      width: constraints.maxWidth * 0.8, // å®½åº¦å çˆ¶çº§80%</span><br><span class="line">      height: 40,</span><br><span class="line">      color: Colors.orange,</span><br><span class="line">    ),</span><br><span class="line">    const SizedBox(height: 20),</span><br><span class="line">    Container(</span><br><span class="line">      width: constraints.maxWidth * 0.6, // å®½åº¦å çˆ¶çº§60%</span><br><span class="line">      height: 60,</span><br><span class="line">      color: Colors.purple,</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">);</span><br><span class="line">&#125;     </span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-4db845824eabcc78.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="LayoutBuilder"></p>
<h2 id="2-OrientationBuilder"><a href="#2-OrientationBuilder" class="headerlink" title="2. OrientationBuilder"></a>2. OrientationBuilder</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> æ ¹æ®è®¾å¤‡çš„æ–¹å‘ï¼ˆçºµå‘æˆ–æ¨ªå‘ï¼‰åŠ¨æ€æ„å»ºå¸ƒå±€ã€‚å®ƒæä¾›äº†ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“è®¾å¤‡æ–¹å‘å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè°ƒç”¨è¯¥å›è°ƒå‡½æ•°æ¥é‡å»ºå¸ƒå±€ã€‚è¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥æ ¹æ®ä¸åŒçš„å±å¹•æ–¹å‘æä¾›ä¸åŒçš„ç”¨æˆ·ç•Œé¢å¸ƒå±€</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> ä¾èµ–äºçˆ¶ç»„ä»¶çš„å°ºå¯¸æ¥åˆ¤æ–­å½“å‰çš„æ–¹å‘ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¾èµ–äºè®¾å¤‡çš„æ–¹å‘ã€‚å› æ­¤ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½éœ€è¦ç»“åˆ MediaQuery æ¥è·å–æ›´å‡†ç¡®çš„æ–¹å‘ä¿¡æ¯</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> ç”±äº OrientationBuilder ä¾èµ–äºçˆ¶ç»„ä»¶çš„å°ºå¯¸ï¼Œå› æ­¤åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½æ— æ³•å‡†ç¡®æ£€æµ‹åˆ°è®¾å¤‡çš„æ–¹å‘ã€‚å»ºè®®åœ¨éœ€è¦é«˜ç²¾åº¦æ–¹å‘æ£€æµ‹æ—¶ï¼Œç»“åˆ MediaQuery.of(context).orientation ä½¿ç”¨</p>
</li>
<li><p><strong>æ¨èï¼š</strong> æ¨ªç«–å±æ˜¾ç¤ºä¸åŒæ’åˆ—çš„ç½‘æ ¼ã€åˆ—è¡¨ï¼Œåœ¨å¤šè®¾å¤‡é€‚é…æ–¹æ¡ˆä¸­ä½œä¸ºåŸºç¡€å·¥å…·</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OrientationBuilder(</span><br><span class="line">  builder: (context, orientation) &#123;</span><br><span class="line">    return orientation == Orientation.portrait</span><br><span class="line">        ? _buildVerticalLayout()</span><br><span class="line">        : _buildHorizontalLayout();</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">Widget _buildVerticalLayout() &#123;</span><br><span class="line">  return ListView(</span><br><span class="line">    children: const &lt;Widget&gt;[</span><br><span class="line">      ListTile(title: Text(&#x27;é¡¹ç›® 1&#x27;)),</span><br><span class="line">      ListTile(title: Text(&#x27;é¡¹ç›® 2&#x27;)),</span><br><span class="line">      ListTile(title: Text(&#x27;é¡¹ç›® 3&#x27;)),</span><br><span class="line">    ],</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Widget _buildHorizontalLayout() &#123;</span><br><span class="line">  return GridView.count(</span><br><span class="line">    crossAxisCount: 3,</span><br><span class="line">    children: &lt;Widget&gt;[</span><br><span class="line">      Container(</span><br><span class="line">        color: Colors.red,</span><br><span class="line">        child: const Center(child: Text(&#x27;é¡¹ç›® 1&#x27;)),</span><br><span class="line">      ),</span><br><span class="line">      Container(</span><br><span class="line">        color: Colors.green,</span><br><span class="line">        child: const Center(child: Text(&#x27;é¡¹ç›® 2&#x27;)),</span><br><span class="line">      ),</span><br><span class="line">      Container(</span><br><span class="line">        color: Colors.blue,</span><br><span class="line">        child: const Center(child: Text(&#x27;é¡¹ç›® 3&#x27;)),</span><br><span class="line">      ),</span><br><span class="line">    ],</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-ddec17f776412266.gif?imageMogr2/auto-orient/strip" alt="OrientationBuilder"></p>
<h2 id="3-MediaQuery"><a href="#3-MediaQuery" class="headerlink" title="3. MediaQuery"></a>3. MediaQuery</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ç”¨äºè·å–è®¾å¤‡çš„å±å¹•å°ºå¯¸ã€æ–¹å‘ã€åƒç´ å¯†åº¦ç­‰ä¿¡æ¯ã€‚å®ƒå¯ä»¥å¸®åŠ©å¼€å‘è€…åˆ›å»ºå“åº”å¼å¸ƒå±€ï¼Œä»¥é€‚åº”ä¸åŒè®¾å¤‡å’Œå±å¹•å°ºå¯¸</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong><br><strong>1. è·å–å±å¹•å°ºå¯¸ï¼š</strong> ä½¿ç”¨ MediaQuery.of(context).size å¯ä»¥è·å–å±å¹•çš„å®½åº¦å’Œé«˜åº¦ã€‚<br><strong>2. è·å–æ–¹å‘ï¼š</strong> ä½¿ç”¨ MediaQuery.of(context).orientation å¯ä»¥è·å–è®¾å¤‡çš„æ–¹å‘ï¼ˆç«–å±æˆ–æ¨ªå±ï¼‰ã€‚<br><strong>3. è·å–æ–‡æœ¬ç¼©æ”¾å› å­ï¼š</strong> ä½¿ç”¨ MediaQuery.of(context).textScaleFactor å¯ä»¥è·å–ç”¨æˆ·çš„æ–‡æœ¬ç¼©æ”¾è®¾ç½®ã€‚<br><strong>4. è·å–ç³»ç»Ÿäº®åº¦ï¼š</strong> ä½¿ç”¨ MediaQuery.of(context).platformBrightness å¯ä»¥è·å–ç³»ç»Ÿçš„äº®åº¦æ¨¡å¼ï¼ˆäº®è‰²æˆ–æš—è‰²ï¼‰ã€‚<br><strong>5. è·å–ç³»ç»Ÿé®æŒ¡åŒºåŸŸï¼š</strong> ä½¿ç”¨ MediaQuery.of(context).padding å¯ä»¥è·å–ç³»ç»Ÿé®æŒ¡åŒºåŸŸçš„ä¿¡æ¯ï¼Œå¦‚çŠ¶æ€æ å’Œå¯¼èˆªæ çš„é«˜åº¦ã€‚</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> é¢‘ç¹ä½¿ç”¨ MediaQuery.of(context).size å¯èƒ½ä¼šå¯¼è‡´ä¸å¿…è¦çš„å°éƒ¨ä»¶é‡å»ºï¼Œå½±å“æ€§èƒ½ã€‚å»ºè®®ä»…åœ¨éœ€è¦çš„åœ°æ–¹ä½¿ç”¨ MediaQueryï¼Œé”®ç›˜å¼¹å‡ºæ—¶ï¼ŒMediaQuery çš„ viewInsets å±æ€§ä¼šå˜åŒ–ï¼Œå¼€å‘è€…éœ€è¦å¤„ç†è¿™ç§æƒ…å†µä»¥é¿å…å¸ƒå±€é—®é¢˜</p>
</li>
<li><p><strong>æ¨èï¼š</strong> æ ¹æ®ç”¨æˆ·çš„æ–‡æœ¬ç¼©æ”¾è®¾ç½®è°ƒæ•´å­—ä½“å¤§å°</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var screenSize = MediaQuery.of(context).size;</span><br><span class="line">var textScaleFactor = MediaQuery.of(context).textScaleFactor;</span><br><span class="line">var orientation = MediaQuery.of(context).orientation;</span><br><span class="line">    </span><br><span class="line">Column(</span><br><span class="line">  mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">  children: [</span><br><span class="line">    Text(</span><br><span class="line">      &#x27;Screen Size: $&#123;screenSize.width&#125; x $&#123;screenSize.height&#125;&#x27;,</span><br><span class="line">      style: TextStyle(fontSize: 24),</span><br><span class="line">    ),</span><br><span class="line">    SizedBox(height: 10),</span><br><span class="line">    Text(</span><br><span class="line">      &#x27;Text Scale Factor: $textScaleFactor&#x27;,</span><br><span class="line">      style: TextStyle(fontSize: 24),</span><br><span class="line">    ),</span><br><span class="line">    SizedBox(height: 10),</span><br><span class="line">    Text(</span><br><span class="line">      &#x27;Orientation: $orientation&#x27;,</span><br><span class="line">      style: TextStyle(fontSize: 24),</span><br><span class="line">    ),</span><br><span class="line">    SizedBox(height: 20),</span><br><span class="line">    if (orientation == Orientation.portrait)</span><br><span class="line">      FilledButton(</span><br><span class="line">        onPressed: () &#123;&#125;,</span><br><span class="line">        child: Text(&#x27;Button for Portrait Mode&#x27;),</span><br><span class="line">      )</span><br><span class="line">    else</span><br><span class="line">      FilledButton(</span><br><span class="line">        onPressed: () &#123;&#125;,</span><br><span class="line">        child: Text(&#x27;Button for Landscape Mode&#x27;),</span><br><span class="line">      ),</span><br><span class="line">    SizedBox(height: 20),</span><br><span class="line">    FilledButton(</span><br><span class="line">      onPressed: () &#123;&#125;,</span><br><span class="line">      child: Text(</span><br><span class="line">        &#x27;Custom Font Size Button&#x27;,</span><br><span class="line">        style: TextStyle(fontSize: 16 * textScaleFactor),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-df8089c55264499f.gif?imageMogr2/auto-orient/strip" alt="MediaQuery"></p>
<h2 id="4-AspectRatio"><a href="#4-AspectRatio" class="headerlink" title="4. AspectRatio"></a>4. AspectRatio</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> æ ¹æ®è®¾å¤‡çš„æ–¹å‘ï¼ˆçºµå‘æˆ–æ¨ªå‘ï¼‰åŠ¨æ€æ„å»ºä¸åŒçš„ UI å¸ƒå±€ã€‚å½“è®¾å¤‡çš„æ–¹å‘å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒOrientationBuilder ä¼šé‡æ–°æ„å»ºå…¶å­ç»„ä»¶æ ‘ï¼Œä»¥é€‚åº”æ–°çš„æ–¹å‘ã€‚è¿™ä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿè½»æ¾åœ°å®ç°æ¨ªç«–å±é€‚é…ï¼Œå®ƒé€šè¿‡å›è°ƒå‡½æ•°è¿”å›å½“å‰å±å¹•æ–¹å‘ï¼Œæ— éœ€ä¾èµ–å…¨å±€ MediaQuery</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> æ ¹æ®è®¾å¤‡çš„æ–¹å‘è¿”å›ä¸åŒçš„å¸ƒå±€ç»„ä»¶ï¼Œbuilder: ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šBuildContext å’Œ Orientationã€‚Orientation æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼ŒåŒ…å«ä¸¤ä¸ªå€¼ï¼šOrientation.portrait å’Œ Orientation.landscape</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OrientationBuilder(</span><br><span class="line">  builder: (BuildContext context, Orientation orientation) &#123;</span><br><span class="line">    // æ ¹æ® orientation çš„å€¼è¿”å›ä¸åŒçš„å¸ƒå±€</span><br><span class="line">    return YourWidget();</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> é¿å…åœ¨ builder å‡½æ•°ä¸­æ‰§è¡Œè€—æ—¶æ“ä½œï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ï¼‰ï¼Œå› å…¶åœ¨å±å¹•æ—‹è½¬æ—¶å¯èƒ½é¢‘ç¹è§¦å‘ï¼Œç›´æ¥é€šè¿‡å›è°ƒæä¾›æ–¹å‘ï¼Œæ›´é€‚åˆå¸ƒå±€æ„å»ºé˜¶æ®µï¼Œä»…ç›‘å¬æ–¹å‘å˜åŒ–ï¼Œè‹¥éœ€å“åº”å°ºå¯¸å˜åŒ–ï¼ˆå¦‚åˆ†å±æ¨¡å¼ï¼‰ï¼Œåº”ç»“åˆ LayoutBuilder</p>
</li>
<li><p><strong>æ¨èï¼š</strong> è§†é¢‘æ’­æ”¾å™¨ã€è¡¨å•è¾“å…¥</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AspectRatio(</span><br><span class="line">  aspectRatio: 16 / 9,</span><br><span class="line">  child: Container(color: Colors.blue),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-7818e3aebfcf1e62.gif?imageMogr2/auto-orient/strip" alt="AspectRatio"></p>
<h1 id="å¹³å°é€‚é…å¸ƒå±€æ§ä»¶"><a href="#å¹³å°é€‚é…å¸ƒå±€æ§ä»¶" class="headerlink" title="å¹³å°é€‚é…å¸ƒå±€æ§ä»¶"></a>å¹³å°é€‚é…å¸ƒå±€æ§ä»¶</h1><h2 id="1-SafeArea"><a href="#1-SafeArea" class="headerlink" title="1. SafeArea"></a>1. SafeArea</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ç”¨äºè§„é¿ç³»ç»Ÿ UIï¼ˆå¦‚çŠ¶æ€æ ã€åˆ˜æµ·å±ã€åº•éƒ¨å¯¼èˆªæ ï¼‰çš„é®æŒ¡ã€‚å®ƒä¼šæ ¹æ®è®¾å¤‡å±å¹•çš„â€œå®‰å…¨åŒºåŸŸâ€è‡ªåŠ¨æ·»åŠ å†…è¾¹è·ï¼ˆpaddingï¼‰ï¼Œç¡®ä¿å†…å®¹ä¸è¢«ç³»ç»Ÿæ§ä»¶è¦†ç›–ï¼Œä½¿ UI åŠ¨æ€ä¸”é€‚åº”å„ç§è®¾å¤‡ã€‚åœ¨è®¾è®¡ç»„ä»¶å¸ƒå±€æ—¶ï¼Œæˆ‘ä»¬è€ƒè™‘äº†ä¸åŒè®¾å¤‡åŠå…¶å±å¹•å ç”¨çš„çº¦æŸï¼Œå¦‚çŠ¶æ€æ ã€åˆ˜æµ·å±ã€å¯¼èˆªæ ç­‰ã€‚ç„¶è€Œï¼Œæ–°è®¾å¤‡ä¸æ–­æ¨å‡ºï¼Œè®¾è®¡å„å¼‚ï¼Œæœ‰æ—¶ä½ çš„åº”ç”¨å¯èƒ½ä¼šè¦†ç›–è¿™äº›å ç”¨çš„çº¦æŸã€‚å› æ­¤ï¼Œä¸ºäº†ä½¿ UI é€‚åº”æ€§å¼ºä¸”æ— é”™è¯¯ï¼Œæˆ‘ä»¬ä½¿ç”¨ SafeArea ç»„ä»¶ã€‚SafeArea å®é™…ä¸Šæ˜¯ä¸€ä¸ªå¡«å……ç»„ä»¶ï¼Œæ ¹æ®è®¾å¤‡è¿è¡Œæ—¶çš„æƒ…å†µï¼Œä¸ºä½ çš„åº”ç”¨æ·»åŠ å¿…è¦çš„å¡«å……ã€‚å¦‚æœåº”ç”¨çš„ç»„ä»¶è¦†ç›–äº†ç³»ç»Ÿç‰¹å¾ï¼Œå¦‚åˆ˜æµ·å±ã€çŠ¶æ€æ ã€ç›¸æœºå­”ç­‰ï¼ŒSafeArea ä¼šæ ¹æ®éœ€è¦åœ¨å‘¨å›´æ·»åŠ å¡«å……ã€‚SafeArea å†…éƒ¨ä½¿ç”¨ MediaQuery æ£€æŸ¥å±å¹•å°ºå¯¸ï¼Œå¹¶åœ¨å¿…è¦æ—¶åŒ…å«é¢å¤–å¡«å……ã€‚æ„é€ å‡½æ•°å…è®¸ä½ å†³å®šæ˜¯å¦åœ¨ç‰¹å®šæ–¹å‘ä¸Šé¿å…ä¾µå…¥ï¼Œé€šè¿‡å¸ƒå°”å€¼ true æˆ– false æ¥å®ç°</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> åœ¨éœ€è¦é¿å…ç³»ç»Ÿä¾µå…¥çš„åŒºåŸŸåŒ…è£¹ SafeArea ç»„ä»¶ï¼Œé€šè¿‡ leftã€topã€rightã€bottom å±æ€§æ§åˆ¶æ˜¯å¦åœ¨ç›¸åº”æ–¹å‘ä¸Šé¿å…ç³»ç»Ÿä¾µå…¥ï¼›é€šè¿‡ minimum å±æ€§è®¾ç½®æœ€å°å¡«å……ï¼›é€šè¿‡ maintainBottomViewPadding å±æ€§å†³å®šæ˜¯å¦ä¿æŒåº•éƒ¨å¡«å……ä¸å˜ï¼Œå°†éœ€è¦ä¿æŠ¤çš„å­ç»„ä»¶æ”¾åœ¨ SafeArea çš„ child å±æ€§ä¸­</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> å½“è½¯é”®ç›˜å¼¹å‡ºæ—¶ï¼Œåº•éƒ¨å¡«å……å¯èƒ½ä¼šæ¶ˆå¤±ã€‚å¯ä»¥é€šè¿‡è®¾ç½® maintainBottomViewPadding ä¸º true æ¥ä¿æŒåº•éƒ¨å¡«å……ä¸å˜ï¼Œåœ¨é¡µé¢éª¨æ¶ä¸­ç›´æ¥åº”ç”¨ï¼Œé¿å…å…¨å±€é®æŒ¡ï¼Œåœ¨æ²‰æµ¸å¼å…¨å±ï¼ˆå¦‚è§†é¢‘æ’­æ”¾é¡µï¼‰ä¸­éœ€å…³é—­ SafeAreaï¼Œå¦åˆ™é¡¶éƒ¨ç•™ç™½ï¼Œè‹¥çˆ¶å®¹å™¨å·²è®¾ç½® paddingï¼ˆå¦‚ ListViewï¼‰ï¼ŒSafeArea å¯èƒ½é€ æˆåŒé‡è¾¹è·ã€‚æ­¤æ—¶éœ€æ‰‹åŠ¨è°ƒæ•´ï¼Œå¼ºåˆ¶å–æ¶ˆå®‰å…¨è¾¹è·ï¼ˆå¦‚ padding: EdgeInsets.zero ï¼‰å¯èƒ½å¯¼è‡´å†…å®¹è¢«é®æŒ¡</p>
</li>
<li><p><strong>æ¨èï¼š</strong> é¡¶éƒ¨çŠ¶æ€æ åŒºåŸŸã€åº•éƒ¨å¯¼èˆªæ åŒºåŸŸã€åˆ˜æµ·å±&#x2F;æŒ–å­”å±è®¾å¤‡ã€å¼¹çª—&#x2F;æµ®å±‚å†…å®¹</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SafeArea(</span><br><span class="line">  // 2. å…³é—­åº•éƒ¨å®‰å…¨åŒºåŸŸï¼ˆè‡ªå®šä¹‰åº•éƒ¨æ æ—¶ä½¿ç”¨ï¼‰</span><br><span class="line">  bottom: false,</span><br><span class="line">  child: Column(</span><br><span class="line">    children: [</span><br><span class="line">      // 3. é¡¶éƒ¨æ ‡é¢˜æ ï¼ˆè‡ªåŠ¨é¿å¼€çŠ¶æ€æ ï¼‰</span><br><span class="line">      const AppHeader(),</span><br><span class="line">      // 4. å†…å®¹åŒºåŸŸï¼ˆä½¿ç”¨Expandedå¡«å……å‰©ä½™ç©ºé—´ï¼‰</span><br><span class="line">      Expanded(</span><br><span class="line">        child: ListView(</span><br><span class="line">          children: List.generate(</span><br><span class="line">              20, (i) =&gt; ListTile(title: Text(&quot;Item $i&quot;))),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">      // 5. è‡ªå®šä¹‰åº•éƒ¨å¯¼èˆªæ ï¼ˆéœ€æ‰‹åŠ¨é¿å¼€ç³»ç»Ÿæ ï¼‰</span><br><span class="line">      const CustomBottomBar(),</span><br><span class="line">    ],</span><br><span class="line">  ),</span><br><span class="line">)</span><br><span class="line">        </span><br><span class="line">// è‡ªå®šä¹‰é¡¶éƒ¨ç»„ä»¶ </span><br><span class="line">class AppHeader extends StatelessWidget &#123;</span><br><span class="line">  const AppHeader(&#123;super.key&#125;); </span><br><span class="line"> </span><br><span class="line">  @override </span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    return Container(</span><br><span class="line">      color: Colors.blue, </span><br><span class="line">      padding: const EdgeInsets.all(16), </span><br><span class="line">      child: const Text(&quot;SafeArea Demo&quot;, style: TextStyle(color: Colors.white)), </span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// è‡ªå®šä¹‰åº•éƒ¨ç»„ä»¶ï¼ˆéœ€å•ç‹¬å¤„ç†å®‰å…¨è¾¹è·ï¼‰</span><br><span class="line">class CustomBottomBar extends StatelessWidget &#123;</span><br><span class="line">  const CustomBottomBar(&#123;super.key&#125;); </span><br><span class="line"> </span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    // 6. ä¸ºåº•éƒ¨æ å•ç‹¬æ·»åŠ SafeArea </span><br><span class="line">    return SafeArea(</span><br><span class="line">      top: false, // å…³é—­é¡¶éƒ¨è¾¹è·</span><br><span class="line">      minimum: const EdgeInsets.only(bottom:  10), // è¿½åŠ é¢å¤–å¤–è¾¹è·</span><br><span class="line">      child: Container(</span><br><span class="line">        height: 50,</span><br><span class="line">        color: Colors.green, </span><br><span class="line">        child: const Center(child: Text(&quot;Bottom Bar&quot;)),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-1a1e4d38633b59e7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="SafeArea"></p>
<h2 id="2-PlatformView"><a href="#2-PlatformView" class="headerlink" title="2. PlatformView"></a>2. PlatformView</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> å…è®¸åœ¨ Flutter åº”ç”¨ä¸­åµŒå…¥åŸç”Ÿçš„ UI ç»„ä»¶ï¼Œå¦‚ Android çš„ View æˆ– iOS çš„ UIView</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong></p>
</li>
</ul>
<ol>
<li>é¦–å…ˆéœ€è¦åœ¨åŸç”Ÿä»£ç ä¸­åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„ PlatformViewã€‚</li>
<li>åˆ›å»ºä¸€ä¸ª PlatformViewFactory æ¥åˆ›å»º PlatformView å®ä¾‹ï¼Œå¹¶å°†å…¶ä¸ Flutter åº”ç”¨å…³è”</li>
<li>é€šè¿‡ PlatformView Widget å°†åŸç”Ÿè§†å›¾åµŒå…¥åˆ° Flutter åº”ç”¨ä¸­</li>
<li>é€šè¿‡ MethodChannel å®ç° Dart ä¸åŸç”Ÿä»£ç çš„åŒå‘é€šä¿¡</li>
</ol>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> ç”±äº PlatformView æ˜¯åŸç”Ÿè§†å›¾ï¼Œé¢‘ç¹çš„äº¤äº’å¯èƒ½ä¼šå½±å“æ€§èƒ½ï¼Œå› æ­¤åº”å°½é‡å‡å°‘ä¸å¿…è¦çš„åŸç”Ÿè§†å›¾åµŒå…¥ï¼Œç¡®ä¿æ­£ç¡®ç®¡ç†åŸç”Ÿè§†å›¾çš„ç”Ÿå‘½å‘¨æœŸï¼Œé¿å…å†…å­˜æ³„æ¼ï¼Œä¸åŒå¹³å°çš„åŸç”Ÿè§†å›¾å®ç°æ–¹å¼ä¸åŒï¼Œéœ€è¦åˆ†åˆ«å¤„ç† Android å’Œ iOS çš„å®ç°ï¼ŒDart çš„ viewTypeï¼ˆnative_text_viewï¼‰éœ€ä¸åŸç”Ÿæ³¨å†Œçš„ ID åŒ¹é…</p>
</li>
<li><p><strong>æ¨èï¼š</strong> åµŒå…¥åœ°å›¾ã€è§†é¢‘æ’­æ”¾ã€ç›¸æœºã€æ–‡ä»¶é€‰æ‹©å™¨ã€WebViewã€æ¡å½¢ç æ‰«æ</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// dart</span><br><span class="line">Column(</span><br><span class="line">  mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">  children: [</span><br><span class="line">    // Flutter æ–‡æœ¬æ˜¾ç¤ºåŸç”Ÿè§†å›¾ä¼ å›çš„æ—¶é—´</span><br><span class="line">    Text(&#x27;Flutter æ˜¾ç¤º: $_currentTime&#x27;,</span><br><span class="line">        style: const TextStyle(fontSize: 20)),</span><br><span class="line">    const SizedBox(height: 30),</span><br><span class="line">    // åŸç”Ÿè§†å›¾å®¹å™¨</span><br><span class="line">    Container(</span><br><span class="line">      width: 300,</span><br><span class="line">      height: 200,</span><br><span class="line">      decoration: BoxDecoration(</span><br><span class="line">        border: Border.all(color: Colors.blue, width: 2),</span><br><span class="line">        borderRadius: BorderRadius.circular(10),</span><br><span class="line">      ),</span><br><span class="line">      child: Platform.isAndroid</span><br><span class="line">          ? const AndroidView(</span><br><span class="line">              viewType: _viewType,</span><br><span class="line">              creationParams: &#123;&#x27;textColor&#x27;: &#x27;#FF0000&#x27;&#125;, // çº¢è‰²æ–‡æœ¬</span><br><span class="line">              creationParamsCodec: StandardMessageCodec(),</span><br><span class="line">            )</span><br><span class="line">          : const UiKitView(</span><br><span class="line">              viewType: _viewType,</span><br><span class="line">              creationParams: &#123;&#x27;textSize&#x27;: 24.0&#125;, // iOS æ–‡æœ¬å¤§å°</span><br><span class="line">              creationParamsCodec: StandardMessageCodec(),</span><br><span class="line">            ),</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// swift</span><br><span class="line">// TimeView.swift</span><br><span class="line">class TimeView: NSObject, FlutterPlatformView &#123;</span><br><span class="line">    private var label: UILabel</span><br><span class="line">    private var methodChannel: FlutterMethodChannel?</span><br><span class="line">    </span><br><span class="line">    init(frame: CGRect, viewIdentifier viewId: Int64, arguments args: Any?, messenger: FlutterBinaryMessenger) &#123;</span><br><span class="line">        label = UILabel(frame: frame)</span><br><span class="line">        label.textAlignment = .center</span><br><span class="line">        label.text = &quot;iOSåŸç”Ÿæ—¶é—´è§†å›¾&quot;</span><br><span class="line">        </span><br><span class="line">        super.init()</span><br><span class="line">        </span><br><span class="line">        // è§£æFlutterä¼ é€’çš„å‚æ•°</span><br><span class="line">        if let params = args as? [String: Any], </span><br><span class="line">           let textSize = params[&quot;textSize&quot;] as? Double &#123;</span><br><span class="line">            label.font = UIFont.systemFont(ofSize: CGFloat(textSize))</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            label.font = UIFont.systemFont(ofSize: 20)</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        label.textColor = .blue</span><br><span class="line">        </span><br><span class="line">        // åˆ›å»ºæ–¹æ³•é€šé“</span><br><span class="line">        methodChannel = FlutterMethodChannel(</span><br><span class="line">            name: &quot;com.example/time_channel&quot;, </span><br><span class="line">            binaryMessenger: messenger</span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        methodChannel?.setMethodCallHandler(handleMethodCall)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    func view() -&gt; UIView &#123;</span><br><span class="line">        return label</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    func handleMethodCall(call: FlutterMethodCall, result: @escaping FlutterResult) &#123;</span><br><span class="line">        switch call.method &#123;</span><br><span class="line">        case &quot;getCurrentTime&quot;:</span><br><span class="line">            // è¿”å›å½“å‰æ—¶é—´ç»™Flutter</span><br><span class="line">            let formatter = DateFormatter()</span><br><span class="line">            formatter.dateFormat = &quot;HH:mm:ss&quot;</span><br><span class="line">            result(formatter.string(from: Date()))</span><br><span class="line">        default:</span><br><span class="line">            result(FlutterMethodNotImplemented)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// TimeViewFactory.swift</span><br><span class="line">class TimeViewFactory: NSObject, FlutterPlatformViewFactory &#123;</span><br><span class="line">    private var messenger: FlutterBinaryMessenger</span><br><span class="line"></span><br><span class="line">    init(messenger: FlutterBinaryMessenger) &#123;</span><br><span class="line">        self.messenger = messenger</span><br><span class="line">        super.init()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    func createArgsCodec() -&gt; FlutterMessageCodec &amp; NSObjectProtocol &#123;</span><br><span class="line">        return FlutterStandardMessageCodec.sharedInstance()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    func create(</span><br><span class="line">        withFrame frame: CGRect,</span><br><span class="line">        viewIdentifier viewId: Int64,</span><br><span class="line">        arguments args: Any?</span><br><span class="line">    ) -&gt; FlutterPlatformView &#123;</span><br><span class="line">        return TimeView(</span><br><span class="line">            frame: frame,</span><br><span class="line">            viewIdentifier: viewId,</span><br><span class="line">            arguments: args,</span><br><span class="line">            messenger: messenger</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// AppDelegate.swift (æ·»åŠ éƒ¨åˆ†)</span><br><span class="line"></span><br><span class="line">import UIKit</span><br><span class="line">import Flutter</span><br><span class="line"></span><br><span class="line">@UIApplicationMain</span><br><span class="line">@objc class AppDelegate: FlutterAppDelegate &#123;</span><br><span class="line">    override func application(</span><br><span class="line">        _ application: UIApplication,</span><br><span class="line">        didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?</span><br><span class="line">    ) -&gt; Bool &#123;</span><br><span class="line">        </span><br><span class="line">        let controller: FlutterViewController = window?.rootViewController as! FlutterViewController</span><br><span class="line">        </span><br><span class="line">        // æ³¨å†ŒPlatformView</span><br><span class="line">        let factory = TimeViewFactory(messenger: controller.binaryMessenger)</span><br><span class="line">        registrar(forPlugin: &quot;TimeViewPlugin&quot;)?.register(</span><br><span class="line">            factory,</span><br><span class="line">            withId: &quot;com.example/NativeTimeView&quot;</span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        GeneratedPluginRegistrant.register(with: self)</span><br><span class="line">        return super.application(application, didFinishLaunchingWithOptions: launchOptions)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ios é…ç½®</span><br><span class="line">&lt;!-- ios/Runner/Info.plist --&gt;</span><br><span class="line">&lt;key&gt;io.flutter.embedded_views_preview&lt;/key&gt;</span><br><span class="line">&lt;true/&gt;</span><br><span class="line"></span><br><span class="line">// android</span><br><span class="line"></span><br><span class="line">// TimeView.kt</span><br><span class="line">package com.example.platformviewdemo;</span><br><span class="line"></span><br><span class="line">import android.content.Context;</span><br><span class="line">import android.graphics.Color;</span><br><span class="line">import android.view.View;</span><br><span class="line">import android.widget.TextView;</span><br><span class="line">import androidx.annotation.NonNull;</span><br><span class="line">import androidx.annotation.Nullable;</span><br><span class="line">import io.flutter.plugin.common.BinaryMessenger;</span><br><span class="line">import io.flutter.plugin.common.MethodCall;</span><br><span class="line">import io.flutter.plugin.common.MethodChannel;</span><br><span class="line">import io.flutter.plugin.platform.PlatformView;</span><br><span class="line">import java.text.SimpleDateFormat;</span><br><span class="line">import java.util.Date;</span><br><span class="line">import java.util.Locale;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">class TimeView implements PlatformView, MethodChannel.MethodCallHandler &#123;</span><br><span class="line">    private final TextView textView;</span><br><span class="line">    private final MethodChannel methodChannel;</span><br><span class="line"></span><br><span class="line">    TimeView(Context context, BinaryMessenger messenger, int id, Map&lt;String, Object&gt; params) &#123;</span><br><span class="line">        textView = new TextView(context);</span><br><span class="line">        </span><br><span class="line">        // è§£æFlutterä¼ é€’çš„å‚æ•°</span><br><span class="line">        if (params != null &amp;&amp; params.containsKey(&quot;textColor&quot;)) &#123;</span><br><span class="line">            String color = (String) params.get(&quot;textColor&quot;);</span><br><span class="line">            textView.setTextColor(Color.parseColor(color));</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            textView.setTextColor(Color.BLUE);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        textView.setTextSize(20);</span><br><span class="line">        textView.setText(&quot;AndroidåŸç”Ÿæ—¶é—´è§†å›¾&quot;);</span><br><span class="line">        </span><br><span class="line">        // åˆ›å»ºæ–¹æ³•é€šé“</span><br><span class="line">        methodChannel = new MethodChannel(messenger, &quot;com.example/time_channel&quot;);</span><br><span class="line">        methodChannel.setMethodCallHandler(this);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public View getView() &#123;</span><br><span class="line">        return textView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onMethodCall(@NonNull MethodCall call, @NonNull MethodChannel.Result result) &#123;</span><br><span class="line">        if (call.method.equals(&quot;getCurrentTime&quot;)) &#123;</span><br><span class="line">            // è¿”å›å½“å‰æ—¶é—´ç»™Flutter</span><br><span class="line">            SimpleDateFormat sdf = new SimpleDateFormat(&quot;HH:mm:ss&quot;, Locale.getDefault());</span><br><span class="line">            result.success(sdf.format(new Date()));</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            result.notImplemented();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void dispose() &#123;</span><br><span class="line">        methodChannel.setMethodCallHandler(null);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// TimeViewFactory.kt</span><br><span class="line">package com.example.platformviewdemo;</span><br><span class="line"></span><br><span class="line">import android.content.Context;</span><br><span class="line">import io.flutter.plugin.common.BinaryMessenger;</span><br><span class="line">import io.flutter.plugin.common.StandardMessageCodec;</span><br><span class="line">import io.flutter.plugin.platform.PlatformView;</span><br><span class="line">import io.flutter.plugin.platform.PlatformViewFactory;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">public class TimeViewFactory extends PlatformViewFactory &#123;</span><br><span class="line">    private final BinaryMessenger messenger;</span><br><span class="line"></span><br><span class="line">    public TimeViewFactory(BinaryMessenger messenger) &#123;</span><br><span class="line">        super(StandardMessageCodec.INSTANCE);</span><br><span class="line">        this.messenger = messenger;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public PlatformView create(Context context, int viewId, Object args) &#123;</span><br><span class="line">        Map&lt;String, Object&gt; params = (Map&lt;String, Object&gt;) args;</span><br><span class="line">        return new TimeView(context, messenger, viewId, params);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// android/app/src/main/java/com/example/platformviewdemo/MainActivity.kt</span><br><span class="line">package com.example.platformviewdemo;</span><br><span class="line"></span><br><span class="line">import androidx.annotation.NonNull;</span><br><span class="line">import io.flutter.embedding.android.FlutterActivity;</span><br><span class="line">import io.flutter.embedding.engine.FlutterEngine;</span><br><span class="line">import io.flutter.plugin.common.MethodChannel;</span><br><span class="line"></span><br><span class="line">public class MainActivity extends FlutterActivity &#123;</span><br><span class="line">    private static final String CHANNEL = &quot;com.example/time_channel&quot;;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void configureFlutterEngine(@NonNull FlutterEngine flutterEngine) &#123;</span><br><span class="line">        super.configureFlutterEngine(flutterEngine);</span><br><span class="line">        </span><br><span class="line">        // æ³¨å†ŒPlatformView</span><br><span class="line">        flutterEngine</span><br><span class="line">            .getPlatformViewsController()</span><br><span class="line">            .getRegistry()</span><br><span class="line">            .registerViewFactory(</span><br><span class="line">                &quot;com.example/NativeTimeView&quot;, </span><br><span class="line">                new TimeViewFactory(flutterEngine.getDartExecutor())</span><br><span class="line">            );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>AndroidViewï¼š</strong> åµŒå…¥AndroidåŸç”Ÿè§†å›¾</p>
<p><strong>UiKitViewï¼š</strong> åµŒå…¥iOSåŸç”Ÿè§†å›¾</p>
<p><strong>å¹³å°é€‚é…ï¼š</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Platform.isIOS</span><br><span class="line">  ? CupertinoButton(onPressed: () &#123;&#125;, child: Text(&#x27;iOS&#x27;))</span><br><span class="line">  : ElevatedButton(onPressed: () &#123;&#125;, child: Text(&#x27;Android&#x27;));</span><br></pre></td></tr></table></figure>
<blockquote>
</blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-a65a119896d825b4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="PlatformView"></p>
<h1 id="ç‰¹æ®Šå¸ƒå±€æ§ä»¶"><a href="#ç‰¹æ®Šå¸ƒå±€æ§ä»¶" class="headerlink" title="ç‰¹æ®Šå¸ƒå±€æ§ä»¶"></a>ç‰¹æ®Šå¸ƒå±€æ§ä»¶</h1><h2 id="1-Offstage"><a href="#1-Offstage" class="headerlink" title="1. Offstage"></a>1. Offstage</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ç”¨äºæ§åˆ¶å­ç»„ä»¶æ˜¯å¦å‚ä¸å¸ƒå±€å’Œæ¸²æŸ“çš„ä¸€ä¸ªå°éƒ¨ä»¶ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯é€šè¿‡offstageå±æ€§åˆ‡æ¢å­ç»„ä»¶çš„å¯è§çŠ¶æ€</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> å½“ offstage å±æ€§è®¾ç½®ä¸º true æ—¶ï¼Œå­ç»„ä»¶ä¼šè¢«éšè—ï¼Œå¹¶ä¸”ä¸ä¼šå‚ä¸å¸ƒå±€æˆ–æ¸²æŸ“ï¼Œä¹Ÿä¸ä¼šå ç”¨ä»»ä½•ç©ºé—´ï¼Œå½“ offstage ä¸º false æ—¶ï¼Œå­ç»„ä»¶æ­£å¸¸æ˜¾ç¤º</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> å¦‚æœå­ç»„ä»¶æœ‰åŠ¨ç”»ï¼Œåº”è¯¥æ‰‹åŠ¨åœæ­¢åŠ¨ç”»ï¼Œå› ä¸º Offstage ä¸ä¼šåœæ­¢åŠ¨ç”»ï¼ŒOffstage ä¸ä¼šä»æ¸²æŸ“æ ‘ä¸­ç§»é™¤å­ç»„ä»¶ï¼Œåªæ˜¯ä¸ç»˜åˆ¶å’Œä¸å“åº”ç‚¹å‡»äº‹ä»¶ï¼Œå› æ­¤åœ¨éœ€è¦é¢‘ç¹åˆ‡æ¢æ˜¾ç¤ºçŠ¶æ€çš„åœºæ™¯ä¸­ï¼ŒOffstage æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„é€‰æ‹©ï¼Œéšè—çŠ¶æ€çš„å­ç»„ä»¶ä¸å ç”¨ç©ºé—´ï¼Œå¯èƒ½å¯¼è‡´çˆ¶å¸ƒå±€é‡æ–°è®¡ç®—å°ºå¯¸ï¼ˆå¦‚Columnä¸­çš„å­ç»„ä»¶éšè—åï¼Œå…¶ä»–å­ç»„ä»¶ä¼šå‘ä¸Šç§»åŠ¨ï¼‰ã€‚éœ€æ³¨æ„å¸ƒå±€çš„ç¨³å®šæ€§ï¼Œé¿å…é¢‘ç¹åˆ‡æ¢å¯¼è‡´ç•Œé¢æŠ–åŠ¨</p>
</li>
<li><p><strong>æ¨èï¼š</strong> å®ç°å¹³æ»‘çš„æ˜¾ç¤º&#x2F;éšè—åŠ¨ç”»ï¼ˆå¦‚æ·¡å…¥æ·¡å‡ºã€æ»‘åŠ¨å…¥åœºï¼‰</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">bool _isHidden = false; // æ§åˆ¶æ–‡æœ¬æ˜¯å¦éšè—</span><br><span class="line"></span><br><span class="line">Column(</span><br><span class="line">  mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">  children: [</span><br><span class="line">    // ä½¿ç”¨ Offstage æ§åˆ¶æ–‡æœ¬æ˜¾ç¤º</span><br><span class="line">    Offstage(</span><br><span class="line">      offstage: _isHidden,</span><br><span class="line">      child: const Text(</span><br><span class="line">        &#x27;Hello, Offstage!&#x27;,</span><br><span class="line">        style: TextStyle(fontSize: 24, fontWeight: FontWeight.bold),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">    const SizedBox(height: 20),</span><br><span class="line">    // åˆ‡æ¢æŒ‰é’®</span><br><span class="line">    ElevatedButton(</span><br><span class="line">      onPressed: () &#123;</span><br><span class="line">        setState(() =&gt; _isHidden = !_isHidden);</span><br><span class="line">      &#125;,</span><br><span class="line">      child: Text(_isHidden ? &#x27;æ˜¾ç¤ºæ–‡æœ¬&#x27; : &#x27;éšè—æ–‡æœ¬&#x27;),</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-2c858bd813c5b102.gif?imageMogr2/auto-orient/strip" alt="Offstage"></p>
<h2 id="2-Visibility"><a href="#2-Visibility" class="headerlink" title="2. Visibility"></a>2. Visibility</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ç”¨äºæ§åˆ¶å­ç»„ä»¶çš„å¯è§æ€§ã€‚å½“è®¾ç½®ä¸ºâ€œå¯è§â€æ—¶ï¼Œå­ç»„ä»¶å°†æ˜¾ç¤ºï¼›è®¾ç½®ä¸ºâ€œéšè—â€æ—¶ï¼Œå­ç»„ä»¶å°†è¢«éšè—ã€‚è¯¥ç»„ä»¶è¿˜æä¾›äº†å¤šä¸ªå¯é€‰å±æ€§æ¥æ§åˆ¶å­ç»„ä»¶çš„çŠ¶æ€å’Œè¡Œä¸ºï¼Œä¾‹å¦‚æ˜¯å¦ç»´æŒçŠ¶æ€ã€åŠ¨ç”»ã€å¤§å°å’Œäº¤äº’æ€§</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong></p>
</li>
</ul>
</blockquote>
<ol>
<li><strong>childï¼š</strong> å¿…å¡«å±æ€§ï¼ŒæŒ‡å®šè¦æ§åˆ¶å¯è§æ€§çš„å­ç»„ä»¶ã€‚</li>
<li><strong>visibleï¼š</strong> å¯é€‰å±æ€§ï¼Œå¸ƒå°”å€¼ï¼Œæ§åˆ¶å­ç»„ä»¶çš„æ˜¾ç¤ºæˆ–éšè—ï¼Œé»˜è®¤ä¸ºtrueã€‚</li>
<li><strong>replacementï¼š</strong> å¯é€‰å±æ€§ï¼Œå½“å­ç»„ä»¶ä¸å¯è§æ—¶æ˜¾ç¤ºçš„æ›¿ä»£å°éƒ¨ä»¶ã€‚</li>
<li><strong>maintainStateï¼š</strong> å¯é€‰å±æ€§ï¼Œå¸ƒå°”å€¼ï¼Œæ§åˆ¶å­ç»„ä»¶çŠ¶æ€æ˜¯å¦ä¿æŒä¸å˜ï¼Œé»˜è®¤ä¸ºfalseã€‚</li>
<li><strong>maintainAnimationï¼š</strong> å¯é€‰å±æ€§ï¼Œå¸ƒå°”å€¼ï¼Œæ§åˆ¶å­ç»„ä»¶åŠ¨ç”»æ˜¯å¦ä¿æŒä¸å˜ï¼Œé»˜è®¤ä¸ºfalseã€‚</li>
<li><strong>maintainSizeï¼š</strong> å¯é€‰å±æ€§ï¼Œå¸ƒå°”å€¼ï¼Œæ§åˆ¶å­ç»„ä»¶ç©ºé—´æ˜¯å¦ä¿æŒä¸å˜ï¼Œé»˜è®¤ä¸ºfalseã€‚</li>
<li><strong>maintainInteractivityï¼š</strong> å¯é€‰å±æ€§ï¼Œå¸ƒå°”å€¼ï¼Œæ§åˆ¶å­ç»„ä»¶åœ¨ä¸å¯è§æ—¶æ˜¯å¦ä»å¯äº¤äº’ï¼Œé»˜è®¤ä¸ºfalseã€‚</li>
<li><strong>maintainSemanticsï¼š</strong> å¯é€‰å±æ€§ï¼Œå¸ƒå°”å€¼ï¼Œæ§åˆ¶å­ç»„ä»¶è¯­ä¹‰æ˜¯å¦ä¿æŒä¸å˜ï¼Œé»˜è®¤ä¸ºfalseã€‚<blockquote>
<ul>
<li><p><strong>æ³¨æ„ï¼š</strong> å³ä½¿å­ç»„ä»¶è¢«éšè—ï¼Œå…¶çŠ¶æ€ä¹Ÿä¼šè¢«ç»´æŒï¼Œè¿™åœ¨éœ€è¦ä¿ç•™ç”¨æˆ·è¾“å…¥æˆ–çŠ¶æ€çš„æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ï¼Œå¯¹é«˜é¢‘åˆ‡æ¢æ˜¾éšçš„ç»„ä»¶ï¼ˆå¦‚åˆ—è¡¨é¡¹ï¼‰ï¼Œé¿å…å¯ç”¨ maintainStateï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ï¼Œ</p>
</li>
<li><p><strong>æ¨èï¼š</strong> è¡¨å•åŠ¨æ€å­—æ®µã€Tab åˆ‡æ¢å†…å®¹ã€é…åˆ AnimatedSwitcher å®ç°æ¸å˜&#x2F;ç¼©æ”¾æ•ˆæœ</p>
</li>
</ul>
</blockquote>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Center(</span><br><span class="line">  child: Column(</span><br><span class="line">    mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">    children: &lt;Widget&gt;[</span><br><span class="line">      Visibility(</span><br><span class="line">        visible: _isShown,</span><br><span class="line">        child: Container(</span><br><span class="line">          width: 100,</span><br><span class="line">          height: 100,</span><br><span class="line">          color: Colors.amber,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">      const SizedBox(height: 20),</span><br><span class="line">      ElevatedButton(</span><br><span class="line">        onPressed: _toggleVisibility,</span><br><span class="line">        child: Text(_isShown ? &#x27;éšè—ç›’å­&#x27; : &#x27;æ˜¾ç¤ºç›’å­&#x27;),</span><br><span class="line">      ),</span><br><span class="line">    ],</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-831a3fd594b06b28.gif?imageMogr2/auto-orient/strip" alt="Visibility"></p>
<h2 id="3-IgnorePointer"><a href="#3-IgnorePointer" class="headerlink" title="3. IgnorePointer"></a>3. IgnorePointer</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ç”¨äºå¿½ç•¥å…¶å­ç»„ä»¶çš„æŒ‡é’ˆäº‹ä»¶ï¼ˆå¦‚ç‚¹å‡»ã€æ‹–åŠ¨ç­‰ï¼‰ã€‚è¿™æ„å‘³ç€åŒ…è£¹åœ¨ IgnorePointer ä¸­çš„å­ç»„ä»¶å°†ä¸ä¼šå“åº”ç”¨æˆ·çš„äº¤äº’æ“ä½œï¼Œä½†ä»ç„¶ä¼šæ˜¾ç¤ºåœ¨ç•Œé¢ä¸Šã€‚IgnorePointer ä¸ AbsorbPointer ç±»ä¼¼ï¼Œä½† IgnorePointer ä¸ä¼šç»ˆæ­¢æŒ‡é’ˆäº‹ä»¶ï¼Œè€Œæ˜¯è®©è¿™äº›äº‹ä»¶ä¼ é€’åˆ°å…¶ä¸‹æ–¹çš„ç»„ä»¶</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> ignoring: å¸ƒå°”å€¼ï¼Œå†³å®šæ˜¯å¦å¿½ç•¥æŒ‡é’ˆäº‹ä»¶ã€‚é»˜è®¤ä¸º trueï¼ŒignoringSemantics: å¸ƒå°”å€¼ï¼Œå†³å®šæ˜¯å¦å¿½ç•¥è¯­ä¹‰ä¿¡æ¯ã€‚é»˜è®¤ä¸º nullï¼Œå³ä¸å¿½ç•¥ï¼Œå¯ä»¥åµŒå¥—åœ¨ä»»ä½•å¸ƒå±€ç»„ä»¶ï¼ˆå¦‚ Stackã€Columnï¼‰ä¸­ã€‚<br>è‹¥å¤šä¸ª IgnorePointer åµŒå¥—ï¼Œå¤–å±‚ ignoring ä¸º true æ—¶ï¼Œå†…å±‚è®¾ç½®æ— æ•ˆï¼Œäº‹ä»¶ç©¿é€ï¼šå½“ ignoring ä¸º true æ—¶ï¼Œå­ç»„ä»¶çš„ç‚¹å‡»äº‹ä»¶ä¼šç©¿é€åˆ°çˆ¶çº§ç»„ä»¶ã€‚é€‚ç”¨äºéœ€è¦éšè—äº¤äº’ä½†ä¿ç•™æ˜¾ç¤ºæ•ˆæœçš„åœºæ™¯ï¼ˆå¦‚èƒŒæ™¯å›¾ã€è£…é¥°å…ƒç´ ï¼‰</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> é¿å…åœ¨å¤æ‚åµŒå¥—ç»“æ„ä¸­æ»¥ç”¨ï¼Œå¯èƒ½å¯¼è‡´ä¸å¿…è¦çš„æ¸²æŸ“å¼€é”€ã€‚ä¼˜å…ˆç»“åˆ Stack å’Œ Positioned å®ç°å±€éƒ¨äº¤äº’æ§åˆ¶ï¼Œéœ€åŠ¨æ€æ§åˆ¶ ignoring æ—¶ï¼Œå»ºè®®é€šè¿‡ StatefulWidget ç®¡ç†çŠ¶æ€ï¼Œé…åˆ setState æ›´æ–°ï¼Œä¸ GestureDetector ç»“åˆä½¿ç”¨æ—¶ï¼Œéœ€æ³¨æ„äº‹ä»¶ä¼˜å…ˆçº§ã€‚ä¾‹å¦‚ï¼Œå¤–å±‚ IgnorePointer ä¸º true æ—¶ï¼Œå†…å±‚ GestureDetector æ— æ³•è§¦å‘äº‹ä»¶</p>
</li>
<li><p><strong>æ¨èï¼š</strong> èƒŒæ™¯å›¾ç‰‡ã€æ°´å°ç­‰æ— éœ€äº¤äº’çš„ç»„ä»¶ã€è¡¨å•æäº¤æ—¶ç¦ç”¨æŒ‰é’®ç‚¹å‡»ï¼Œé˜²æ­¢é‡å¤æäº¤ã€åœ¨ Stack ä¸­å åŠ å¤šä¸ªç»„ä»¶æ—¶ï¼Œæ§åˆ¶ç‰¹å®šå±‚çš„äº¤äº’ä¼˜å…ˆçº§</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Column(</span><br><span class="line">  mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">  children: [</span><br><span class="line">    // ä½¿ç”¨ IgnorePointer åŒ…è£¹æŒ‰é’®</span><br><span class="line">    IgnorePointer(</span><br><span class="line">      ignoring: _isIgnoring,</span><br><span class="line">      child: ElevatedButton(</span><br><span class="line">        onPressed: () &#123;</span><br><span class="line">          print(&#x27;æŒ‰é’®è¢«ç‚¹å‡»&#x27;);</span><br><span class="line">        &#125;,</span><br><span class="line">        child: const Text(&#x27;å¯ç‚¹å‡»æŒ‰é’®&#x27;),</span><br><span class="line">      ),</span><br><span class="line">    ),</span><br><span class="line">    const SizedBox(height: 20),</span><br><span class="line">    // åˆ‡æ¢å¼€å…³</span><br><span class="line">    Switch(</span><br><span class="line">      value: _isIgnoring,</span><br><span class="line">      onChanged: (value) &#123;</span><br><span class="line">        setState(() &#123;</span><br><span class="line">          _isIgnoring = value;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;,</span><br><span class="line">      activeTrackColor: Colors.blueGrey,</span><br><span class="line">      activeColor: Colors.blue,</span><br><span class="line">    ),</span><br><span class="line">    const Text(&#x27;å¼€å…³å¼€å¯æ—¶æŒ‰é’®ä¸å¯ç‚¹å‡»&#x27;),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-078c8668ce079a84.gif?imageMogr2/auto-orient/strip" alt="IgnorePointer"></p>
<h2 id="4-AbsorbPointer"><a href="#4-AbsorbPointer" class="headerlink" title="4. AbsorbPointer"></a>4. AbsorbPointer</h2><blockquote>
<ul>
<li><p><strong>è¯´æ˜ï¼š</strong> ç”¨äºé˜»æ­¢å­ç»„ä»¶æ¥æ”¶æŒ‡é’ˆäº‹ä»¶çš„å¸ƒå±€ç»„ä»¶ï¼Œå…¶æ ¸å¿ƒåŠŸèƒ½æ˜¯é€šè¿‡ç»ˆæ­¢å‘½ä¸­æµ‹è¯•ï¼ˆHitTestï¼‰æ¥ç¦ç”¨å­æ ‘çš„äº¤äº’èƒ½åŠ›ã€‚å®ƒä¸ä¼šå½±å“å¸ƒå±€å’Œç»˜åˆ¶ï¼Œä»…æ§åˆ¶äº‹ä»¶ä¼ é€’</p>
</li>
<li><p><strong>è§„åˆ™ï¼š</strong> absorbingï¼šå¸ƒå°”å€¼ï¼Œé»˜è®¤ä¸º trueã€‚å½“è®¾ç½®ä¸º true æ—¶ï¼Œå­ç»„ä»¶å°†æ— æ³•æ¥æ”¶ç”¨æˆ·è¾“å…¥äº‹ä»¶ï¼Œå¿…é¡»ç›´æ¥åŒ…è£¹éœ€è¦ç¦ç”¨çš„å­ç»„ä»¶ï¼Œä¸”ä¸å½±å“çˆ¶çº§æˆ–å¤–éƒ¨ç»„ä»¶çš„äº¤äº’</p>
</li>
<li><p><strong>æ³¨æ„ï¼š</strong> è™½ç„¶ AbsorbPointer çš„ä½¿ç”¨ä¸ä¼šæ˜¾è‘—å½±å“æ€§èƒ½ï¼Œä½†åœ¨å¤æ‚çš„å¸ƒå±€ä¸­åº”è°¨æ…ä½¿ç”¨ï¼Œé¿å…ä¸å¿…è¦çš„åµŒå¥—ï¼Œéœ€é…åˆçŠ¶æ€ç®¡ç†ï¼ˆå¦‚ setStateï¼‰åŠ¨æ€æ§åˆ¶ absorbing å±æ€§ï¼Œå®ç°äº¤äº’å¼€å…³ï¼Œå³ä½¿ AbsorbPointer è®¾ç½®ä¸ºå¸æ”¶æ¨¡å¼ï¼Œå®ƒä»ç„¶ä¼šå°†ç‚¹å‡»äº‹ä»¶ä¼ é€’ç»™å…¶çˆ¶ç»„ä»¶ã€‚è¿™æ„å‘³ç€çˆ¶ç»„ä»¶çš„ GestureDetector ä»ç„¶èƒ½å¤Ÿæ•è·ç‚¹å‡»äº‹ä»¶</p>
</li>
<li><p><strong>æ¨èï¼š</strong> ä¸´æ—¶ç¦ç”¨äº¤äº’ã€æ‰¹é‡ç¦ç”¨ç»„ä»¶</p>
</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Center(</span><br><span class="line">  child: Column(</span><br><span class="line">    mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">    children: [</span><br><span class="line">      // å¤–å±‚å¯ç‚¹å‡»åŒºåŸŸ</span><br><span class="line">      GestureDetector(</span><br><span class="line">        // ignore: avoid_print</span><br><span class="line">        onTap: () =&gt; print(&#x27;å¤–å±‚ç‚¹å‡»&#x27;),</span><br><span class="line">        child: Container(</span><br><span class="line">          color: Colors.grey,</span><br><span class="line">          padding: const EdgeInsets.all(16),</span><br><span class="line">          child: AbsorbPointer(</span><br><span class="line">            absorbing: true, // ç¦ç”¨å­ç»„ä»¶äº¤äº’</span><br><span class="line">            child: Row(</span><br><span class="line">              children: [</span><br><span class="line">                ElevatedButton(</span><br><span class="line">                  // ignore: avoid_print</span><br><span class="line">                  onPressed: () =&gt; print(&#x27;æŒ‰é’®ç‚¹å‡»&#x27;),</span><br><span class="line">                  child: const Text(&#x27;ç¦ç”¨æŒ‰é’®&#x27;),</span><br><span class="line">                ),</span><br><span class="line">                const SizedBox(width: 16),</span><br><span class="line">                const Text(&#x27;ä¸å¯ç‚¹å‡»åŒºåŸŸ&#x27;),</span><br><span class="line">              ],</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">      const SizedBox(height: 20),</span><br><span class="line">      // å¯¹æ¯”ç¤ºä¾‹ï¼ˆäº¤äº’æ­£å¸¸ï¼‰</span><br><span class="line">      GestureDetector(</span><br><span class="line">        // ignore: avoid_print</span><br><span class="line">        onTap: () =&gt; print(&#x27;å¤–å±‚ç‚¹å‡»&#x27;),</span><br><span class="line">        child: Container(</span><br><span class="line">          color: Colors.grey,</span><br><span class="line">          padding: const EdgeInsets.all(16),</span><br><span class="line">          child: AbsorbPointer(</span><br><span class="line">            absorbing: false, // å¯ç”¨å­ç»„ä»¶äº¤äº’</span><br><span class="line">            child: ElevatedButton(</span><br><span class="line">              // ignore: avoid_print</span><br><span class="line">              onPressed: () =&gt; print(&#x27;æ­£å¸¸æŒ‰é’®&#x27;),</span><br><span class="line">              child: const Text(&#x27;å¯ç‚¹å‡»æŒ‰é’®&#x27;),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    ],</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://upload-images.jianshu.io/upload_images/1976231-8dd7fec9bf947ef9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="AbsorbPointer"></p>
<blockquote>
<p><strong>Overlay  è¦†ç›–å±‚</strong></p>
<p><strong>Opacity é€æ˜åº¦æ•ˆæœ</strong></p>
<p><strong>AnimatedOpacity åŠ¨ç”»é€æ˜åº¦</strong></p>
<p><strong>ClipRRect åœ†è§’è£å‰ª</strong></p>
<p><strong>ClipOval  æ¤­åœ†è£å‰ª</strong></p>
<p><strong>ClipPath  è·¯å¾„è£å‰ª</strong></p>
<p><strong>ClipRect  çŸ©å½¢è£å‰ª</strong></p>
<p><strong>BackdropFilter  èƒŒæ™¯æ»¤é•œ</strong></p>
<p><strong>DecoratedBox  è£…é¥°ç›’å­</strong></p>
<p><strong>RotatedBox  æ—‹è½¬ç›’å­</strong></p>
</blockquote>
<h1 id="å¹³å°ç‰¹å®šå¸ƒå±€æ§ä»¶"><a href="#å¹³å°ç‰¹å®šå¸ƒå±€æ§ä»¶" class="headerlink" title="å¹³å°ç‰¹å®šå¸ƒå±€æ§ä»¶"></a>å¹³å°ç‰¹å®šå¸ƒå±€æ§ä»¶</h1><blockquote>
<p><strong>CupertinoPageScaffold  iOSé£æ ¼é¡µé¢è„šæ‰‹æ¶</strong></p>
<p><strong>CupertinoTabScaffold  iOSé£æ ¼æ ‡ç­¾æ è„šæ‰‹æ¶</strong></p>
<p><strong>CupertinoNavigationBar   iOSé£æ ¼å¯¼èˆªæ </strong></p>
<p><strong>CupertinoTabBar  iOSé£æ ¼æ ‡ç­¾æ </strong></p>
<p><strong>CupertinoActionSheet  iOSé£æ ¼æ“ä½œè¡¨</strong></p>
<p><strong>CupertinoAlertDialog  iOSé£æ ¼è­¦å‘Šå¯¹è¯æ¡†</strong></p>
<p><strong>CupertinoContextMenu  iOSé£æ ¼ä¸Šä¸‹æ–‡èœå•</strong></p>
<p><strong>MaterialApp	Material Design    åº”ç”¨å®¹å™¨</strong></p>
<p><strong>Scaffold	  Material Design   é¡µé¢è„šæ‰‹æ¶</strong></p>
<p><strong>AppBar	Material Design   åº”ç”¨æ </strong></p>
<p><strong>BottomAppBar   Material Design   åº•éƒ¨åº”ç”¨æ </strong></p>
<p><strong>TabBar  Material Design   æ ‡ç­¾æ </strong></p>
<p><strong>Drawer  Material Design   æŠ½å±‰</strong></p>
<p><strong>SnackBar  Material Design  åº•éƒ¨æ¶ˆæ¯æ¡</strong></p>
<p><strong>BottomSheet  Material Design   åº•éƒ¨è¡¨å•</strong></p>
<p><strong>Material	Material Design   è¡¨é¢</strong></p>
<p><strong>Card  Material Design   å¡ç‰‡</strong></p>
<p><strong>Chip  Material Design  æ ‡ç­¾</strong></p>
<p><strong>Divider   Material Design åˆ†å‰²çº¿ï¼š</strong> æ°´å¹³åˆ†å‰²çº¿ç»„ä»¶ï¼Œå¸¸è§äºåˆ—è¡¨é¡¹ã€æ¿å—åˆ’åˆ†ç­‰åœºæ™¯</p>
<p><strong>ListTile   Material Design åˆ—è¡¨é¡¹ï¼š</strong> ä¸»è¦ç”¨äºåˆ›å»ºåˆ—è¡¨é¡¹ï¼ˆList Itemï¼‰ï¼Œé€šå¸¸ç”¨äº ListViewã€Card æˆ– Drawer ç­‰å¸ƒå±€ä¸­</p>
</blockquote>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><blockquote>
<p>è™½ç„¶ Flutter æä¾›äº†è¶…è¿‡ 100+ ä¸ªå¸ƒå±€ç›¸å…³æ§ä»¶ï¼Œä»¥ä¸Šåˆ—ä¸¾è¦†ç›–äº†å‡ ä¹æ‰€æœ‰å®˜æ–¹æ ¸å¿ƒå¸ƒå±€æ§ä»¶ï¼Œå®é™…å¼€å‘ä¸­æœ€å¸¸ç”¨çš„çº¦åªæœ‰ 15 ä¸ªã€‚æŒæ¡ <strong>Row&#x2F;Column&#x2F;Stack&#x2F;Expanded&#x2F;ListView</strong>è¿™äº”ä¸ªæ ¸å¿ƒç»„ä»¶å³å¯è§£å†³ç»å¤§å¤šæ•°å¸ƒå±€éœ€æ±‚ã€‚</p>
<p><strong>åŸºç¡€å¸ƒå±€ä¸‰å·¨å¤´ï¼š</strong> Row&#x2F;Columnï¼ˆçº¿æ€§å¸ƒå±€ï¼‰ã€Stackï¼ˆå±‚å å¸ƒå±€ï¼‰ã€ListView&#x2F;GridViewï¼ˆæ»šåŠ¨å¸ƒå±€ï¼‰æ»¡è¶³ 80% åœºæ™¯</p>
<p><strong>å¼¹æ€§å¸ƒå±€å¿…ç”¨ï¼š</strong> Expanded å’Œ Flexible æ˜¯è‡ªé€‚åº”å¸ƒå±€çš„æ ¸å¿ƒ</p>
<p><strong>æ€§èƒ½å…³é”®ï¼š</strong> é•¿åˆ—è¡¨å¿…ç”¨ ListView.builderï¼Œé¿å…æ»¥ç”¨ IntrinsicWidth&#x2F;Heightï¼Œå¤æ‚åŠ¨ç”»ä½¿ç”¨ CustomMultiChildLayout</p>
<p><strong>å“åº”å¼æœ€ä½³å®è·µï¼š</strong> LayoutBuilder + MediaQuery + çº¦æŸæ¡ä»¶åˆ¤æ–­</p>
</blockquote>
<p><a href="https://github.com/GavinCarter1991/flutter-layout-demo">DEMO</a></p>
]]></content>
      <categories>
        <category>Flutter</category>
      </categories>
      <tags>
        <tag>â€œFlutterâ€</tag>
        <tag>â€œLayoutâ€</tag>
        <tag>å¸ƒå±€</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€å°ç”µè„‘ç®¡ç†å¤šä¸ªcocoapodsè´¦å·</title>
    <url>/2025/06/19/%E4%B8%80%E5%8F%B0%E7%94%B5%E8%84%91%E7%AE%A1%E7%90%86%E5%A4%9A%E4%B8%AAcocoapods%E8%B4%A6%E5%8F%B7/</url>
    <content><![CDATA[<h2 id="éœ€æ±‚ï¼š"><a href="#éœ€æ±‚ï¼š" class="headerlink" title="éœ€æ±‚ï¼š"></a>éœ€æ±‚ï¼š</h2><blockquote>
<p><strong>æˆ‘çš„éœ€æ±‚æ˜¯ï¼š</strong>æˆ‘éœ€è¦åœ¨ä¸€ä¸ªç”µè„‘ä¸Šç®¡ç†ä¸¤ä¸ªcocoapodsè´¦å·ï¼Œä¸€ä¸ªç”¨äºå…¬å¸SDKçš„å‘å¸ƒï¼Œä¸€ä¸ªç”¨äºè‡ªå·±å¹³æ—¶æµ‹è¯•ç”¨ã€‚</p>
<p><strong>æˆ‘çš„é—®é¢˜æ˜¯ï¼š</strong>å½“æˆ‘åˆ›å»ºç¬¬äºŒä¸ªè´¦å·æˆåŠŸå(ç¬¬äºŒä¸ªè´¦å·çš„é‚®ç®±å¿…é¡»å’Œç¬¬ä¸€ä¸ªä¸åŒ)ï¼Œç¬¬ä¸€ä¸ªè´¦å·çš„ä¿¡æ¯å°±æŸ¥ä¸åˆ°äº†ã€‚</p>
</blockquote>
<h2 id="é—®é¢˜åˆ†æï¼š"><a href="#é—®é¢˜åˆ†æï¼š" class="headerlink" title="é—®é¢˜åˆ†æï¼š"></a>é—®é¢˜åˆ†æï¼š</h2><blockquote>
<p>CocoaPods é»˜è®¤åªæ”¯æŒä¸€ä¸ªæ´»è·ƒ sessionï¼ŒCocoaPodsé»˜è®¤æ˜¯ä½¿ç”¨**<code>~/.netrc</code><strong>æ–‡ä»¶æ¥å­˜å‚¨è®¤è¯tokenã€‚å½“æˆ‘åˆ›å»ºæ–°çš„è´¦å·æ—¶ï¼Œæ–°çš„tokenå°±ä¼šè¢«å†™å…¥åˆ°</strong><code>~/.netrc</code>**æ–‡ä»¶ä¸­ï¼Œä½†æ˜¯ä¼šè¦†ç›–ç¬¬ä¸€ä¸ªè´¦å·çš„tokenï¼Œå¦‚ä½•éœ€è¦åŒæ—¶åœ¨ä¸€å°ç”µè„‘ä¸Šå­˜åœ¨ä¸¤ä¸ªåŠä»¥ä¸Šçš„CocoaPodsè´¦å·å°±éœ€è¦å¤‡ä»½æ¯ä¸€ä¸ªtokenï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸åŒçš„æ–¹å¼æ¥ç®¡ç†å¤šä¸ªè´¦å·çš„å‡­è¯ã€‚</p>
</blockquote>
<h2 id="è§£å†³æ–¹æ¡ˆï¼š"><a href="#è§£å†³æ–¹æ¡ˆï¼š" class="headerlink" title="è§£å†³æ–¹æ¡ˆï¼š"></a>è§£å†³æ–¹æ¡ˆï¼š</h2><p><em>ç”±äºCocoaPodsæœ¬èº«å¹¶ä¸æ”¯æŒå¤šè´¦å·åˆ‡æ¢ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç®¡ç†å¤šä¸ªè´¦å·çš„tokenã€‚</em></p>
<p><strong>ä»¥ä¸‹æ˜¯å‡ ç§æ–¹æ³•ï¼š</strong></p>
<h3 id="æ–¹æ³•1ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡"><a href="#æ–¹æ³•1ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡" class="headerlink" title="æ–¹æ³•1ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡"></a>æ–¹æ³•1ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡</h3><blockquote>
<p>CocoaPodså¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡**<code>COCOAPODS_TRUNK_TOKEN</code>**æ¥æŒ‡å®šå½“å‰ä¼šè¯ä½¿ç”¨çš„tokenã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥ä¸ºä¸åŒçš„è´¦å·è®¾ç½®ä¸åŒçš„tokenï¼Œå¹¶åœ¨ä½¿ç”¨å‰è®¾ç½®ç›¸åº”çš„ç¯å¢ƒå˜é‡ã€‚</p>
</blockquote>
<p><strong>1.</strong> æ³¨å†ŒCocoaPodsè´¦å·ï¼Œå¹¶ä¿å­˜æ³¨å†Œæ—¶å¾—åˆ°çš„tokenï¼ˆæ³¨å†Œæ—¶ä¼šå‘é€é‚®ä»¶ï¼Œé‚®ä»¶ä¸­æœ‰éªŒè¯é“¾æ¥ï¼Œç‚¹å‡»éªŒè¯åï¼Œtokenæ‰æœ‰æ•ˆï¼‰</p>
<p><code>æ³¨æ„ï¼šæ¯ä¸ªè´¦å·çš„tokenæ˜¯å”¯ä¸€çš„ï¼Œå¹¶ä¸”é•¿æœŸæœ‰æ•ˆï¼ˆé™¤éåœ¨ç½‘é¡µä¸Šé‡ç½®ï¼‰</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ³¨å†Œç¬¬ä¸€ä¸ªè´¦å·</span><br><span class="line">pod trunk register your-first-email@example.com &quot;First Name&quot; --description=&#x27;MacBook Pro&#x27;</span><br><span class="line"></span><br><span class="line"># éªŒè¯ç¬¬ä¸€ä¸ªè´¦å·é‚®ç®±ï¼šå»é‚®ç®±ç‚¹å‡»é‚®ä»¶ä¸­çš„éªŒè¯é“¾æ¥ã€‚æœªéªŒè¯çš„ token æ— æ³•æ‰§è¡Œ pod trunk å‘½ä»¤</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹å½“å‰ç™»å½•çŠ¶æ€</span><br><span class="line"># å¦‚æœæŠ¥é”™ [!] Authentication token is invalid or unverified</span><br><span class="line"># è¡¨ç¤ºå½“å‰ token æ— æ•ˆæˆ–æœªéªŒè¯</span><br><span class="line">pod trunk me</span><br><span class="line"></span><br><span class="line"># éªŒè¯æˆåŠŸåå¤‡ä»½å½“å‰è´¦å·å‡­è¯</span><br><span class="line">cp ~/.netrc ~/.netrc_account1</span><br><span class="line"></span><br><span class="line"># æ³¨å†Œç¬¬äºŒä¸ªè´¦å·</span><br><span class="line">pod trunk register your-second-email@example.com &quot;Second Name&quot; --description=&#x27;MacBook Pro&#x27;</span><br><span class="line"></span><br><span class="line"># éªŒè¯ç¬¬äºŒä¸ªè´¦å·é‚®ç®±</span><br><span class="line"># å¤‡ä»½ç¬¬äºŒä¸ªè´¦å·å‡­è¯</span><br><span class="line">cp ~/.netrc ~/.netrc_account2</span><br></pre></td></tr></table></figure>
<p>åˆ°æ­¤æ ¹ç›®å½•å°±å­˜åœ¨ä¸‰ä¸ªtokenæ–‡ä»¶äº†ï¼š**.netrc**  <strong>.netrc_account1</strong>   <strong>.netrc_account2</strong></p>
<p><strong>2.</strong> ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†ä¼šè¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># åˆ›å»ºè´¦å·1çš„ç¯å¢ƒå˜é‡</span><br><span class="line">echo &quot;export COCOAPODS_TRUNK_TOKEN_ACCOUNT1=&#x27;your-token-here&#x27;&quot; &gt;&gt; ~/.bash_profile</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºè´¦å·2çš„ç¯å¢ƒå˜é‡</span><br><span class="line">echo &quot;export COCOAPODS_TRUNK_TOKEN_ACCOUNT2=&#x27;your-other-token-here&#x27;&quot; &gt;&gt; ~/.bash_profile</span><br><span class="line"></span><br><span class="line"># åˆ·æ–°ç¯å¢ƒ</span><br><span class="line">source ~/.bash_profile</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ç‰¹å®šè´¦å·</span><br><span class="line">function pod-account1() &#123;</span><br><span class="line">    export COCOAPODS_TRUNK_TOKEN=$COCOAPODS_TRUNK_TOKEN_ACCOUNT1</span><br><span class="line">    pod &quot;$@&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function pod-account2() &#123;</span><br><span class="line">    export COCOAPODS_TRUNK_TOKEN=$COCOAPODS_TRUNK_TOKEN_ACCOUNT2</span><br><span class="line">    pod &quot;$@&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>3.</strong> åˆ›å»ºåˆ‡æ¢è„šæœ¬ï¼ˆ cocoapods-switch.shï¼‰ï¼Œç§»åŠ¨è„šæœ¬åˆ°PATH</p>
<p><strong>è„šæœ¬å†…å®¹ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if [ &quot;$1&quot; = &quot;account1&quot; ]; then</span><br><span class="line">    # åˆ‡æ¢åˆ°è´¦å·1</span><br><span class="line">    cp ~/.netrc_account1 ~/.netrc</span><br><span class="line">    echo &quot;Switched to CocoaPods account: account1&quot;</span><br><span class="line">elif [ &quot;$1&quot; = &quot;account2&quot; ]; then</span><br><span class="line">    # åˆ‡æ¢åˆ°è´¦å·2</span><br><span class="line">    cp ~/.netrc_account2 ~/.netrc</span><br><span class="line">    echo &quot;Switched to CocoaPods account: account2&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;Usage: cocoapods-switch [account1|account2]&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p><strong>åœ¨ç»ˆç«¯è¿è¡Œï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># åˆ›å»ºåˆ‡æ¢è„šæœ¬</span><br><span class="line">nano cocoapods-switch.sh</span><br><span class="line"></span><br><span class="line"># ç²˜è´´ä¸Šé¢çš„è„šæœ¬å†…å®¹</span><br><span class="line"></span><br><span class="line"># è®¾ç½®æƒé™</span><br><span class="line">chmod +x cocoapods-switch.sh</span><br><span class="line"></span><br><span class="line"># ç§»åŠ¨è„šæœ¬åˆ° PATH</span><br><span class="line">sudo mv cocoapods-switch.sh /usr/local/bin/</span><br></pre></td></tr></table></figure>

<p><strong>4.</strong> å¤šè´¦å·æ“ä½œæµç¨‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># åˆ‡æ¢åˆ°è´¦å·1</span><br><span class="line">cocoapods-switch account1</span><br><span class="line"></span><br><span class="line"># éªŒè¯è´¦å·1çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°è´¦å·1çš„ä¿¡æ¯</span><br><span class="line">pod trunk me</span><br><span class="line"></span><br><span class="line"># å‘å¸ƒåˆ°è´¦å·1çš„ä»“åº“</span><br><span class="line">pod trunk push MyPod.podspec</span><br><span class="line"></span><br><span class="line"># åˆ‡æ¢åˆ°è´¦å·2</span><br><span class="line">cocoapods-switch account2</span><br><span class="line"></span><br><span class="line"># éªŒè¯è´¦å·2çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°è´¦å·2çš„ä¿¡æ¯</span><br><span class="line">pod trunk me</span><br><span class="line"></span><br><span class="line"># å‘å¸ƒåˆ°è´¦å·2çš„ä»“åº“</span><br><span class="line">pod trunk push OtherPod.podspec</span><br></pre></td></tr></table></figure>

<h3 id="æ–¹æ³•2ï¼šä½¿ç”¨è„šæœ¬æ–‡ä»¶"><a href="#æ–¹æ³•2ï¼šä½¿ç”¨è„šæœ¬æ–‡ä»¶" class="headerlink" title="æ–¹æ³•2ï¼šä½¿ç”¨è„šæœ¬æ–‡ä»¶"></a>æ–¹æ³•2ï¼šä½¿ç”¨è„šæœ¬æ–‡ä»¶</h3><blockquote>
<p>å‰é¢çš„è´¦å·åˆ›å»ºå’Œå¤‡ä»½Tokenæ˜¯ç›¸åŒçš„å°±ä¸é‡å¤äº†ã€‚</p>
</blockquote>
<p><strong>åˆ›å»ºå’Œä½¿ç”¨ pod-switch è„šæœ¬</strong></p>
<p>ç»ˆç«¯è¿è¡Œï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ä½¿ç”¨ nano ç¼–è¾‘å™¨åˆ›å»ºæ–‡ä»¶</span><br><span class="line">nano pod-switch</span><br></pre></td></tr></table></figure>

<p>å¤åˆ¶å¹¶ç²˜è´´ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ£€æŸ¥å‚æ•°æ•°é‡</span><br><span class="line">if [ $# -ne 1 ]; then</span><br><span class="line">    echo &quot;Usage: pod-switch [account1 | account2]&quot;</span><br><span class="line">    echo &quot;Current account:&quot;</span><br><span class="line">    pod trunk me | grep &quot;Email&quot; || echo &quot;No active account&quot;</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"># æ ¹æ®å‚æ•°åˆ‡æ¢è´¦å·</span><br><span class="line">if [ &quot;$1&quot; = &quot;account1&quot; ]; then</span><br><span class="line">    cp ~/.netrc_ account1 ~/.netrc 2&gt;/dev/null</span><br><span class="line">    if [ $? -eq 0 ]; then</span><br><span class="line">        echo &quot;âœ… Switched to Account1 CocoaPods account&quot;</span><br><span class="line">        pod trunk me | grep &quot;Email&quot;</span><br><span class="line">    else</span><br><span class="line">        echo &quot;âŒ Error: Account1 credentials not found&quot;</span><br><span class="line">        echo &quot;Run &#x27;cp ~/.netrc ~/.netrc_ account1&#x27; to backup your account1&quot;</span><br><span class="line">    fi</span><br><span class="line">elif [ &quot;$1&quot; = &quot;account2&quot; ]; then</span><br><span class="line">    cp ~/.netrc_ account2 ~/.netrc 2&gt;/dev/null</span><br><span class="line">    if [ $? -eq 0 ]; then</span><br><span class="line">        echo &quot;âœ… Switched to account2 CocoaPods account&quot;</span><br><span class="line">        pod trunk me | grep &quot;Email&quot;</span><br><span class="line">    else</span><br><span class="line">        echo &quot;âŒ Error: account2 credentials not found&quot;</span><br><span class="line">        echo &quot;Run &#x27;cp ~/.netrc ~/.netrc_ account2&#x27; to backup your account2&quot;</span><br><span class="line">    fi</span><br><span class="line">else</span><br><span class="line">    echo &quot;âŒ Invalid account name. Use &#x27;account1&#x27; or &#x27;account2&#x27;&quot;</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p><strong>ä¿å­˜å¹¶é€€å‡ºç¼–è¾‘å™¨</strong></p>
<ol>
<li><p>æŒ‰ Ctrl + O ä¿å­˜æ–‡ä»¶</p>
</li>
<li><p>æŒ‰ Enter ç¡®è®¤æ–‡ä»¶å</p>
</li>
<li><p>æŒ‰ Ctrl + X é€€å‡º nano</p>
</li>
</ol>
<p>è®¾ç½®æ‰§è¡Œæƒé™ï¼š<code>chmod +x pod-switch</code></p>
<p><strong>ç§»åŠ¨åˆ°å¯æ‰§è¡Œè·¯å¾„</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo mv pod-switch /usr/local/bin/</span><br></pre></td></tr></table></figure>

<p><strong>éªŒè¯è„šæœ¬å®‰è£…</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">which pod-switch</span><br></pre></td></tr></table></figure>

<p><code>åº”è¯¥è¾“å‡º: /usr/local/bin/pod-switch</code></p>
<p><strong>ä½¿ç”¨ pod-switch è„šæœ¬</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># åˆ‡æ¢åˆ°ä¸»è´¦å·</span><br><span class="line">pod-switch account1</span><br><span class="line"></span><br><span class="line"># éªŒè¯è´¦å·</span><br><span class="line">pod trunk me</span><br><span class="line"></span><br><span class="line"># åˆ‡æ¢åˆ°ç¬¬äºŒä¸ªè´¦å·</span><br><span class="line">pod-switch account2</span><br><span class="line"></span><br><span class="line"># éªŒè¯è´¦å·</span><br><span class="line">pod trunk me</span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•éªŒè¯ï¼š</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/1976231-48996848ade104ac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ“ä½œæµç¨‹"></p>
]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>â€œcocoapodsâ€</tag>
        <tag>å¤šä¸ªè´¦å·</tag>
      </tags>
  </entry>
  <entry>
    <title>Widgetè¿›é˜¶</title>
    <url>/2025/06/07/widget-advanced/</url>
    <content><![CDATA[<h2 id="1-Widget-ä»‹ç»"><a href="#1-Widget-ä»‹ç»" class="headerlink" title="1.Widget ä»‹ç»"></a>1.Widget ä»‹ç»</h2><blockquote>
<p>Everything is a widget è¿™æ˜¯ä½ å­¦ä¹  flutter ä¼šå¬åˆ°çš„æœ€å¤šçš„ä¸€å¥è¯ã€‚å› ä¸ºåœ¨ Flutter ä¸­å‡ ä¹æ‰€æœ‰çš„å¯¹è±¡éƒ½æ˜¯ä¸€ä¸ª widgetï¼Œåœ¨ flutter ä¸­ UI çš„æ„å»ºå’Œäº‹ä»¶çš„å¤„ç†åŸºæœ¬éƒ½æ˜¯é€šè¿‡ widget çš„ç»„åˆåŠåµŒå¥—æ¥å®Œæˆçš„ã€‚åœ¨ iOS ä¸­æˆ‘ä»¬ç»å¸¸æåŠçš„â€œç»„ä»¶â€ã€â€œæ§ä»¶â€åœ¨ flutter ä¸­å°±æ˜¯ widgetï¼Œå½“ç„¶ widget çš„èŒƒå›´æ¯”ä¹‹æ›´åŠ å¹¿æ³›ã€‚å¦‚ï¼šæ‰‹åŠ¿æ£€æµ‹ GestureDetectorã€ä¸»é¢˜ Theme å’ŒåŠ¨ç”»å®¹å™¨ AnimatedContainer ç­‰ä¹Ÿæ˜¯ widgetã€‚</p>
</blockquote>
<p><strong>Flutter é»˜è®¤æ”¯æŒçš„ä¸¤ç§è®¾è®¡é£æ ¼ï¼š</strong></p>
<blockquote>
<p><strong>1.Material components Designï¼š</strong> è°·æ­Œï¼ˆandroidï¼‰çš„ UI é£æ ¼ï¼Œä¸»è¦ä¸º Android è®¾è®¡ï¼Œä½†ä¹Ÿæ”¯æŒè·¨å¹³å°ä½¿ç”¨ã€‚</p>
</blockquote>
<blockquote>
<p><strong>2.Cupertino Designï¼š</strong> è‹¹æœï¼ˆiOSï¼‰çš„ UI é£æ ¼ï¼Œæ¨¡ä»¿è‹¹æœåŸç”Ÿ UIKit é£æ ¼ã€‚é«˜åº¦è¿˜åŸ iOS åŸç”Ÿä½“éªŒï¼Œé€‚åˆéœ€è¦ä¸è‹¹æœç”Ÿæ€ä¸€è‡´çš„åº”ç”¨ã€‚</p>
</blockquote>
<h2 id="2-Widget-åˆ†ç±»"><a href="#2-Widget-åˆ†ç±»" class="headerlink" title="2.Widget åˆ†ç±»"></a>2.Widget åˆ†ç±»</h2><p><strong><em>1.æŒ‰çŠ¶æ€ç®¡ç†</em></strong></p>
<h6 id="ä¸€ã€StatelessWidgetï¼š"><a href="#ä¸€ã€StatelessWidgetï¼š" class="headerlink" title="ä¸€ã€StatelessWidgetï¼š"></a>ä¸€ã€StatelessWidgetï¼š</h6><p>æ— çŠ¶æ€ç»„ä»¶ï¼Œé€šè¿‡ build æ–¹æ³•è¿”å›é™æ€ UIã€‚ä¸å¯å˜ï¼Œå±æ€§ï¼ˆfinalï¼‰åœ¨åˆ›å»ºåæ— æ³•ä¿®æ”¹ï¼Œé€‚ç”¨äºä¸éœ€è¦å†…éƒ¨çŠ¶æ€å˜åŒ–çš„åœºæ™¯ï¼ˆå¦‚æ–‡æœ¬æ˜¾ç¤ºã€å›¾æ ‡ï¼‰ï¼Œä¸ä¾èµ–ç”¨æˆ·äº¤äº’æˆ–æ•°æ®å˜åŒ–çš„ UI éƒ¨åˆ†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class IconTextButton extends StatelessWidget &#123;</span><br><span class="line">  final String iconName;</span><br><span class="line">  final String label;</span><br><span class="line">  final VoidCallback onPressed;</span><br><span class="line"></span><br><span class="line">  const IconTextButton(&#123;</span><br><span class="line">    super.key,</span><br><span class="line">    required this.iconName,</span><br><span class="line">    required this.label,</span><br><span class="line">    required this.onPressed,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    return GestureDetector(</span><br><span class="line">      onTap: onPressed,</span><br><span class="line">      child: Column(</span><br><span class="line">        mainAxisAlignment: MainAxisAlignment.center,</span><br><span class="line">        children: &lt;Widget&gt;[</span><br><span class="line">          Image.asset(</span><br><span class="line">            &quot;assets/images/$iconName.png&quot;,</span><br><span class="line">            width: 40,</span><br><span class="line">            height: 40,</span><br><span class="line">          ),</span><br><span class="line">          const SizedBox(</span><br><span class="line">            height: 10,</span><br><span class="line">          ), // å›¾æ ‡</span><br><span class="line">          Text(</span><br><span class="line">            label,</span><br><span class="line">            style: const TextStyle(color: ColorConstant.color33, fontSize: 10),</span><br><span class="line">          ), // æ–‡å­—</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="äºŒã€StatefulWidgetï¼š"><a href="#äºŒã€StatefulWidgetï¼š" class="headerlink" title="äºŒã€StatefulWidgetï¼š"></a>äºŒã€StatefulWidgetï¼š</h6><p>æœ‰çŠ¶æ€ç»„ä»¶ï¼Œé€šè¿‡ State å¯¹è±¡ç®¡ç†åŠ¨æ€æ•°æ®ã€‚å½“çŠ¶æ€å˜åŒ–æ—¶è°ƒç”¨ setState è§¦å‘ UI æ›´æ–°ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’ï¼ˆå¦‚æŒ‰é’®ç‚¹å‡»ã€è¡¨å•è¾“å…¥ï¼‰å’Œä¾èµ–å®æ—¶æ•°æ®å˜åŒ–ï¼ˆå¦‚è®¡æ•°å™¨ã€åŠ¨æ€åˆ—è¡¨ï¼‰ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// ä¸Šä¸‹æ»šåŠ¨çš„æ¶ˆæ¯è½®æ’­</span><br><span class="line">class MarqueeWidget extends StatefulWidget &#123;</span><br><span class="line">  /// å­è§†å›¾æ•°é‡</span><br><span class="line">  final int count;</span><br><span class="line"></span><br><span class="line">  ///å­è§†å›¾æ„å»ºå™¨</span><br><span class="line">  final IndexedWidgetBuilder itemBuilder;</span><br><span class="line"></span><br><span class="line">  ///è½®æ’­çš„æ—¶é—´é—´éš”</span><br><span class="line">  final int loopSeconds;</span><br><span class="line"></span><br><span class="line">  const MarqueeWidget(&#123;</span><br><span class="line">    super.key,</span><br><span class="line">    required this.count,</span><br><span class="line">    required this.itemBuilder,</span><br><span class="line">    this.loopSeconds = 5,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  _MarqueeWidgetState createState() =&gt; _MarqueeWidgetState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class _MarqueeWidgetState extends State&lt;MarqueeWidget&gt; &#123;</span><br><span class="line">  late PageController _controller;</span><br><span class="line">  late Timer _timer;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  void initState() &#123;</span><br><span class="line">    super.initState();</span><br><span class="line">    _controller = PageController();</span><br><span class="line">    _timer = Timer.periodic(Duration(seconds: widget.loopSeconds), (timer) &#123;</span><br><span class="line">      if (_controller.page != null) &#123;</span><br><span class="line">        // å¦‚æœå½“å‰ä½äºæœ€åä¸€é¡µï¼Œåˆ™ç›´æ¥è·³è½¬åˆ°ç¬¬ä¸€é¡µï¼Œä¸¤è€…å†…å®¹ç›¸åŒï¼Œè·³è½¬æ—¶è§†è§‰ä¸Šæ— æ„ŸçŸ¥</span><br><span class="line">        if (_controller.page!.round() &gt;= widget.count) &#123;</span><br><span class="line">          _controller.jumpToPage(0);</span><br><span class="line">        &#125;</span><br><span class="line">        _controller.nextPage(</span><br><span class="line">            duration: const Duration(seconds: 1), curve: Curves.linear);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    return PageView.builder(</span><br><span class="line">      scrollDirection: Axis.vertical,</span><br><span class="line">      controller: _controller,</span><br><span class="line">      itemBuilder: (buildContext, index) &#123;</span><br><span class="line">        if (index &lt; widget.count) &#123;</span><br><span class="line">          return widget.itemBuilder(buildContext, index);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          return widget.itemBuilder(buildContext, 0);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      itemCount: widget.count + 1,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  void dispose() &#123;</span><br><span class="line">    super.dispose();</span><br><span class="line">    _controller.dispose();</span><br><span class="line">    _timer.cancel();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong><em>2.æŒ‰åŠŸèƒ½åˆ†ç±»</em></strong></p>
<blockquote>
<p><strong>1.å¸ƒå±€ç±» Widgetï¼š</strong> æ§åˆ¶å­ Widget çš„æ’åˆ—æ–¹å¼ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¸¸è§æœ‰ï¼š</span><br><span class="line">Row/Columnï¼šæ°´å¹³/å‚ç›´æ’åˆ—å­é¡¹ï¼ˆåŸºäº Flexboxï¼‰ã€‚</span><br><span class="line">Stackï¼šå­ Widget å †å ï¼ˆç±»ä¼¼ CSS çš„ç»å¯¹å®šä½ï¼‰ã€‚</span><br><span class="line">Expanded/Flexibleï¼šåœ¨ Row æˆ– Column ä¸­åˆ†é…å‰©ä½™ç©ºé—´ã€‚</span><br><span class="line">Containerï¼šç»“åˆå¸ƒå±€ã€è£…é¥°ã€è¾¹è·ç­‰åŠŸèƒ½</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>2.åŸºç¡€ç»„ä»¶ Widgetï¼š</strong> æ„æˆ UI çš„åŸºæœ¬å…ƒç´ ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¸¸è§æœ‰ï¼š</span><br><span class="line">Textï¼šæ˜¾ç¤ºæ–‡æœ¬ã€‚</span><br><span class="line">Imageï¼šåŠ è½½æœ¬åœ°æˆ–ç½‘ç»œå›¾ç‰‡ã€‚</span><br><span class="line">Iconï¼šæ˜¾ç¤ºå›¾æ ‡ï¼ˆéœ€å¼•å…¥ cupertino_icons æˆ–è‡ªå®šä¹‰å›¾æ ‡åº“ï¼‰</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>3.æ»šåŠ¨ç±» Widgetï¼š</strong> å¤„ç†å†…å®¹è¶…å‡ºå±å¹•æ—¶çš„æ»šåŠ¨è¡Œä¸ºã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¸¸è§æœ‰ï¼š</span><br><span class="line">ListViewï¼šå‚ç›´/æ°´å¹³æ»šåŠ¨åˆ—è¡¨ã€‚</span><br><span class="line">GridViewï¼šç½‘æ ¼å¸ƒå±€æ»šåŠ¨è§†å›¾ã€‚</span><br><span class="line">SingleChildScrollViewï¼šåŒ…è£¹å•ä¸ªå¯æ»šåŠ¨å­ç»„ä»¶ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>4.äº¤äº’ç±» Widgetï¼š</strong> å“åº”ç”¨æˆ·è¾“å…¥äº‹ä»¶ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¸¸è§æœ‰ï¼š</span><br><span class="line">ElevatedButton/TextButtonï¼šæŒ‰é’®äº¤äº’ã€‚</span><br><span class="line">TextFieldï¼šæ–‡æœ¬è¾“å…¥æ¡†ã€‚</span><br><span class="line">Checkbox/Switchï¼šé€‰æ‹©æ§ä»¶ã€‚</span><br><span class="line">GestureDetectorï¼šè‡ªå®šä¹‰æ‰‹åŠ¿æ£€æµ‹ï¼ˆç‚¹å‡»ã€é•¿æŒ‰ã€æ‹–åŠ¨ï¼‰ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>5.å¹³å°é£æ ¼ç±» Widgetï¼š</strong> é€‚é…ä¸åŒæ“ä½œç³»ç»Ÿçš„è§†è§‰é£æ ¼ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¸¸è§æœ‰ï¼š</span><br><span class="line">Material Designï¼šMaterialAppã€AppBarã€FloatingActionButtonã€‚</span><br><span class="line">Cupertinoï¼ˆiOS é£æ ¼ï¼‰ï¼šCupertinoAppã€CupertinoNavigationBarã€CupertinoPickerã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>6.åŠ¨ç”»ç±» Widgetï¼š</strong> å®ç°åŠ¨æ€è§†è§‰æ•ˆæœã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¸¸è§æœ‰ï¼š</span><br><span class="line">AnimatedContainerï¼šè‡ªåŠ¨è¿‡æ¸¡çš„å®¹å™¨ï¼ˆå¤§å°ã€é¢œè‰²ç­‰å±æ€§å˜åŒ–ï¼‰ã€‚</span><br><span class="line">Heroï¼šé¡µé¢åˆ‡æ¢å…±äº«å…ƒç´ çš„è¿‡æ¸¡åŠ¨ç”»ã€‚</span><br><span class="line">AnimatedBuilderï¼šè‡ªå®šä¹‰å¤æ‚åŠ¨ç”»ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>7. å¯¼èˆªä¸è·¯ç”±ç±» Widgetï¼š</strong> ç®¡ç†é¡µé¢è·³è½¬å’Œå¯¼èˆªç»“æ„ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¸¸è§æœ‰ï¼š</span><br><span class="line">Navigatorï¼šç®¡ç†é¡µé¢å †æ ˆï¼ˆpush/popï¼‰ã€‚</span><br><span class="line">PageViewï¼šå®ç°æ»‘åŠ¨åˆ‡æ¢é¡µé¢ã€‚</span><br><span class="line">BottomNavigationBarï¼šåº•éƒ¨å¯¼èˆªæ ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>é€šè¿‡ç®€å• Widget ç»„åˆå®ç°å¤æ‚ UIï¼ˆä¾‹å¦‚ç”¨ Row + Expanded æ›¿ä»£è‡ªå®šä¹‰å¸ƒå±€ï¼‰(ä¼˜å…ˆç»„åˆè€Œéç»§æ‰¿)<br>å±€éƒ¨çŠ¶æ€ä½¿ç”¨ StatefulWidget<br>å…¨å±€çŠ¶æ€ä½¿ç”¨çŠ¶æ€ç®¡ç†å·¥å…·ï¼ˆå¦‚ Providerã€Riverpodï¼‰<br>å¯¹é¢‘ç¹æ›´æ–°çš„éƒ¨åˆ†ä½¿ç”¨ const æ„é€ å‡½æ•°<br>é•¿åˆ—è¡¨ä½¿ç”¨ ListView.builder æ‡’åŠ è½½</p>
</blockquote>
<h2 id="3-Widget-ç”Ÿå‘½å‘¨æœŸ"><a href="#3-Widget-ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="3.Widget ç”Ÿå‘½å‘¨æœŸ"></a>3.Widget ç”Ÿå‘½å‘¨æœŸ</h2><p><strong>StatelessWidget çš„ç”Ÿå‘½å‘¨æœŸ</strong></p>
<blockquote>
<p>StatelessWidget ä»…æœ‰ä¸€ä¸ª build() æ–¹æ³•ï¼Œæ— çŠ¶æ€ç®¡ç†é€»è¾‘ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸå®Œå…¨ç”±çˆ¶ç»„ä»¶æ§åˆ¶ã€‚</p>
</blockquote>
<p><strong>StatefulWidget ä¸»è¦ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</strong></p>
<blockquote>
<p>åˆ›å»ºé˜¶æ®µ<br>createState()</p>
</blockquote>
<blockquote>
<p>åˆå§‹åŒ–é˜¶æ®µ<br>initState()<br>didChangeDependencies()</p>
</blockquote>
<blockquote>
<p>æ›´æ–°é˜¶æ®µ<br>didUpdateWidget(oldWidget)<br>build()</p>
</blockquote>
<blockquote>
<p>é”€æ¯é˜¶æ®µ<br>deactivate()<br>dispose()</p>
</blockquote>
<p><img src="https://i-blog.csdnimg.cn/img_convert/a33469c55f94b5278f698d8605d8e0cc.webp?x-oss-process=image/format,png" alt="2025-05-22 18.38.22.png"></p>
<p><strong>1.createState()</strong><br>å½“ StatefulWidget è¢«æ’å…¥ Widget æ ‘æ—¶è°ƒç”¨ï¼Œè€Œä¸”åªæ‰§è¡Œä¸€æ¬¡ã€‚</p>
<blockquote>
<p>ä¸»è¦ç”¨äºåˆ›å»ºä¸ä¹‹å…³è”çš„ State å¯¹è±¡ï¼ˆæ¯ä¸ª Widget å¯¹åº”ä¸€ä¸ª State å®ä¾‹ï¼‰ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class MyWidget extends StatefulWidget &#123;</span><br><span class="line">  @override</span><br><span class="line">  _MyWidgetState createState() =&gt; _MyWidgetState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>2.initState()</strong><br>åœ¨ State å¯¹è±¡åˆ›å»ºåï¼Œé¦–æ¬¡è°ƒç”¨ build() ä¹‹å‰è§¦å‘è¯¥æ–¹æ³•ï¼Œè€Œä¸”åªæ‰§è¡Œä¸€æ¬¡ã€‚</p>
<blockquote>
<p>ä¸»è¦ç”¨äºåˆå§‹åŒ–ä¾èµ–æ•°æ®ï¼ˆå¦‚è®¢é˜…äº‹ä»¶ã€åŠ è½½æœ¬åœ°é…ç½®ï¼‰å’Œ åˆ›å»ºåŠ¨ç”»æ§åˆ¶å™¨ï¼ˆAnimationControllerï¼‰ç­‰éœ€ä¸ dispose() é…å¯¹çš„èµ„æºã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@override</span><br><span class="line">void initState() &#123;</span><br><span class="line">  super.initState();</span><br><span class="line">  _controller = AnimationController(vsync: this);</span><br><span class="line">  _fetchData(); // åˆå§‹åŒ–æ•°æ®</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<br><code>å¿…é¡»è°ƒç”¨ super.initState()ã€‚</code><br><code>åœ¨è¿™é‡Œ View å¹¶æ²¡æœ‰æ¸²æŸ“ï¼Œåªæ˜¯ StatefulWidget è¢«åŠ è½½åˆ°æ¸²æŸ“æ ‘é‡Œäº†ã€‚</code><br><code>é¿å…åœ¨æ­¤å¤„è§¦å‘ setStateï¼ˆå¯èƒ½å¯¼è‡´æ¸²æŸ“æœªå®Œæˆï¼‰ã€‚</code><br><code>StatefulWidgetçš„ mount çš„å€¼å˜ä¸ºäº†trueï¼ˆè°ƒç”¨dispose()æ‰ä¼šå˜ä¸º falseï¼‰ã€‚</code></p>
<p><strong>3.didChangeDependencies()</strong><br>initState() åç«‹å³è°ƒç”¨ didChangeDependencies()ã€‚<br>å½“ State ä¾èµ–çš„ InheritedWidget å‘ç”Ÿå˜åŒ–æ—¶ï¼ˆå¦‚ä¸»é¢˜ã€æœ¬åœ°åŒ–ï¼‰ä¹Ÿä¼šè°ƒç”¨ didChangeDependencies()ã€‚</p>
<blockquote>
<p>ä¸»è¦ç”¨äºå¤„ç†ä¾èµ–å˜åŒ–åçš„é€»è¾‘ï¼ˆå¦‚é‡æ–°è¯·æ±‚ç½‘ç»œæ•°æ®ï¼‰ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@override</span><br><span class="line">void didChangeDependencies() &#123;</span><br><span class="line">  super.didChangeDependencies();</span><br><span class="line">  if (Provider.of&lt;Data&gt;(context).hasChanged) &#123;</span><br><span class="line">    _updateData();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>4. didUpdateWidget(oldWidget)</strong><br>åœ¨çˆ¶ç»„ä»¶é‡å»ºæ—¶ï¼Œè‹¥æ–°æ—§ Widget çš„ runtimeType å’Œ key ç›¸åŒè§¦å‘ didUpdateWidgetï¼ˆdidUpdateWidget æˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šç”¨åˆ°ï¼‰ã€‚</p>
<blockquote>
<p>ä¸»è¦æ˜¯ï¼š<br>å¯¹æ¯”æ–°æ—§ Widget çš„é…ç½®ï¼ˆå¦‚å±æ€§å˜åŒ–ï¼‰ã€‚<br>æ ¹æ®å˜åŒ–è°ƒæ•´çŠ¶æ€ï¼ˆå¦‚é‡ç½®åŠ¨ç”»ã€æ›´æ–°ç›‘å¬ï¼‰ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@override</span><br><span class="line">void didUpdateWidget(MyWidget oldWidget) &#123;</span><br><span class="line">  super.didUpdateWidget(oldWidget);</span><br><span class="line">  if (oldWidget.color != widget.color) &#123;</span><br><span class="line">    _updateColor(); // é¢œè‰²å˜åŒ–æ—¶æ‰§è¡Œé€»è¾‘</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>5. build()</strong><br>åˆå§‹åŒ–åã€ä¾èµ–å˜åŒ–åã€setState() è°ƒç”¨åè°ƒç”¨ build()ã€‚<br>çˆ¶ç»„ä»¶æˆ–ç¥–å…ˆç»„ä»¶è§¦å‘é‡å»ºæ—¶è°ƒç”¨ build()ã€‚</p>
<blockquote>
<p>ä¸»è¦æ˜¯æ ¹æ®å½“å‰çŠ¶æ€æ„å»º UIï¼ˆä¸è¦åœ¨è¿™é‡Œåšé™¤äº†åˆ›å»º Widget ä¹‹å¤–çš„æ“ä½œï¼‰</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@override</span><br><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line">  return Container(</span><br><span class="line">    color: widget.color,</span><br><span class="line">    child: Text(&#x27;Count: $_count&#x27;),</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<br><code>å¿…é¡»è¿”å›ä¸€ä¸ª Widget</code><br><code>é¿å…åœ¨æ­¤å¤„ä¿®æ”¹çŠ¶æ€æˆ–æ‰§è¡Œè€—æ—¶æ“ä½œ</code></p>
<p><strong>6. deactivate()</strong><br>å½“ State ä»æ ‘ä¸­æš‚æ—¶ç§»é™¤ï¼ˆå¦‚é¡µé¢åˆ‡æ¢ã€ç»„ä»¶è¢«ç§»é™¤ï¼‰è§¦å‘ deactivate()ã€‚</p>
<blockquote>
<p>æ¸…ç†ä¸´æ—¶èµ„æºæˆ–ä¿å­˜ä¸´æ—¶çŠ¶æ€.</p>
</blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<br><code>å¯èƒ½è¢«é‡æ–°æ’å…¥æ ‘ä¸­ï¼ˆå¦‚é¡µé¢è¿”å›æ—¶ï¼‰ï¼Œéœ€ä¸ dispose() åŒºåˆ†</code></p>
<p><strong>7. dispose()</strong><br>State è¢«æ°¸ä¹…ç§»é™¤æ—¶è°ƒç”¨ dispose()ã€‚</p>
<blockquote>
<p>é‡Šæ”¾èµ„æºï¼ˆå¦‚å–æ¶ˆç½‘ç»œè¯·æ±‚ã€é”€æ¯åŠ¨ç”»æ§åˆ¶å™¨ï¼‰</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@override</span><br><span class="line">void dispose() &#123;</span><br><span class="line">  _controller.dispose(); // é”€æ¯åŠ¨ç”»æ§åˆ¶å™¨</span><br><span class="line">  _subscription.cancel(); // å–æ¶ˆäº‹ä»¶è®¢é˜…</span><br><span class="line">  super.dispose();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<br><code>å¦‚æœåœ¨ dispose() ä¸­æœªé‡Šæ”¾èµ„æºï¼ˆå¦‚åŠ¨ç”»æ§åˆ¶å™¨ã€Stream è®¢é˜…ï¼‰å¯èƒ½é€ æˆå†…å­˜æ³„æ¼</code><br><code>å¦‚æœåœ¨ dispose() åè°ƒç”¨ setState ä¼šå¯¼è‡´å¼‚å¸¸</code></p>
<h2 id="4-Widget-çš„æ¸²æŸ“"><a href="#4-Widget-çš„æ¸²æŸ“" class="headerlink" title="4.Widget çš„æ¸²æŸ“"></a>4.Widget çš„æ¸²æŸ“</h2><p><strong>æ¸²æŸ“æµç¨‹ï¼š</strong><br>Flutter çš„æ¸²æŸ“ç³»ç»ŸåŸºäºä¸‰æ£µæ ¸å¿ƒæ ‘ç»“æ„ï¼Œé€šè¿‡é«˜åº¦ä¼˜åŒ–çš„ç®¡çº¿ï¼ˆPipelineï¼‰å®ç°é«˜æ•ˆçš„ UI æ›´æ–°ã€‚</p>
<blockquote>
<p><strong>Widget é‡å»º â†’ Diff æ–°æ—§ Widget æ ‘ â†’ æ›´æ–° Element æ ‘ â†’ æ›´æ–° RenderObject æ ‘ â†’ è§¦å‘ Layer åˆæˆ â†’ å±å¹•åˆ·æ–°</strong></p>
</blockquote>
<p><strong>1.Widget æ ‘çš„æ„å»ºï¼š</strong></p>
<blockquote>
<p>æè¿° UI çš„ä¸å¯å˜é…ç½®ï¼Œç”±å¼€å‘è€…åˆ›å»ºï¼Œé¢‘ç¹é‡å»ºï¼Œéœ€è½»é‡åŒ–ã€‚<br>å¼€å‘è€…ç¼–å†™çš„ Widget ä»£ç è¢«è½¬åŒ–ä¸ºåµŒå¥—çš„ Widget æ ‘ï¼ˆåº”ç”¨çš„å…¥å£æ˜¯æ ¹ Widgetï¼Œä¸€èˆ¬æ˜¯ MaterialApp æˆ– CupertinoAppã€‚æ ¹ Widget ä¼šé€’å½’åœ°æ„å»ºå…¶å­ Widgetï¼Œå½¢æˆä¸€æ£µæ ‘ã€‚ï¼‰ã€‚<br>å…·æœ‰ä¸å¯å˜æ€§ï¼Œæ¯æ¬¡é‡å»ºç”Ÿæˆå…¨æ–°çš„ Widget æ ‘ï¼Œä½†é€šè¿‡ Diff ç®—æ³•å¯ä»¥ä¼˜åŒ–å®é™…æ›´æ–°èŒƒå›´ã€‚</p>
</blockquote>
<p><strong>2. Element æ ‘çš„ Diff ä¸æ›´æ–°</strong></p>
<blockquote>
<p>æ ¹æ® Widget æ ‘ç”Ÿæˆä¸€ä¸ª Element æ ‘ï¼ŒElement æ ‘ä¸­çš„èŠ‚ç‚¹éƒ½ç»§æ‰¿è‡ª Element ç±»ã€‚<br>Element æ˜¯ Widget çš„å®ä¾‹åŒ–å¯¹è±¡ï¼Œè´Ÿè´£ç®¡ç† çŠ¶æ€ï¼ˆStateï¼‰ å’Œ å­èŠ‚ç‚¹å¼•ç”¨ã€‚<br>æ¯ä¸ª Widget éƒ½ä¼šæœ‰ä¸€ä¸ªå¯¹åº”çš„ Element å¯¹è±¡ï¼Œç”¨äºç®¡ç†å…¶ç”Ÿå‘½å‘¨æœŸã€‚</p>
</blockquote>
<blockquote>
<p>Diff ç®—æ³•ï¼šFlutter å¯¹æ¯”æ–°æ—§ Widget æ ‘ï¼Œä»…æ›´æ–°å˜åŒ–çš„ Element å’Œ RenderObjectï¼Œç±»ä¼¼ React çš„è™šæ‹Ÿ DOMã€‚<br>å½“ Widget æ ‘é‡å»ºæ—¶ï¼ŒFlutter é€šè¿‡ Diff ç®—æ³• å¯¹æ¯”æ–°æ—§ Widget æ ‘ï¼Œå†³å®š Element æ ‘çš„æ›´æ–°ç­–ç•¥<br>Reuseï¼šè‹¥æ–°æ—§ Widget çš„ runtimeType å’Œ key ç›¸åŒï¼Œå¤ç”¨ç°æœ‰ Elementã€‚<br>Updateï¼šæ›´æ–° Element çš„é…ç½®ï¼ˆè°ƒç”¨ Element.update(newWidget)ï¼‰ã€‚<br>Replaceï¼šç±»å‹æˆ– Key ä¸åŒæ—¶ï¼Œé”€æ¯æ—§ Elementï¼Œåˆ›å»ºæ–° Elementã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// æ—§ Widget æ ‘</span><br><span class="line">Container(color: Colors.red)</span><br><span class="line"></span><br><span class="line">// æ–° Widget æ ‘</span><br><span class="line">Container(color: Colors.blue)</span><br><span class="line"></span><br><span class="line">// Diff ç»“æœï¼šContainer ç±»å‹ç›¸åŒä¸”æ—  Key â†’ å¤ç”¨ Elementï¼Œæ›´æ–° RenderObject é¢œè‰²</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// Element æ›´æ–°é€»è¾‘</span><br><span class="line">Element.updateChild()</span><br><span class="line"></span><br><span class="line">Element updateChild(Element child, Widget newWidget, dynamic newSlot) &#123;</span><br><span class="line">  if (newWidget == null) &#123;</span><br><span class="line">    // ç§»é™¤å­èŠ‚ç‚¹</span><br><span class="line">    return null;</span><br><span class="line">  &#125;</span><br><span class="line">  if (child != null) &#123;</span><br><span class="line">    if (child.widget == newWidget) &#123;</span><br><span class="line">      // Widget æœªå˜åŒ– â†’ å¤ç”¨ Element</span><br><span class="line">      return child;</span><br><span class="line">    &#125;</span><br><span class="line">    if (Widget.canUpdate(child.widget, newWidget)) &#123;</span><br><span class="line">      // æ›´æ–° Element é…ç½®</span><br><span class="line">      child.update(newWidget);</span><br><span class="line">      return child;</span><br><span class="line">    &#125;</span><br><span class="line">    // é”€æ¯æ—§ Elementï¼Œåˆ›å»ºæ–° Element</span><br><span class="line">    deactivateChild(child);</span><br><span class="line">  &#125;</span><br><span class="line">  return inflateWidget(newWidget, newSlot);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>3. RenderObject æ ‘çš„æ›´æ–°</strong></p>
<p>æ›´æ–° RenderObject æ ‘ï¼Œè®¡ç®—å¸ƒå±€å’Œç”Ÿæˆç»˜åˆ¶æŒ‡ä»¤ã€‚<br>è¿è¡Œåœ¨ UI Threadã€‚</p>
<blockquote>
<p>æ ¹æ® Element æ ‘ç”Ÿæˆ Render æ ‘ï¼ˆæ¸²æŸ“æ ‘ï¼‰ï¼Œæ¸²æŸ“æ ‘ä¸­çš„èŠ‚ç‚¹éƒ½ç»§æ‰¿è‡ª RenderObject ç±»ã€‚<br>æ¯ä¸ª Element å¯¹åº”ä¸€ä¸ª RenderObjectï¼ˆé€šè¿‡ Element.createRenderObject() åˆ›å»ºï¼‰ã€‚</p>
</blockquote>
<blockquote>
<p>æ ¹æ®çˆ¶ RenderObject ä¼ é€’çš„ çº¦æŸï¼ˆConstraintsï¼‰ï¼Œè®¡ç®—è‡ªèº«å°ºå¯¸å’Œä½ç½®ã€‚<br>é€’å½’è°ƒç”¨å­èŠ‚ç‚¹çš„ layout() æ–¹æ³•ï¼ˆæ·±åº¦ä¼˜å…ˆéå†ï¼‰ã€‚</p>
</blockquote>
<p><strong>å¸ƒå±€ï¼ˆLayoutï¼‰æ ¸å¿ƒæ–¹æ³•ï¼š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// RenderObject å¸ƒå±€æµç¨‹</span><br><span class="line">RenderObject.layout()</span><br><span class="line"></span><br><span class="line">void layout(Constraints constraints, &#123; bool parentUsesSize = false &#125;) &#123;</span><br><span class="line">  _constraints = constraints;</span><br><span class="line">  if (_relayoutBoundary != this) &#123;</span><br><span class="line">    markNeedsLayout();</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  performLayout();  // 1. è®¡ç®—è‡ªèº«å°ºå¯¸ï¼ˆè°ƒç”¨ performLayoutï¼‰ ç”±å­ç±»å®ç°å…·ä½“å¸ƒå±€é€»è¾‘</span><br><span class="line">  _needsLayout = false;</span><br><span class="line">  markNeedsPaint(); // æ ‡è®°éœ€è¦é‡ç»˜</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç”Ÿæˆç»˜åˆ¶æŒ‡ä»¤ï¼ˆå¦‚å½¢çŠ¶ã€é¢œè‰²ã€æ–‡æœ¬ï¼‰ï¼Œå†™å…¥ Layerï¼ˆåˆæˆå±‚ï¼‰ã€‚</p>
</blockquote>
<p><strong>ç»˜åˆ¶ï¼ˆPaintï¼‰æ ¸å¿ƒæ–¹æ³•:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void paint(PaintingContext context, Offset offset) &#123;</span><br><span class="line">  // ç»˜åˆ¶é€»è¾‘ï¼Œå¦‚ç”»çŸ©å½¢</span><br><span class="line">  context.canvas.drawRect(rect, paint);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>4. åˆæˆä¸å…‰æ …åŒ–ï¼ˆComposition &amp; Rasterizationï¼‰</strong></p>
<p>ç”Ÿæˆ Layer æ ‘å¹¶å…‰æ …åŒ–ã€‚<br>è¿è¡Œåœ¨ Raster Threadï¼ˆä¸ UI Thread å¹¶è¡Œï¼‰</p>
<blockquote>
<p>æ ¹æ®æ¸²æŸ“æ ‘ç”Ÿæˆ Layer æ ‘ï¼Œç„¶åä¸Šå±æ˜¾ç¤ºï¼ŒLayer æ ‘ä¸­çš„èŠ‚ç‚¹éƒ½ç»§æ‰¿è‡ª Layer ç±»ã€‚<br>RenderObject çš„ç»˜åˆ¶ç»“æœè¢«ç»„ç»‡ä¸º Layer æ ‘ï¼Œæ¯ä¸ª Layer å¯¹åº”ä¸€ä¸ª GPU çº¹ç†ï¼ˆTextureï¼‰ã€‚è‡ªæ­¤ Layer æ ‘ç”Ÿæˆã€‚<br>ç±»å‹åŒ…æ‹¬ï¼šPictureLayerï¼ˆçŸ¢é‡ç»˜åˆ¶ï¼‰ã€TextureLayerï¼ˆå›¾åƒçº¹ç†ï¼‰ã€TransformLayerï¼ˆå˜æ¢æ•ˆæœï¼‰ç­‰ã€‚</p>
</blockquote>
<blockquote>
<p>å°† Layer æ ‘ä¸­çš„ç»˜åˆ¶æŒ‡ä»¤è½¬æ¢ä¸º GPU å¯è¯†åˆ«çš„ä½å›¾æ•°æ®ã€‚<br>é€šè¿‡ Skia å›¾å½¢åº“ï¼ˆæˆ– Impellerï¼‰å®Œæˆï¼Œæœ€ç»ˆæäº¤ç»™ GPU æ¸²æŸ“ã€‚ï¼ˆå®Œæˆå…‰æ …åŒ–ï¼ˆRaster Threadï¼‰ï¼‰ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">void paintChild(RenderObject child, Offset offset) &#123;</span><br><span class="line">  if (child.isRepaintBoundary) &#123;</span><br><span class="line">    // åˆ›å»ºç‹¬ç«‹ Layer</span><br><span class="line">    stopRecordingIfNeeded();</span><br><span class="line">    child._layer = OffsetLayer();</span><br><span class="line">    appendLayer(child._layer);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    child._paintWithContext(this, offset);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>5. GPU æ¸²æŸ“ä¸å±å¹•åˆ·æ–°</strong></p>
<blockquote>
<p><strong>å‚ç›´åŒæ­¥ï¼ˆVSyncï¼‰ï¼š</strong><br>ç”±ç³»ç»Ÿå®šæ—¶è§¦å‘çš„ä¿¡å·ï¼Œæ§åˆ¶å¸§ç‡ï¼ˆå¦‚ 60Hz â†’ 16.6ms&#x2F;å¸§ï¼‰ã€‚<br>Flutter å¼•æ“åœ¨ VSync ä¿¡å·åˆ°æ¥æ—¶ï¼Œæäº¤å…‰æ …åŒ–åçš„å¸§æ•°æ®åˆ° GPUã€‚</p>
</blockquote>
<blockquote>
<p><strong>å±å¹•æ˜¾ç¤ºï¼š</strong><br>GPU å°†å¸§æ•°æ®å†™å…¥å¸§ç¼“å†²åŒºï¼ˆFrame Bufferï¼‰ï¼Œå±å¹•ç¡¬ä»¶æŒ‰åˆ·æ–°ç‡è¯»å–å¹¶æ˜¾ç¤ºã€‚</p>
</blockquote>
<h2 id="5-Widget-ä¼˜åŒ–"><a href="#5-Widget-ä¼˜åŒ–" class="headerlink" title="5.Widget ä¼˜åŒ–"></a>5.Widget ä¼˜åŒ–</h2><p><code>é«˜æ€§èƒ½æ¸²æŸ“ = æœ€å°åŒ– Widget Diff + é«˜æ•ˆå¸ƒå±€/ç»˜åˆ¶ + GPU çº¿ç¨‹ä¼˜åŒ–</code></p>
<blockquote>
<p>Flutter ä¼˜åŒ–çš„æœ¬è´¨æ˜¯ å‡å°‘æ— æ•ˆè®¡ç®— å’Œ é™ä½ GPU è´Ÿè½½<br>ä¸€èˆ¬å›´ç»•å››ä¸ªæ–¹å‘ï¼š 1.æœ€å°åŒ– Widget æ ‘ Diff èŒƒå›´ 2.å‡å°‘å¸ƒå±€ï¼ˆLayoutï¼‰å’Œç»˜åˆ¶ï¼ˆPaintï¼‰è®¡ç®— 3.ä¼˜åŒ– GPU åˆæˆä¸å…‰æ …åŒ–ï¼ˆRasterizationï¼‰ 4.é«˜æ•ˆç®¡ç†çŠ¶æ€ä¸èµ„æº</p>
</blockquote>
<blockquote>
<p><strong>æ€§èƒ½åˆ†æå·¥å…·</strong><br>Flutter DevToolsï¼š<br>Performance é¢æ¿ï¼šåˆ†æ UI&#x2F;Raster çº¿ç¨‹çš„å¸§è€—æ—¶ã€‚<br>Layer æŸ¥çœ‹å™¨ï¼šæ£€æµ‹ Layer åˆæˆæ˜¯å¦åˆç†ã€‚<br>debugProfileBuildsEnabledï¼šè¿½è¸ª Widget æ„å»ºè€—æ—¶<br>è°ƒè¯•æ ‡è®°ï¼š<br>debugPrintMarkNeedsLayoutStacksï¼šæ‰“å°è§¦å‘å¸ƒå±€çš„å †æ ˆä¿¡æ¯ã€‚<br>debugPaintLayerBordersEnabledï¼šå¯è§†åŒ– Layer è¾¹ç•Œã€‚</p>
</blockquote>
<p><strong>1.Widget æ ‘ Diff ä¼˜åŒ–</strong></p>
<blockquote>
<p><strong>Diff ç®—æ³•æœºåˆ¶ï¼š</strong> å½“çˆ¶ç»„ä»¶æ›´æ–°æ—¶ï¼ŒFlutter é€’å½’å¯¹æ¯”æ–°æ—§ Widget æ ‘ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–° Element å’Œ RenderObjectã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">static bool canUpdate(Widget oldWidget, Widget newWidget) &#123;</span><br><span class="line">  return oldWidget.runtimeType == newWidget.runtimeType</span><br><span class="line">      &amp;&amp; oldWidget.key == newWidget.key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>å¤ç”¨æ¡ä»¶ï¼š</strong> runtimeType å’Œ key ç›¸åŒ â†’ å¤ç”¨ Elementï¼Œä»…æ›´æ–°é…ç½®ã€‚<br><strong>æ›¿æ¢æ¡ä»¶ï¼š</strong> ç±»å‹æˆ– Key ä¸åŒ â†’ é”€æ¯æ—§ Elementï¼Œåˆ›å»ºæ–° Elementã€‚</p>
</blockquote>
<p><strong>ä¼˜åŒ–ç­–ç•¥ï¼š</strong><br><strong>1.ä½¿ç”¨ const æ„é€ å‡½æ•°ï¼š</strong> const Widget åœ¨å¤šæ¬¡é‡å»ºä¸­å¼•ç”¨åŒä¸€å†…å­˜åœ°å€ï¼ŒWidget.canUpdate ç›´æ¥è¿”å› trueï¼Œè·³è¿‡ Diff è®¡ç®—ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const MyWidget(text: &#x27;Hello&#x27;); // âœ… ä¼˜åŒ–</span><br><span class="line">MyWidget(text: &#x27;Hello&#x27;);      // âŒ é const</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>2.åˆç†ä½¿ç”¨ Keyï¼š</strong> ValueKeyï¼šåœ¨åˆ—è¡¨é¡¹ä¸­æ ‡è¯†å”¯ä¸€æ€§ï¼Œé¿å…é”™è¯¯å¤ç”¨å¯¼è‡´çŠ¶æ€æ··ä¹±ã€‚<br>GlobalKeyï¼šè·¨ç»„ä»¶è®¿é—®çŠ¶æ€ï¼ˆè°¨æ…ä½¿ç”¨ï¼Œç ´åå±€éƒ¨æ€§ï¼‰ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ListView.builder(</span><br><span class="line">  itemBuilder: (_, index) =&gt; ItemWidget(</span><br><span class="line">    key: ValueKey(items[index].id), // å”¯ä¸€æ ‡è¯†</span><br><span class="line">    data: items[index],</span><br><span class="line">  ),</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>3.æ‹†åˆ†ç»†ç²’åº¦ Widgetï¼š</strong> å°†é¢‘ç¹å˜åŒ–çš„éƒ¨åˆ†æ‹†åˆ†ä¸ºç‹¬ç«‹ Widgetï¼Œç¼©å° setState è§¦å‘çš„ Diff èŒƒå›´ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// çˆ¶ç»„ä»¶ï¼ˆä»…ä¼ é€’é™æ€æ•°æ®ï¼‰</span><br><span class="line">class ParentWidget extends StatelessWidget &#123;</span><br><span class="line">  const ParentWidget(&#123;super.key&#125;);</span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    return Column(</span><br><span class="line">      children: [</span><br><span class="line">        const StaticHeader(), // é™æ€éƒ¨åˆ†</span><br><span class="line">        DynamicContent(data: _data), // åŠ¨æ€éƒ¨åˆ†</span><br><span class="line">      ],</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>2.å¸ƒå±€ï¼ˆLayoutï¼‰é˜¶æ®µä¼˜åŒ–</strong></p>
<blockquote>
<p><strong>å¸ƒå±€è®¡ç®—æœºåˆ¶ï¼š</strong> å½“æŸä¸ª RenderObject çš„å°ºå¯¸å˜åŒ–ä¸å½±å“çˆ¶èŠ‚ç‚¹å¸ƒå±€æ—¶ï¼Œå¯æ ‡è®°ä¸ºå¸ƒå±€è¾¹ç•Œï¼Œé˜»æ–­å¸ƒå±€è®¡ç®—å‘ä¸Šä¼ æ’­ã€‚é€šè¿‡ RenderObject.isRepaintBoundary &#x3D; true è®¾ç½®ï¼ˆå¸ƒå±€è¾¹ç•Œï¼ˆRelayout Boundaryï¼‰ï¼‰</p>
</blockquote>
<blockquote>
<p>çˆ¶èŠ‚ç‚¹ä¼ é€’ çº¦æŸï¼ˆConstraintsï¼‰ ç»™å­èŠ‚ç‚¹<br>å­èŠ‚ç‚¹æ ¹æ®çº¦æŸè®¡ç®—è‡ªèº«å°ºå¯¸ï¼Œå¹¶é€’å½’å¸ƒå±€å­èŠ‚ç‚¹(å¸ƒå±€è¿‡ç¨‹)</p>
</blockquote>
<p><strong>ä¼˜åŒ–ç­–ç•¥</strong></p>
<blockquote>
<p><strong>1.é¿å…è¿‡åº¦åµŒå¥—ï¼š</strong> å¤šå±‚ Row&#x2F;Column ä¼šå¯¼è‡´å¸ƒå±€è®¡ç®—å¤æ‚åº¦å‘ˆæŒ‡æ•°å¢é•¿ã€‚<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Flexã€Wrap æˆ–è‡ªå®šä¹‰å¸ƒå±€é€»è¾‘æ›¿ä»£åµŒå¥—ã€‚</p>
</blockquote>
<blockquote>
<p><strong>2.é¢„è®¡ç®—å°ºå¯¸ï¼š</strong> é€šè¿‡å›ºå®šå°ºå¯¸ï¼ˆSizedBoxï¼‰æˆ– LayoutBuilder æå‰ç¡®å®šå¸ƒå±€çº¦æŸï¼Œå‡å°‘è®¡ç®—é‡ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SizedBox(</span><br><span class="line">  width: 100,</span><br><span class="line">  height: 50,</span><br><span class="line">  child: Text(&#x27;Fixed Size&#x27;),</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>3.ä½¿ç”¨ IntrinsicWidth&#x2F;IntrinsicHeight çš„æ›¿ä»£æ–¹æ¡ˆï¼š</strong> IntrinsicWidth ä¼šè§¦å‘å¤šæ¬¡å­èŠ‚ç‚¹å¸ƒå±€è®¡ç®—ï¼Œæ€§èƒ½ä½ä¸‹ã€‚<br>æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨è®¡ç®—å­èŠ‚ç‚¹æœ€å¤§å®½åº¦ï¼Œä½¿ç”¨ ConstrainedBox é™åˆ¶å°ºå¯¸ã€‚</p>
</blockquote>
<p><strong>3.ç»˜åˆ¶ï¼ˆPaintï¼‰é˜¶æ®µä¼˜åŒ–</strong></p>
<blockquote>
<p><strong>ç»˜åˆ¶æœºåˆ¶ï¼š</strong> å½“ RenderObject çš„è§†è§‰å±æ€§ï¼ˆå¦‚é¢œè‰²ã€ä½ç½®ï¼‰å˜åŒ–æ—¶ï¼Œè°ƒç”¨ markNeedsPaint() æ ‡è®°éœ€è¦é‡ç»˜ã€‚</p>
</blockquote>
<blockquote>
<p><strong>åˆæˆå±‚ï¼ˆLayerï¼‰ï¼š</strong> æ¯ä¸ª RenderObject çš„ç»˜åˆ¶ç»“æœè¢«ç»„ç»‡ä¸º Layer æ ‘ï¼Œæœ€ç»ˆç”± GPU å…‰æ …åŒ–ã€‚ï¼ˆPictureLayerï¼ˆçŸ¢é‡ç»˜åˆ¶ï¼‰ã€TextureLayerï¼ˆå›¾åƒï¼‰ã€TransformLayerï¼ˆå˜æ¢ï¼‰ï¼‰ã€‚</p>
</blockquote>
<p><strong>ä¼˜åŒ–ç­–ç•¥</strong></p>
<blockquote>
<p><strong>1.ä½¿ç”¨ RepaintBoundaryï¼š</strong> å°†ç‹¬ç«‹å˜åŒ–çš„ UI éƒ¨åˆ†åŒ…è£¹ RepaintBoundaryï¼Œç”Ÿæˆç‹¬ç«‹ Layerï¼Œå‡å°‘é‡ç»˜åŒºåŸŸã€‚<br>é€šè¿‡ RenderObject.isRepaintBoundary &#x3D; true æ ‡è®°ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">RepaintBoundary(</span><br><span class="line">  child: MyAnimatedWidget(), // ç‹¬ç«‹é‡ç»˜åŒºåŸŸ</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>2.é¿å…é«˜å¼€é”€ç»˜åˆ¶æ“ä½œï¼š</strong> ä½¿ç”¨ AnimatedOpacity æˆ–ç›´æ¥è®¾ç½®é¢œè‰²é€æ˜åº¦ï¼ˆColor.withOpacityï¼‰æ›¿ä»£ Opacity ã€‚<br>ä¼˜å…ˆä½¿ç”¨ ClipRect æˆ– ClipRRectï¼Œå‡å°‘è·¯å¾„è£å‰ªçš„è®¡ç®—é‡ã€‚</p>
</blockquote>
<blockquote>
<p><strong>3.è‡ªå®šä¹‰ç»˜åˆ¶ä¼˜åŒ–ï¼š</strong> åœ¨ CustomPainter ä¸­ç²¾ç¡®æ§åˆ¶é‡ç»˜æ¡ä»¶ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class MyPainter extends CustomPainter &#123;</span><br><span class="line">  @override</span><br><span class="line">  bool shouldRepaint(MyPainter old) &#123;</span><br><span class="line">    return old.color != color; // ä»…é¢œè‰²å˜åŒ–æ—¶é‡ç»˜</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>4.GPU åˆæˆä¸å…‰æ …åŒ–ä¼˜åŒ–</strong></p>
<blockquote>
<p><strong>1.å…‰æ …åŒ–æœºåˆ¶ï¼š</strong> é€šè¿‡ä¸Šé¢çš„åˆæˆä¸å…‰æ …åŒ–å¯çŸ¥é“ï¼šå…‰æ …åŒ–è¿è¡Œåœ¨ç‹¬ç«‹çš„ Raster Threadï¼Œä¸ UI Thread å¹¶è¡Œã€‚<br>Flutter è‡ªåŠ¨å¤ç”¨æœªå˜åŒ–çš„ Layer å¯¹åº”çš„ GPU çº¹ç†ï¼Œå‡å°‘æ•°æ®ä¼ è¾“ã€‚ï¼ˆçº¹ç†ï¼ˆTextureï¼‰å¤ç”¨ï¼‰</p>
</blockquote>
<p><strong>ä¼˜åŒ–ç­–ç•¥</strong></p>
<blockquote>
<p><strong>1.å‡å°‘ Layer æ•°é‡ï¼š</strong> è¿‡å¤šçš„ Layer ä¼šå¢åŠ  GPU åˆæˆå¼€é”€ï¼Œæˆ‘ä»¬éœ€è¦å°½å¯èƒ½çš„åˆå¹¶ç›¸é‚»çš„ PictureLayerï¼Œé¿å…ä¸å¿…è¦çš„ Opacity æˆ– Transform åµŒå¥—ã€‚</p>
</blockquote>
<blockquote>
<p><strong>2.ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿæ“ä½œï¼š</strong> åˆ©ç”¨ GPU çš„çŸ©é˜µå˜æ¢ç¡¬ä»¶åŠ é€Ÿï¼ˆTransform æ›¿ä»£æ‰‹åŠ¨çŸ©é˜µè®¡ç®—ï¼‰ã€‚<br>å¯¹é‡å¤ä½¿ç”¨çš„å›¾ç‰‡æå‰è§£ç ï¼ˆprecacheImageï¼‰ ï¼ˆImage é¢„åŠ è½½ï¼‰ã€‚</p>
</blockquote>
<blockquote>
<p><strong>3.å¯ç”¨ Impeller å¼•æ“ï¼š</strong> Flutter 3.0+ å¼•å…¥çš„ Impeller å¼•æ“é’ˆå¯¹ GPU è´Ÿè½½ä¼˜åŒ–ï¼Œå‡å°‘å…‰æ …åŒ–æŠ–åŠ¨ã€‚</p>
</blockquote>
<p><strong>5.çŠ¶æ€ç®¡ç†ä¸èµ„æºä¼˜åŒ–</strong></p>
<blockquote>
<p><strong>1.çŠ¶æ€ç®¡ç†ï¼š</strong><br>å±€éƒ¨çŠ¶æ€ï¼šä½¿ç”¨ StatefulWidget ç®¡ç†ï¼Œç¡®ä¿ dispose() é‡Šæ”¾èµ„æºã€‚<br>å…¨å±€çŠ¶æ€ï¼šé‡‡ç”¨ Providerã€Riverpod æˆ– Blocï¼Œé¿å…çŠ¶æ€ç©¿é€å’Œå†—ä½™é‡å»ºã€‚</p>
</blockquote>
<blockquote>
<p><strong>2.èµ„æºé‡Šæ”¾ï¼š</strong><br>å¿…é¡»é‡Šæ”¾åŠ¨ç”»æ§åˆ¶å™¨ï¼ˆAnimationController.dispose()ï¼‰ã€Stream è®¢é˜…ï¼ˆSubscription.cancel()ï¼‰ç­‰èµ„æºã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@override</span><br><span class="line">void dispose() &#123;</span><br><span class="line">  _controller.dispose();</span><br><span class="line">  _streamSubscription.cancel();</span><br><span class="line">  super.dispose();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://i-blog.csdnimg.cn/img_convert/58ae194fbfc28292a73f2130d949f78a.webp?x-oss-process=image/format,png" alt="2025-05-23 14.45.52.png"></p>
]]></content>
      <categories>
        <category>Flutter</category>
      </categories>
      <tags>
        <tag>â€œFlutterâ€</tag>
        <tag>â€œWidgetâ€</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸webå‰ç«¯æœ‹å‹é—²èŠçš„å‘ç°-ä»£ç ç›¸é€šæ€§</title>
    <url>/2016/07/15/%E4%B8%8Eweb%E5%89%8D%E7%AB%AF%E6%9C%8B%E5%8F%8B%E9%97%B2%E8%81%8A%E7%9A%84%E5%8F%91%E7%8E%B0-%E4%BB%A3%E7%A0%81%E7%9B%B8%E9%80%9A%E6%80%A7/</url>
    <content><![CDATA[<h3 id="ç¼˜èµ·"><a href="#ç¼˜èµ·" class="headerlink" title="ç¼˜èµ·"></a>ç¼˜èµ·</h3><blockquote>
<p>  ä»Šå¤©ä¸ä¸€ä¸ªåšwebå‰ç«¯çš„å“¥ä»¬é—²èŠäº†ä¸€ä¼šï¼Œä»–ä»Šå¤©é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼šå°±æ˜¯åœ¨åšä¸€ä¸ªæ··åˆå¼€å‘çš„APPæ—¶å€™ï¼Œä»–ä»¬H5ç«¯æœ‰ä¸€ä¸ªé¡µé¢éœ€è¦åšæœç´¢ï¼Œå°±æ˜¯åœ¨æœç´¢æ¡†å†…è¾“å…¥èƒ½å¤Ÿå®æ—¶çš„å±•ç¤ºæœç´¢ç»“æœã€‚</p>
</blockquote>
<h3 id="æƒ³æ³•ä¸é—®é¢˜"><a href="#æƒ³æ³•ä¸é—®é¢˜" class="headerlink" title="æƒ³æ³•ä¸é—®é¢˜"></a>æƒ³æ³•ä¸é—®é¢˜</h3><blockquote>
<p>ä»–æƒ³ç›‘å¬äº†æœç´¢æ¡†å¹¶ä¸”å®æ—¶çš„è¿›è¡Œæ•°æ®çš„è¯·æ±‚ã€‚åæ¥å‘ç°è¾“å…¥çš„è¿‡ç¨‹ä¸€ç›´åœ¨è¿›è¡Œè¿œç¨‹æ•°æ®çš„è¯·æ±‚ï¼Œä»–è§‰å¾—è¿™æ ·æ¶ˆè€—å¤ªå¤§äº†ã€‚äºæ˜¯æƒ³åšä¸€ä¸ªå»¶æ—¶çš„æ“ä½œï¼Œå°±æ˜¯ç­‰ç”¨æˆ·ç¨å¾®åœæ­¢è¾“å…¥çš„æ—¶å€™æ‰å»è¿œç¨‹è¯·æ±‚æ•°æ®ã€‚å¯æ˜¯æ²¡æœ‰ç†æ¸…è¿™ä¸ªé€»è¾‘ï¼Œäºæ˜¯ä»–çš„æ–¹æ³•ç›¸å½“çš„å¤æ‚ï¼Œå¥½åƒæ˜¯è¦å°†æ¯ä¸€å®æ—¶è¾“å…¥çš„æ•°æ®å­˜å…¥æ•°ç»„ï¼Œç„¶åè¿›è¡Œå¯¹æ¯”ï¼Œå½“å»¶æ—¶å®Œæˆè¿›è¡Œå¯¹æ¯”å†³å®šè¯·æ±‚çš„æ•°æ®ã€‚</p>
</blockquote>
<h3 id="æ’æ›²"><a href="#æ’æ›²" class="headerlink" title="æ’æ›²"></a>æ’æ›²</h3><blockquote>
<p>ä½†æ˜¯ä»–åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å»¶æ—¶æ“ä½œå¹¶æ²¡æœ‰å‡å°‘ç½‘ç»œè¯·æ±‚çš„æ¬¡æ•°ã€‚è¿™ä¸ªé—®é¢˜åœ¨å‰æ®µæ—¶é—´çš„é¡¹ç›®ä¸­æˆ‘ä¹Ÿé‡åˆ°äº†ï¼Œå°±æ˜¯å»¶æ—¶æ“ä½œå¹¶ä¸æ˜¯é‡å¤äº†ï¼Œå°±ä¸æ‰§è¡Œäº†ï¼Œå»¶æ—¶æ“ä½œåªæ˜¯å»¶ç¼“æ“ä½œæ—¶é—´ï¼Œæ¯ä¸€æ¬¡çš„å»¶æ—¶éƒ½ä¼šè¢«æ‰§è¡Œã€‚æ‰€ä»¥æƒ³è¦å‡å°‘æ‰§è¡Œæ¬¡å°±å¿…é¡»åœ¨å»¶æ—¶æ“ä½œæœªæ‰§è¡Œ å‰å–æ¶ˆå»¶æ—¶æ“ä½œã€‚å–æ¶ˆçš„å»¶æ—¶æ“ä½œå¦‚æœè¿˜æ²¡æœ‰æ‰§è¡Œï¼Œå°±ä¸ä¼šæ‰§è¡Œäº†è€Œä¸æ˜¯å–æ¶ˆåå°±ç«‹å³æ‰§è¡Œã€‚</p>
</blockquote>
<h3 id="è®¨è®º"><a href="#è®¨è®º" class="headerlink" title="è®¨è®º"></a>è®¨è®º</h3><blockquote>
<p>è¿™æ—¶å€™æˆ‘æƒ³èµ·å‡ å¤©å‰åœ¨ç®€ä¹¦ä¸Šçœ‹è§ä¸€ä¸ªå“¥ä»¬å†™äº†ä¸€ç¯‡<a href="http://www.jianshu.com/p/7bca987976bd">å…³äºå¦‚ä½•é˜²æ­¢buttonè¢«é‡å¤ç‚¹å‡»</a>çš„æ–‡ç« ï¼Œä»–ä¸€å…±ä»‹ç»äº†ä¸‰ç§æ–¹æ³•ï¼Œä»–çš„ç¬¬äºŒç§æ–¹æ³•ï¼š</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[button addTarget:self action:@selector(click:) forControlEvents:UIControlEventTouchUpInside]</span><br><span class="line">- (void)click:(UIButton *)sender</span><br><span class="line"> &#123; </span><br><span class="line">      [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(btnClicke) object:nil]; </span><br><span class="line">      [self performSelector:@selector(btnClicke) withObject:nil afterDelay:1];</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<blockquote>
<p>å°±æ˜¯ç”¨çš„å»¶æ—¶æ“ä½œä»–çš„æ˜¯åœ¨buttonçš„æ–¹æ³•é‡Œé¢å…ˆå–æ¶ˆå»¶æ—¶æ–¹æ³•ï¼Œå†æ·»åŠ å»¶æ—¶æ–¹æ³•ï¼Œè¿™ä¸ªå¯¹äºé˜²æ­¢buttoné‡å¤ç‚¹å‡»æ¥è¯´å¹¶ä¸æ˜¯å¥½çš„æ–¹æ³•ï¼Œå› ä¸ºè¿™æ ·ä¼šå½±å“ç”¨æˆ·çš„ä½“éªŒï¼Œæ¯æ¬¡ç‚¹å‡»buttonä¸èƒ½åŠæ—¶çš„è¿›è¡Œå“åº”ã€‚ä½†æ˜¯å¯¹äºæˆ‘æœ‹å‹çš„è¿™ä¸ªé—®é¢˜å´æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚ä»–åŸæœ¬å°±æƒ³å‡ç¼“è¯·æ±‚æ¬¡æ•°ã€‚</p>
</blockquote>
<h3 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h3><blockquote>
<p>æˆ‘å‘ç°ç¼–ç¨‹è¯­è¨€æ˜¯ç›¸é€šçš„ï¼Œè™½ç„¶å„æœ‰å„çš„è¯­æ³•ï¼Œä½†æ˜¯å®ç°æ€è·¯æ˜¯ä¸€æ ·çš„ï¼Œç‰¹æ­¤è®°å½•ã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>â€œiOSâ€</tag>
        <tag>â€œwebâ€</tag>
        <tag>â€œä»£ç ç›¸é€šæ€§â€</tag>
      </tags>
  </entry>
  <entry>
    <title>å›¾ç‰‡ä¸Šä¼ é¢„è§ˆ</title>
    <url>/2016/08/01/%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0%E9%A2%84%E8%A7%88/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬å‘¨å¸®ä¸€å“¥ä»¬å†™äº†ä¸€ä¸ªé¡µé¢é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œç‰¹æ­¤è®°å½•ä¸€ä¸‹ã€‚ä¸»è¦é‡åˆ°çš„é—®é¢˜æ˜¯å›¾ç‰‡ä¸Šä¼ é¢„è§ˆï¼ˆå¤šä¸ªä¸Šä¼ æ§ä»¶ï¼‰ã€å¤šä¸ªé¢œè‰²é€‰æ‹©ï¼Œé‡åˆ°äº†å†²çªã€‚</p>
</blockquote>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/236f8ed15fd552d48cf2c3287edd9c53.webp?x-image-process=image/format,png" alt="æ¥ä¸ªæ•ˆæœä¸€æ’‡ 2016-08-01 00.13.22.png"></p>
<p><strong>è¿™æ˜¯ä»£ç ä¸Šä¼ çš„HTMLéƒ¨åˆ†ä»£ç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div id=&quot;home11&quot; class=&quot;tab-pane in active lowerContent &quot;&gt;</span><br><span class="line">                  &lt;div class=&quot;tool floatLeft&quot;&gt;</span><br><span class="line">                    &lt;span class=&quot;spanStylef floatLeft&quot;&gt;åç§°&lt;/span&gt;</span><br><span class="line">                    &lt;input type=&quot;text&quot; name=&quot;appName&quot;&gt;</span><br><span class="line">                  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">                  &lt;div class=&quot;upImage floatLeft&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;tool floatLeft&quot;&gt;</span><br><span class="line">                      &lt;span class=&quot;spanStylef floatLeft&quot;&gt;é»˜è®¤å›¾æ ‡&lt;/span&gt;</span><br><span class="line">                      &lt;a href=&quot;javascript:;&quot; class=&quot;file&quot; onchange=&quot;javascript:setImagePreview(2);&quot;&gt;ä¸Šä¼ å›¾ç‰‡</span><br><span class="line">                        &lt;input type=&quot;file&quot; name=&quot;imagereview2&quot; class =&quot;inputImages&quot;&gt;</span><br><span class="line">                      &lt;/a&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">                    &lt;div class=&quot;tool floatLeft&quot;&gt;</span><br><span class="line">                      &lt;span class=&quot;spanStylef floatLeft&quot;&gt;&amp;nbsp&lt;/span&gt;</span><br><span class="line">                      &lt;img class=&quot;imagereview2&quot; width=&quot;100&quot; height=&quot;100&quot; /&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">                  &lt;div class=&quot;upImage floatLeft&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;tool floatLeft&quot;&gt;</span><br><span class="line">                      &lt;span class=&quot;spanStylef floatLeft&quot;&gt;è§¦åŠå›¾æ ‡&lt;/span&gt;</span><br><span class="line">                      &lt;a href=&quot;javascript:;&quot; class=&quot;file&quot; onchange=&quot;javascript:setImagePreview(3);&quot;&gt;ä¸Šä¼ å›¾ç‰‡</span><br><span class="line">                        &lt;input type=&quot;file&quot; name=&quot;imagereview3&quot; class =&quot;inputImages&quot;&gt;</span><br><span class="line">                      &lt;/a&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">                    &lt;div class=&quot;tool floatLeft&quot;&gt;</span><br><span class="line">                      &lt;span class=&quot;spanStylef floatLeft&quot;&gt;&amp;nbsp&lt;/span&gt;</span><br><span class="line">                      &lt;img class=&quot;imagereview3&quot; width=&quot;100&quot; height=&quot;100&quot; /&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                  &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p><strong>ä¿®æ”¹ä¸Šä¼ æŒ‰é’®çš„éƒ¨åˆ†cssä»£ç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.file &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    background: #D0EEFF;</span><br><span class="line">    border: 1px solid #99D3F5;</span><br><span class="line">    border-radius: 4px;</span><br><span class="line">    padding: 4px 12px;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    color: #1E88C7;</span><br><span class="line">    text-decoration: none;</span><br><span class="line">    text-indent: 0;</span><br><span class="line">    line-height: 20px;</span><br><span class="line">&#125;</span><br><span class="line">.file input &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    font-size: 100px;</span><br><span class="line">    right: 0;</span><br><span class="line">    top: 0;</span><br><span class="line">    opacity: 0;</span><br><span class="line">&#125;</span><br><span class="line">.file:hover &#123;</span><br><span class="line">    text-decoration: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>è¿™æ˜¯JSéƒ¨åˆ†çš„ä»£ç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function setImagePreview(avalue) &#123;</span><br><span class="line">               //input</span><br><span class="line">               var docObjs = document.getElementsByClassName(&quot;inputImages&quot;);</span><br><span class="line">               var docObj = docObjs[avalue];</span><br><span class="line">               if (docObj.files &amp;&amp; docObj.files[0]) &#123;</span><br><span class="line">                   var imgObjPreviews = document.getElementsByClassName(docObj.name);</span><br><span class="line">                   var imgObjPreview = imgObjPreviews[0];</span><br><span class="line">               if (avalue == 0) &#123;</span><br><span class="line">                   imgObjPreview.style.display = &#x27;block&#x27;;</span><br><span class="line">                   imgObjPreview.style.width = &#x27;200px&#x27;;</span><br><span class="line">                   imgObjPreview.style.height = &#x27;350px&#x27;;</span><br><span class="line">               &#125;else &#123;</span><br><span class="line">                   //ç«ç‹ä¸‹ï¼Œç›´æ¥è®¾imgå±æ€§</span><br><span class="line">                   imgObjPreview.style.display = &#x27;block&#x27;;</span><br><span class="line">                   imgObjPreview.style.width = &#x27;100px&#x27;;</span><br><span class="line">                   imgObjPreview.style.height = &#x27;100px&#x27;;</span><br><span class="line">               &#125;</span><br><span class="line">                  imgObjPreview.src = window.URL.createObjectURL(docObj.files[0]);</span><br><span class="line">               &#125; else &#123;</span><br><span class="line">                   //IEä¸‹ï¼Œä½¿ç”¨æ»¤é•œ</span><br><span class="line">                   // docObj.select();</span><br><span class="line">                   // var imgSrc = document.selection.createRange().text;</span><br><span class="line">                   // var localImagId = document.getElementById(&quot;localImag&quot;);</span><br><span class="line">                   // //å¿…é¡»è®¾ç½®åˆå§‹å¤§å°</span><br><span class="line">                   // localImagId.style.width = &quot;100px&quot;;</span><br><span class="line">                   // localImagId.style.height = &quot;100px&quot;;</span><br><span class="line">                   // //å›¾ç‰‡å¼‚å¸¸çš„æ•æ‰ï¼Œé˜²æ­¢ç”¨æˆ·ä¿®æ”¹åç¼€æ¥ä¼ªé€ å›¾ç‰‡</span><br><span class="line">                   // try &#123;</span><br><span class="line">                   //     localImagId.style.filter = &quot;progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)&quot;;</span><br><span class="line">                   //     localImagId.filters.item(&quot;DXImageTransform.Microsoft.AlphaImageLoader&quot;).src = imgSrc;</span><br><span class="line">                   // &#125; catch(e) &#123;</span><br><span class="line">                   //     alert(&quot;æ‚¨ä¸Šä¼ çš„å›¾ç‰‡æ ¼å¼ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°é€‰æ‹©!&quot;);</span><br><span class="line">                   //     return false;</span><br><span class="line">                   // &#125;</span><br><span class="line">                   // imgObjPreview.style.display = &#x27;none&#x27;;</span><br><span class="line">                   // document.selection.empty();</span><br><span class="line">               &#125;</span><br><span class="line">               return true;</span><br><span class="line">           &#125;</span><br><span class="line">           </span><br></pre></td></tr></table></figure>

<h2 id="é—®é¢˜ä¸è§£å†³ï¼š"><a href="#é—®é¢˜ä¸è§£å†³ï¼š" class="headerlink" title="é—®é¢˜ä¸è§£å†³ï¼š"></a>é—®é¢˜ä¸è§£å†³ï¼š</h2><h3 id="é—®é¢˜ä¸€ï¼šæ˜¯ä¸Šä¼ æŒ‰é’®é»˜è®¤çš„æ–‡ä»¶ä¸Šä¼ æ˜¯è¿™æ ·çš„"><a href="#é—®é¢˜ä¸€ï¼šæ˜¯ä¸Šä¼ æŒ‰é’®é»˜è®¤çš„æ–‡ä»¶ä¸Šä¼ æ˜¯è¿™æ ·çš„" class="headerlink" title="é—®é¢˜ä¸€ï¼šæ˜¯ä¸Šä¼ æŒ‰é’®é»˜è®¤çš„æ–‡ä»¶ä¸Šä¼ æ˜¯è¿™æ ·çš„"></a>é—®é¢˜ä¸€ï¼šæ˜¯ä¸Šä¼ æŒ‰é’®é»˜è®¤çš„æ–‡ä»¶ä¸Šä¼ æ˜¯è¿™æ ·çš„</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/247191efee00edfe40ac992ff86a4b93.webp?x-image-process=image/format,png" alt="é»˜è®¤ 2016-08-01 00.26.51.png"></p>
<h3 id="ä½†æ˜¯æˆ‘éœ€è¦çš„æ˜¯è¿™æ ·çš„ï¼š"><a href="#ä½†æ˜¯æˆ‘éœ€è¦çš„æ˜¯è¿™æ ·çš„ï¼š" class="headerlink" title="ä½†æ˜¯æˆ‘éœ€è¦çš„æ˜¯è¿™æ ·çš„ï¼š"></a>ä½†æ˜¯æˆ‘éœ€è¦çš„æ˜¯è¿™æ ·çš„ï¼š</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/b519bb3cae0f98c75720b46596facebb.webp?x-image-process=image/format,png" alt="ç›®æ ‡ 2016-08-01 00.28.07.png"></p>
<blockquote>
<p>è§£å†³æ–¹æ¡ˆï¼šå°±æ˜¯å°†fileAPIæ”¾åœ¨ä½ éœ€è¦çš„æ§ä»¶ä¸Šé¢ï¼Œç„¶åå°†fileAPIè®¾ç½®ä¸ºé€æ˜ï¼Œç„¶åç‚¹å‡»ä½ éœ€è¦çš„æ§ä»¶å…¶å®å°±æ˜¯ç‚¹å‡»äº†fileAPIã€‚è¿˜æœ‰ä¸€ä¸ªæ–¹æ¡ˆå°±æ˜¯ç”¨js:å°†ä½ çš„æ§ä»¶çš„ç‚¹å‡»äº‹ä»¶é‡Œé¢çš„è¿”å›ä¸ºfileAPIçš„äº‹ä»¶ã€‚è¿™æ ·ç‚¹å‡»ä½ çš„æ§ä»¶å°±å®Œæˆäº†fileAPIäº‹ä»¶äº†ï¼Œï¼ˆæˆ‘æƒ³çš„ï¼Œæ²¡æœ‰å»å®ç°å–”ï¼‰</p>
</blockquote>
<h3 id="é—®é¢˜äºŒï¼šç‚¹å‡»äº‹ä»¶å†²çª"><a href="#é—®é¢˜äºŒï¼šç‚¹å‡»äº‹ä»¶å†²çª" class="headerlink" title="é—®é¢˜äºŒï¼šç‚¹å‡»äº‹ä»¶å†²çª"></a>é—®é¢˜äºŒï¼šç‚¹å‡»äº‹ä»¶å†²çª</h3><blockquote>
<p>ä¸€å¼€å§‹æˆ‘æ˜¯é€šè¿‡idé€‰æ‹©å™¨æ¥æ ‡è®°imageä¸inputçš„,åæ¥å‘ç°å¤šä¸ªä¸Šä¼ æŒ‰é’®å°±éœ€è¦å¤šä¸ªjsåˆ¤å®šï¼Œä¼šæœ‰å¾ˆå¤šçš„é‡å¤ä»£ç ã€‚äºæ˜¯åæ¥æˆ‘æ”¹ä¸ºäº†ç”¨ç±»é€‰æ‹©å™¨ä½†æ˜¯ç±»åä¸€æ ·æ— æ³•å°†imageä¸inputå¯¹åº”ã€‚äºæ˜¯æˆ‘å°†inputçš„nameä¸ä¸imageçš„ç±»åå†™æˆä¸€æ ·ï¼Œé€šè¿‡inputçš„nameæ‰¾åˆ°å¯¹åº”çš„imageã€‚</p>
</blockquote>
<h5 id="NOTEï¼šæˆ‘å‰ç«¯å¼€å‘å¾ˆä¹…æ²¡æœ‰å¼„äº†ï¼Œå¾ˆå¤šå¿˜è®°äº†ï¼Œå¦‚æœ‰é”™è¯¯ã€‚è¯·äº²ä»¬ä¸€å®šè¦æŒ‡å‡ºå•Šï¼"><a href="#NOTEï¼šæˆ‘å‰ç«¯å¼€å‘å¾ˆä¹…æ²¡æœ‰å¼„äº†ï¼Œå¾ˆå¤šå¿˜è®°äº†ï¼Œå¦‚æœ‰é”™è¯¯ã€‚è¯·äº²ä»¬ä¸€å®šè¦æŒ‡å‡ºå•Šï¼" class="headerlink" title="NOTEï¼šæˆ‘å‰ç«¯å¼€å‘å¾ˆä¹…æ²¡æœ‰å¼„äº†ï¼Œå¾ˆå¤šå¿˜è®°äº†ï¼Œå¦‚æœ‰é”™è¯¯ã€‚è¯·äº²ä»¬ä¸€å®šè¦æŒ‡å‡ºå•Šï¼"></a>NOTEï¼šæˆ‘å‰ç«¯å¼€å‘å¾ˆä¹…æ²¡æœ‰å¼„äº†ï¼Œå¾ˆå¤šå¿˜è®°äº†ï¼Œå¦‚æœ‰é”™è¯¯ã€‚è¯·äº²ä»¬ä¸€å®šè¦æŒ‡å‡ºå•Šï¼</h5>]]></content>
      <categories>
        <category>web</category>
      </categories>
      <tags>
        <tag>â€œwebâ€</tag>
        <tag>â€œå›¾ç‰‡ä¸Šä¼ â€</tag>
        <tag>â€œé¢„è§ˆâ€</tag>
      </tags>
  </entry>
  <entry>
    <title>å¾®ä¿¡å°ç¨‹åºtips</title>
    <url>/2017/02/22/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8Ftips/</url>
    <content><![CDATA[<blockquote>
<p>æœ€è¿‘å…¬å¸é¡¹ç›®æ”¹ç‰ˆï¼Œè¶äº§å“ä¿®æ”¹ä¸UIå‡ºå›¾çš„é—´æ­‡ç”¨å…¬å¸å•†æˆ·ç«¯UIå›¾æ’¸äº†ä¸€æŠŠå¾®ä¿¡å°ç¨‹åºã€‚å› ä¸ºåˆšåˆšå®ä¹ é‚£ä¸€ä¼šæ¥è§¦è¿‡å‰ç«¯å¼€å‘ï¼Œæ‰€ä»¥ä¸Šæ‰‹è¿˜æ¯”è¾ƒå¿«ï¼Œå½“ç„¶ä¹Ÿé‡åˆ°äº†å¾ˆå¤šçš„é—®é¢˜ï¼Œä¸è¿‡å¥½åœ¨åŸºæœ¬æŒ‰å›¾å®Œæˆã€‚è¶æ­¤æ€»ç»“ä¸€ä¸‹æˆ‘é‡åˆ°çš„é—®é¢˜,å¥‰ä¸Šä¸€äº›å¯è¡Œçš„è§£å†³æ–¹æ¡ˆï¼Œå¸Œæœ›å¯ä»¥å¸®åŠ©ä¸æˆ‘é‡åˆ°ç›¸åŒé—®é¢˜çš„æœ‹å‹ã€‚<a href="https://github.com/GavinCarter1991/wx-onePro">demo</a> </p>
</blockquote>
<h3 id="å…ˆä¸Šå›¾"><a href="#å…ˆä¸Šå›¾" class="headerlink" title="å…ˆä¸Šå›¾"></a>å…ˆä¸Šå›¾</h3><p><img src="https://i-blog.csdnimg.cn/blog_migrate/b6d605c3b3e52fc14fcf8b758b6c4b33.webp?x-image-process=image/format,png" alt="å¾®ä¿¡å°ç¨‹åº"></p>
<h3 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h3><p><strong>èƒŒæ™¯å›¾ç‰‡ä¸èƒ½ä½¿ç”¨æœ¬åœ°çš„</strong></p>
<blockquote>
<p>è¿™ä¸ªé—®é¢˜å‘äº†æˆ‘å¾ˆä¹…ï¼Œå› ä¸ºåœ¨æ¨¡æ‹Ÿå™¨ä¸Šè·‘æ—¶ï¼Œå°†æœ¬åœ°å›¾ç‰‡ä½œä¸ºViewçš„èƒŒæ™¯å›¾ç‰‡æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ä¸€åˆ°çœŸæœºæµ‹è¯•å°±ä¸æ˜¾ç¤ºèƒŒæ™¯å›¾ç‰‡äº†ï¼Œä¸€å¼€å§‹è¿˜ä»¥ä¸ºæ˜¯è·¯å¾„é”™äº†ï¼Œç»è¿‡æµ‹è¯•å‘ç°è·¯å¾„æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œæœ€ååœ¨ç½‘ä¸Šæ‰¾åˆ°äº†åŸå› ï¼šå¾®ä¿¡å°ç¨‹åºçš„èƒŒæ™¯å›¾ç‰‡ä¸èƒ½æ˜¯æœ¬åœ°å›¾ç‰‡ï¼Œå¿…é¡»æ˜¯æ˜¯ç½‘ç»œå›¾ç‰‡ï¼Œäºæ˜¯æˆ‘å°±æ‰¾äº†ä¸€ä¸ªç½‘ç«™å°†å›¾ç‰‡ä¼ äº†ä¸Šå»ï¼Œå°†ç½‘å€ä½œä¸ºèƒŒæ™¯å›¾ç‰‡é“¾æ¥ï¼Œå°±å¥‡è¿¹èˆ¬çš„æ˜¾ç¤ºäº†ï¼Œå¾ˆæ˜¯æ— è¯­ã€‚</p>
</blockquote>
<h3 id="ä¸èƒ½åŠ è½½ç½‘é¡µ"><a href="#ä¸èƒ½åŠ è½½ç½‘é¡µ" class="headerlink" title="ä¸èƒ½åŠ è½½ç½‘é¡µ"></a>ä¸èƒ½åŠ è½½ç½‘é¡µ</h3><blockquote>
<p>å¾®ä¿¡å°ç¨‹åºæ˜¯ä¸èƒ½è·³è½¬åˆ°ç½‘é¡µçš„ï¼Œä¹Ÿè®¸æ˜¯å› ä¸ºå¾®ä¿¡å°ç¨‹åºæœ¬èº«å°±å¦‚åŒç½‘é¡µå§ï¼Œä¹Ÿå¯èƒ½æ˜¯å¾®ä¿¡ä¸æƒ³æœ‰äººè¶Šè¿‡å®ƒçš„å®¡æ ¸ï¼Œåæ­£ä»–æ˜¯ä¸å…è®¸ç›´æ¥åŠ è½½ç½‘é¡µçš„ã€‚</p>
</blockquote>
<h3 id="ä¸èƒ½éšè—å¯¼èˆªæ "><a href="#ä¸èƒ½éšè—å¯¼èˆªæ " class="headerlink" title="ä¸èƒ½éšè—å¯¼èˆªæ "></a>ä¸èƒ½éšè—å¯¼èˆªæ </h3><blockquote>
<p>æˆ‘çš„ç™»é™†é¡µé¢æœ¬æ¥æ˜¯ä¸åº”è¯¥æœ‰å¯¼èˆªæ çš„ï¼Œå¯æ˜¯å°±æ˜¯éšè—ä¸äº†ï¼Œä¹Ÿè®¸æœ‰æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘æ‰¾äº†å¾ˆä¹…ä¹Ÿæ²¡æœ‰å‘ç°ã€‚</p>
</blockquote>
<h3 id="åªæ”¯æŒHTTPSçš„ç½‘ç»œåè®®å¹¶ä¸”ä¸€ä¸ªæœˆåªèƒ½ä¿®æ”¹5æ¬¡"><a href="#åªæ”¯æŒHTTPSçš„ç½‘ç»œåè®®å¹¶ä¸”ä¸€ä¸ªæœˆåªèƒ½ä¿®æ”¹5æ¬¡" class="headerlink" title="åªæ”¯æŒHTTPSçš„ç½‘ç»œåè®®å¹¶ä¸”ä¸€ä¸ªæœˆåªèƒ½ä¿®æ”¹5æ¬¡"></a>åªæ”¯æŒHTTPSçš„ç½‘ç»œåè®®å¹¶ä¸”ä¸€ä¸ªæœˆåªèƒ½ä¿®æ”¹5æ¬¡</h3><blockquote>
<p>åœ¨å¾®ä¿¡å°ç¨‹åºä¸­ç½‘ç»œè¯·æ±‚åªèƒ½æ˜¯httpsç±»å‹çš„ã€‚åœ¨æ·»åŠ URLçš„æ—¶å€™éƒ½å·²ç»é™åˆ¶æ­»äº†ã€‚å¹¶ä¸”ä¸€ä¸ªæœˆåªèƒ½ä¿®æ”¹5æ¬¡ï¼Œç½‘ç»œè¯·æ±‚å¿…é¡»å…ˆè¿›è¡ŒæœåŠ¡å™¨åŸŸåé…ç½®ã€‚</p>
</blockquote>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/48f1eaa31d6ea1dd09c872920e359dee.webp?x-image-process=image/format,png" alt="æ·»åŠ URL"><br>)</p>
<h3 id="æ‰€æœ‰çš„é¡µé¢éƒ½å¿…é¡»åœ¨app-jsonä¸­é…ç½®è·¯å¾„"><a href="#æ‰€æœ‰çš„é¡µé¢éƒ½å¿…é¡»åœ¨app-jsonä¸­é…ç½®è·¯å¾„" class="headerlink" title="æ‰€æœ‰çš„é¡µé¢éƒ½å¿…é¡»åœ¨app.jsonä¸­é…ç½®è·¯å¾„"></a>æ‰€æœ‰çš„é¡µé¢éƒ½å¿…é¡»åœ¨app.jsonä¸­é…ç½®è·¯å¾„</h3><blockquote>
<p>æˆ‘ä¹‹å‰æ–°å»ºä¸€ä¸ªé¡µé¢ç„¶åè·³è½¬è¿‡å»ä¸€ç›´æŠ¥è·¯å¾„é”™è¯¯ï¼Œå»ç½‘ä¸ŠæŸ¥è¯¢æ‰çŸ¥é“ï¼Œæ¯ä¸€ä¸ªé¡µé¢è·¯å¾„éƒ½éœ€è¦æå‰é…ç½®ã€‚</p>
</blockquote>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/2cb2cfa23e160b24cec566232710f644.webp?x-image-process=image/format,png" alt="é¡µé¢è·¯å¾„é…ç½®"></p>
<h3 id="ç½‘ç»œè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°ä¸º5ã€é¡µé¢å±‚çº§æœ€å¤š5å±‚"><a href="#ç½‘ç»œè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°ä¸º5ã€é¡µé¢å±‚çº§æœ€å¤š5å±‚" class="headerlink" title="ç½‘ç»œè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°ä¸º5ã€é¡µé¢å±‚çº§æœ€å¤š5å±‚"></a>ç½‘ç»œè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•°ä¸º5ã€é¡µé¢å±‚çº§æœ€å¤š5å±‚</h3><blockquote>
<p>å°±æ˜¯è¯´åŒæ—¶æœ€å¤š5ä¸ªç½‘ç»œè¯·æ±‚ï¼Œé¡µé¢çš„å­é¡µé¢æœ€å¤š4ä¸ªã€‚æˆ‘åœ¨æƒ³è¦æ˜¯ä¸€ä¸ªé¡µé¢æ˜¯ä¸€ä¸ªè§†é¢‘åˆ—è¡¨å±•ç¤ºæ€ä¹ˆåŠï¼Œæ¯ä¸€ä¸ªè§†é¢‘éƒ½éœ€è¦ç½‘ç»œè¯·æ±‚å•Šã€‚</p>
<p>ä»¥ä¸Šå°±æ˜¯è¿™æ¬¡é‡åˆ°çš„ä¸€äº›æ¯”è¾ƒå˜æ€çš„é—®é¢˜ã€‚</p>
</blockquote>
<h3 id="è°ˆè°ˆæˆ‘çš„ä¸€äº›ä»£ç å®ç°"><a href="#è°ˆè°ˆæˆ‘çš„ä¸€äº›ä»£ç å®ç°" class="headerlink" title="è°ˆè°ˆæˆ‘çš„ä¸€äº›ä»£ç å®ç°"></a>è°ˆè°ˆæˆ‘çš„ä¸€äº›ä»£ç å®ç°</h3><p><strong>é…ç½®tabBar(app.json)</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;tabBar&quot;: &#123;</span><br><span class="line">  &quot;color&quot;: &quot;#888888&quot;,</span><br><span class="line">  &quot;selectedColor&quot;: &quot;#09BB07&quot;,</span><br><span class="line">  &quot;backgroundColor&quot;: &quot;&quot;,</span><br><span class="line">  &quot;borderStyle&quot;: &quot;white&quot;,</span><br><span class="line">  &quot;list&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;pagePath&quot;: &quot;pages/orderManage/orderManage&quot;,</span><br><span class="line">      &quot;text&quot;: &quot;è®¢å•ç®¡ç†&quot;,</span><br><span class="line">      &quot;iconPath&quot;: &quot;pages/images/order.png&quot;,</span><br><span class="line">      &quot;selectedIconPath&quot;: &quot;pages/images/order_r.png&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;pagePath&quot;: &quot;pages/moneyManage/moneyManage&quot;,</span><br><span class="line">      &quot;text&quot;: &quot;è´¢åŠ¡ç®¡ç†&quot;,</span><br><span class="line">      &quot;iconPath&quot;: &quot;pages/images/money.png&quot;,</span><br><span class="line">      &quot;selectedIconPath&quot;: &quot;pages/images/money_r.png&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;pagePath&quot;: &quot;pages/myself/myself&quot;,</span><br><span class="line">      &quot;text&quot;: &quot;æˆ‘çš„å•†æˆ·&quot;,</span><br><span class="line">      &quot;iconPath&quot;: &quot;pages/images/people.png&quot;,</span><br><span class="line">      &quot;selectedIconPath&quot;: &quot;pages/images/people_r.png&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="è®¢å•ç®¡ç†é¡µçš„èœå•æ "><a href="#è®¢å•ç®¡ç†é¡µçš„èœå•æ " class="headerlink" title="è®¢å•ç®¡ç†é¡µçš„èœå•æ "></a>è®¢å•ç®¡ç†é¡µçš„èœå•æ </h3><blockquote>
<p>ç‚¹å‡»èœå•æ åˆ‡æ¢Viewç®€å•ï¼Œç›´æ¥å°†å°†ç‚¹å‡»çš„èœå•çš„å€¼èµ‹ç»™Viewè®©å…¶åç§»å¯¹åº”çš„ç™¾åˆ†æ¯”å°±å¥½ã€‚</p>
<p>æ‰‹åŠ¿åˆ‡æ¢ï¼šé€šè¿‡è§¦æ‘¸çš„èµ·ç‚¹ä¸ç»ˆç‚¹è®¡ç®—å‡ºæ»‘åŠ¨æ–¹å‘ï¼Œç„¶ååç§»å¹¶ä¸”åˆ‡æ¢èœå•æ ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">    catchtouchstart:function(e)&#123;</span><br><span class="line">    var that = this;</span><br><span class="line">    that.setData(&#123;</span><br><span class="line">      startPoint: [e.touches[0].clientX,e.touches[0].clientY]</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;,</span><br><span class="line">  catchtouchend:function(e)&#123;</span><br><span class="line">    var that = this;</span><br><span class="line">    var currentNum = parseInt(this.data.currentNavtab);</span><br><span class="line">    var endPoint = [e.changedTouches[0].clientX,e.changedTouches[0].clientY];</span><br><span class="line">    var startPoint = that.data.startPoint</span><br><span class="line">    if(endPoint[0] &lt;= startPoint[0]) &#123;</span><br><span class="line">      if(Math.abs(endPoint[0] - startPoint[0]) &gt;= Math.abs(endPoint[1] - startPoint[1]) &amp;&amp; currentNum&lt; this.data.navTab.length -1) &#123;</span><br><span class="line">         currentNum=currentNum + 1;  </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;else &#123;</span><br><span class="line">      if(Math.abs(endPoint[0] - startPoint[0]) &gt;= Math.abs(endPoint[1] - startPoint[1]) &amp;&amp; currentNum &gt; 0) &#123;</span><br><span class="line">          currentNum -= 1;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    this.setData(&#123;</span><br><span class="line">      currentNavtab: currentNum</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">// ç‚¹å‡»èœå•æ åˆ‡æ¢View</span><br><span class="line">  switchTab: function(e)&#123;</span><br><span class="line">    this.setData(&#123;</span><br><span class="line">      currentNavtab: e.currentTarget.dataset.idx</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h3><blockquote>
<p>æ•´ä¸ªç¨‹åºè¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œå°±æ˜¯åˆæ¬¡å†™è¿˜æ˜¯æœ‰äº›ä¸é€‚åº”ã€‚å°¤å…¶æ˜¯æŠŠdivæ”¹ä¸ºäº†Viewï¼Œä¸èƒ½ä½¿ç”¨windowå¯¹è±¡å’Œdocumentå¯¹è±¡ï¼Œå¾ˆä¸é€‚åº”ã€‚å†æ¬¡å¥‰ä¸Š<a href="https://github.com/GavinCarter1991/wx-onePro">demo</a></p>
</blockquote>
]]></content>
      <categories>
        <category>å¾®ä¿¡å°ç¨‹åº</category>
      </categories>
      <tags>
        <tag>â€œå¾®ä¿¡å°ç¨‹åºâ€</tag>
      </tags>
  </entry>
  <entry>
    <title>é¡¹ç›®å‰–æ01-swift WebSocket</title>
    <url>/2019/12/23/%E9%A1%B9%E7%9B%AE%E5%89%96%E6%9E%9001-swift-WebSocket/</url>
    <content><![CDATA[<blockquote>
<p>å·²ç»å¾ˆé•¿ä¸€æ®µæ—¶é—´æ²¡æœ‰æ€»ç»“é¡¹ç›®äº†ï¼Œæ­£å¥½æœ€è¿‘å®Œæˆé¡¹ç›®ç¬¬äºŒç‰ˆçš„æ”¹ç‰ˆ(æ–°é¡¹ç›®å®Œå…¨æ˜¯ç”¨swiftå†™çš„)ï¼Œå°±æŠŠé¡¹ç›®ä¸­ä¸€äº›æœ‰æ„ä¹‰çš„çŸ¥è¯†å—åœ¨æ­¤è®°å½•ä¸€ä¸‹ï¼Œ é¡¹ç›®ä¸­æœ‰å®æ—¶çš„äº¤æ˜“éœ€è¦å±•ç¤ºï¼Œæ‰€ä»¥ç”¨åˆ°äº†socketé•¿é“¾æ¥ï¼Œæˆ‘ç”¨çš„æ˜¯<a href="https://github.com/daltoniam/Starscream">Starscream</a>è¿™ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œé›†æˆæ–¹æ³•å¾ˆç®€å•å»ç½‘ç«™çœ‹çœ‹å°±çŸ¥é“ã€‚</p>
</blockquote>
<h3 id="å…ˆä¸Šä»£ç "><a href="#å…ˆä¸Šä»£ç " class="headerlink" title="å…ˆä¸Šä»£ç "></a>å…ˆä¸Šä»£ç </h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import UIKit</span><br><span class="line">import Reachability</span><br><span class="line">import Starscream</span><br><span class="line">import zlib</span><br><span class="line"></span><br><span class="line">let reachability = Reachability()! // åˆ¤æ–­ç½‘ç»œè¿æ¥</span><br><span class="line">let webSocket = WTWebsocket.shared</span><br><span class="line">var reConnectTime = 0 // è®¾ç½®é‡è¿æ¬¡æ•°</span><br><span class="line">let reConnectMaxTime = 1000 // è®¾ç½®æœ€å¤§é‡è¿æ¬¡æ•°</span><br><span class="line">let reConnectIntervalTime: TimeInterval = 15 // è®¾ç½®é‡è¿æ—¶é—´é—´éš”(ç§’)</span><br><span class="line">var websocketTimer: Timer? = nil</span><br><span class="line">var reConnectSubscribeDict:[String : Any] = [:]</span><br><span class="line">var page = &quot;home&quot;</span><br><span class="line">var isReconnect = true</span><br><span class="line"></span><br><span class="line">final class WTWebsocket: NSObject,WebSocketDelegate &#123;</span><br><span class="line">    </span><br><span class="line">    var isPingBack = true</span><br><span class="line">    var myWebsocket: WebSocket? = nil</span><br><span class="line">    //  socketè¿æ¥ä¸Šå‡½æ•°</span><br><span class="line">    func websocketDidConnect(socket: WebSocketClient) &#123;</span><br><span class="line">        //è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œè§£å†³æ— é™é‡è¿é—®é¢˜</span><br><span class="line">        reConnectTime = 0</span><br><span class="line">        if reConnectSubscribeDict.count &gt; 0 &#123;</span><br><span class="line">            self.subscribe(subscribeDict: reConnectSubscribeDict)</span><br><span class="line">        &#125;</span><br><span class="line">        self.hearJump()</span><br><span class="line">        if  websocketTimer == nil &#123;</span><br><span class="line">            websocketTimer = Timer.scheduledTimer(timeInterval: reConnectIntervalTime, target: self, selector: #selector(sendBrandStr), userInfo: nil, repeats: true)</span><br><span class="line">        &#125;</span><br><span class="line">        isReconnect = true</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //å‘é€æ–‡å­—æ¶ˆæ¯</span><br><span class="line">    @objc func sendBrandStr()&#123;</span><br><span class="line">        self.checkPing()</span><br><span class="line">        let json = getJSONStringFromDictionary(dictionary: [&quot;topic&quot;:&quot;PING&quot;])</span><br><span class="line">        SingletonSocket.sharedInstance.socket.write(string: json)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // å‘é€ping</span><br><span class="line">    func hearJump() &#123;</span><br><span class="line">        let json = getJSONStringFromDictionary(dictionary: [&quot;topic&quot;:&quot;PING&quot;])</span><br><span class="line">        SingletonSocket.sharedInstance.socket.write(string: json)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //  socketæ–­å¼€æ‰§è¡Œå‡½æ•°</span><br><span class="line">    func websocketDidDisconnect(socket: WebSocketClient, error: Error?) &#123;</span><br><span class="line">        //æ‰§è¡Œé‡æ–°è¿æ¥æ–¹æ³•</span><br><span class="line">        socketReconnect()</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //  æ¥æ”¶è¿”å›æ¶ˆæ¯å‡½æ•°</span><br><span class="line">    func websocketDidReceiveMessage(socket: WebSocketClient, text: String) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    func websocketDidReceiveData(socket: WebSocketClient, data: Data) &#123;</span><br><span class="line">        guard let newStr = String(data: data.gzipUncompress(), encoding: .utf8) else &#123;return&#125;</span><br><span class="line">        if newStr == &quot;PONG&quot; &#123;</span><br><span class="line">            isPingBack = true</span><br><span class="line">            return</span><br><span class="line">        &#125;</span><br><span class="line">      // å¤„ç†æ”¶åˆ°çš„ä¿¡æ¯</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // æ·»åŠ æ³¨å†Œ</span><br><span class="line">    func subscribe(subscribeDict: [String : Any]) &#123;</span><br><span class="line">        var subscribeDicts = subscribeDict</span><br><span class="line">        reConnectSubscribeDict = subscribeDicts</span><br><span class="line">        page = subscribeDicts[&quot;type&quot;] as! String</span><br><span class="line">        subscribeDicts.removeValue(forKey: &quot;type&quot;)</span><br><span class="line">        let json = getJSONStringFromDictionary(dictionary:</span><br><span class="line">            subscribeDicts as NSDictionary)</span><br><span class="line">        SingletonSocket.sharedInstance.socket.write(string: json)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //æ£€æµ‹</span><br><span class="line">    @objc func checkPing() &#123;</span><br><span class="line">        if !isPingBack &#123;</span><br><span class="line">            // é‡æ–°è¿æ¥</span><br><span class="line">            socketReconnect()</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            isPingBack = false</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //æ„é€ å•ä¾‹æ•°æ®</span><br><span class="line">    static let shared = WTWebsocket()</span><br><span class="line">    private override init() &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//socket é‡è¿é€»è¾‘</span><br><span class="line">func socketReconnect() &#123;</span><br><span class="line">    //åˆ¤æ–­ç½‘ç»œæƒ…å†µï¼Œå¦‚æœç½‘ç»œæ­£å¸¸ï¼Œå¯ä»¥æ‰§è¡Œé‡è¿</span><br><span class="line">    if reachability.connection != .none &#123;</span><br><span class="line">        //è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œè§£å†³æ— é™é‡è¿é—®é¢˜</span><br><span class="line">        reConnectTime =  reConnectTime + 1</span><br><span class="line">        if reConnectTime &lt; reConnectMaxTime &#123;</span><br><span class="line">            //æ·»åŠ é‡è¿å»¶æ—¶æ‰§è¡Œï¼Œé˜²æ­¢æŸä¸ªæ—¶é—´æ®µï¼Œå…¨éƒ¨æ‰§è¡Œ</span><br><span class="line">            let time: TimeInterval = 2.0</span><br><span class="line">            DispatchQueue.main.asyncAfter(deadline: DispatchTime.now() + time) &#123;</span><br><span class="line">                SingletonSocket.sharedInstance.socket.connect()</span><br><span class="line">                SingletonSocket.sharedInstance.socket.disconnect()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            //æç¤ºé‡è¿å¤±è´¥</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        //æç¤ºæ— ç½‘ç»œ</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//socketä¸»åŠ¨æ–­å¼€ï¼Œæ”¾åœ¨appè¿›å…¥åå°æ—¶ï¼Œæ•°æ®è¿›å…¥ç¼“å­˜ã€‚appå†è¿›å…¥å‰å°ï¼Œappå‡ºç°å¡æ­»çš„æƒ…å†µ</span><br><span class="line">func socketDisConnect() &#123;</span><br><span class="line">    if !SingletonSocket.sharedInstance.socket.isConnected &#123;</span><br><span class="line">        websocketTimer?.invalidate()</span><br><span class="line">        websocketTimer = nil</span><br><span class="line">        SingletonSocket.sharedInstance.socket.disconnect()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// initSocketæ–¹æ³•</span><br><span class="line">func initWebSocketSingle () &#123;</span><br><span class="line">    SingletonSocket.sharedInstance.socket.delegate = webSocket</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//å£°æ˜webSocketå•ä¾‹</span><br><span class="line">class SingletonSocket &#123;</span><br><span class="line">    let socket:WebSocket = WebSocket(url: URL(string: AppURLHOST.SocketURL)!)</span><br><span class="line">    class var sharedInstance : SingletonSocket&#123;</span><br><span class="line">        struct Static&#123;</span><br><span class="line">            static let instance:SingletonSocket = SingletonSocket()</span><br><span class="line">        &#125;</span><br><span class="line">        if !Static.instance.socket.isConnected&#123;</span><br><span class="line">            Static.instance.socket.connect()</span><br><span class="line">        &#125;</span><br><span class="line">        return Static.instance</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ•´ä¸ªä»£ç å¾ˆç®€å•ï¼ŒåŸºæœ¬éƒ½æœ‰æ³¨é‡Šï¼Œå¤§æ¦‚èŠä¸€èŠé‡Œé¢çš„ä¸€äº›å…³é”®ç‚¹"><a href="#æ•´ä¸ªä»£ç å¾ˆç®€å•ï¼ŒåŸºæœ¬éƒ½æœ‰æ³¨é‡Šï¼Œå¤§æ¦‚èŠä¸€èŠé‡Œé¢çš„ä¸€äº›å…³é”®ç‚¹" class="headerlink" title="æ•´ä¸ªä»£ç å¾ˆç®€å•ï¼ŒåŸºæœ¬éƒ½æœ‰æ³¨é‡Šï¼Œå¤§æ¦‚èŠä¸€èŠé‡Œé¢çš„ä¸€äº›å…³é”®ç‚¹"></a>æ•´ä¸ªä»£ç å¾ˆç®€å•ï¼ŒåŸºæœ¬éƒ½æœ‰æ³¨é‡Šï¼Œå¤§æ¦‚èŠä¸€èŠé‡Œé¢çš„ä¸€äº›å…³é”®ç‚¹</h3><blockquote>
<p>å‘é€ping-ä¿—ç§°å‘é€å¿ƒè·³ï¼Œè¿™ä¸ªä¸»è¦æ˜¯åˆ¤æ–­socketæ˜¯å¦æ–­å¼€ï¼Œé“¾æ¥æˆåŠŸåæ¯æ¬¡é—´éš”å›ºå®šæ—¶é—´å‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œç„¶ååœ¨è¿”å›ä¸­ä¿®æ”¹isPingBackï¼Œåœ¨ä¸‹ä¸€æ¬¡å‘é€è¯·æ±‚å‰æ£€æŸ¥isPingBackåˆ¤æ–­ä¸Šä¸€æ¬¡çš„è¯·æ±‚æ˜¯å¦è¿”å›ï¼Œè¿™æ ·å°±å¯ä»¥åˆ¤æ–­socketæ˜¯å¦æ–­å¼€ï¼Œè¿™ä¸ªé—´éš”æ—¶é—´å¯ä»¥è‡ªç”±è®¾å®šï¼Œä½†æ˜¯æœ€å¥½ä¸è¦å¤ªçŸ­ï¼Œå¤ªçŸ­æœ‰å¯èƒ½æ˜¯socketè¿æ¥äº†ä½†æ˜¯æ²¡æœ‰æ¥å¾—åŠè¿”å›ã€‚å½“ç„¶å¤ªé•¿ä¹Ÿä¸è¡Œï¼Œè¿™å¯èƒ½å¯¼è‡´å‘ç°socketæ–­å¼€ä¸åŠæ—¶ã€‚</p>
</blockquote>
<p><strong>appåœ¨åå°éœ€è¦æ–­å¼€socketï¼Œå½“ appé‡æ–°è¿›å…¥å‰å°éœ€è¦é‡æ–°è¿æ¥</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">func applicationWillResignActive(_ application: UIApplication) &#123;</span><br><span class="line">        //è¿›å…¥åå°æ¨¡å¼ï¼Œä¸»åŠ¨æ–­å¼€socketï¼Œé˜²æ­¢å‡ºç°å¤„ç†ä¸äº†çš„æƒ…å†µ</span><br><span class="line">        if SingletonSocket.sharedInstance.socket.isConnected &#123;</span><br><span class="line">            reConnectTime = reConnectMaxTime</span><br><span class="line">            socketDisConnect()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    func applicationDidBecomeActive(_ application: UIApplication) &#123;</span><br><span class="line">        //è¿›å…¥å‰å°æ¨¡å¼ï¼Œä¸»åŠ¨è¿æ¥socket</span><br><span class="line">        //è§£å†³å› ä¸ºç½‘ç»œåˆ‡æ¢æˆ–é“¾æ¥ä¸ç¨³å®šé—®é¢˜ï¼Œå¼•èµ·socketæ–­è¿é—®é¢˜</span><br><span class="line">        //å¦‚æœappä»æ— ç½‘ç»œï¼Œåˆ°å›å¤ç½‘ç»œï¼Œéœ€è¦æ‰§è¡Œé‡è¿</span><br><span class="line">        if !isFirstApplicationDidBecomeActive &#123;</span><br><span class="line">            reConnectTime = 0</span><br><span class="line">            socketReconnect()</span><br><span class="line">            WTBasicConfigManager.shareDataSingle.getHash()</span><br><span class="line">        &#125;</span><br><span class="line">        isFirstApplicationDidBecomeActive = false</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä¸€å®šè¦è®¾ç½®æœ€å¤§é‡æ–°è¿æ¥çš„æ¬¡æ•°ï¼Œä¸ç„¶appä¼šæ— é™é‡æ–°è¿æ¥</strong></p>
<p><strong>è¿æ¥æˆåŠŸæˆ–è€…é‡è¿æˆåŠŸéƒ½éœ€è¦å¯¹éœ€è¦æ¨é€çš„æ•°æ®è¿›è¡Œä¸€æ¬¡ç½‘ç»œè¯·æ±‚ï¼Œç¡®ä¿æ•°æ®çš„å‡†ç¡®æ€§ã€‚</strong></p>
<blockquote>
<p>ä»¥ä¸Šå°±æ˜¯æˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨WebSocketçš„æ–¹æ³•ï¼Œå¦‚æœæœ‰é”™è¯¯æˆ–è€…ä¸è¶³ä¹‹å¤„è¿˜æœ›æŒ‡æ­£ï¼Œè°¢è°¢</p>
</blockquote>
]]></content>
      <categories>
        <category>swift</category>
      </categories>
      <tags>
        <tag>â€œswiftâ€</tag>
        <tag>â€œWebSocketâ€</tag>
      </tags>
  </entry>
  <entry>
    <title>é¡¹ç›®å‰–æ02-swift è½»æ¾å®ç°åŠ¨ç”»æ•ˆæœ-Lottie</title>
    <url>/2019/12/23/%E9%A1%B9%E7%9B%AE%E5%89%96%E6%9E%9002-swift-%E8%BD%BB%E6%9D%BE%E5%AE%9E%E7%8E%B0%E5%8A%A8%E7%94%BB%E6%95%88%E6%9E%9C-Lottie/</url>
    <content><![CDATA[<blockquote>
<p><a href="https://github.com/airbnb/lottie-ios">Lottie</a> æ˜¯ <a href="https://lottiefiles.com/?lang=zh_CN">Airbnb</a>å¼€æºçš„ä¸€å¥—è·¨å¹³å°çš„åŠ¨ç”»æ•ˆæœè§£å†³æ–¹æ¡ˆ,å®ƒèƒ½å¤ŸåŒæ—¶æ”¯æŒ<code>iOS</code>ã€<code>Android</code>ã€<code>Web</code> å’Œ <code>React Native</code>çš„å¼€å‘ï¼Œè®¾è®¡å¸ˆåªéœ€è¦ç”¨ <a href="https://www.adobe.com/cn/products/aftereffects.html">AdobeAfterEffects</a>(AE) è®¾è®¡å‡ºéœ€è¦çš„çš„åŠ¨ç”»ä¹‹åï¼Œä½¿ç”¨ <code>Lottie</code> æä¾›çš„ <a href="https://github.com/bodymovin/bodymovin">Bodymovin</a> æ’ä»¶å°†è®¾è®¡å¥½çš„åŠ¨ç”»å¯¼å‡ºæˆJSONæ ¼å¼(æ–‡ä»¶å¾ˆå°ä¸ä¼šè±¡GIFé‚£ä¹ˆåºå¤§)ç»™ä½ å³å¯ï¼Œå¯ä»¥è®©è®¾è®¡å¸ˆå®ç°æ‰€è§å³æ‰€å¾—çš„åŠ¨ç”»å†ä¹Ÿä¸ç”¨å’Œè®¾è®¡å¸ˆäº‰è®ºåŠ¨ç”»è®¾è®¡äº†ã€‚æœ¬æ–‡åªæ˜¯å±•ç¤ºåœ¨swiftä¸­å¦‚ä½•ç®€å•ä½¿ç”¨<code>Lottie</code> ï¼Œè¯¦ç»†çš„ä½¿ç”¨æ–¹æ³•è¯·å‚è€ƒ<a href="https://airbnb.io/lottie/#/">å®˜æ–¹æ–‡æ¡£</a></p>
</blockquote>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/9435d33b4f8d95e2fbaed37fa0c418ba.gif" alt="githubä¾‹å›¾"></p>
<h3 id="ç”¨æ³•ä¸¾ä¾‹"><a href="#ç”¨æ³•ä¸¾ä¾‹" class="headerlink" title="ç”¨æ³•ä¸¾ä¾‹"></a>ç”¨æ³•ä¸¾ä¾‹</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lazy var lottieAnimationView: AnimationView = &#123;</span><br><span class="line">        // åŠ è½½æœ¬åœ°èµ„æº</span><br><span class="line">        let path : String = Bundle.main.path(forResource: &quot;data&quot;, ofType: &quot;json&quot;)!</span><br><span class="line">        let lottieAnimationView = AnimationView.init(filePath: path)</span><br><span class="line">        WTNavigationManger.Nav?.view.addSubview(lottieAnimationView)</span><br><span class="line">        lottieAnimationView.constrain(toSuperviewEdges: nil)</span><br><span class="line">        lottieAnimationView.isUserInteractionEnabled = true</span><br><span class="line">        lottieAnimationView.addGestureRecognizer(UITapGestureRecognizer(target: self, action: #selector(removeLottieAnimationViewFromParent)))</span><br><span class="line">        return lottieAnimationView</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">// è°ƒç”¨</span><br><span class="line">lottieAnimationView.play &#123;[weak self] (complete) in</span><br><span class="line">       guard let mySelf = self else &#123;return&#125;</span><br><span class="line">       mySelf.removeLottieAnimationViewFromParent()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">@objc func removeLottieAnimationViewFromParent() &#123;</span><br><span class="line">        lottieAnimationView.removeFromSuperview()</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å°†è®¾è®¡å¸ˆç»™ä½ çš„æ–‡ä»¶å¯¼å…¥é¡¹ç›®ï¼Œç„¶åé€šè¿‡Bundle.main.path(forResource:æ‰¾åˆ°jsonæ–‡ä»¶ï¼Œç„¶åå°†AnimationViewæ·»åŠ åˆ°è§†å›¾ï¼Œåœ¨éœ€è¦å±•ç¤ºåŠ¨ç”»çš„åœ°æ–¹è°ƒç”¨play() æ–¹æ³•ï¼Œè¿™æ ·åŠ¨ç”»å°±å¯ä»¥åŠ è½½äº†ã€‚</p>
</blockquote>
<h3 id="å¼•å…¥jsonçš„æ–¹å¼"><a href="#å¼•å…¥jsonçš„æ–¹å¼" class="headerlink" title="å¼•å…¥jsonçš„æ–¹å¼"></a>å¼•å…¥jsonçš„æ–¹å¼</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/// jsonæ‰€åœ¨çš„æ–‡ä»¶ï¼Œé»˜è®¤ä¸ºBundle.main</span><br><span class="line">let animation = Animation.named(&quot;StarAnimation&quot;) </span><br><span class="line">/// é»˜è®¤ä¸ºBundle.main</span><br><span class="line">let animation = Animation.named(&quot;StarAnimation&quot;, bundle: myBundle)</span><br><span class="line">/// subdirectory ä¸ºåŠ¨ç”»æ‰€åœ¨çš„åŒ…ä¸­çš„å­ç›®å½•(å¯é€‰çš„)</span><br><span class="line">let animation = Animation.named(&quot;StarAnimation&quot;, subdirectory: &quot;Animations&quot;)</span><br><span class="line">/// animationCache ä¸ºä¿å­˜åŠ è½½åŠ¨ç”»çš„ç¼“å­˜(å¯é€‰çš„)</span><br><span class="line">let animation = Animation.named(&quot;StarAnimation&quot;, animationCache: LRUAnimationCache.sharedCache)</span><br></pre></td></tr></table></figure>

<h3 id="æŒ‡å®šåŠ è½½è·¯å¾„"><a href="#æŒ‡å®šåŠ è½½è·¯å¾„" class="headerlink" title="æŒ‡å®šåŠ è½½è·¯å¾„"></a>æŒ‡å®šåŠ è½½è·¯å¾„</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Animation.filepath(_ filepath: String, animationCache: AnimationCacheProvider?) -&gt; Animation?</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä»ç»å¯¹æ–‡ä»¶è·¯å¾„åŠ è½½åŠ¨ç”»æ¨¡å‹ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŠ¨ç”»ï¼Œåˆ™è¿”å›nil<br>filepath:è¦åŠ è½½çš„åŠ¨ç”»çš„ç»å¯¹æ–‡ä»¶è·¯å¾„<br>animationCache:ç”¨äºä¿å­˜åŠ è½½çš„åŠ¨ç”»çš„ç¼“å­˜(å¯é€‰çš„)</p>
</blockquote>
<h3 id="æ’­æ”¾åŠ¨ç”»"><a href="#æ’­æ”¾åŠ¨ç”»" class="headerlink" title="æ’­æ”¾åŠ¨ç”»"></a>æ’­æ”¾åŠ¨ç”»</h3><p><strong>åŸºæœ¬æ’­æ”¾(Basic Playing)</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// æ’­æ”¾åŠ¨ç”»ä»å®ƒçš„å½“å‰çŠ¶æ€åˆ°å®ƒçš„æ—¶é—´è½´ç»“æŸã€‚åœ¨åŠ¨ç”»åœæ­¢æ—¶è°ƒç”¨completionä»£ç å—</span><br><span class="line">// å¦‚æœåŠ¨ç”»å®Œæˆï¼Œåˆ™completionè¿”å›trueã€‚å¦‚æœåŠ¨ç”»è¢«ä¸­æ–­ï¼Œåˆ™è¿”å›false</span><br><span class="line">AnimationView.play(completion: LottieCompletionBlock?)</span><br></pre></td></tr></table></figure>
<p><strong>åˆ©ç”¨è¿›åº¦æ—¶é—´(Play with Progress Time)</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// æŒ‡å®šä¸€ä¸ªæ—¶é—´åˆ°å¦ä¸€ä¸ªæ—¶é—´çš„æ’­æ”¾</span><br><span class="line">AnimationView.play(fromProgress: AnimationProgressTime?, toProgress: AnimationProgressTime, loopMode: LottieLoopMode?, completion: LottieCompletionBlock?)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>æ—¶é—´å¸§æ’­æ”¾(Play with Marker Names)</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// åŠ¨ç”»æ’­æ”¾ä»ä¸€ä¸ªæ—¶é—´å¸§åˆ°å¦ä¸€ä¸ªæ—¶é—´å¸§</span><br><span class="line">AnimationView.play(fromFrame: AnimationProgressTime?, toFrame: AnimationFrameTime, loopMode: LottieLoopMode?, completion: LottieCompletionBlock?)</span><br></pre></td></tr></table></figure>
<p><strong>æ—¶é—´å¸§æ’­æ”¾(Play with Marker Names)</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// å°†åŠ¨ç”»ä»å‘½åæ ‡è®°æ’­æ”¾åˆ°å¦ä¸€ä¸ªæ ‡è®°ã€‚æ ‡è®°æ˜¯ç¼–ç åˆ°åŠ¨ç”»æ•°æ®ä¸­å¹¶æŒ‡å®šåç§°çš„æ—¶é—´ç‚¹</span><br><span class="line">AnimationView.play(fromMarker: String?, toMarker: String, loopMode: LottieLoopMode?, completion: LottieCompletionBlock?)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="å…¶å®ƒæ“ä½œ"><a href="#å…¶å®ƒæ“ä½œ" class="headerlink" title="å…¶å®ƒæ“ä½œ"></a>å…¶å®ƒæ“ä½œ</h3><blockquote>
<ol>
<li><p>AnimationView.pause() &#x2F;&#x2F; æš‚åœ</p>
</li>
<li><p>AnimationView.stop()  &#x2F;&#x2F; åœæ­¢</p>
</li>
<li><p>var AnimationView.backgroundBehavior: LottieBackgroundBehavior { get set} &#x2F;&#x2F; appè¿›å…¥åå°</p>
</li>
<li><p>var AnimationView.contentMode: UIViewContentMode { get set } &#x2F;&#x2F; å¾ªç¯æ’­æ”¾æ¨¡å¼ã€‚é»˜è®¤æ˜¯playOnceï¼Œè¿˜æœ‰autoReverseæ— é™å¾ªç¯</p>
</li>
<li><p>var AnimationView.isAnimationPlaying: Bool { get set } &#x2F;&#x2F; åˆ¤æ–­åŠ¨ç”»æ˜¯å¦åœ¨æ’­æ”¾</p>
</li>
<li><p>var AnimationView.animationSpeed: CGFloat { get set } &#x2F;&#x2F; åŠ¨ç”»é€Ÿåº¦</p>
</li>
<li><p>func AnimationView.forceDisplayUpdate() &#x2F;&#x2F; å¼ºåˆ¶é‡ç»˜åŠ¨ç”»è§†å›¾</p>
</li>
</ol>
</blockquote>
<p><strong>ä»¥ä¸Šå°±æ˜¯æˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨<code>Lottie</code>çš„æ–¹æ³•ï¼Œå¦‚æœæœ‰é”™è¯¯æˆ–è€…ä¸è¶³ä¹‹å¤„è¿˜æœ›æŒ‡æ­£ï¼Œè°¢è°¢</strong></p>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>â€œiOSâ€</tag>
        <tag>â€œåŠ¨ç”»â€</tag>
        <tag>â€œLottieâ€</tag>
      </tags>
  </entry>
  <entry>
    <title>é¡¹ç›®å‰–æ03-swift ç½‘ç»œè¯·æ±‚Moya+HandyJSON+RxSwift</title>
    <url>/2019/12/23/%E9%A1%B9%E7%9B%AE%E5%89%96%E6%9E%9003-swift-%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82Moya-HandyJSON-RxSwift/</url>
    <content><![CDATA[<blockquote>
<p>é¡¹ç›®ç¬¬ä¸€ç‰ˆç½‘ç»œæ¡†æ¶ç”¨çš„æ˜¯<a href="https://github.com/bustoutsolutions/siesta">siesta</a>,å®ƒçš„ç¼“å­˜ä¸è‡ªåŠ¨åˆ·æ–°ç¡®å®å¾ˆå¥½ç”¨è€Œä¸”ä»£ç å¾ˆç®€æ´ï¼Œä½†æ˜¯åœ¨æ–‡ä»¶çš„ä¸Šä¼ ä¸ä¸‹è½½ä»¥åŠå¯¹è¿”å›ç±»å‹éœ€è¦ç²¾ç¡®åŒ¹é…è¦æ±‚è¿™æ–¹é¢å°±å¾ˆä¸å‹å¥½ï¼Œæ‰€ä»¥åœ¨ç¬¬äºŒç‰ˆçš„æˆ‘é€‰æ‹©äº†<a href="https://github.com/Moya/Moya">Moya</a>,å®ƒæ˜¯ä¸€ä¸ªç½‘ç»œæŠ½è±¡å±‚ï¼Œå®ƒåœ¨<a href="https://github.com/Alamofire/Alamofire">Alamofire</a>åŸºç¡€ä¸Šæä¾›äº†ä¸€ç³»åˆ—çš„æŠ½è±¡æ¥å£æ–¹ä¾¿ç»´æŠ¤ã€‚å…³äº<code>Moya</code>çš„ä½¿ç”¨ä»‹ç»å¾ˆå¤šï¼Œæˆ‘å°±ä¸å†èµ˜è¿°äº†ã€‚æˆ‘ä¸»è¦è®°å½•ä¸€ä¸‹æˆ‘åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å­¦åˆ°çš„å¤„ç†æ–¹å¼ã€‚æˆ‘çš„ç½‘ç»œæ¡†æ¶æ˜¯æ­ç€<a href="https://github.com/alibaba/HandyJSON">HandyJSON</a>å’Œ<a href="https://github.com/Moya/Moya/blob/master/docs/RxSwift.md">RxSwift</a>ä¸€èµ·æ„å»ºçš„ã€‚</p>
</blockquote>
<h3 id="Moya"><a href="#Moya" class="headerlink" title="Moya"></a>Moya</h3><p><strong>ä»£ç </strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import Foundation</span><br><span class="line">import enum Result.Result</span><br><span class="line">import Alamofire</span><br><span class="line"></span><br><span class="line">//è®¾ç½®è¯·æ±‚è¶…æ—¶æ—¶é—´</span><br><span class="line">private let requestTimeoutClosure = &#123; (endpoint: Endpoint, done: @escaping MoyaProvider&lt;ApiManager&gt;.RequestResultClosure) in</span><br><span class="line">    do &#123;</span><br><span class="line">        var request = try endpoint.urlRequest()</span><br><span class="line">        request.timeoutInterval = 60</span><br><span class="line">        done(.success(request))</span><br><span class="line">    &#125; catch &#123;</span><br><span class="line">        return</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">let ApiManagerProvider = MoyaProvider&lt;ApiManager&gt;(endpointClosure: endpointMapping, requestClosure: requestTimeoutClosure, plugins:[])</span><br><span class="line"></span><br><span class="line">// MARK: å–æ¶ˆæ‰€æœ‰è¯·æ±‚</span><br><span class="line">func cancelAllRequest() &#123;</span><br><span class="line">    WTOtherProvider.manager.session.getTasksWithCompletionHandler &#123; dataTasks, uploadTasks, downloadTasks in</span><br><span class="line">        dataTasks.forEach &#123; $0.cancel() &#125;</span><br><span class="line">        uploadTasks.forEach &#123; $0.cancel() &#125;</span><br><span class="line">        downloadTasks.forEach &#123; $0.cancel() &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    WTLoginProvider.manager.session.getTasksWithCompletionHandler &#123; dataTasks, uploadTasks, downloadTasks in</span><br><span class="line">        dataTasks.forEach &#123; $0.cancel() &#125;</span><br><span class="line">        uploadTasks.forEach &#123; $0.cancel() &#125;</span><br><span class="line">        downloadTasks.forEach &#123; $0.cancel() &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    â€¦â€¦</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">public func endpointMapping&lt;Target: TargetType&gt;(target: Target) -&gt; Endpoint &#123;</span><br><span class="line">    WTDLog(&quot;è¯·æ±‚è¿æ¥ï¼š\(target.baseURL)\(target.path) \næ–¹æ³•ï¼š\(target.method)\nå‚æ•°ï¼š\(String(describing: target.task.self)) &quot;)</span><br><span class="line">    return MoyaProvider.defaultEndpointMapping(for: target)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">final class RequestAlertPlugin: PluginType &#123;</span><br><span class="line">    </span><br><span class="line">    func prepare(_ request: URLRequest, target: TargetType) -&gt; URLRequest &#123;</span><br><span class="line">        return request</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    func willSend(_ request: RequestType, target: TargetType) &#123;</span><br><span class="line">        //å®ç°å‘é€è¯·æ±‚å‰éœ€è¦åšçš„äº‹æƒ…</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public func didReceive(_ result: Result&lt;Response, MoyaError&gt;, target: TargetType) &#123;</span><br><span class="line"></span><br><span class="line">        switch result &#123;</span><br><span class="line">        case .success(let response):</span><br><span class="line">            guard response.statusCode == 200 else &#123;</span><br><span class="line">                if response.statusCode == 401 &#123;</span><br><span class="line">                    if isJumpLogin == false &#123;</span><br><span class="line">                        cancelAllRequest()</span><br><span class="line">                        // é€€å‡ºç™»å½•</span><br><span class="line">                        if let nvc = (WTNavigationManger.Nav as? WTMainViewController) &#123;</span><br><span class="line">                            nvc.login()</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                return</span><br><span class="line">            &#125;</span><br><span class="line">            var json = try? JSON(data: response.data)</span><br><span class="line">            WTDLog(&quot;è¯·æ±‚çŠ¶æ€ç \(json?[&quot;status&quot;] ?? &quot;&quot;)&quot;)</span><br><span class="line">            </span><br><span class="line">            guard let codeString = json?[&quot;status&quot;] else &#123;return&#125;</span><br><span class="line">             if codeString == 401 &#123;// é€€å‡ºç™»å½•</span><br><span class="line">                if isJumpLogin == false &#123;</span><br><span class="line">                    cancelAllRequest()</span><br><span class="line">                    if let nvc = (WTNavigationManger.Nav as? WTMainViewController) &#123;</span><br><span class="line">                        nvc.login()</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                break</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        case .failure(let error):</span><br><span class="line">            WTDLog(error)</span><br><span class="line">            let myAppdelegate = UIApplication.shared.delegate as! AppDelegate</span><br><span class="line">            myAppdelegate.listenNetwork()</span><br><span class="line">            break</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">struct AuthPlugin: PluginType &#123;</span><br><span class="line">    let token: String</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">enum ApiManager &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">extension ApiManager: TargetType &#123;</span><br><span class="line">    var headers: [String : String]? &#123;</span><br><span class="line">        var dict = [&quot;ColaLanguage&quot;: (&quot;common.isChinese&quot;.L() == &quot;YES&quot;) ? &quot;CN&quot; : &quot;EN&quot;]</span><br><span class="line">        if let authToken =  WTLoginInfoManger.shareDataSingle.model?.accessToken &#123;</span><br><span class="line">            dict[&quot;Authorization&quot;] = authToken</span><br><span class="line">        &#125;</span><br><span class="line">        return dict</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    var baseURL: URL &#123;</span><br><span class="line">        return URL.init(string: AppURLHOST.MyPublicBaseURL)!</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    var path: String &#123;</span><br><span class="line">        return &quot;&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    var method: Moya.Method &#123;</span><br><span class="line">        return .get</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    var task: Task &#123;</span><br><span class="line">        return .requestPlain</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    var validate: Bool &#123;</span><br><span class="line">        return false</span><br><span class="line">    &#125;</span><br><span class="line">    var sampleData: Data &#123;</span><br><span class="line">        return &quot;&quot;.data(using: String.Encoding.utf8)!</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">/// æ•°æ® è½¬ æ¨¡å‹</span><br><span class="line">extension ObservableType where E == Response &#123;</span><br><span class="line">    public func mapHandyJsonModel&lt;T: HandyJSON&gt;(_ type: T.Type) -&gt; Observable&lt;T&gt; &#123;</span><br><span class="line">        return flatMap &#123; response -&gt; Observable&lt;T&gt; in</span><br><span class="line">            return Observable.just(response.mapHandyJsonModel(T.self))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">/// æ•°æ® è½¬ æ¨¡å‹</span><br><span class="line">extension Response &#123;</span><br><span class="line">    func mapHandyJsonModel&lt;T: HandyJSON&gt;(_ type: T.Type) -&gt; T &#123;</span><br><span class="line">        let jsonString = String.init(data: data, encoding: .utf8)</span><br><span class="line">        if let modelT = JSONDeserializer&lt;T&gt;.deserializeFrom(json: jsonString) &#123;</span><br><span class="line">            return modelT</span><br><span class="line">        &#125;</span><br><span class="line">        return JSONDeserializer&lt;T&gt;.deserializeFrom(json: &quot;&#123;\&quot;msg\&quot;:\&quot;\(&quot;common.try&quot;.L())\&quot;&#125;&quot;)!</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/// è‡ªå®šä¹‰æ’ä»¶</span><br><span class="line">public final class NetworkLoadingPlugin: PluginType &#123;</span><br><span class="line">    public func willSend(_ request: RequestType, target: TargetType) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    public func didReceive(_ result: Result&lt;Moya.Response, MoyaError&gt;, target: TargetType) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>æ¨¡å¼Target -&gt; Endpoint -&gt; Request</strong></p>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/24422c24f3f5cf628f45d967e4ec09c9.png" alt="æ¥è‡ªGitHubå›¾ç‰‡"></p>
<blockquote>
<p><code>Moya</code>è™½ç„¶æ˜¯åŸºäºAlamofireçš„ä½†æ˜¯æˆ‘ä»¬åœ¨ä»£ç ä¸­å´ä¸ä¼šå’ŒAlamofireæ‰“äº¤é“ï¼Œå®ƒæ˜¯é€šè¿‡æšä¸¾æ¥ç®¡ç†APIçš„ã€‚æˆ‘åœ¨é¡¹ç›®ä¸­å®šä¹‰æ¥ä¸€ä¸ªAPIåŸºç±»ï¼Œç„¶åä¸ºæ¯ä¸€ä¸ªæ¨¡å—å®šä¹‰äº†ä¸€ä¸ªAPIç®¡ç†ç±»ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">enum HomeApiManager &#123;</span><br><span class="line">    case getBanner // è·å–è½®æ’­</span><br><span class="line">    case getAnnouncement(per_page: String) // è·å–å…¬å‘Š</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¯¹äºè¯·æ±‚ç±»å‹çš„æ”¹å˜å’Œå¯¹äºURLçš„æ”¹å˜ä¹Ÿæ˜¯é€šè¿‡æšä¸¾</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var method: Moya.Method &#123;</span><br><span class="line">        switch self &#123;</span><br><span class="line">        case .orderCreate:</span><br><span class="line">            return .post</span><br><span class="line">        case .orderCancelById, .orderCancelByPair:</span><br><span class="line">            return .delete</span><br><span class="line">        default:</span><br><span class="line">            return .get</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">var path: String &#123;</span><br><span class="line">        switch self &#123;</span><br><span class="line">        case .getKline:</span><br><span class="line">            return &quot;/api/kline&quot;</span><br><span class="line">        case .transGetByID(let orderId):</span><br><span class="line">            return &quot;/api/\(orderId)&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><strong>è¯·æ±‚ä»»åŠ¡</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var task: Task &#123;</span><br><span class="line">    switch self &#123;</span><br><span class="line">    case .securityPostGoogleAuth(let tokenKey, let oldGoogleCode, let googleCode, let captcha):</span><br><span class="line">        return .requestParameters(parameters: [&quot;captcha&quot;: captcha], encoding: JSONEncoding.default) // postè¯·æ±‚</span><br><span class="line"></span><br><span class="line">    case .getReward(let type, let cursor, let limit):</span><br><span class="line">        return .requestParameters(parameters: [&quot;type&quot;: type], encoding: URLEncoding.default) // å…¶å®ƒè¯·æ±‚</span><br><span class="line"></span><br><span class="line">    case .uploadImage(let imageArry):</span><br><span class="line">        let formDataAry:NSMutableArray = NSMutableArray()</span><br><span class="line">        for (index,image) in imageArry.enumerated() &#123;</span><br><span class="line">            //å›¾ç‰‡è½¬æˆData</span><br><span class="line">            let data:Data = image.jpegData(compressionQuality: 0.7)!</span><br><span class="line">            //æ ¹æ®å½“å‰æ—¶é—´è®¾ç½®å›¾ç‰‡ä¸Šä¼ æ—¶å€™çš„åå­—</span><br><span class="line">            var dateStr: String = &quot;yyyy-MM-dd-HH:mm:ss&quot;.timeStampToString(timeStamp: Date().timeIntervalSince1970)</span><br><span class="line">            //åˆ«å¿˜è®°è¿™é‡Œç»™åå­—åŠ ä¸Šå›¾ç‰‡çš„åç¼€å“¦</span><br><span class="line">            dateStr = dateStr.appendingFormat(&quot;-%i.jpg&quot;, index)</span><br><span class="line">            let formData = MultipartFormData(provider: .data(data), name: &quot;file\(index)&quot;, fileName: dateStr, mimeType: &quot;image/jpeg&quot;)</span><br><span class="line">            formDataAry.add(formData)</span><br><span class="line">        &#125;</span><br><span class="line">        return .uploadCompositeMultipart(formDataAry as! [MultipartFormData], urlParameters: [</span><br><span class="line">            :])</span><br><span class="line">        </span><br><span class="line">    default:</span><br><span class="line">        return .requestPlain</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ’ä»¶æœºåˆ¶"><a href="#æ’ä»¶æœºåˆ¶" class="headerlink" title="æ’ä»¶æœºåˆ¶"></a>æ’ä»¶æœºåˆ¶</h3><blockquote>
<p><code>Moya</code>çš„å¦ä¸€ä¸ªå¼ºå¤§çš„åŠŸèƒ½å°±æ˜¯å®ƒçš„æ’ä»¶æœºåˆ¶ï¼Œæä¾›äº†ä¸¤ä¸ªæ¥å£ï¼ŒwillSendRequest å’Œ didReceiveResponseï¼Œå®ƒå¯ä»¥åœ¨è¯·æ±‚å‰å’Œè¯·æ±‚ååšä¸€äº›é¢å¤–çš„æ“ä½œè€Œå’Œä¸»åŠŸèƒ½æ˜¯è§£è€¦çš„ï¼Œæ¯”å¦‚å¯ä»¥åœ¨è¯·æ±‚å‰å¼€å§‹åŠ è½½åŠ¨ç”»è¯·æ±‚ç»“æŸåç§»é™¤åŠ è½½åŠ¨ç”»ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰æ’ä»¶ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">final class RequestAlertPlugin: PluginType &#123;</span><br><span class="line">    func prepare(_ request: URLRequest, target: TargetType) -&gt; URLRequest &#123;</span><br><span class="line">        return request</span><br><span class="line">    &#125;</span><br><span class="line">    func willSend(_ request: RequestType, target: TargetType) &#123;</span><br><span class="line">        ç°å‘é€è¯·æ±‚å‰éœ€è¦åšçš„äº‹æƒ…</span><br><span class="line">        if target.headers?[&quot;isHiddentLoading&quot;] != &quot;true&quot; &#123;</span><br><span class="line">            currentView?.addSubview(activityIndicatorView)</span><br><span class="line">            activityIndicatorView.center = currentView!.center</span><br><span class="line">            activityIndicatorView.startAnimating()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    public func didReceive(_ result: Result&lt;Response, MoyaError&gt;, target: TargetType) &#123;</span><br><span class="line">        if activityIndicatorView.isAnimating &#123;</span><br><span class="line">            activityIndicatorView.stopAnimating()</span><br><span class="line">            activityIndicatorView.removeFromSuperview()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/// è‡ªå®šä¹‰æ’ä»¶</span><br><span class="line">public final class NetworkLoadingPlugin: PluginType &#123;</span><br><span class="line">    public func willSend(_ request: RequestType, target: TargetType) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    public func didReceive(_ result: Result&lt;Moya.Response, MoyaError&gt;, target: TargetType) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Moyaé»˜è®¤æœ‰4ä¸ªæ’ä»¶</p>
<ol>
<li><p>AccessTokenPlugin    &#x2F;&#x2F; ç®¡ç†AccessTokençš„æ’ä»¶</p>
</li>
<li><p>CredentialsPlugin       &#x2F;&#x2F; ç®¡ç†è®¤è¯çš„æ’ä»¶</p>
</li>
<li><p>NetworkActivityPlugin &#x2F;&#x2F; ç®¡ç†ç½‘ç»œçŠ¶æ€çš„æ’ä»¶</p>
</li>
<li><p>NetworkLoggerPlugin &#x2F;&#x2F; ç®¡ç†ç½‘ç»œlogçš„æ’ä»¶</p>
</li>
</ol>
</blockquote>
<h3 id="RxSwift"><a href="#RxSwift" class="headerlink" title="RxSwift"></a>RxSwift</h3><blockquote>
<p>è¿™é‡Œçš„RxSwiftä¸æ˜¯å®Œæ•´çš„RxSwiftï¼Œè€Œæ˜¯ä¸ºMoyaå®šåˆ¶çš„ä¸€ä¸ªæ‰©å±•(pod â€˜Moya&#x2F;RxSwiftâ€™)åœ¨æ•°æ®è¯·æ±‚å›æ¥åè¿›è¡Œå¤„ç†ã€‚</p>
<ol>
<li><p>request()  ä¼ å…¥API</p>
</li>
<li><p>asObservable() æ˜¯Moyaä¸ºRxSwiftæä¾›çš„æ‰©å±•æ–¹æ³•ï¼Œè¿”å›å¯ç›‘å¬åºåˆ—</p>
</li>
<li><p>mapHandyJsonModel() ä¹Ÿæ˜¯Moya RxSwiftçš„æ‰©å±•æ–¹æ³•è¿›è¡Œè‡ªå®šä¹‰çš„ï¼Œå¯ä»¥æŠŠè¿”å›çš„æ•°æ®è§£ææˆmodel</p>
</li>
<li><p>subscribe() æ˜¯å¯¹å¤„ç†è¿‡çš„ Observable è®¢é˜…ä¸€ä¸ª onNext çš„è§‚å¯Ÿè€…ï¼Œä¸€æ—¦å¾—åˆ°JSONæ ¼å¼çš„æ•°æ®ï¼Œå°±ä¼šç»è¡Œç›¸åº”çš„å¤„ç†</p>
</li>
<li><p>disposed() æ˜¯RxSwiftçš„ä¸€ä¸ªè‡ªåŠ¨å†…å­˜å¤„ç†æœºåˆ¶ï¼Œç±»ä¼¼ARCï¼Œä¼šè‡ªåŠ¨å¤„ç†ä¸éœ€è¦çš„å¯¹è±¡</p>
</li>
</ol>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/// æ•°æ® è½¬ æ¨¡å‹</span><br><span class="line">extension ObservableType where E == Response &#123;</span><br><span class="line">    public func mapHandyJsonModel&lt;T: HandyJSON&gt;(_ type: T.Type) -&gt; Observable&lt;T&gt; &#123;</span><br><span class="line">        return flatMap &#123; response -&gt; Observable&lt;T&gt; in</span><br><span class="line">            return Observable.just(response.mapHandyJsonModel(T.self))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">/// æ•°æ® è½¬ æ¨¡å‹</span><br><span class="line">extension Response &#123;</span><br><span class="line">    func mapHandyJsonModel&lt;T: HandyJSON&gt;(_ type: T.Type) -&gt; T &#123;</span><br><span class="line">        let jsonString = String.init(data: data, encoding: .utf8)</span><br><span class="line">        if let modelT = JSONDeserializer&lt;T&gt;.deserializeFrom(json: jsonString) &#123;</span><br><span class="line">            return modelT</span><br><span class="line">        &#125;</span><br><span class="line">        return JSONDeserializer&lt;T&gt;.deserializeFrom(json: &quot;&#123;\&quot;msg\&quot;:\&quot;\(&quot;common.try&quot;.L())\&quot;&#125;&quot;)!</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">extension WTApiManager &#123;</span><br><span class="line">    class func NetExchangeRequest&lt;T: BaseModel&gt;(disposeBag: DisposeBag,type: ExchangeApiManager, model: T.Type, isBackFail: Bool = false, Success:@escaping (T)-&gt;(), Error: @escaping ()-&gt;()) &#123;</span><br><span class="line">        WTExchangeProvider.rx.request(type)</span><br><span class="line">            .asObservable()</span><br><span class="line">            .mapHandyJsonModel(model)</span><br><span class="line">            .subscribe &#123; (event) in</span><br><span class="line">                switch event &#123;</span><br><span class="line">                case let .next(data):</span><br><span class="line">                    if isBackFail &#123;</span><br><span class="line">                        Success(data)</span><br><span class="line">                        break</span><br><span class="line">                    &#125;</span><br><span class="line">                    guard data.status == 200 else &#123;</span><br><span class="line">                        WTProgressHUD.show(error: data.message ?? &quot;common.try&quot;.L(), toView: nil)</span><br><span class="line">                        Error()</span><br><span class="line">                        break</span><br><span class="line">                    &#125;</span><br><span class="line">                    Success(data)</span><br><span class="line">                    break</span><br><span class="line">                case let .error(error):</span><br><span class="line">                    WTDLog(error)</span><br><span class="line">                    Error()</span><br><span class="line">                    break</span><br><span class="line">                default:</span><br><span class="line">                    break</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;.disposed(by: disposeBag)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="HandyJSON"><a href="#HandyJSON" class="headerlink" title="HandyJSON"></a>HandyJSON</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class BaseModel: HandyJSON &#123;</span><br><span class="line">    var status: Int = 0</span><br><span class="line">    var message: String? = nil // æœåŠ¡ç«¯è¿”å›æç¤º</span><br><span class="line">    required init()&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class WTBaseModel&lt;T: HandyJSON&gt;: BaseModel &#123;</span><br><span class="line">    var data: T? // å…·ä½“çš„dataçš„æ ¼å¼å’Œä¸šåŠ¡ç›¸å…³ï¼Œæ•…ç”¨æ³›å‹å®šä¹‰</span><br><span class="line">&#125;</span><br><span class="line">struct WTCurrencyBalanceModel: HandyJSON &#123;</span><br><span class="line">    var coinCode: String = &quot;&quot;</span><br><span class="line">    let balanceAvailable: Double = 0.0</span><br><span class="line">    let balanceFrozen: Double = 0.0</span><br><span class="line">    let worth: Double = 0.0</span><br><span class="line">&#125;</span><br><span class="line">// ç½‘ç»œè¯·æ±‚ ä¼ å…¥å¯¹åº”model</span><br><span class="line">WTApiManager.NetOtherRequest(disposeBag: disposeBag, type: .getMarketsPrice, model: WTBaseModel&lt;WTRateModel&gt;, Success: &#123;(model) in</span><br><span class="line">&#125;) &#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä»¥ä¸Šå°±æ˜¯æˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨"><a href="#ä»¥ä¸Šå°±æ˜¯æˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨" class="headerlink" title="ä»¥ä¸Šå°±æ˜¯æˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨"></a>ä»¥ä¸Šå°±æ˜¯æˆ‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨</h3><p><strong><code>Moya+HandyJSON+RxSwift</code>çš„æ–¹æ³•ï¼Œå¦‚æœæœ‰é”™è¯¯æˆ–è€…ä¸è¶³ä¹‹å¤„è¿˜æœ›æŒ‡æ­£ï¼Œè°¢è°¢</strong></p>
]]></content>
      <categories>
        <category>swift</category>
      </categories>
      <tags>
        <tag>â€œswiftâ€</tag>
        <tag>â€œç½‘ç»œè¯·æ±‚â€</tag>
        <tag>â€œMoyaâ€</tag>
        <tag>â€œHandyJSONâ€</tag>
        <tag>â€œRxSwiftâ€</tag>
      </tags>
  </entry>
  <entry>
    <title>é¡¹ç›®å‰–æ04-swift ç½‘ç»œè¯·æ±‚Moya+Alamofire(HTTPS)è¯ä¹¦éªŒè¯</title>
    <url>/2024/03/05/%E9%A1%B9%E7%9B%AE%E5%89%96%E6%9E%9004-swift-%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82Moya-Alamofire-HTTPS-%E8%AF%81%E4%B9%A6%E9%AA%8C%E8%AF%81/</url>
    <content><![CDATA[<h2 id="SSLè¯ä¹¦éªŒè¯"><a href="#SSLè¯ä¹¦éªŒè¯" class="headerlink" title="SSLè¯ä¹¦éªŒè¯"></a>SSLè¯ä¹¦éªŒè¯</h2><p><strong>ä¸€ç§åŠ å¼ºApp å’Œ Server é—´é€šè®¯å®‰å…¨çš„æ–¹æ³•ã€‚ä¸»è¦ç›®æ ‡æ˜¯ç¡®ä¿ App ä»…ä¸é¢„å…ˆéªŒè¯çš„ Server å»ºç«‹å®‰å…¨è¿æ¥ï¼Œé˜²æ­¢ä¸­é—´äººæ”»å‡»ï¼ˆMan-in-the-Middleï¼ŒMitMï¼‰ç­‰å®‰å…¨é£é™©ã€‚ä¸€èˆ¬å¸¸ç”¨çš„æœ‰ä¸¤ç§æ–¹å¼è¿›è¡ŒéªŒè¯ï¼ŒCertificate Pinningå’ŒPublic Key Pinningã€‚</strong></p>
<blockquote>
<p>Alamofire5.0 ä»¥åå°†è¯ä¹¦éªŒè¯ç±»æ”¾äºServerTrustEvaluationè¿™ä¸ªç±»é‡Œé¢ã€‚ä¸€å…±æœ‰6ç§éªŒè¯ç­–ç•¥ï¼š</p>
<ol>
<li><p><strong>DefaultTrustEvaluator</strong> - ï¼ˆé»˜è®¤éªŒè¯ç­–ç•¥ï¼‰åªè¦æ˜¯åˆæ³•è¯ä¹¦å°±èƒ½é€šè¿‡éªŒè¯ã€‚</p>
</li>
<li><p><strong>RevocationTrustEvaluator</strong>ï¼ˆéªŒè¯æ³¨é”€ç­–ç•¥ï¼‰å¯¹æ³¨é”€è¯ä¹¦åšçš„ä¸€ç§é¢å¤–è®¾ç½®ï¼ŒAlamofireä»iOS10.1æ‰å¼€å§‹æ”¯æŒåŠé”€è¯ä¹¦çš„ç­–ç•¥ã€‚</p>
</li>
<li><p><strong>PinnedCertificatesTrustEvaluator</strong>ï¼ˆè¯ä¹¦éªŒè¯ç­–ç•¥ï¼‰appç«¯ä¼šå¯¹æœåŠ¡å™¨ç«¯è¿”å›çš„è¯ä¹¦å’Œæœ¬åœ°ä¿å­˜çš„è¯ä¹¦ä¸­çš„å…¨éƒ¨å†…å®¹è¿›è¡Œæ ¡éªŒéœ€è¦å…¨éƒ¨æ­£ç¡®ï¼Œæ­¤éªŒè¯ç­–ç•¥è¿˜å¯ä»¥æ¥å—è‡ªç­¾åè¯ä¹¦ï¼Œå®‰å…¨æ€§ç›¸å¯¹è¾ƒé«˜ï¼Œæ­¤æ–¹æ³•è¾ƒä¸ºå›ºå®šï¼Œå¦‚æœ Server æ›´æ–°è¯ä¹¦ï¼ŒApp éœ€è¦å®šæœŸæ›´æ–°å¹¶é‡æ–°ä¸Šæ¶ã€‚</p>
</li>
<li><p><strong>PublicKeysTrustEvaluator</strong>ï¼ˆå…¬é’¥éªŒè¯ç­–ç•¥ï¼‰appç«¯åªä¼šå¯¹æœåŠ¡å™¨è¿”å›çš„è¯ä¹¦å’Œæœ¬åœ°ä¿å­˜çš„è¯ä¹¦ä¸­çš„ PublicKey(å…¬é’¥)è¿›è¡Œæ ¡éªŒï¼Œæ‰€ä»¥å½“è¯ä¹¦éœ€è¦æ›´æ–°æ—¶ï¼Œåªéœ€ç¡®ä¿å…¬é’¥ä¿æŒä¸å˜ï¼Œä¸éœ€è¦æ›´æ–°Appã€‚</p>
</li>
<li><p><strong>CompositeTrustEvaluator</strong>ï¼ˆè‡ªå®šä¹‰ç»„åˆéªŒè¯ç­–ç•¥ï¼‰ä»¥ä¸Šå¤šç§ç­–ç•¥ç»„åˆä¸€èµ·ï¼Œåªæœ‰åœ¨æ‰€æœ‰æ•°ç»„ä¸­å€¼éƒ½æˆåŠŸæ—¶æ‰æˆåŠŸã€‚</p>
</li>
<li><p><strong>DisabledTrustEvalutor</strong>ï¼ˆä¸éªŒéªŒè¯ç­–ç•¥ï¼‰æ— æ¡ä»¶ä¿¡ä»»ï¼Œæ‰€æœ‰éƒ½å¯ä»¥é€šè¿‡éªŒè¯ã€‚æ­£å¼ç¯å¢ƒä¸å»ºè®®ç”¨æ­¤ç­–ç•¥ï¼Œå¤šç”¨äºæµ‹è¯•ã€‚</p>
</li>
</ol>
</blockquote>
<p><strong>æˆ‘ä»¬ç”¨çš„æ˜¯PublicKeysTrustEvaluatorï¼ˆå…¬é’¥éªŒè¯ç­–ç•¥ï¼‰</strong></p>
<hr>
<blockquote>
<p>åå°æä¾›è¯ä¹¦ï¼Œå°†æ­£å¼æ”¾åœ¨é¡¹ç›®ç›®å½•ä¸­ã€‚</p>
</blockquote>
<p><img src="https://i-blog.csdnimg.cn/blog_migrate/d2b909e2935eccedbf88e97df824ecf9.png" alt="æœ¬åœ°è¯ä¹¦å­˜æ”¾"></p>
<blockquote>
<p>è·å–æœ¬åœ°è¯ä¹¦ï¼Œæå–è¯ä¹¦çš„å…¬é’¥ï¼ˆè·å–å…¬é’¥keyæ•°ç»„ï¼‰ã€‚è¯ä¹¦åç¼€åä¸€èˆ¬æœ‰ï¼š.cerã€.crtã€.derç­‰ï¼Œæˆ‘é¡¹ç›®ä¸­ç”¨çš„cerï¼Œè¯ä¹¦é“¾å¿…é¡»åŒ…å«ä¸€ä¸ªå›ºå®šçš„å…¬é’¥ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">struct WTCertificates &#123;</span><br><span class="line">    static let rootCA = WTCertificates.certificate( )</span><br><span class="line">    static func certificate() -&gt; [SecKey] &#123;</span><br><span class="line">        var publicKeyArray:[SecKey] = []</span><br><span class="line">        for resource in [&quot;xxx&quot;, &quot;xxxx&quot;, &quot;xxxxx&quot;] &#123;// æœ¬åœ°è¯ä¹¦åç§°</span><br><span class="line">            if let filePath = Bundle.main.path(forResource: resource, ofType: &quot;cer&quot;), let data = try? Data(contentsOf: URL(fileURLWithPath: filePath)) as CFData, let certificate = SecCertificateCreateWithData(nil, data),let publicKey = certificate.af.publicKey &#123;</span><br><span class="line">                publicKeyArray.append(publicKey)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return publicKeyArray</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ç»™Sessionæ·»åŠ ç­–ç•¥ï¼ˆæ¥å—è´¨è¯¢ï¼‰</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var requestManagerSession: Session = &#123;</span><br><span class="line">    if WTCertificates.rootCA.count &gt; 0, verifyCert &#123;</span><br><span class="line">        let certificates: [SecKey] = WTCertificates.rootCA</span><br><span class="line">        let trustPolicy = PublicKeysTrustEvaluator(keys: certificates, performDefaultValidation: false, validateHost: false)</span><br><span class="line">        let manager = ServerTrustManager(evaluators: [</span><br><span class="line">            &quot;xxx.xxx.com&quot;: trustPolicy,</span><br><span class="line">            &quot;xx.xx.jftplus.com&quot;: trustPolicy,</span><br><span class="line">            &quot;xxx.xx.com&quot;: trustPolicy])// base url å¦‚ä½•åŸŸåè¿‡å¤šï¼Œå¯ä»¥å­ç±»åŒ– ServerTrustManagerï¼Œå¹¶ç”¨è‡ªå·±çš„è‡ªå®šä¹‰å®ç°é‡å†™ serverTrustEvaluator(forHost:) æ–¹æ³•</span><br><span class="line">        let configuration = URLSessionConfiguration.af.default</span><br><span class="line">        return Session(configuration: configuration, serverTrustManager: manager)</span><br><span class="line">    &#125;</span><br><span class="line">    return MoyaProvider&lt;ApiManager&gt;.defaultAlamofireSession()</span><br><span class="line">&#125;()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>åœ¨Moyaä¸­æ·»åŠ requestManagerSession</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var JKOtherApiManagerProvider = MoyaProvider&lt;JKOtherApiManager&gt;(endpointClosure: endpointMapping, requestClosure: requestTimeoutClosure, session:requestManagerSession, plugins:[RequestAlertPlugin(), networkPlugin])</span><br></pre></td></tr></table></figure>
<h2 id="OC-HTTPS-è¯ä¹¦é…ç½®éªŒè¯"><a href="#OC-HTTPS-è¯ä¹¦é…ç½®éªŒè¯" class="headerlink" title="OC HTTPS è¯ä¹¦é…ç½®éªŒè¯"></a>OC HTTPS è¯ä¹¦é…ç½®éªŒè¯</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//1 å°†è¯ä¹¦æ‹–è¿›é¡¹ç›®</span><br><span class="line"></span><br><span class="line">//2 è·å–è¯ä¹¦è·¯å¾„</span><br><span class="line">NSString *certPath = [[NSBundle mainBundle] pathForResource: @&quot;cetus&quot; ofType:@&quot;cer&quot;];</span><br><span class="line">//3 è·å–è¯ä¹¦data</span><br><span class="line">NSData *certData = [NSData dataWithContentsOfFile:certPath];</span><br><span class="line">//4 åˆ›å»ºAFN ä¸­çš„securityPolicy</span><br><span class="line">AFSecurityPolicy *securityPolicy = [AFSecurityPolicy policyWithPinningMode:AFSSLPinningModePublicKey withPinnedCertificates:[[NSSet alloc] initWithObjects:certData,nil]];</span><br><span class="line">//5 è¿™é‡Œå°±å¯ä»¥æ·»åŠ å¤šä¸ªserverè¯ä¹¦</span><br><span class="line">NSSet *dataSet = [[NSSet alloc]initWithObjects:certData, nil];</span><br><span class="line">//6 ç»‘å®šè¯ä¹¦ï¼ˆä¸æ­¢ä¸€ä¸ªè¯ä¹¦ï¼‰</span><br><span class="line">[securityPolicy setPinnedCertificates:dataSet];</span><br><span class="line">//7 æ˜¯å¦å…è®¸æ— æ•ˆè¯ä¹¦</span><br><span class="line">securityPolicy.allowInvalidCertificates = YES;</span><br><span class="line">//8 æ˜¯å¦éœ€è¦éªŒè¯åŸŸå</span><br><span class="line">securityPolicy.validatesDomainName = YES;</span><br><span class="line">uploadManager.securityPolicy = securityPolicy;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æˆ‘ä»¬åå°ç»™çš„è¯ä¹¦æ ¼å¼åç¼€æ˜¯.pemï¼Œä»¥ä¸‹æ˜¯ç”¨OpenSSLå‘½ä»¤å°†.pemè¯ä¹¦è½¬æ¢ä¸ºceræ ¼å¼è¯ä¹¦æ–¹æ³•</p>
</blockquote>
<ol>
<li>æ‰“å¼€å‘½ä»¤è¡Œå·¥å…·ï¼Œè¿›å…¥å­˜æ”¾xxx.pemè¯ä¹¦çš„ç›®å½•</li>
<li>è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œå°†.pemè¯ä¹¦è½¬æ¢ä¸ºceræ ¼å¼<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">openssl x509 -in xxx.pem -inform PEM -out xxx.cer -outform DER</span><br></pre></td></tr></table></figure></li>
<li>æ‰§è¡Œå®Œæ¯•åï¼Œæ‚¨å°†åœ¨å½“å‰ç›®å½•ä¸‹çœ‹åˆ°ç”Ÿæˆçš„xxx.ceræ–‡ä»¶</li>
</ol>
<blockquote>
<p><strong>æ³¨æ„ï¼šè½¬æ¢åçš„cerè¯ä¹¦æ–‡ä»¶åªåŒ…å«å…¬é’¥ï¼Œä¸åŒ…å«ç§é’¥ä¿¡æ¯</strong></p>
</blockquote>
]]></content>
      <categories>
        <category>swift</category>
      </categories>
      <tags>
        <tag>â€œswiftâ€</tag>
        <tag>â€œè¯ä¹¦éªŒè¯â€</tag>
        <tag>â€œSSLâ€</tag>
      </tags>
  </entry>
  <entry>
    <title>é¡¹ç›®æ€»ç»“-ä½ç½®å®æ—¶å…±äº«</title>
    <url>/2016/11/17/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93-%E4%BD%8D%E7%BD%AE%E5%AE%9E%E6%97%B6%E5%85%B1%E4%BA%AB/</url>
    <content><![CDATA[<blockquote>
<p>ä»åŒ—äº¬å›æ¥åˆ°ä»Šå¤©å·²ç»æ•´æ•´ä¸‰ä¸ªæœˆäº†ï¼Œä¸‰ä¸ªæœˆæ²¡æœ‰æ›´æ–°ç®€ä¹¦äº†ã€‚å›æ¥æ‰¾äº†ä¸€å®¶æ–°çš„å…¬å¸ä¸Šç­ï¼Œæ­£å¥½ä»Šå¤©æ–°é¡¹ç›®æ‰“åŒ…æµ‹è¯•äº†ï¼Œæ‰¾äº†ç‚¹æ—¶é—´æ¥æ€»ç»“ä¸€ä¸‹æœ€è¿‘é¡¹ç›®ä¸­é‡åˆ°çš„ä¸€äº›é—®é¢˜ä¸å¿ƒå¾—ã€‚ä»Šå¤©ä¸»è¦åˆ†äº«<em>ä½ç½®å®æ—¶å…±äº«</em>ï¼Œå…¶å®ä¹‹å‰ä¹Ÿæœ‰æ—¶é—´ï¼Œå› ä¸ºåœ¨æ–°çš„å…¬å¸å¾ˆå°‘åŠ ç­ã€‚ä½†æ˜¯è‡ªå·±å¤ªæ‡’äº†ï¼Œæ‰€ä»¥â€¦â€¦ã€‚</p>
</blockquote>
<p><strong>è°ˆè°ˆæ–°å…¬å¸</strong>  </p>
<blockquote>
<p>è¿›å…¥å…¬å¸æ‰å‘ç°å…¬å¸æœ‰ä¸ªiOSå¤§ç¥å’Œæˆ‘æ˜¯ä¸€ä¸ªå¤§å­¦çš„ è¿˜æ˜¯ä¸€ä¸ªç³»çš„ è¿˜æ˜¯åŒä¸€çº§çš„ï¼Œè¿˜æœ‰ä¸¤ä¸ªAndroidä¸æˆ‘æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ï¼Œè¿™ä¸ªè¡Œä¸šçœŸçš„å°å•ŠğŸ˜„ã€‚å…¬å¸ä¸å¤§ï¼Œè€æ¿æ˜¯ä¸ªç¾ç±åäººï¼ˆè¿™åº”è¯¥æ˜¯æˆ‘ä»¬åŠ ç­å°‘çš„åŸå› å§ï¼‰ã€‚     </p>
</blockquote>
<p><strong>è°ˆè°ˆé¡¹ç›®</strong>    </p>
<blockquote>
<p>é¡¹ç›®å†…å®¹ä¿å¯†ï¼ˆç­¾äº†åè®®çš„ï¼‰â€¦â€¦ï¼Œè¿˜æ˜¯è°ˆæŠ€æœ¯å§ã€‚<br>1&gt;å³æ—¶é€šè®¯ï¼šæˆ‘ä»¬ç”¨çš„æ˜¯ç¯ä¿¡çš„ï¼Œå› ä¸ºè¿™ä¸æ˜¯ä¸»è¦çš„åŠŸèƒ½ï¼Œä½¿ç”¨å°±ç›´æ¥ç”¨çš„æ˜¯ç¯ä¿¡çš„UIï¼Œå°±æ˜¯å®˜æ–¹demoé‡Œé¢çš„EaseUIï¼Œå¯¼å…¥SDKå°±ä¸ç”¨è¯´äº†ï¼Œæˆ‘ä¸»è¦åˆ†äº«ä¸€ä¸‹æˆ‘ä»¬åœ¨é‡Œé¢æ·»åŠ çš„ä¸€ä¸ªæ–°çš„åŠŸèƒ½ï¼š<em>å®æ—¶ä½ç½®å…±äº«</em> æˆ‘ä»¬å°†è¿™ä¸ªåŠŸèƒ½æ·»åŠ åœ¨ç¾¤èŠé‡Œé¢çš„ã€‚ä¸»è¦é€»è¾‘ï¼šæ˜¯é€šè¿‡ç¯ä¿¡ç¾¤èŠçš„é€ä¼ æ¶ˆæ¯å®ç°çš„ç”¨çš„æ˜¯ç™¾åº¦åœ°å›¾ã€‚</p>
</blockquote>
<p><strong>é€šè¿‡ç™¾åº¦åœ°å›¾å®šä½ å°†è‡ªå·±çš„ä½ç½®çš„ç»çº¬åº¦æ”¾åœ¨é€ä¼ æ¶ˆæ¯çš„æ‰©å±•ä¿¡æ¯ä¸­ä¼ å‡ºå»</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// æ›´æ–°å‘é€</span><br><span class="line">- (void)sendCmdMessageWithType:(NSString *)type &#123;</span><br><span class="line">    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</span><br><span class="line">        EMCmdMessageBody *body = [[EMCmdMessageBody alloc] initWithAction:@&quot;shareLocation&quot;];</span><br><span class="line">        _currentUserId = [[NSUserDefaults standardUserDefaults] objectForKey:@&quot;eid&quot;];</span><br><span class="line">        NSDictionary *ext = @&#123;@&quot;latitude&quot;:@(_userStartLocation.location.coordinate.latitude),@&quot;longitude&quot;:@(_userStartLocation.location.coordinate.longitude),@&quot;type&quot;:type,_currentUserId:[[NSUserDefaults standardUserDefaults] objectForKey:@&quot;user_nickname&quot;]&#125;;</span><br><span class="line">        </span><br><span class="line">        EMMessage *message = [[EMMessage alloc] initWithConversationID:self.conversationID</span><br><span class="line">                                                                  from:_currentUserId</span><br><span class="line">                                                                    to:self.conversationID</span><br><span class="line">                                                                  body:body</span><br><span class="line">                                                                   ext:ext];</span><br><span class="line">        message.chatType = EMChatTypeGroupChat;</span><br><span class="line">        [[EMClient sharedClient].chatManager sendMessage:message progress:nil completion:^(EMMessage *message, EMError *error) &#123;</span><br><span class="line">            if (error) &#123;</span><br><span class="line">                [CTHUD showText:@&quot;ä½ç½®æ›´æ–°å¤±è´¥&quot;];</span><br><span class="line">                // å»è¯·æ±‚token</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ç„¶ååœ¨è§£æé€å½»ä¿¡æ¯çš„è§£æä½ç½®ä¿¡æ¯</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// æ”¶åˆ°è§£æ</span><br><span class="line">- (void)didReceiveCmdMessages:(NSArray *)aCmdMessages &#123;</span><br><span class="line">    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</span><br><span class="line">        for (EMMessage *cmdMessage in aCmdMessages) &#123;</span><br><span class="line">            EMCmdMessageBody *body = (EMCmdMessageBody *)cmdMessage.body;</span><br><span class="line">            // åˆ¤æ–­æ˜¯å¦æ˜¯ä½ç½®å…±äº«æ¶ˆæ¯</span><br><span class="line">            if ([body.action isEqualToString:@&quot;shareLocation&quot;]) &#123;</span><br><span class="line">                CLLocationCoordinate2D coordinate;</span><br><span class="line">                coordinate.latitude = [[cmdMessage.ext objectForKey:@&quot;latitude&quot;] doubleValue];</span><br><span class="line">                coordinate.longitude = [[cmdMessage.ext objectForKey:@&quot;longitude&quot;] doubleValue];</span><br><span class="line">                NSString *nickName = [cmdMessage.ext objectForKey:cmdMessage.from];</span><br><span class="line">                if ([[cmdMessage.ext objectForKey:@&quot;type&quot;] isEqualToString:@&quot;update&quot;]) &#123;</span><br><span class="line">                    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                        [self updateOtherAnnotationWithLocation:coordinate UserNickName:nickName];</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;else if ([[cmdMessage.ext objectForKey:@&quot;type&quot;] isEqualToString:@&quot;remove&quot;]) &#123;</span><br><span class="line">                    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                        [self removeOtherAnnotationWithUserNickName:nickName];</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;else if ([[cmdMessage.ext objectForKey:@&quot;type&quot;] isEqualToString:@&quot;join&quot;]) &#123;</span><br><span class="line">                    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                        [self addMyAnnotationWithLocation:coordinate UserNickName:nickName];</span><br><span class="line">                        [self sendCmdMessageWithType:@&quot;feedback&quot;];</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;else if ([[cmdMessage.ext objectForKey:@&quot;type&quot;] isEqualToString:@&quot;feedback&quot;]) &#123;</span><br><span class="line">                    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                        [self addMyAnnotationWithLocation:coordinate UserNickName:nickName];</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>å°†æ‰€æœ‰æ”¶åˆ°çš„é€ä¼ æ¶ˆçš„ä½ç½®ä¿¡æ¯æ ‡è¯†åœ¨åœ°å›¾ä¸Š</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// æ·»åŠ æ–°çš„ç”¨æˆ·æ ‡æ³¨</span><br><span class="line">- (void)addMyAnnotationWithLocation:(CLLocationCoordinate2D)coordinate UserNickName:(NSString *)nickName&#123;</span><br><span class="line">    BMKPointAnnotation *annotation = [[BMKPointAnnotation alloc]init];</span><br><span class="line">    annotation.coordinate = coordinate;</span><br><span class="line">    annotation.title = nickName;</span><br><span class="line">    [_mapView addAnnotation:annotation];</span><br><span class="line">    [_mapView selectAnnotation:annotation animated:YES];</span><br><span class="line">    [_otherUserAnnotation addObject:annotation];</span><br><span class="line">    [_otherUserNickName addObject:nickName];</span><br><span class="line">    [_mapView showAnnotations:_otherUserAnnotation animated:YES];</span><br><span class="line">    [_mapView setCenterCoordinate:coordinate animated:YES];</span><br><span class="line">    while (!_mapView.zoomOut) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>è¿˜éœ€è¦é€šè¿‡ä¼ é€’è€…çš„ä¼ é€’çš„ç±»å‹å®šè¯¥ä½ç½®æ˜¯æ–°åŠ å…¥ç”¨æˆ·è¿˜æ˜¯å·²ç»å­˜åœ¨çš„ç”¨æˆ·</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if ([[cmdMessage.ext objectForKey:@&quot;type&quot;] isEqualToString:@&quot;update&quot;]) &#123;</span><br><span class="line">                    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                        [self updateOtherAnnotationWithLocation:coordinate UserNickName:nickName];</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;else if ([[cmdMessage.ext objectForKey:@&quot;type&quot;] isEqualToString:@&quot;remove&quot;]) &#123;</span><br><span class="line">                    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                        [self removeOtherAnnotationWithUserNickName:nickName];</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;else if ([[cmdMessage.ext objectForKey:@&quot;type&quot;] isEqualToString:@&quot;join&quot;]) &#123;</span><br><span class="line">                    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                        [self addMyAnnotationWithLocation:coordinate UserNickName:nickName];</span><br><span class="line">                        [self sendCmdMessageWithType:@&quot;feedback&quot;];</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;else if ([[cmdMessage.ext objectForKey:@&quot;type&quot;] isEqualToString:@&quot;feedback&quot;]) &#123;</span><br><span class="line">                    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                        [self addMyAnnotationWithLocation:coordinate UserNickName:nickName];</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ–°ç”¨æˆ·éœ€è¦æ·»åŠ å¤§å¤´é’ˆï¼Œå·²ç»å­˜åœ¨çš„ç”¨æˆ·åªéœ€è¦æ›´æ–°ä½ç½®</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// æ›´æ–°ç”¨æˆ·æ ‡æ³¨</span><br><span class="line">- (void)updateOtherAnnotationWithLocation:(CLLocationCoordinate2D)coordinate UserNickName:(NSString *)nickName&#123;</span><br><span class="line">    for (BMKPointAnnotation *annotation in _otherUserAnnotation) &#123;</span><br><span class="line">        if ([annotation.title isEqualToString:nickName]) &#123;</span><br><span class="line">            annotation.coordinate = coordinate;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>é€šè¿‡ç™¾åº¦åœ°å›¾è·å¾—è‡ªå·±ç§»åŠ¨çš„è·ç¦»</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">BMKMapPoint point1 = BMKMapPointForCoordinate(CLLocationCoordinate2DMake(_userStartLocation.location.coordinate.latitude,_userStartLocation.location.coordinate.latitude));</span><br><span class="line"></span><br><span class="line">BMKMapPoint point2 = BMKMapPointForCoordinate(CLLocationCoordinate2DMake(userLocation.location.coordinate.latitude,userLocation.location.coordinate.latitude));</span><br><span class="line"></span><br><span class="line"> CLLocationDistance distance = BMKMetersBetweenMapPoints(point1,point2);</span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<blockquote>
<p>è‡ªå·±å®šä¹‰ä¸€ä¸ªç§»åŠ¨çš„ç²¾åº¦ï¼Œæˆ‘ä»¬å½“æ—¶å®šçš„ç§»åŠ¨è·ç¦»å¤§äº20ç±³ï¼ˆdistance&gt;20ï¼‰å°±å‘é€ä¸€æ¬¡ä½ç½®æ›´æ–°ã€‚<br>æœ€åå½“éœ€è¦ç¦»å¼€ä½ç½®å…±äº«æ˜¯ä¹Ÿéœ€è¦å†å‘é€ä¸€æ¬¡ä¿¡æ¯ï¼Œé€ä¼ è§£æå‡ºï¼Œç„¶åç§»é™¤æ ‡è¯†</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// åˆ é™¤ç”¨æˆ·æ ‡æ³¨</span><br><span class="line">- (void)removeOtherAnnotationWithUserNickName:(NSString *)nickName&#123;</span><br><span class="line">    for (BMKPointAnnotation *annotation in _otherUserAnnotation) &#123;</span><br><span class="line">        if ([annotation.title isEqualToString:nickName]) &#123;</span><br><span class="line">            [_otherUserAnnotation removeObject:annotation];</span><br><span class="line">            [_otherUserNickName removeObject:nickName];</span><br><span class="line">            [_mapView removeAnnotation:annotation];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ç»“æŸè¯­</strong></p>
<blockquote>
<p>å®æ—¶å…±äº« å…¶å®ä¸ç¾¤èŠå·®ä¸å¤šï¼Œå°±æ˜¯æˆ‘çš„ä½ç½®ç§»åŠ¨è·ç¦»è¾¾åˆ°äº†ç²¾åº¦è¦æ±‚ï¼Œæˆ‘å°±å‘é€ä¸€æ¬¡ç¾¤æ¶ˆæ¯ï¼Œè®©æ¯ä¸€ä¸ªå‚åŠ å…±äº«çš„äººéƒ½çŸ¥é“ï¼Œç„¶ååœ¨è‡ªå·±çš„åœ°å›¾ä¸Šæ›´æ–°ä¸€æ¬¡ã€‚ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬çš„ä½ç½®å®æ—¶å…±äº«çš„é€»è¾‘ä¸éƒ¨åˆ†ä»£ç ï¼Œæ¬¢è¿å„ä½çš„æŒ‡æ­£ï¼Œè°¢è°¢ã€‚</p>
</blockquote>
]]></content>
      <categories>
        <category>iOS</category>
      </categories>
      <tags>
        <tag>â€œiOSâ€</tag>
        <tag>â€œç™¾åº¦åœ°å›¾â€</tag>
        <tag>â€œä½ç½®å®æ—¶å…±äº«â€</tag>
      </tags>
  </entry>
</search>
